"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[81118],{81118:function(e,t,r){r.d(t,{xp:function(){return z},Vt:function(){return K}});var n=r(37762),i=r(1413),a=r(74165),o=r(15861),s=r(15671),l=r(43144),u=r(60136),c=r(29388),p=r(27366),d=r(76200),v=r(10064),f=r(32718),h=r(66978),y=r(35995),m=r(49861),x=(r(93169),r(84936),r(38511)),g=r(69912),Z=r(31201),b=r(15909),w=r(53866),S=r(90724),k=r(78952),I=r(25899),_=r(70361),N=r(30494),R=null;function C(){return R}var E,P,A=r(7575),T=r(98995),U=r(32698),j=r(40739),L=r(76926),O=r(9634),K=function(e){var t=function(e){(0,u.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,s.Z)(this,r),(e=t.apply(this,arguments)).spatialReference=null,e.fullExtent=null,e.heightModelInfo=null,e.minScale=0,e.maxScale=0,e.version={major:Number.NaN,minor:Number.NaN,versionString:""},e.copyright=null,e.sublayerTitleMode="item-title",e.title=null,e.layerId=null,e.indexInfo=null,e._debouncedSaveOperations=(0,h.Ds)(function(){var t=(0,o.Z)((0,a.Z)().mark((function t(r,n,i){return(0,a.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next=t.t0===z.SAVE?3:t.t0===z.SAVE_AS?4:5;break;case 3:return t.abrupt("return",e._save(n));case 4:return t.abrupt("return",e._saveAs(i,n));case 5:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()),e}return(0,l.Z)(r,[{key:"readSpatialReference",value:function(e,t){return q(t)}},{key:"readFullExtent",value:function(e,t,r){if(null!=e&&"object"==typeof e){var n=null==e.spatialReference?(0,i.Z)((0,i.Z)({},e),{},{spatialReference:q(t)}):e;return w.Z.fromJSON(n,r)}var a=t.store,o=q(t);return null==o||null==(null===a||void 0===a?void 0:a.extent)||!Array.isArray(a.extent)||a.extent.some((function(e){return e<V}))?null:new w.Z({xmin:a.extent[0],ymin:a.extent[1],xmax:a.extent[2],ymax:a.extent[3],spatialReference:o})}},{key:"parseVersionString",value:function(e){var t={major:Number.NaN,minor:Number.NaN,versionString:e},r=e.split(".");return r.length>=2&&(t.major=parseInt(r[0],10),t.minor=parseInt(r[1],10)),t}},{key:"readVersion",value:function(e,t){var r=t.store,n=null!=r.version?r.version.toString():"";return this.parseVersionString(n)}},{key:"readTitlePortalItem",value:function(e){return"item-title"!==this.sublayerTitleMode?void 0:e}},{key:"readTitleService",value:function(e,t){var r,n=null===(r=this.portalItem)||void 0===r?void 0:r.title;if("item-title"===this.sublayerTitleMode)return this.url?(0,I.a7)(this.url,t.name):t.name;var i=t.name;if(!i&&this.url){var a=(0,I.Qc)(this.url);null!=a&&(i=a.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&n&&(i=n+" - "+i),(0,I.ld)(i)}},{key:"url",set:function(e){if(null!=e){var t=(0,I.XG)({layer:this,url:e,nonStandardUrlAllowed:!1,logger:f.Z.getLogger(this)});this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}else this._set("url",e)}},{key:"writeUrl",value:function(e,t,r,n){(0,I.wH)(this,e,"layers",t,n)}},{key:"parsedUrl",get:function(){var e=this._get("url"),t=(0,y.mN)(e);return t&&null!=this.layerId&&(t.path="".concat(t.path,"/layers/").concat(this.layerId)),t}},{key:"_fetchIndexAndUpdateExtent",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r){var n,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.indexInfo=(0,N.T)(null!==(n=null===(i=this.parsedUrl)||void 0===i?void 0:i.path)&&void 0!==n?n:"",this.rootNode,t,this.customParameters,this.apiKey,f.Z.getLogger(this),r),e.t0=null==this.fullExtent||this.fullExtent.hasZ,e.t0){e.next=8;break}return e.t1=this,e.next=6,this.indexInfo;case 6:e.t2=e.sent,e.t1._updateExtent.call(e.t1,e.t2);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_updateExtent",value:function(e){if("page"===(null===e||void 0===e?void 0:e.type)){var t,r,n,i=e.rootIndex%e.pageSize,a=null===(t=e.rootPage)||void 0===t||null===(r=t.nodes)||void 0===r?void 0:r[i];if(null==(null===a||void 0===a||null===(n=a.obb)||void 0===n?void 0:n.center)||null==a.obb.halfSize)throw new v.Z("sceneservice:invalid-node-page","Invalid node page.");if(a.obb.center[0]<V||null==this.fullExtent||this.fullExtent.hasZ)return;var o=a.obb.halfSize,s=a.obb.center[2],l=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]);this.fullExtent.zmin=s-l,this.fullExtent.zmax=s+l}else if("node"===(null===e||void 0===e?void 0:e.type)){var u,c=null===(u=e.rootNode)||void 0===u?void 0:u.mbs;if(!Array.isArray(c)||4!==c.length||c[0]<V)return;var p=c[2],d=c[3],f=this.fullExtent;f&&(f.zmin=p-d,f.zmax=p+d)}}},{key:"_fetchService",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.url){e.next=2;break}throw new v.Z("sceneservice:url-not-set","Scene service can not be loaded without valid portal item or url");case 2:if(null!=this.layerId||!/SceneServer\/*$/i.test(this.url)){e.next=7;break}return e.next=5,this._fetchFirstLayerId(t);case 5:null!=(r=e.sent)&&(this.layerId=r);case 7:return e.abrupt("return",this._fetchServiceLayer(t));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchFirstLayerId",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.Z)(null!==(r=this.url)&&void 0!==r?r:"",{query:(0,i.Z)((0,i.Z)({f:"json"},this.customParameters),{},{token:this.apiKey}),responseType:"json",signal:t});case 2:if(!((n=e.sent).data&&Array.isArray(n.data.layers)&&n.data.layers.length>0)){e.next=5;break}return e.abrupt("return",n.data.layers[0].id);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchServiceLayer",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,n,o,s,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.Z)(null!==(r=null===(n=this.parsedUrl)||void 0===n?void 0:n.path)&&void 0!==r?r:"",{query:(0,i.Z)((0,i.Z)({f:"json"},this.customParameters),{},{token:this.apiKey}),responseType:"json",signal:t});case 2:if((o=e.sent).ssl&&this.url&&(this.url=this.url.replace(/^http:/i,"https:")),s=!1,o.data.layerType&&"Voxel"===o.data.layerType&&(s=!0),!s){e.next=7;break}return e.abrupt("return",this._fetchVoxelServiceLayer());case 7:l=o.data,this.read(l,this._getServiceContext()),this.validateLayer(l);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchVoxelServiceLayer",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.Z)((null===(r=this.parsedUrl)||void 0===r?void 0:r.path)+"/layer",{query:(0,i.Z)((0,i.Z)({f:"json"},this.customParameters),{},{token:this.apiKey}),responseType:"json",signal:t});case 2:n=e.sent.data,this.read(n,this._getServiceContext()),this.validateLayer(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getServiceContext",value:function(){var e;return{origin:"service",portalItem:this.portalItem,portal:null===(e=this.portalItem)||void 0===e?void 0:e.portal,url:this.parsedUrl}}},{key:"_ensureLoadBeforeSave",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(e.t0="beforeSave"in this&&"function"==typeof this.beforeSave,!e.t0){e.next=6;break}return e.next=6,this.beforeSave();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateLayer",value:function(e){}},{key:"_saveAs",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r){var n,o,s,l,u,c,p;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(0,i.Z)((0,i.Z)({},F),r),l=T.default.from(t)){e.next=4;break}throw new v.Z("sceneservice:portal-item-required","_saveAs() requires a portal item to save to");case 4:return(0,L.w)(l),l.id&&((l=l.clone()).id=null),u=l.portal||A.Z.getDefault(),e.next=8,this._ensureLoadBeforeSave();case 8:return l.type=D,l.portal=u,c=(0,U.Y)(l,"portal-item",!0),p={layers:[this.write({},c)]},e.next=13,Promise.all(null!==(n=c.resources.pendingOperations)&&void 0!==n?n:[]);case 13:return e.next=15,this._validateAgainstJSONSchema(p,c,s);case 15:return this.url&&(l.url=this.url),l.title||(l.title=this.title),M(l,s,E.newItem),e.next=20,u.signIn();case 20:return e.next=22,null===(o=u.user)||void 0===o?void 0:o.addItem({item:l,folder:null===s||void 0===s?void 0:s.folder,data:p});case 22:return e.next=24,(0,j.H)(this.resourceReferences,c);case 24:return this.portalItem=l,(0,b.D)(c),c.portalItem=l,e.abrupt("return",l);case 28:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_save",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var r,n,o,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,i.Z)((0,i.Z)({},F),t),this.portalItem){e.next=3;break}throw new v.Z("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService");case 3:if((0,L.w)(this.portalItem),this.portalItem.type===D){e.next=5;break}throw new v.Z("sceneservice:portal-item-wrong-type",'Portal item needs to have type "'.concat(D,'"'));case 5:return e.next=7,this._ensureLoadBeforeSave();case 7:return o=(0,U.Y)(this.portalItem,"portal-item",!0),s={layers:[this.write({},o)]},e.next=10,Promise.all(null!==(r=o.resources.pendingOperations)&&void 0!==r?r:[]);case 10:return e.next=12,this._validateAgainstJSONSchema(s,o,n);case 12:return this.url&&(this.portalItem.url=this.url),this.portalItem.title||(this.portalItem.title=this.title),M(this.portalItem,n,E.existingItem),e.next=17,(0,j.b)(this.portalItem,s,this.resourceReferences,o);case 17:return(0,b.D)(o),e.abrupt("return",this.portalItem);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_validateAgainstJSONSchema",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,r,n){var i,o,s,l,u,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null===n||void 0===n?void 0:n.validationOptions,(0,O.z)(r,{errorName:"sceneservice:save"},{ignoreUnsupported:null===i||void 0===i?void 0:i.ignoreUnsupported,supplementalUnsupportedErrors:["scenemodification:unsupported"]}),o=null===i||void 0===i?void 0:i.enabled,s=C(),!o||!s){e.next=13;break}return e.next=6,s();case 6:if((l=e.sent.validate(t,n.portalItemLayerType)).length){e.next=9;break}return e.abrupt("return");case 9:if(u="Layer item did not validate:\n".concat(l.join("\n")),f.Z.getLogger(this).error("_validateAgainstJSONSchema(): ".concat(u)),"throw"!==i.failPolicy){e.next=13;break}throw c=l.map((function(e){return new v.Z("sceneservice:schema-validation",e)})),new v.Z("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{validationErrors:c});case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(e);return(0,p._)([(0,m.Cb)(_.id)],t.prototype,"id",void 0),(0,p._)([(0,m.Cb)({type:k.Z})],t.prototype,"spatialReference",void 0),(0,p._)([(0,x.r)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readSpatialReference",null),(0,p._)([(0,m.Cb)({type:w.Z})],t.prototype,"fullExtent",void 0),(0,p._)([(0,x.r)("fullExtent",["fullExtent","store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readFullExtent",null),(0,p._)([(0,m.Cb)({readOnly:!0,type:S.Z})],t.prototype,"heightModelInfo",void 0),(0,p._)([(0,m.Cb)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],t.prototype,"minScale",void 0),(0,p._)([(0,m.Cb)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],t.prototype,"maxScale",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],t.prototype,"version",void 0),(0,p._)([(0,x.r)("version",["store.version"])],t.prototype,"readVersion",null),(0,p._)([(0,m.Cb)({type:String,json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,p._)([(0,m.Cb)({type:String,json:{read:!1}})],t.prototype,"sublayerTitleMode",void 0),(0,p._)([(0,m.Cb)({type:String})],t.prototype,"title",void 0),(0,p._)([(0,x.r)("portal-item","title")],t.prototype,"readTitlePortalItem",null),(0,p._)([(0,x.r)("service","title",["name"])],t.prototype,"readTitleService",null),(0,p._)([(0,m.Cb)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],t.prototype,"layerId",void 0),(0,p._)([(0,m.Cb)(_.HQ)],t.prototype,"url",null),(0,p._)([(0,Z.c)("url")],t.prototype,"writeUrl",null),(0,p._)([(0,m.Cb)()],t.prototype,"parsedUrl",null),(0,p._)([(0,m.Cb)({readOnly:!0})],t.prototype,"store",void 0),(0,p._)([(0,m.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],t.prototype,"rootNode",void 0),t=(0,p._)([(0,g.j)("esri.layers.mixins.SceneService")],t)},V=-1e38;function q(e){if(null!=e.spatialReference)return k.Z.fromJSON(e.spatialReference);var t=e.store,r=t.indexCRS||t.geographicCRS,n=r&&parseInt(r.substring(r.lastIndexOf("/")+1,r.length),10);return null!=n?new k.Z(n):null}function M(e,t,r){e.typeKeywords||(e.typeKeywords=[]);var i,a=t.getTypeKeywords(),o=(0,n.Z)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;e.typeKeywords.push(s)}}catch(l){o.e(l)}finally{o.f()}e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((function(e,t,r){return r.indexOf(e)===t})),r===E.newItem&&(e.typeKeywords=e.typeKeywords.filter((function(e){return"Hosted Service"!==e}))))}(P=E||(E={}))[P.existingItem=0]="existingItem",P[P.newItem=1]="newItem";var z,D="Scene Service",F={getTypeKeywords:function(){return[]},portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}};!function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(z||(z={}))},30494:function(e,t,r){r.d(t,{T:function(){return l}});var n=r(74165),i=r(1413),a=r(15861),o=r(76200),s=r(10064);function l(e,t,r,n,i,a,o){return u.apply(this,arguments)}function u(){return u=(0,a.Z)((0,n.Z)().mark((function e(t,r,a,l,u,c,p){var d,v,f,h,y,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=null,null==a){e.next=17;break}return v="".concat(t,"/nodepages/"),f=v+Math.floor(a.rootIndex/a.nodesPerPage),e.prev=3,e.next=6,(0,o.Z)(f,{query:(0,i.Z)((0,i.Z)({f:"json"},l),{},{token:u}),responseType:"json",signal:p});case 6:return e.t0=e.sent.data,e.t1=a.rootIndex,e.t2=a.nodesPerPage,e.t3=a.lodSelectionMetricType,e.t4=v,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),null!=c&&c.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",f,e.t5),d=e.t5;case 17:if(r){e.next=19;break}return e.abrupt("return",null);case 19:return h=null===r||void 0===r?void 0:r.split("/").pop(),y="".concat(t,"/nodes/"),m=y+h,e.prev=20,e.next=23,(0,o.Z)(m,{query:(0,i.Z)((0,i.Z)({f:"json"},l),{},{token:u}),responseType:"json",signal:p});case 23:return e.t6=e.sent.data,e.t7=y,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new s.Z("sceneservice:root-node-missing","Root node missing.",{pageError:d,nodeError:e.t8,url:m});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),u.apply(this,arguments)}},32698:function(e,t,r){r.d(t,{Y:function(){return s},h:function(){return o}});var n=r(1413),i=r(35995),a=r(7575);function o(e,t){return(0,n.Z)((0,n.Z)({},l(e,t)),{},{readResourcePaths:[]})}function s(e,t,r){var a=(0,i.mN)(e.itemUrl);return(0,n.Z)((0,n.Z)({},l(e,t)),{},{messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:a?{rootPath:a.path,writtenUrls:[]}:null,resources:r?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null})}function l(e,t){return{origin:t,url:(0,i.mN)(e.itemUrl),portal:e.portal||a.Z.getDefault(),portalItem:e}}},9634:function(e,t,r){r.d(t,{P:function(){return s},z:function(){return c}});var n=r(74165),i=r(37762),a=r(15861),o=r(10064);function s(e){return l.apply(this,arguments)}function l(){return l=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,o,s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=(0,i.Z)(t.allLayers);try{for(a.s();!(o=a.n()).done;)"beforeSave"in(s=o.value)&&"function"==typeof s.beforeSave&&(l=s.beforeSave())&&r.push(l)}catch(n){a.e(n)}finally{a.f()}return e.next=5,Promise.allSettled(r);case 5:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var u=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function c(e,t,r){var n,i=(null!==(n=e.messages)&&void 0!==n?n:[]).filter((function(e){return"error"===e.type})).map((function(e){var t=e.name,r=e.message,n=e.details;return new o.Z(t,r,n)}));if(e.blockedRelativeUrls&&(i=i.concat(e.blockedRelativeUrls.map((function(e){return new o.Z("url:unsupported","Relative url '".concat(e,"' is not supported"))})))),r){var a=r.ignoreUnsupported,s=r.supplementalUnsupportedErrors,l=void 0===s?[]:s,c=r.requiredPropertyChecksDisabled;a&&(i=i.filter((function(e){var t=e.name;return!(u.has(t)||l.includes(t))}))),c&&(i=i.filter((function(e){return"web-document-write:property-required"!==e.name})))}if(i.length>0)throw new o.Z(t.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:i})}}}]);
//# sourceMappingURL=81118.32e821dd.chunk.js.map