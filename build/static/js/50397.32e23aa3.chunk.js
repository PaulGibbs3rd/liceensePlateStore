"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[50397],{50397:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(1413),s=n(74165),i=n(15861),a=n(15671),o=n(43144),u=n(88301),c=n(61120),l=n(60136),h=n(29388),d=n(27366),f=n(10064),p=n(42537),y=n(94172),v=n(49861),_=(n(93169),n(32718),n(84936),n(69912)),k=n(49818),m=n(57898),g=n(62862),Z=function(e){(0,l.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,a.Z)(this,n),(e=t.apply(this,arguments)).pipelineConnectionStatus="disconnected",e.pipelineErrorString=null,e}return(0,o.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,y.watch)((function(){return e.layer.customParameters}),function(){var t=(0,i.Z)((0,s.Z)().mark((function t(n){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getWorker();case 2:t.sent.streamMessenger.updateCustomParameters(n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.layer.on("send-message-to-socket",function(){var t=(0,i.Z)((0,s.Z)().mark((function t(n){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getWorker();case 2:t.sent.streamMessenger.sendMessageToSocket(n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.layer.on("send-message-to-client",function(){var t=(0,i.Z)((0,s.Z)().mark((function t(n){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getWorker();case 2:t.sent.streamMessenger.sendMessageToClient(n),e._isUserPaused&&"type"in n&&"clear"===n.type&&e.incrementSourceRefreshVersion();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),(0,y.watch)((function(){return e.layer.purgeOptions}),(function(){return e._update()})),(0,y.watch)((function(){return e.suspended}),this._onSuspendedChange.bind(this))],"constructor"),this._doResume()}},{key:"destroy",value:function(){this._doPause()}},{key:"connectionError",get:function(){return this.pipelineErrorString?new f.Z("stream-controller",this.pipelineErrorString):null}},{key:"on",value:function(e,t){var r=this;if(Array.isArray(e))return(0,p.AL)(e.map((function(e){return r.on(e,t)})));var s=["data-received","message-received"].includes(e);s&&this.getWorker().then((function(t){return t.streamMessenger.enableEvent(e,!0)}));var i=(0,u.Z)((0,c.Z)(n.prototype),"on",this).call(this,e,t),a=this;return(0,p.kB)((function(){i.remove(),s&&(a._workerProxy.closed||a.hasEventListener(e)||a.getWorker().then((function(t){return t.streamMessenger.enableEvent(e,!1)})))}))}},{key:"queryLatestObservations",value:function(){var e=(0,i.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,o,u=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=this.layer.timeInfo)&&void 0!==r&&r.endField||null!==(i=this.layer.timeInfo)&&void 0!==i&&i.startField||null!==(a=this.layer.timeInfo)&&void 0!==a&&a.trackIdField){e.next=2;break}throw new f.Z("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");case 2:return e.next=4,this.getWorker();case 4:return o=e.sent,e.abrupt("return",(0,g.Y)(o.features.executeQueryForLatestObservations(this._cleanUpQuery(t),n).then((function(e){var t=k.Z.fromJSON(e);return t.features.forEach((function(e){e.layer=u.layer,e.sourceLayer=u.layer})),t})),new k.Z({features:[]})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"detach",value:function(){(0,u.Z)((0,c.Z)(n.prototype),"detach",this).call(this),this.pipelineConnectionStatus="disconnected"}},{key:"_streamConnectionStatus",get:function(){return this.pipelineConnectionStatus}},{key:"_doPause",value:function(){null!=this._refreshInterval&&(clearInterval(this._refreshInterval),this._refreshInterval=null)}},{key:"_doResume",value:function(){var e=this;this._refreshInterval=setInterval((function(){return e.incrementSourceRefreshVersion()}),this.layer.updateInterval)}},{key:"_doDisconnect",value:function(){this.getWorker().then((function(e){return e.streamMessenger.disconnect()})),this._doPause()}},{key:"_doConnect",value:function(){this.getWorker().then((function(e){return e.streamMessenger.connect()})),this.resume()}},{key:"_doClear",value:function(){this.getWorker().then((function(e){return e.streamMessenger.clear()})),null==this._refreshInterval&&this.incrementSourceRefreshVersion()}},{key:"_createClientOptions",value:function(){var e=this,t=(0,u.Z)((0,c.Z)(n.prototype),"_createClientOptions",this).call(this),s=this;return(0,r.Z)((0,r.Z)({},t),{},{get container(){return s.featureContainer},setProperty:function(t){e.set(t.propertyName,t.value)}})}}]),n}((0,n(27499).Z)(m.default));(0,d._)([(0,v.Cb)()],Z.prototype,"pipelineConnectionStatus",void 0),(0,d._)([(0,v.Cb)()],Z.prototype,"pipelineErrorString",void 0),(0,d._)([(0,v.Cb)({readOnly:!0})],Z.prototype,"connectionError",null),(0,d._)([(0,v.Cb)({readOnly:!0})],Z.prototype,"_streamConnectionStatus",null);var C=Z=(0,d._)([(0,_.j)("esri.views.2d.layers.StreamLayerView2D")],Z)},27499:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(15671),s=n(43144),i=n(60136),a=n(29388),o=n(27366),u=n(49861),c=(n(93169),n(32718),n(84936),n(69912)),l=n(18661),h=function(e){var t=function(e){(0,i.Z)(n,e);var t=(0,a.Z)(n);function n(){var e;(0,r.Z)(this,n);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._isUserPaused=!1,e.filter=null,e}return(0,s.Z)(n,[{key:"resume",value:function(){this._isUserPaused=!1,this.suspended||this._doResume()}},{key:"pause",value:function(){this._isUserPaused=!0,this.suspended||this._doPause()}},{key:"disconnect",value:function(){this._doDisconnect()}},{key:"connect",value:function(){this._doConnect()}},{key:"clear",value:function(){this._doClear()}},{key:"connectionStatus",get:function(){return(this._isUserPaused||this.suspended)&&"connected"===this._streamConnectionStatus?"paused":this._streamConnectionStatus}},{key:"_onSuspendedChange",value:function(e){e?this._doPause():this._isUserPaused||this._doResume()}}]),n}(e);return(0,o._)([(0,u.Cb)()],t.prototype,"_isUserPaused",void 0),(0,o._)([(0,u.Cb)({readOnly:!0})],t.prototype,"connectionStatus",null),(0,o._)([(0,u.Cb)({type:l.Z})],t.prototype,"filter",void 0),t=(0,o._)([(0,c.j)("esri.views.layers.StreamLayerView")],t)}}}]);
//# sourceMappingURL=50397.32e23aa3.chunk.js.map