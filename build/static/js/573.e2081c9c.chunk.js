"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[573],{2622:function(e,t,n){n.d(t,{Z:function(){return u}});var i=n(15671),r=n(43144),o=n(39052),a=n(56885),u=function(e,t){function n(e){(0,i.Z)(this,n),this._observable=new a.s,this._set=new Set(e)}return(0,r.Z)(n,[{key:"size",get:function(){return(0,o.it)(this._observable),this._set.size}},{key:"add",value:function(e){var t=this._set.size;return this._set.add(e),this._set.size!==t&&this._observable.notify(),this}},{key:"clear",value:function(){this._set.size>0&&(this._set.clear(),this._observable.notify())}},{key:"delete",value:function(e){var t=this._set.delete(e);return t&&this._observable.notify(),t}},{key:"entries",value:function(){return(0,o.it)(this._observable),this._set.entries()}},{key:"forEach",value:function(e,t){var n=this;(0,o.it)(this._observable),this._set.forEach((function(i,r){return e.call(t,i,r,n)}),t)}},{key:"has",value:function(e){return(0,o.it)(this._observable),this._set.has(e)}},{key:"keys",value:function(){return(0,o.it)(this._observable),this._set.keys()}},{key:"values",value:function(){return(0,o.it)(this._observable),this._set.values()}},{key:e,value:function(){return(0,o.it)(this._observable),this._set[Symbol.iterator]()}},{key:t,get:function(){return this._set[Symbol.toStringTag]}}]),n}(Symbol.iterator,Symbol.toStringTag)},66033:function(e,t,n){n.d(t,{$J:function(){return u},LT:function(){return c},RH:function(){return l},vb:function(){return d}});var i=n(74165),r=n(15861),o=(n(59486),n(82582)),a=n(53866);function u(e){var t;switch(null===e||void 0===e?void 0:e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}function l(e,t){return s.apply(this,arguments)}function s(){return s=(0,r.Z)((0,i.Z)().mark((function e(t,n){var r,o,a,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasZ&&"2d"!==n.type){e.next=2;break}return e.abrupt("return",t);case 2:if(null!==(a=null===(r=n.map)||void 0===r?void 0:r.ground)&&void 0!==a&&a.layers.length){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,a.queryElevation(t,{cache:null===(o=n.basemapTerrain)||void 0===o?void 0:o.elevationQueryCache});case 7:return u=e.sent,l=u.geometry,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function c(e,t,n){return v(e.center,t,n)}function d(e,t,n){switch(null===e||void 0===e?void 0:e.type){case"extent":return e;case"multipoint":case"polygon":case"polyline":return e.extent;case"point":return v(e,t,n);default:return null}}function v(e,t,n){var i=e.hasZ?e.z:void 0;if(null!==t&&void 0!==t&&t.map)return(null!=n?(0,o.D9)(t,n):t.extent).clone().centerAt(e).set({zmax:i,zmin:i});var r=e.x,u=e.y,l=e.spatialReference;return new a.Z({xmin:r-.25,ymin:u-.25,xmax:r+.25,ymax:u+.25,spatialReference:l,zmin:i,zmax:i})}},82582:function(e,t,n){n.d(t,{D9:function(){return l},DE:function(){return u},dp:function(){return a},o2:function(){return s},yZ:function(){return o}});var i=n(16889),r=n(68860);function o(e,t){var n=t||e.extent,i=e.width,o=(0,r.c9)(null===n||void 0===n?void 0:n.spatialReference);return n&&i?n.width/i*o*r.hd*96:0}function a(e,t){return e/((0,r.c9)(t)*r.hd*96)}function u(e){return e/(96*r.hd)}function l(e,t){var n=e.extent,i=e.width-(e.padding?e.padding.left+e.padding.right:0),r=a(t,n.spatialReference);return n.clone().expand(r*i/n.width)}function s(e,t,n){return function(e,t){return 0===t||(0,i.W8)(e,t)||e<t}(e,t)&&function(e,t){return 0===t||(0,i.W8)(e,t)||e>t}(e,n)}},28970:function(e,t,n){n.d(t,{d:function(){return i}});var i="OBJECTID"},91953:function(e,t,n){n.d(t,{b$:function(){return a},mR:function(){return r},uS:function(){return o}});n(59166);var i=n(8704);function r(e){return e.icon?e.icon:"image"in e&&e.image||e.className?void 0:"question"}function o(e){return e?{backgroundImage:"url(".concat(e,")")}:{}}function a(e){var t=e.action,n=e.feature,r=null===n||void 0===n?void 0:n.attributes,o="image"in t?t.image:void 0;return o&&r?(0,i.n)(o,r):null!==o&&void 0!==o?o:""}},69787:function(e,t,n){function i(e){return e&&"function"==typeof e.highlight}function r(e){return e&&"function"==typeof e.maskOccludee}function o(e,t,n){return null==e||e>=n&&(0===t||e<=t)}function a(e,t){if(t&&e){var n=e.minScale,i=e.maxScale;if(u(n,i))return o(t,n,i)}return!0}function u(e,t){return null!=e&&e>0||null!=t&&t>0}function l(e){return!(null!==e&&void 0!==e&&e.minScale)||!e.maxScale||e.minScale>=e.maxScale}function s(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatures"in e&&"layer"in e&&"view"in e}n.d(t,{Av:function(){return u},Cy:function(){return l},GB:function(){return a},Xi:function(){return s},_1:function(){return r},rs:function(){return o},tl:function(){return i}})},573:function(e,t,n){n.r(t),n.d(t,{default:function(){return q}});var i=n(4942),r=n(93433),o=n(74165),a=n(15861),u=n(29439),l=n(15671),s=n(43144),c=n(97326),d=n(60136),v=n(29388),h=n(27366),f=(n(59166),n(80987)),p=n(32718),g=n(94172),y=n(14916),w=n(49861),_=(n(93169),n(84936),n(69912)),b=n(66033),m=n(91953),F=n(10194),k=n(45966),C=n(33565),M=n(29845),x=n(72221),Z="esri-features",I={icon:"".concat(Z,"__icon"),actionImage:"".concat(Z,"__action-image"),base:Z,container:"".concat(Z,"__container"),contentContainer:"".concat(Z,"__content-container"),contentFeature:"".concat(Z,"__content-feature"),flowItemCollapsed:"".concat(Z,"__flow-item--collapsed"),header:"".concat(Z,"__header"),footer:"".concat(Z,"__footer"),featureMenuObserver:"".concat(Z,"__feature-menu-observer"),actionExit:"".concat(Z,"__action--exit"),loader:"".concat(Z,"__loader"),featuresHeading:"".concat(Z,"__heading"),paginationActionBar:"".concat(Z,"__pagination-action-bar"),paginationPrevious:"".concat(Z,"__pagination-previous"),paginationNext:"".concat(Z,"__pagination-next")},A=n(8905),P=(n(80975),n(80532)),E=n(67005),O=function(e){(0,d.Z)(i,e);var t=(0,v.Z)(i);function i(e,n){var r;return(0,l.Z)(this,i),(r=t.call(this,e,n)).messages=null,r.closed=!1,r.closable=!0,r._handleOpenRelatedFeature=function(e){r.emit("open-related-feature",{feature:e})},r}return(0,s.Z)(i,[{key:"loadDependencies",value:function(){return(0,A.h)({action:function(){return Promise.all([n.e(92358),n.e(46895),n.e(65138),n.e(91741)]).then(n.bind(n,6814))},"flow-item":function(){return Promise.all([n.e(92358),n.e(46895),n.e(89219),n.e(63839),n.e(65138),n.e(2654),n.e(23635),n.e(89524),n.e(48926)]).then(n.bind(n,48926))}})}},{key:"render",value:function(){var e=this,t=this.flowItems,n=null===t||void 0===t?void 0:t.toArray();return(0,E.u)(E.D,null,null===n||void 0===n?void 0:n.map((function(t){return e._renderRelatedRecordsFlowItem(t)})))}},{key:"_handleCloseClick",value:function(){this.emit("close")}},{key:"_handleExitClick",value:function(){this.emit("exit")}},{key:"_handleRelatedRecordsBackClick",value:function(){var e,t=null===(e=this.flowItems)||void 0===e?void 0:e.pop();t&&("showAllEnabled"in t.viewModel&&(t.viewModel.showAllEnabled=!1),t&&(t.viewModel=null,t.destroy()))}},{key:"_renderRelatedRecordsFlowItem",value:function(e){var t,n,i=this,r=this.messages,o=this.closable,a=this.closed,u="graphic"in e&&!e.isTable&&(null===(t=e.graphic)||void 0===t?void 0:t.geometry),l=r.exitRelatedRecords,s=r.selectFeature;return(0,E.u)("calcite-flow-item",{bind:this,closable:o,closed:a,description:this._getRelatedRecordsFlowItemDescription(e),heading:null!==(n=e.title)&&void 0!==n?n:"",key:"flow-item-".concat(e.viewModel.uid),onCalciteFlowItemBack:function(e){e.preventDefault(),i._handleRelatedRecordsBackClick()},onCalciteFlowItemClose:this._handleCloseClick},(0,E.u)("calcite-action",{appearance:"transparent",bind:this,class:I.actionExit,icon:"move-up",key:"exit-related-records-action",onclick:this._handleExitClick,slot:"header-actions-start",text:l,title:l}),u?(0,E.u)("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-related-feature-action",onclick:function(){return i._handleOpenRelatedFeature(e)},slot:"header-actions-end",text:s,title:s}):null,(0,E.u)("div",{class:I.container},e.render()))}},{key:"_getRelatedRecordsFlowItemDescription",value:function(e){var t;return"featureCountDescription"in e?e.featureCountDescription:null!==(t=e.viewModel.description)&&void 0!==t?t:""}}]),i}(C.Z);(0,h._)([(0,w.Cb)()],O.prototype,"flowItems",void 0),(0,h._)([(0,w.Cb)(),(0,P.H)("esri/widgets/Features/t9n/Features")],O.prototype,"messages",void 0),(0,h._)([(0,w.Cb)()],O.prototype,"closed",void 0),(0,h._)([(0,w.Cb)()],O.prototype,"closable",void 0);var R=O=(0,h._)([(0,_.j)("esri.widgets.Features.FeaturesRelatedRecords")],O),L=n(36702),N=function(e){(0,d.Z)(n,e);var t=(0,v.Z)(n);function n(){var e;return(0,l.Z)(this,n),(e=t.apply(this,arguments)).actionBar=!0,e.closeButton=!0,e.collapseButton=!1,e.featureNavigation=!0,e.featureListLayerTitle=!0,e.flow=!0,e.heading=!0,e.spinner=!0,e}return(0,s.Z)(n)}(n(7138).default);(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"actionBar",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"closeButton",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"collapseButton",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"featureNavigation",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"featureListLayerTitle",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"flow",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"heading",void 0),(0,h._)([(0,w.Cb)({type:Boolean,nonNullable:!0})],N.prototype,"spinner",void 0);var T=N=(0,h._)([(0,_.j)("esri.widgets.Features.FeaturesVisibleElements")],N),S=n(65497),B=n(7021),V=n(96919),z=n(28907),H=n(8704),W=n(6291),j="selected-index",D="features-spinner";function G(e){var t;return null!==(t=null===e||void 0===e?void 0:e.declaredClass.startsWith("esri.layers."))&&void 0!==t&&t}var $=function(e){(0,d.Z)(h,e);var t=(0,v.Z)(h);function h(e,n){var i;return(0,l.Z)(this,h),(i=t.call(this,e,n))._featureMenuIntersectionObserverCallback=function(e){var t=(0,u.Z)(e,1)[0];(null===t||void 0===t?void 0:t.isIntersecting)&&null!=i.viewModel.featurePage&&i.viewModel.featurePage++},i._featureMenuIntersectionObserver=new IntersectionObserver(i._featureMenuIntersectionObserverCallback,{root:window.document}),i._featureMenuIntersectionObserverNode=null,i._focusOn=null,i._spinner=null,i._feature=null,i._relatedRecordsFlowItems=new f.Z,i._relatedRecordsWidget=new R({flowItems:i._relatedRecordsFlowItems}),i._rootFlowItemNode=null,i._featureMenuViewportNode=null,i._actionBarMenuNode=null,i.collapsed=!1,i.featureNavigationTop=!1,i.headerActions=new S.$Q,i.headingLevel=2,i.messages=null,i.messagesCommon=null,i.responsiveActionsEnabled=!1,i.viewModel=new L.Z,i.visibleElements=new T,i._renderAction=function(e,t){var n=i._getActionTitle(e),r=e.type,o=e.active,a=e.uid,u=e.disabled,l=e.indicator;return e.visible?(0,E.u)("calcite-action",{active:"toggle"===r&&e.value,appearance:"solid",bind:(0,c.Z)(i),"data-action-uid":a,disabled:u,icon:i._getActionIcon(e),indicator:l,key:"action-".concat(t),loading:o,onclick:i._triggerAction,scale:"s",text:n,title:i._hideActionText?n:void 0},i._getFallbackIcon(e)):null},i._openFeatureMenu=function(){i.featureMenuOpen=!0,i._focusOn="menu-flow-item"},i._previousFeature=function(){i.viewModel.selectedFeatureIndex--},i._nextFeature=function(){i.viewModel.selectedFeatureIndex++},i._handleFeatureMenuBack=function(){i.featureMenuOpen&&(i._focusOn="root-flow-item",i.featureMenuOpen=!1)},i._focusFlowItemNode=function(e){i._focusOn===e&&requestAnimationFrame((0,a.Z)((0,o.Z)().mark((function t(){var n,r;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="menu-flow-item"===t.t0?3:"root-flow-item"===t.t0?6:8;break;case 3:return t.next=5,null===(n=i._featureMenuViewportNode)||void 0===n?void 0:n.setFocus();case 5:return t.abrupt("break",8);case 6:return t.next=8,null===(r=i._rootFlowItemNode)||void 0===r?void 0:r.setFocus();case 8:i._focusOn=null;case 9:case"end":return t.stop()}}),t)}))))},i._focusFlowItemNodeThrottled=(0,y.P)(i._focusFlowItemNode,50),i._displaySpinnerThrottled=(0,y.P)((function(){return i._displaySpinner()}),0),i._addSelectedFeatureIndexHandle(),i.addHandles([i._displaySpinnerThrottled,i._focusFlowItemNodeThrottled,(0,g.watch)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.active}),(function(){return i._toggleScreenLocationEnabled()})),(0,g.watch)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.active}),(function(e){return i._relatedRecordsWidget.closed=!e})),(0,g.watch)((function(){var e;return null===(e=i.visibleElements)||void 0===e?void 0:e.closeButton}),(function(e){return i._relatedRecordsWidget.closable=e})),(0,g.watch)((function(){var e;return null===(e=i.visibleElements)||void 0===e?void 0:e.spinner}),(function(e){return i._spinnerEnabledChange(e)})),(0,g.watch)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.view}),(function(e,t){return i._viewChange(e,t)})),(0,g.watch)((function(){var e,t;return null===(e=i.viewModel)||void 0===e||null===(t=e.view)||void 0===t?void 0:t.ready}),(function(e,t){return i._viewReadyChange(null!==e&&void 0!==e&&e,null!==t&&void 0!==t&&t)})),(0,g.watch)((function(){var e,t;return[null===(e=i.viewModel)||void 0===e?void 0:e.waitingForResult,null===(t=i.viewModel)||void 0===t?void 0:t.location]}),(function(){i._hideSpinner(),i._displaySpinnerThrottled()})),(0,g.watch)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.screenLocation}),(function(){return i._closeOpenActionMenu()})),(0,g.watch)((function(){return i.selectedFeatureWidget}),(function(){return i._destroyRelatedRecordsFlowItemWidgets()})),(0,g.watch)((function(){var e,t=null===(e=i.selectedFeatureWidget)||void 0===e?void 0:e.viewModel;return[null===t||void 0===t?void 0:t.title,null===t||void 0===t?void 0:t.state]}),(function(){return i._setTitleFromFeatureWidget()})),(0,g.watch)((function(){var e,t=null===(e=i.selectedFeatureWidget)||void 0===e?void 0:e.viewModel;return[null===t||void 0===t?void 0:t.content,null===t||void 0===t?void 0:t.state]}),(function(){return i._setContentFromFeatureWidget()})),(0,g.watch)((function(){var e;return null===(e=i.viewModel)||void 0===e?void 0:e.featureViewModels}),(function(){return i._featureMenuViewportScrollTop()})),i._relatedRecordsWidget.on("close",(function(){return i.close()})),i._relatedRecordsWidget.on("exit",(function(){return i._destroyRelatedRecordsFlowItemWidgets()})),i._relatedRecordsWidget.on("open-related-feature",(function(e){var t=e.feature;return i._openRelatedFeature(t)}))]),i}return(0,s.Z)(h,[{key:"loadDependencies",value:function(){return(0,A.h)({action:function(){return Promise.all([n.e(92358),n.e(46895),n.e(65138),n.e(91741)]).then(n.bind(n,6814))},"action-bar":function(){return Promise.all([n.e(92358),n.e(46895),n.e(89219),n.e(63839),n.e(65138),n.e(2654),n.e(23635),n.e(68698)]).then(n.bind(n,68698))},"action-group":function(){return Promise.all([n.e(92358),n.e(46895),n.e(89219),n.e(63839),n.e(65138),n.e(2654),n.e(23635),n.e(70405)]).then(n.bind(n,70405))},button:function(){return Promise.all([n.e(92358),n.e(46895),n.e(54438),n.e(14105),n.e(32275)]).then(n.bind(n,32275))},flow:function(){return n.e(53049).then(n.bind(n,53049))},"flow-item":function(){return Promise.all([n.e(92358),n.e(46895),n.e(89219),n.e(63839),n.e(65138),n.e(2654),n.e(23635),n.e(89524),n.e(48926)]).then(n.bind(n,48926))},list:function(){return Promise.all([n.e(92358),n.e(46895),n.e(54438),n.e(34504),n.e(8715),n.e(38782)]).then(n.bind(n,38782))},"list-item":function(){return Promise.all([n.e(92358),n.e(46895),n.e(65138),n.e(21340)]).then(n.bind(n,67994))},"list-item-group":function(){return n.e(78800).then(n.bind(n,78800))},loader:function(){return Promise.all([n.e(92358),n.e(46895),n.e(92382)]).then(n.bind(n,92382))}})}},{key:"destroy",value:function(){var e,t;this._destroyRelatedRecordsFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),this._unobserveFeatureMenuObserver(),null!==(e=this._featureMenuIntersectionObserver)&&void 0!==e&&e.disconnect(),null===(t=this._relatedRecordsWidget)||void 0===t||t.destroy()}},{key:"_hideActionText",get:function(){var e;if(!this.responsiveActionsEnabled)return!1;var t=null===(e=this.view)||void 0===e?void 0:e.widthBreakpoint;return"xsmall"===t||"small"===t||"medium"===t}},{key:"_featureNavigationVisible",get:function(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}},{key:"_isCollapsed",get:function(){return this._collapseEnabled&&this.collapsed}},{key:"_collapseEnabled",get:function(){return this.visibleElements.collapseButton&&!!this.title&&!!this.content}},{key:"active",get:function(){return this.viewModel.active}},{key:"content",get:function(){return this.viewModel.content},set:function(e){this.viewModel.content=e}},{key:"icon",get:function(){return null}},{key:"featureMenuOpen",get:function(){return this.viewModel.featureMenuOpen},set:function(e){this.viewModel.featureMenuOpen=e}},{key:"features",get:function(){return this.viewModel.features},set:function(e){this.viewModel.features=e}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"map",get:function(){return this.viewModel.map},set:function(e){this.viewModel.map=e}},{key:"promises",get:function(){return this.viewModel.promises},set:function(e){this.viewModel.promises=e}},{key:"selectedFeature",get:function(){return this.viewModel.selectedFeature}},{key:"selectedFeatureIndex",get:function(){return this.viewModel.selectedFeatureIndex},set:function(e){this.viewModel.selectedFeatureIndex=e}},{key:"selectedFeatureWidget",get:function(){var e=this._feature,t=this.headingLevel,n=this._relatedRecordsFlowItems,i=this.timeZone,r=this.spatialReference,o=this.map,a=this.viewModel.selectedFeatureViewModel,u={title:!1};return a?(e?(e.viewModel=a,e.visibleElements=u):this._feature=new F.default({flowItems:n,headingLevel:t+1,timeZone:i,spatialReference:r,map:o,viewModel:a,visibleElements:u}),this._feature):null}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(e){this.viewModel.spatialReference=e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}},{key:"timeZone",get:function(){return this.viewModel.timeZone},set:function(e){this.viewModel.timeZone=e}},{key:"updateLocationEnabled",get:function(){return this.viewModel.updateLocationEnabled},set:function(e){this.viewModel.updateLocationEnabled=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"blur",value:function(){var e;this.viewModel.active?null===(e=this._rootFlowItemNode)||void 0===e||e.blur():p.Z.getLogger(this).warn("Features can only be blurred when currently active.")}},{key:"clear",value:function(){return this.viewModel.clear()}},{key:"close",value:function(){this.viewModel.visible=!1}},{key:"fetchFeatures",value:function(e,t){return this.viewModel.fetchFeatures(e,t)}},{key:"focus",value:function(){this.viewModel.active?this._setFocusOn():p.Z.getLogger(this).warn("Features can only be focused when currently active.")}},{key:"next",value:function(){return this.viewModel.next()}},{key:"open",value:function(e){var t,n=this;this.removeHandles(j);var i={collapsed:null!==(t=null===e||void 0===e?void 0:e.collapsed)&&void 0!==t&&t};this.set(i),this.viewModel.open(e),this.addHandles((0,g.when)((function(){return!n.viewModel.waitingForResult}),(function(){return n._addSelectedFeatureIndexHandle()}),{once:!0}))}},{key:"previous",value:function(){return this.viewModel.previous()}},{key:"triggerAction",value:function(e){return this.viewModel.triggerAction(e)}},{key:"render",value:function(){return(0,E.u)("div",{bind:this,class:this.classes(I.base,B.z.widget,B.z.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}},{key:"_renderFeatureNavigation",value:function(){return[this._renderPagination(),this._renderFeatureMenuButton()]}},{key:"_renderHeader",value:function(){return!this.featureMenuOpen&&this.featureNavigationTop&&this._featureNavigationVisible?(0,E.u)("div",{class:I.header,key:"header-actions"},this._renderFeatureNavigation()):null}},{key:"_renderFooter",value:function(){return this.featureMenuOpen||this.featureNavigationTop||!this._featureNavigationVisible?null:(0,E.u)("div",{class:I.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation())}},{key:"_renderFeatureMenuButton",value:function(){var e=this.messages,t=this.viewModel,n=t.featureCount,i=t.selectedFeatureIndex,r=t.pendingPromisesCount;return(0,E.u)("calcite-action",{appearance:"solid",bind:this,icon:"list",key:"feature-menu-button",label:e.selectFeature,loading:r>0,onclick:this._openFeatureMenu,scale:"s",text:(0,H.n)(e.pageText,{index:(0,W.uf)(i+1),total:(0,W.uf)(n)}),textEnabled:!0,title:e.selectFeature})}},{key:"_renderPagination",value:function(){var e=this.messagesCommon.pagination,t=e.previous,n=e.next;return(0,E.u)("calcite-action-bar",{class:I.paginationActionBar,expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},(0,E.u)("calcite-action-group",{scale:"s"},(0,E.u)("calcite-action",{appearance:"solid",class:I.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:t,onclick:this._previousFeature,scale:"s",text:t,title:t}),(0,E.u)("calcite-action",{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:n,onclick:this._nextFeature,scale:"s",text:n,title:n})))}},{key:"_renderFeatureMenuItem",value:function(e){var t=this.viewModel,n=e===t.selectedFeatureViewModel,i=t.featureViewModels.indexOf(e);return(0,E.u)("calcite-list-item",{bind:this,"data-feature-index":i,key:"feature-menu-item-".concat(e.uid),onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:n,onCalciteListItemSelect:this._selectFeature},(0,E.u)("span",{innerHTML:e.title||this.messagesCommon.untitled,slot:"content"}))}},{key:"_groupResultsByLayer",value:function(){var e=this.viewModel.featureViewModels,t=new Map;return e.forEach((function(e){var n,i=null===e||void 0===e?void 0:e.graphic;if(i){var o=i.layer,a=i.sourceLayer,u=(G(o)?o:null)||(G(a)?a:null),l=null!==(n=t.get(u))&&void 0!==n?n:[];t.set(u,[].concat((0,r.Z)(l),[e]))}})),t}},{key:"_renderFeatureMenu",value:function(){var e=this,t=this.viewModel.featureViewModels,n=this._groupResultsByLayer();return t.length?(0,E.u)("calcite-list",{selectionAppearance:"icon",selectionMode:"single"},Array.from(n.keys(),(function(t){var i,r,o=null===(i=n.get(t))||void 0===i?void 0:i.map((function(t){return e._renderFeatureMenuItem(t)})),a=t?null!==(r=t.title)&&void 0!==r?r:e.messagesCommon.untitled:null;return e.visibleElements.featureListLayerTitle&&null!==a?(0,E.u)("calcite-list-item-group",{heading:a,key:(null===t||void 0===t?void 0:t.uid)||"map-graphics"},o):o}))):null}},{key:"_renderHeaderAction",value:function(e,t){var n,i=e.title||"";return e.visible?(0,E.u)("calcite-action",{active:"toggle"===e.type&&e.value,appearance:"solid",bind:this,"data-action-uid":e.uid,disabled:e.disabled,icon:null!==(n=e.icon)&&void 0!==n?n:void 0,indicator:e.indicator,key:"header-action-".concat(t),loading:e.active,onclick:this._triggerHeaderAction,slot:"header-actions-end",text:i,title:i}):null}},{key:"_renderHeaderActions",value:function(){var e=this;return this.headerActions.map((function(t,n){return e._renderHeaderAction(t,n)})).toArray()}},{key:"_renderContentFeature",value:function(){var e,t=this.headingLevel,n=this.visibleElements,r=this._isCollapsed,o=this._collapseEnabled,a=this.featureNavigationTop,u=this.viewModel,l=u.title,s=u.active,c=n.heading&&l?l:"";return(0,E.u)("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,class:this.classes((e={},(0,i.Z)(e,I.contentFeature,!0),(0,i.Z)(e,I.flowItemCollapsed,r),e)),closable:n.closeButton,closed:!s,collapsed:r,collapseDirection:a?"down":"up",collapsible:o,headingLevel:t,key:"root-flow-item",onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},c?(0,E.u)(V.X,{class:this.classes(I.featuresHeading,B.z.heading),innerHTML:c,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),r?null:(0,E.u)("div",{class:this.classes(I.container,I.contentContainer)},this._renderContent()),this._renderFooter())}},{key:"_renderFeatureMenuContainer",value:function(){var e=this,t=this.viewModel,n=this.featureMenuOpen,i=this.messages,r=this.messagesCommon,o=t.active,a=t.featureViewModels,u=t.pendingPromisesCount;return n?(0,E.u)("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,afterUpdate:this._focusFeatureMenuFlowItemNode,bind:this,closable:!1,closed:!o,description:(0,H.n)(i.total,{total:a.length}),heading:i.selectFeature,key:"feature-menu",loading:t.waitingForContents,onCalciteFlowItemBack:function(t){t.preventDefault(),e._handleFeatureMenuBack()}},u>0?(0,E.u)("calcite-loader",{class:I.loader,inline:!0,key:"feature-menu-loader",label:r.loading,slot:"header-actions-end"}):null,(0,E.u)("div",{class:I.container},this._renderFeatureMenu()),(0,E.u)("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:I.featureMenuObserver}),(0,E.u)("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},r.back)):null}},{key:"_renderContentContainer",value:function(){var e=[this._renderContentFeature(),this._renderFeatureMenuContainer(),this._relatedRecordsWidget.render()];return this.visibleElements.flow?(0,E.u)("calcite-flow",{key:"content-container"},e):e}},{key:"_getFallbackIcon",value:function(e){var t,n=e.className;if(e.icon)return null;var r=(0,m.b$)({action:e,feature:this.selectedFeature}),o=(t={},(0,i.Z)(t,I.icon,!!n),(0,i.Z)(t,I.actionImage,!!r),t);return n&&(o[n]=!0),r||n?(0,E.u)("span",{"aria-hidden":"true",class:this.classes(I.icon,o),key:"icon",styles:(0,m.uS)(r)}):null}},{key:"_renderActionBar",value:function(){var e,t=this;return!this._isCollapsed&&this.visibleElements.actionBar&&null!==(e=this.viewModel.allActions)&&void 0!==e&&e.length?(0,E.u)("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},(0,E.u)("calcite-action-group",{afterCreate:function(e){return t._actionBarMenuNode=e},overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}},{key:"_renderActions",value:function(){return this.viewModel.allActions.toArray().map(this._renderAction)}},{key:"_renderContent",value:function(){var e,t=null===(e=this.viewModel)||void 0===e?void 0:e.content;return t?"string"==typeof t?(0,E.u)("div",{class:M.i.contentNode,innerHTML:t,key:t}):this.renderNodeContent(t):null}},{key:"_setFocusOn",value:function(){var e=this;this.renderNow(),requestAnimationFrame((function(){e._focusOn=e.featureMenuOpen?"menu-flow-item":"root-flow-item"}))}},{key:"_handleCollapseToggle",value:function(){this.collapsed=!this.collapsed}},{key:"_openRelatedFeature",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t){var n,i,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.viewModel.updateGeometry();case 2:if(n=t.graphic,null!=(i=null===n||void 0===n?void 0:n.geometry)&&null!=n){e.next=5;break}return e.abrupt("return");case 5:return this._destroyRelatedRecordsFlowItemWidgets(),e.next=8,this.viewModel.zoomTo({target:i});case 8:r=(0,b.$J)(i),this.open({features:[n],location:null!=r?r:void 0});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_focusRootFlowItemNode",value:function(){this._focusFlowItemNodeThrottled("root-flow-item")}},{key:"_focusFeatureMenuFlowItemNode",value:function(){this._focusFlowItemNodeThrottled("menu-flow-item")}},{key:"_storeRootFlowItemNode",value:function(e){this._rootFlowItemNode=e,this._focusFlowItemNodeThrottled("root-flow-item")}},{key:"_storeFeatureMenuFlowItemNode",value:function(e){this._featureMenuViewportNode=e,this._focusFlowItemNodeThrottled("menu-flow-item")}},{key:"_setActiveFeature",value:function(e){var t,n=this.viewModel,i=e.currentTarget["data-feature-index"];n.activeFeature=(null===(t=n.features)||void 0===t?void 0:t[i])||null}},{key:"_removeActiveFeature",value:function(){this.viewModel.activeFeature=null}},{key:"_selectFeature",value:function(e){var t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this._handleFeatureMenuBack()}},{key:"_unobserveFeatureMenuObserver",value:function(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}},{key:"_featureMenuIntersectionObserverCreated",value:function(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}},{key:"_getActionIcon",value:function(e){return e.icon?e.icon:e.image||e.className?void 0:"question"}},{key:"_getActionTitle",value:function(e){var t,n=this.messages,i=this.selectedFeature,r=this.messagesCommon,o=e.id,a=null===i||void 0===i?void 0:i.attributes,u=null!==(t=e.title)&&void 0!==t?t:"",l="zoom-to-feature"===o?(0,H.n)(u,{messages:n}):"remove-selected-feature"===o?(0,H.n)(u,{messages:r}):"zoom-to-clustered-features"===o||"browse-clustered-features"===o?(0,H.n)(u,{messages:n}):e.title;return l&&a?(0,H.n)(l,a):null!==l&&void 0!==l?l:""}},{key:"_onMainKeydown",value:function(e){var t=e.key;"ArrowLeft"===t&&(e.stopPropagation(),this._handleFeatureMenuBack(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this._handleFeatureMenuBack(),this.next())}},{key:"_featureMenuViewportScrollTop",value:function(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}},{key:"_setContentFromFeatureWidget",value:function(){var e=this.selectedFeatureWidget;e&&(this.viewModel.content=e)}},{key:"_setTitleFromFeatureWidget",value:function(){var e=this.selectedFeatureWidget,t=this.messagesCommon,n=null===e||void 0===e?void 0:e.viewModel;e&&(this.viewModel.title="error"===(null===n||void 0===n?void 0:n.state)?null===t||void 0===t?void 0:t.errorMessage:(null===n||void 0===n?void 0:n.title)||"")}},{key:"_addSelectedFeatureIndexHandle",value:function(){var e=this,t=(0,g.watch)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.selectedFeatureIndex}),(function(t,n){return e._selectedFeatureIndexUpdated(t,n)}));this.addHandles(t,j)}},{key:"_selectedFeatureIndexUpdated",value:function(e,t){this.viewModel.featureCount&&e!==t&&-1!==e&&(this._destroyRelatedRecordsFlowItemWidgets(),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}},{key:"_triggerHeaderAction",value:function(e){var t=e.currentTarget;if(!t.disabled){var n=t.dataset.actionUid,i=this.headerActions.find((function(e){return e.uid===n}));i&&!i.disabled&&("toggle"===(null===i||void 0===i?void 0:i.type)&&(i.value=!i.value),this.emit("trigger-header-action",{action:i}))}}},{key:"_triggerAction",value:function(e){var t=e.currentTarget;if(!t.disabled){var n=t.dataset.actionUid,i=this.viewModel.allActions,r=i.findIndex((function(e){return e.uid===n})),o=i.at(r);o&&"toggle"===o.type&&(o.value=!o.value),this.viewModel.triggerAction(r)}}},{key:"_createSpinner",value:function(e){e&&(this._spinner=new k.Z({view:e}),e.ui.add(this._spinner,{key:D,position:"manual",internal:!0}))}},{key:"_wireUpView",value:function(e){var t;this._destroySpinner(),e&&(null===(t=this.visibleElements)||void 0===t?void 0:t.spinner)&&this._createSpinner(e)}},{key:"_hideSpinner",value:function(){var e=this._spinner;e&&(e.location=null,e.hide())}},{key:"_viewReadyChange",value:function(e,t){var n;e?this._wireUpView(null===(n=this.viewModel)||void 0===n?void 0:n.view):t&&this.viewModel.clear()}},{key:"_viewChange",value:function(e,t){e&&t&&this.viewModel.clear()}},{key:"_destroySelectedFeatureWidget",value:function(){var e=this._feature;e&&(e.viewModel=null,!e.destroyed&&e.destroy()),this._feature=null}},{key:"_closeOpenActionMenu",value:function(){var e=this._actionBarMenuNode;e&&(e.menuOpen=!1)}},{key:"_destroyRelatedRecordsFlowItemWidgets",value:function(){this._relatedRecordsFlowItems.drain((function(e){"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()}))}},{key:"_toggleScreenLocationEnabled",value:function(){var e=this.viewModel;e&&(e.screenLocationEnabled=e.active)}},{key:"_displaySpinner",value:function(){var e=this._spinner;if(e){var t=this.viewModel,n=t.location;t.waitingForResult&&n?e.show({location:n}):e.hide()}}},{key:"_destroySpinner",value:function(){var e,t=this._spinner,n=this.view;t&&(null!==n&&void 0!==n&&null!==(e=n.ui)&&void 0!==e&&e.remove(t,D),t.destroy(),this._spinner=null)}},{key:"_spinnerEnabledChange",value:function(e){var t;this._destroySpinner(),e&&this._createSpinner(null===(t=this.viewModel)||void 0===t?void 0:t.view)}}]),h}((0,x.q)(C.Z));(0,h._)([(0,w.Cb)()],$.prototype,"_focusOn",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"_relatedRecordsFlowItems",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"_hideActionText",null),(0,h._)([(0,w.Cb)()],$.prototype,"_featureNavigationVisible",null),(0,h._)([(0,w.Cb)()],$.prototype,"_isCollapsed",null),(0,h._)([(0,w.Cb)()],$.prototype,"_collapseEnabled",null),(0,h._)([(0,w.Cb)({readOnly:!0})],$.prototype,"active",null),(0,h._)([(0,w.Cb)()],$.prototype,"collapsed",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"content",null),(0,h._)([(0,w.Cb)()],$.prototype,"icon",null),(0,h._)([(0,w.Cb)()],$.prototype,"featureMenuOpen",null),(0,h._)([(0,w.Cb)()],$.prototype,"featureNavigationTop",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"features",null),(0,h._)([(0,w.Cb)()],$.prototype,"goToOverride",null),(0,h._)([(0,w.Cb)({type:S.$Q})],$.prototype,"headerActions",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"headingLevel",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"location",null),(0,h._)([(0,w.Cb)()],$.prototype,"label",null),(0,h._)([(0,w.Cb)()],$.prototype,"map",null),(0,h._)([(0,w.Cb)(),(0,P.H)("esri/widgets/Features/t9n/Features")],$.prototype,"messages",void 0),(0,h._)([(0,w.Cb)(),(0,P.H)("esri/t9n/common")],$.prototype,"messagesCommon",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"promises",null),(0,h._)([(0,w.Cb)()],$.prototype,"responsiveActionsEnabled",void 0),(0,h._)([(0,w.Cb)({readOnly:!0})],$.prototype,"selectedFeature",null),(0,h._)([(0,w.Cb)()],$.prototype,"selectedFeatureIndex",null),(0,h._)([(0,w.Cb)({readOnly:!0})],$.prototype,"selectedFeatureWidget",null),(0,h._)([(0,w.Cb)()],$.prototype,"spatialReference",null),(0,h._)([(0,w.Cb)()],$.prototype,"title",null),(0,h._)([(0,w.Cb)()],$.prototype,"timeZone",null),(0,h._)([(0,w.Cb)()],$.prototype,"updateLocationEnabled",null),(0,h._)([(0,w.Cb)()],$.prototype,"view",null),(0,h._)([(0,w.Cb)({type:L.Z}),(0,z.s)(["triggerAction","trigger-action"])],$.prototype,"viewModel",void 0),(0,h._)([(0,w.Cb)({type:T,nonNullable:!0})],$.prototype,"visibleElements",void 0),(0,h._)([(0,w.Cb)()],$.prototype,"visible",null);var q=$=(0,h._)([(0,_.j)("esri.widgets.Features")],$)},36702:function(e,t,n){n.d(t,{Z:function(){return Y}});var i=n(1413),r=n(74165),o=n(15861),a=n(15671),u=n(43144),l=n(97326),s=n(60136),c=n(29388),d=n(27366),v=(n(59486),n(52639)),h=(n(51508),n(63780)),f=n(10064),p=n(32718),g=n(66978),y=n(2622),w=n(94172),_=n(49861),b=(n(93169),n(69912)),m=n(79803),F=n(66033),k=n(81753),C=n(30651),M=n(28970),x=n(86828),Z=n(6701),I=n(69787),A=n(71045),P=n(65497),E=n(29439),O=function(){return p.Z.getLogger("esri.widgets.Popup.PopupViewModel")},R=function(e){var t=e.event,n=e.view,i=e.viewModel,r=t.action;if(!r)return Promise.reject(new f.Z("trigger-action:missing-arguments","Event has no action"));var o=r.disabled,a=r.id;if(!a)return Promise.reject(new f.Z("trigger-action:invalid-action","action.id is missing"));if(o)return Promise.reject(new f.Z("trigger-action:invalid-action","Action is disabled"));if(a===P.OO.id)return function(e){return B.apply(this,arguments)}(i).catch(g.H9);if(a===P.wS.id)return function(e){return V.apply(this,arguments)}(i);if(a===P.iA.id)return i.browseClusterEnabled=!i.browseClusterEnabled,i.featureMenuOpen=i.browseClusterEnabled,Promise.resolve();if(a===P.tP.id){i.visible=!1;var u=i.selectedFeature;if(!u)return Promise.reject(new f.Z("trigger-action:".concat(P.tP.id),"selectedFeature is required",{selectedFeature:u}));var l=u.sourceLayer;return l?l.remove(u):null===n||void 0===n||n.graphics.remove(u),Promise.resolve()}return Promise.resolve()};function L(e){var t,n=e.selectedFeature,i=e.location;return e.view&&null!==(t=null!==n&&void 0!==n?n:i)&&void 0!==t?t:null}function N(e){var t,n;return!!e&&e.isAggregate&&"cluster"===(null===(t=e.sourceLayer)||void 0===t||null===(n=t.featureReduction)||void 0===n?void 0:n.type)}function T(e,t){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("3d"===(null===n||void 0===n?void 0:n.type)&&t&&"esri.Graphic"===t.declaredClass){e.next=2;break}return e.abrupt("return",!0);case 2:if(!(i=n.getViewForGraphic(t))||!("whenGraphicBounds"in i)){e.next=14;break}return o=null,e.prev=5,e.next=8,i.whenGraphicBounds(t,{useViewElevation:!0});case 8:o=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:return e.abrupt("return",!o||!o.boundingBox||o.boundingBox[0]===o.boundingBox[3]&&o.boundingBox[1]===o.boundingBox[4]&&o.boundingBox[2]===o.boundingBox[5]);case 14:return e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}function B(){return B=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a,u,l,s,c,d,v,h,p;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.location,o=t.selectedFeature,a=t.view,u=t.zoomFactor,l=L(t),a&&l){e.next=4;break}throw s=new f.Z("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:l,view:a}),O().error(s),s;case 4:if(c=a.scale/u,d=null===(n=t.selectedFeature)||void 0===n?void 0:n.geometry,v=null!==d&&void 0!==d?d:i,e.t0=null!=v&&"point"===v.type,!e.t0){e.next=12;break}return e.next=11,T(o,a);case 11:e.t0=e.sent;case 12:return h=e.t0,P.OO.active=!0,P.OO.disabled=!0,e.prev=14,e.next=17,t.zoomTo({target:{target:l,scale:h?c:void 0}});case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(14),p=new f.Z("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:o}),O().error(p);case 23:return e.prev=23,P.OO.active=!1,P.OO.disabled=!1,t.zoomToLocation=null,h&&(t.location=v),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[14,19,23,26]])}))),B.apply(this,arguments)}function V(){return V=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a,u,l,s,c,d,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selectedFeature,"2d"===(null===(i=t.view)||void 0===i?void 0:i.type)){e.next=4;break}throw o=new f.Z("zoomToCluster:invalid-view","View must be 2d MapView.",{view:i}),O().error(o),o;case 4:if(n&&N(n)){e.next=7;break}throw a=new f.Z("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:n}),O().error(a),a;case 7:return e.next=9,D(i,n);case 9:return u=e.sent,l=(0,E.Z)(u,2),s=l[0],c=l[1],P.wS.active=!0,P.wS.disabled=!0,e.next=16,s.queryExtent(c);case 16:if(d=e.sent,v=d.extent,e.t0=v,!e.t0){e.next=22;break}return e.next=22,t.zoomTo({target:v});case 22:P.wS.active=!1,P.wS.disabled=!1;case 24:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function z(e){return H.apply(this,arguments)}function H(){return(H=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a,u,l,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.view,i=t.selectedFeature,n&&i){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,D(n,i);case 5:return o=e.sent,a=(0,E.Z)(o,2),u=a[0],l=a[1],e.next=11,u.queryExtent(l);case 11:s=e.sent,c=s.extent,t.selectedClusterBoundaryFeature.geometry=c,n.graphics.add(t.selectedClusterBoundaryFeature);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return j.apply(this,arguments)}function j(){return(j=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a,u,l,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.selectedFeature,(i=t.view)&&n){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,D(i,n);case 5:return o=e.sent,a=(0,E.Z)(o,2),u=a[0],l=a[1],P.iA.active=!0,P.iA.disabled=!0,e.next=12,u.queryFeatures(l);case 12:s=e.sent,c=s.features,P.iA.active=!1,P.iA.disabled=!1,P.iA.value=!0,null===t||void 0===t||t.open({features:[n].concat(c),featureMenuOpen:!0});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){return G.apply(this,arguments)}function G(){return(G=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.whenLayerView(n.sourceLayer);case 2:return i=e.sent,o=i.createQuery(),a=n.getObjectId(),e.abrupt("return",(o.aggregateIds=null!=a?[a]:[],[i,o]));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $=n(70407),q=n(99505),Q=n(61459),U=n(848),J="location-scale-handle",K=null;var X=function(e){(0,s.Z)(d,e);var t=(0,c.Z)(d);function d(e){var i;return(0,a.Z)(this,d),(i=t.call(this,e))._pendingPromises=new y.Z,i._fetchFeaturesController=null,i._highlightSelectedFeaturePromise=null,i._highlightActiveFeaturePromise=null,i._selectedClusterFeature=null,i.actions=new P.$Q,i.activeFeature=null,i.autoCloseEnabled=!1,i.browseClusterEnabled=!1,i.content=null,i.defaultPopupTemplateEnabled=!1,i.featurePage=null,i.featuresPerPage=20,i.featureMenuOpen=!1,i.featureViewModelAbilities=null,i.featureViewModels=[],i.highlightEnabled=!0,i.includeDefaultActions=!0,i.selectedClusterBoundaryFeature=new v.Z({symbol:new Q.default({outline:{width:1.5,color:"cyan"},style:"none"})}),i.title=null,i.updateLocationEnabled=!1,i.view=null,i.visible=!1,i.zoomFactor=4,i.zoomToLocation=null,i._debouncedLocationUpdate=(0,g.Ds)(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var o,a,u,s,c,d,v,h,f,y,w,_,b,k,C,M,x,Z,I,A;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(0,l.Z)(i),d=c.spatialReference,v=null===(o=i.selectedFeature)||void 0===o||null===(a=o.geometry)||void 0===a?void 0:a.type,h=null!==(u=i.location)&&void 0!==u?u:t,!(v&&"mesh"!==v&&d&&h&&i.selectedFeature)){e.next=52;break}if("point"===v){e.next=51;break}if(e.prev=3,f=i.selectedFeature,y=f.geometry,w=i._getHighlightLayer(f),_=f.getObjectId(),w&&i.view){e.next=9;break}return e.abrupt("return");case 9:if(!_){e.next=20;break}if(C=null===(b=i.view)||void 0===b?void 0:b.allLayerViews.find((function(e){return e.layer.uid===w.uid})),C&&"queryFeatures"in C){e.next=13;break}return e.abrupt("return");case 13:return(M=C.createQuery()).outSpatialReference=d,M.objectIds=[_],M.returnGeometry=!0,e.next=17,C.queryFeatures(M);case 17:x=e.sent,Z=x.features,y=null===(k=Z[0])||void 0===k?void 0:k.geometry;case 20:if(y&&"mesh"!==y.type){e.next=22;break}return e.abrupt("return");case 22:if(y=(0,m.project)(y,d),e.t0=K,e.t0){e.next=28;break}return e.next=27,n.e(84178).then(n.bind(n,84178));case 27:K=e.sent;case 28:return e.next=30,K.intersects(y,h);case 30:if(e.sent){e.next=44;break}return e.next=33,K.nearestCoordinate(y,h);case 33:if(e.t2=I=e.sent.coordinate,e.t1=null!==e.t2,!e.t1){e.next=37;break}e.t1=void 0!==I;case 37:if(!e.t1){e.next=41;break}e.t3=I,e.next=42;break;case 41:e.t3=h;case 42:A=e.t3,i.selectedFeature===f&&(i.location=A);case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(3),(0,g.D_)(e.t4)||p.Z.getLogger((0,l.Z)(i)).error(e.t4);case 49:e.next=52;break;case 51:i.location=null!==(s=(0,F.$J)(i.selectedFeature.geometry))&&void 0!==s?s:h;case 52:case"end":return e.stop()}}),e,null,[[3,46]])})));return function(t){return e.apply(this,arguments)}}()),i}return(0,u.Z)(d,[{key:"initialize",value:function(){var e=this;this.addHandles([this.on("view-change",(function(){return e._autoClose()})),(0,w.watch)((function(){return[e.highlightEnabled,e.selectedFeature,e.visible,e.view]}),(function(){return e._highlightSelectedFeature()})),(0,w.watch)((function(){return[e.highlightEnabled,e.activeFeature,e.visible,e.view]}),(function(){return e._highlightActiveFeature()})),(0,w.watch)((function(){var t,n;return null===(t=e.view)||void 0===t||null===(n=t.animation)||void 0===n?void 0:n.state}),(function(t){return e._animationStateChange(t)})),(0,w.watch)((function(){return e.location}),(function(t){return e._locationChange(t)})),(0,w.watch)((function(){return e.selectedFeature}),(function(t){return e._selectedFeatureChange(t)})),(0,w.watch)((function(){return[e.selectedFeatureIndex,e.featureCount,e.featuresPerPage]}),(function(){return e._selectedFeatureIndexChange()})),(0,w.watch)((function(){return[e.featurePage,e.selectedFeatureIndex,e.featureCount,e.featuresPerPage,e.featureViewModels]}),(function(){return e._setGraphicOnFeatureViewModels()})),(0,w.watch)((function(){return e.featureViewModels}),(function(){return e._featureViewModelsChange()})),this.on("trigger-action",(function(t){return R({event:t,viewModel:e,view:e.view})})),(0,w.when)((function(){return!e.waitingForResult}),(function(){return e._waitingForResultChange()}),w.sync),(0,w.watch)((function(){return[e.features,e.map,e.spatialReference,e.timeZone]}),(function(){return e._updateFeatureVMs()})),(0,w.watch)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.scale}),(function(){return e._viewScaleChange()})),(0,w.when)((function(){return!e.visible}),(function(){return e.browseClusterEnabled=!1})),(0,w.watch)((function(){return e.browseClusterEnabled}),(function(t){return t?e.enableClusterBrowsing():e.disableClusterBrowsing()}))])}},{key:"destroy",value:function(){this._cancelFetchingFeatures(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null,this.map=null,this.spatialReference=null,this.timeZone=null}},{key:"active",get:function(){return!(!this.visible||this.waitingForResult)}},{key:"allActions",get:function(){var e,t=this._get("allActions")||new P.$Q;t.removeAll();var n=this.actions,i=this.defaultActions,r=this.defaultPopupTemplateEnabled,o=this.includeDefaultActions,a=this.selectedFeature,u=o?i.concat(n):n,l=a&&("function"==typeof a.getEffectivePopupTemplate&&a.getEffectivePopupTemplate(r)||a.popupTemplate),s=null===l||void 0===l?void 0:l.actions,c=null!==l&&void 0!==l&&l.overwriteActions?s:null!==(e=null===s||void 0===s?void 0:s.concat(u))&&void 0!==e?e:u;return null!==c&&void 0!==c&&c.filter(Boolean).forEach((function(e){return t.add(e)})),t}},{key:"defaultActions",get:function(){var e=this._get("defaultActions")||new P.$Q;return e.removeAll(),e.addMany(N(this.selectedFeature)?[P.wS.clone(),P.iA.clone()]:[P.OO.clone()]),e}},{key:"featureCount",get:function(){return this.features.length}},{key:"features",set:function(e){var t=e||[];this._set("features",t);var n=this.pendingPromisesCount,i=this.promiseCount,r=this.selectedFeatureIndex,o=i&&t.length;o&&n&&-1===r?this.selectedFeatureIndex=0:o&&-1!==r||(this.selectedFeatureIndex=t.length?0:-1)}},{key:"location",set:function(e){var t,n,i=e,r=null===(t=this.spatialReference)||void 0===t?void 0:t.isWebMercator;(null===e||void 0===e||null===(n=e.spatialReference)||void 0===n?void 0:n.isWGS84)&&r&&(i=(0,k.$)(e)),this._set("location",i)}},{key:"map",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.map)&&void 0!==e?e:null},set:function(e){this._override("map",e)}},{key:"pendingPromisesCount",get:function(){return this._pendingPromises.size}},{key:"promiseCount",get:function(){return this.promises.length}},{key:"promises",get:function(){return this._get("promises")||[]},set:function(e){var t=this;this._pendingPromises.clear(),this.features=[],Array.isArray(e)&&e.length?(this._set("promises",e),(e=e.slice(0)).forEach((function(e){return t._pendingPromises.add(e)})),e.reduce((function(e,n){return e.finally((function(){return n.then((function(e){t._pendingPromises.has(n)&&t._updateFeatures(e)})).finally((function(){return t._pendingPromises.delete(n)})).catch((function(){}))}))}),Promise.resolve())):this._set("promises",[])}},{key:"selectedFeature",get:function(){var e=this.features,t=this.selectedFeatureIndex;return-1===t?null:e[t]||null}},{key:"selectedFeatureIndex",get:function(){var e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1},set:function(e){var t=this.featureCount;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}},{key:"selectedFeatureViewModel",get:function(){return this.featureViewModels[this.selectedFeatureIndex]||null}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null},set:function(e){this._override("spatialReference",e)}},{key:"state",get:function(){var e=this.view,t=this.map;return e?e.ready?"ready":"disabled":t?"ready":"disabled"}},{key:"timeZone",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.timeZone)&&void 0!==e?e:Z.By},set:function(e){this._overrideIfSome("timeZone",e)}},{key:"waitingForContents",get:function(){return this.featureViewModels.some((function(e){return e.waitingForContent}))}},{key:"waitingForResult",get:function(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}},{key:"centerAtLocation",value:function(){var e=this.view,t=L(this);return t&&e?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new f.Z("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}},{key:"zoomTo",value:function(e){return this.callGoTo(e)}},{key:"clear",value:function(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}},{key:"fetchFeatures",value:function(e,t){var n,i=this.view;if(!i||!e)throw new f.Z("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return i.fetchPopupFeatures(e,{pointerType:null===t||void 0===t||null===(n=t.event)||void 0===n?void 0:n.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:null===t||void 0===t?void 0:t.signal})}},{key:"open",value:function(e){var t=(0,i.Z)((0,i.Z)({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{},{visible:!0}),n=t.fetchFeatures;delete t.fetchFeatures,n&&this._setFetchFeaturesPromises(t.location);for(var r=0,o=["actionsMenuOpen","collapsed"];r<o.length;r++){delete t[o[r]]}this.set(t)}},{key:"triggerAction",value:function(e){var t=this.allActions.at(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}},{key:"next",value:function(){return this.selectedFeatureIndex++,this}},{key:"previous",value:function(){return this.selectedFeatureIndex--,this}},{key:"disableClusterBrowsing",value:function(){(function(e){P.iA.value=!1;var t=e.features.filter((function(e){return N(e)}));t.length&&(e.features=t)})(this),this._clearBrowsedClusterGraphics()}},{key:"enableClusterBrowsing",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.view,n=this.selectedFeature,"2d"!==(null===t||void 0===t?void 0:t.type)){e.next=12;break}if(!N(n)){e.next=9;break}return e.next=5,z(this);case 5:return e.next=7,W(this);case 7:e.next=10;break;case 9:p.Z.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",n);case 10:e.next=13;break;case 12:p.Z.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleViewClick",value:function(e){this._fetchFeaturesAndOpen(e)}},{key:"_animationStateChange",value:function(e){this.zoomToLocation||(P.OO.disabled="waiting-for-target"===e)}},{key:"_clearBrowsedClusterGraphics",value:function(){var e,t,n=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(h.pC);null!==(e=this.view)&&void 0!==e&&null!==(t=e.graphics)&&void 0!==t&&t.removeMany(n),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}},{key:"_viewScaleChange",value:function(){if(N(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}},{key:"_locationChange",value:function(e){var t=this.selectedFeature,n=this.updateLocationEnabled;this.view&&n&&e&&(!t||t.geometry)&&this.centerAtLocation()}},{key:"_selectedFeatureIndexChange",value:function(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}},{key:"_featureViewModelsChange",value:function(){this.featurePage=this.featureCount>1?1:null}},{key:"_setGraphicOnFeatureViewModels",value:function(){var e=this.features,t=this.featureCount,n=this.featurePage,i=this.featuresPerPage,r=this.featureViewModels;if(null!==n){var o=((n-1)*i+t)%t,a=o+i;r.slice(o,a).forEach((function(t,n){var i;t&&(null!==(i=t.graphic)&&void 0!==i||(t.graphic=e[o+n]))}))}}},{key:"_selectedFeatureChange",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a,u,l,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.location,o=this.updateLocationEnabled,a=this.view,t&&a){e.next=3;break}return e.abrupt("return");case 3:if(!this.browseClusterEnabled){e.next=11;break}if(this._selectedClusterFeature&&(a.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),!N(t)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,(0,x.zd)(t);case 8:return t.symbol=e.sent,this._selectedClusterFeature=t,e.abrupt("return",void a.graphics.add(this._selectedClusterFeature));case 11:if(u=null===(n=t.sourceLayer)||void 0===n?void 0:n.type,e.t0="map-image"!==u&&"imagery"!==u&&"imagery-tile"!==u,e.t0){e.next=17;break}return e.next=16,(0,x.zd)(t);case 16:t.symbol=e.sent;case 17:if((o||!i)&&t.geometry){e.next=25;break}if(!o||t.geometry){e.next=23;break}return e.next=21,this.centerAtLocation();case 21:(s=null===(l=a.center)||void 0===l?void 0:l.clone())&&(this.location=s);case 23:e.next=26;break;case 25:this.location=(0,F.$J)(t.geometry);case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_waitingForResultChange",value:function(){!this.featureCount&&this.promises&&(this.visible=!1)}},{key:"_setFetchFeaturesPromises",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchFeaturesWithController({mapPoint:t});case 2:n=e.sent,i=n.pendingFeatures,this.promises=i;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_destroyFeatureVMs",value:function(){this.featureViewModels.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",[])}},{key:"_updateFeatureVMs",value:function(){var e=this,t=this.selectedFeature,n=this.features,i=this.featureViewModels,r=this.view,o=this.spatialReference,a=this.map,u=this.timeZone,l=this.location;if(N(t)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),null!==n&&void 0!==n&&n.length){var s=i.slice(0),c=[];n.forEach((function(n,i){if(n){var d=null;if(s.some((function(e,t){return e&&e.graphic===n&&(d=e,s.splice(t,1)),!!d})),d)c[i]=d;else{var v=new A.Z({abilities:e.featureViewModelAbilities,defaultPopupTemplateEnabled:e.defaultPopupTemplateEnabled,spatialReference:o,graphic:n===t?n:null,location:l,map:a,view:r,timeZone:u});c[i]=v}}})),s.forEach((function(e){return e&&!e.destroyed&&e.destroy()})),this._set("featureViewModels",c)}}},{key:"_getScreenPoint",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var i,o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.spatialReference,o=this.view){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,null===o||void 0===o?void 0:o.when();case 5:if(!(a=null===t||void 0===t?void 0:t.spatialReference)||!i){e.next=12;break}return e.next=9,(0,m.initializeProjection)(a,i,null,n);case 9:e.t0=o.toScreen(t),e.next=13;break;case 12:e.t0=null;case 13:return e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_cancelFetchingFeatures",value:function(){var e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null}},{key:"_projectScreenPointAndFetchFeatures",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.mapPoint,i=t.screenPoint,o=t.event,a=t.signal,e.t0=this,null===i||void 0===i){e.next=6;break}e.t1=i,e.next=9;break;case 6:return e.next=8,this._getScreenPoint(null!==n&&void 0!==n?n:this.location,{signal:a});case 8:e.t1=e.sent;case 9:return e.t2=e.t1,e.t3={signal:a,event:o},e.abrupt("return",e.t0.fetchFeatures.call(e.t0,e.t2,e.t3));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchFeaturesWithController",value:function(e){var t=this,n=e.mapPoint,i=e.screenPoint,r=e.event;this._cancelFetchingFeatures();var o=new AbortController,a=o.signal;this._fetchFeaturesController=o;var u=this._projectScreenPointAndFetchFeatures({mapPoint:n,screenPoint:i,signal:a,event:r});return u.catch((function(){})).then((function(){t._fetchFeaturesController=null})),u}},{key:"_fetchFeaturesAndOpen",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n,i,o,a,u,l=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.mapPoint,i=t.screenPoint,o=this.view,this.removeHandles(J),this.addHandles([(0,w.watch)((function(){var e;return null===(e=l.view)||void 0===e?void 0:e.scale}),(function(){return l._debouncedLocationUpdate(n).catch((function(e){(0,g.D_)(e)||p.Z.getLogger(l).error(e)}))})),(0,w.when)((function(){return!l.visible}),(function(){l.removeHandles(J)}),{once:!0})],J),e.next=4,this._fetchFeaturesWithController({mapPoint:n,screenPoint:i,event:t});case 4:a=e.sent,u=a.pendingFeatures,(null===o||void 0===o?void 0:o.popup)&&"open"in o.popup&&o.popup.open({location:null!==n&&void 0!==n?n:void 0,promises:u});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_autoClose",value:function(){this.autoCloseEnabled&&(this.visible=!1)}},{key:"_getLayerView",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.when();case 2:return e.abrupt("return",t.whenLayerView(n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getHighlightLayer",value:function(e){var t=e.layer,n=e.sourceLayer;return n&&"layer"in n&&n.layer?n.layer:"map-notes"===(null===n||void 0===n?void 0:n.type)||"subtype-group"===(null===n||void 0===n?void 0:n.type)?n:t}},{key:"_getHighlightTarget",value:function(e,t,n){if(function(e,t){return"building-scene"===e||"2d"===t&&("map-image"===e||"tile"===e||"imagery"===e||"imagery-tile"===e)}(t.type,n))return e;var i=e.getObjectId();if(null!=i)return i;var r="imagery"===t.type?void 0:"objectIdField"in t?t.objectIdField||M.d:null,o=e.attributes;return o&&r&&o[r]||e}},{key:"_mapIncludesLayer",value:function(e){var t,n;return!(null===(t=this.map)||void 0===t||null===(n=t.allLayers)||void 0===n||!n.includes(e))}},{key:"_highlightActiveFeature",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n,i,o,a,u,l,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-active-feature",this.removeHandles(t),n=this.highlightEnabled,i=this.view,o=this.activeFeature,a=this.visible,o&&i&&n&&a){e.next=5;break}return e.abrupt("return");case 5:if((u=this._getHighlightLayer(o))&&u instanceof C.Z&&this._mapIncludesLayer(u)){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(i,u),this._highlightActiveFeaturePromise=l,e.next=12,l;case 12:if((s=e.sent)&&(0,I.tl)(s)&&this._highlightActiveFeaturePromise===l&&this.activeFeature&&this.highlightEnabled){e.next=15;break}return e.abrupt("return");case 15:c=s.highlight(this._getHighlightTarget(o,u,i.type)),this.addHandles(c,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_highlightSelectedFeature",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n,i,o,a,u,l,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="highlight-selected-feature",this.removeHandles(t),n=this.selectedFeature,i=this.highlightEnabled,o=this.view,a=this.visible,n&&o&&i&&a){e.next=5;break}return e.abrupt("return");case 5:if((u=this._getHighlightLayer(n))&&u instanceof C.Z&&this._mapIncludesLayer(u)){e.next=8;break}return e.abrupt("return");case 8:return l=this._getLayerView(o,u),this._highlightSelectedFeaturePromise=l,e.next=12,l;case 12:if((s=e.sent)&&(0,I.tl)(s)&&this._highlightSelectedFeaturePromise===l&&this.selectedFeature&&this.highlightEnabled&&this.visible){e.next=15;break}return e.abrupt("return");case 15:c=s.highlight(this._getHighlightTarget(n,u,o.type)),this.addHandles(c,t);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_updateFeatures",value:function(e){var t=this.features,n=e.filter((function(e){return!t.includes(e)}));(null===n||void 0===n?void 0:n.length)&&(this.features=t.concat(n))}}]),d}((0,q._)($.Z));(0,d._)([(0,_.Cb)()],X.prototype,"_fetchFeaturesController",void 0),(0,d._)([(0,_.Cb)({type:P.$Q})],X.prototype,"actions",void 0),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"active",null),(0,d._)([(0,_.Cb)()],X.prototype,"activeFeature",void 0),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"allActions",null),(0,d._)([(0,_.Cb)()],X.prototype,"autoCloseEnabled",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"browseClusterEnabled",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"content",void 0),(0,d._)([(0,_.Cb)({type:P.$Q,readOnly:!0})],X.prototype,"defaultActions",null),(0,d._)([(0,_.Cb)({type:Boolean})],X.prototype,"defaultPopupTemplateEnabled",void 0),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"featureCount",null),(0,d._)([(0,_.Cb)()],X.prototype,"featurePage",void 0),(0,d._)([(0,_.Cb)({value:[]})],X.prototype,"features",null),(0,d._)([(0,_.Cb)()],X.prototype,"featuresPerPage",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"featureMenuOpen",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"featureViewModelAbilities",void 0),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"featureViewModels",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"highlightEnabled",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"includeDefaultActions",void 0),(0,d._)([(0,_.Cb)({type:U.Z})],X.prototype,"location",null),(0,d._)([(0,_.Cb)()],X.prototype,"map",null),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"pendingPromisesCount",null),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"promiseCount",null),(0,d._)([(0,_.Cb)()],X.prototype,"promises",null),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"selectedClusterBoundaryFeature",void 0),(0,d._)([(0,_.Cb)({value:null,readOnly:!0})],X.prototype,"selectedFeature",null),(0,d._)([(0,_.Cb)({value:-1})],X.prototype,"selectedFeatureIndex",null),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"selectedFeatureViewModel",null),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"state",null),(0,d._)([(0,_.Cb)()],X.prototype,"timeZone",null),(0,d._)([(0,_.Cb)()],X.prototype,"title",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"updateLocationEnabled",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"view",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"visible",void 0),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"waitingForContents",null),(0,d._)([(0,_.Cb)({readOnly:!0})],X.prototype,"waitingForResult",null),(0,d._)([(0,_.Cb)()],X.prototype,"zoomFactor",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"zoomToLocation",void 0),(0,d._)([(0,_.Cb)()],X.prototype,"centerAtLocation",null);var Y=X=(0,d._)([(0,b.j)("esri.widgets.Features.FeaturesViewModel")],X)},65497:function(e,t,n){n.d(t,{$Q:function(){return l},OO:function(){return s},iA:function(){return v},tP:function(){return c},wS:function(){return d}});var i=n(80987),r=n(57976),o=n(6945),a=n(9676),u=n(33095),l=i.Z.ofType({key:"type",defaultKeyValue:"button",base:r.Z,typeMap:{button:o.Z,toggle:a.Z}}),s=new o.Z({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:u.W.zoomInMagnifyingGlass}),c=new o.Z({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:u.W.trash}),d=new o.Z({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:u.W.zoomInMagnifyingGlass}),v=new a.Z({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:u.W.table,value:!1})},45966:function(e,t,n){n.d(t,{Z:function(){return _}});var i=n(4942),r=n(15671),o=n(43144),a=n(60136),u=n(29388),l=n(27366),s=n(66978),c=n(94172),d=n(49861),v=(n(93169),n(32718),n(84936),n(69912)),h=n(33565),f=n(67354),p=(n(80975),n(67005)),g="esri-spinner",y={base:g,spinnerStart:"".concat(g,"--start"),spinnerFinish:"".concat(g,"--finish")},w=function(e){(0,a.Z)(n,e);var t=(0,u.Z)(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,e,i))._animationDelay=500,o._animationPromise=null,o.viewModel=new f.Z,o}return(0,o.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,c.watch)((function(){return e.visible}),(function(t){return e._visibleChange(t)})))}},{key:"destroy",value:function(){this._animationPromise=null}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"show",value:function(e){var t=this,n=null!==e&&void 0!==e?e:{},i=n.location,r=n.promise;i&&(this.viewModel.location=i),this.visible=!0;r&&r.catch((function(){})).then((function(){return t.hide()}))}},{key:"hide",value:function(){this.visible=!1}},{key:"render",value:function(){var e,t=this.visible,n=!!this.viewModel.screenLocation,r=t&&n,o=!t&&n,a=(e={},(0,i.Z)(e,y.spinnerStart,r),(0,i.Z)(e,y.spinnerFinish,o),e),u=this._getPositionStyles();return(0,p.u)("div",{class:this.classes(y.base,a),styles:u})}},{key:"_visibleChange",value:function(e){var t=this;if(e)this.viewModel.screenLocationEnabled=!0;else{var n=(0,s.e4)(this._animationDelay);this._animationPromise=n,n.catch((function(){})).then((function(){t._animationPromise===n&&(t.viewModel.screenLocationEnabled=!1,t._animationPromise=null)}))}}},{key:"_getPositionStyles",value:function(){var e=this.viewModel,t=e.screenLocation,n=e.view;if(null==n||null==t)return{};var i=n.padding;return{left:t.x-i.left+"px",top:t.y-i.top+"px"}}}]),n}(h.Z);(0,l._)([(0,d.Cb)()],w.prototype,"location",null),(0,l._)([(0,d.Cb)()],w.prototype,"view",null),(0,l._)([(0,d.Cb)({type:f.Z})],w.prototype,"viewModel",void 0),(0,l._)([(0,d.Cb)()],w.prototype,"visible",null);var _=w=(0,l._)([(0,v.j)("esri.widgets.Spinner")],w)},67354:function(e,t,n){n.d(t,{Z:function(){return d}});var i=n(43144),r=n(15671),o=n(60136),a=n(29388),u=n(27366),l=n(49861),s=(n(93169),n(32718),n(84936),n(69912)),c=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).visible=!1,i}return(0,i.Z)(n)}(n(70407).Z);(0,u._)([(0,l.Cb)()],c.prototype,"visible",void 0);var d=c=(0,u._)([(0,s.j)("esri.widgets.Spinner.SpinnerViewModel")],c)},70407:function(e,t,n){n.d(t,{Z:function(){return f}});var i=n(15671),r=n(43144),o=n(60136),a=n(29388),u=n(27366),l=n(91505),s=n(94172),c=n(49861),d=(n(93169),n(32718),n(84936),n(69912)),v=n(79803),h=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).location=null,r.screenLocationEnabled=!1,r.view=null,r.addHandles([(0,s.when)((function(){var e=r.screenLocationEnabled?r.view:null;return e?[e.size,"3d"===e.type?e.camera:e.viewpoint]:null}),(function(){return r.notifyChange("screenLocation")})),(0,s.watch)((function(){return r.screenLocation}),(function(e,t){null!=e&&null!=t&&r.emit("view-change")}))]),r}return(0,r.Z)(n,[{key:"destroy",value:function(){this.view=null}},{key:"screenLocation",get:function(){var e=this.location,t=this.view,n=this.screenLocationEnabled,i=null===t||void 0===t?void 0:t.spatialReference,r=i?(0,v.projectOrLoad)(e,i).geometry:null;return n&&r&&null!==t&&void 0!==t&&t.ready?t.toScreen(r):null}}]),n}(l.Z.EventedAccessor);(0,u._)([(0,c.Cb)()],h.prototype,"location",void 0),(0,u._)([(0,c.Cb)()],h.prototype,"screenLocation",null),(0,u._)([(0,c.Cb)()],h.prototype,"screenLocationEnabled",void 0),(0,u._)([(0,c.Cb)()],h.prototype,"view",void 0);var f=h=(0,u._)([(0,d.j)("esri.widgets.support.AnchorElementViewModel")],h)},28907:function(e,t,n){n.d(t,{s:function(){return r}});var i=n(93433);function r(e){return function(t){t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);var n=t._delegatedEventNames,r=Array.isArray(e)?e:function(e){return e.split(",").map((function(e){return e.trim()}))}(e);n.push.apply(n,(0,i.Z)(r))}}}}]);
//# sourceMappingURL=573.e2081c9c.chunk.js.map