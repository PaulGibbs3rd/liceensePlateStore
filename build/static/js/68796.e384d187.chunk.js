"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[68796],{32500:function(e,t,n){n.d(t,{I:function(){return b},b:function(){return P}});var i,a,r,s,l=n(30168),o=n(37081),u=n(33280),c=n(94951),p=n(15226),d=n(26461),h=n(116),v=n(41012),f=n(58406),y=n(98634),_=n(64201),w=n(19253),g=n(25920),m=n(4760);function P(e){var t=new _.kG,n=t.vertex,P=t.fragment;return(0,v.Sv)(n,e),t.include(c.w,e),t.attributes.add(m.T.POSITION,"vec3"),t.attributes.add(m.T.UV0,"vec2"),e.perspectiveInterpolation&&t.attributes.add(m.T.PERSPECTIVEDIVIDE,"float"),t.varyings.add("vpos","vec3"),e.multipassEnabled&&t.varyings.add("depth","float"),n.code.add((0,y.H)(i||(i=(0,l.Z)(["\n    void main(void) {\n      vpos = position;\n      ","\n      vTexCoord = uv0;\n      gl_Position = transformPosition(proj, view, vpos);\n\n      ","\n    }\n  "])),e.multipassEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",e.perspectiveInterpolation?"gl_Position *= perspectiveDivide;":"")),t.include(u.f5,e),t.include(p.l,e),P.uniforms.add(new w.A("tex",(function(e){return e.texture})),new f.p("opacity",(function(e){return e.opacity}))),t.varyings.add("vTexCoord","vec2"),e.transparencyPassType===g.A.ColorAlpha&&(t.outputs.add("fragColor","vec4",0),t.outputs.add("fragAlpha","float",1)),P.include(h.Y),P.code.add((0,y.H)(a||(a=(0,l.Z)(["\n    void main() {\n      discardBySlice(vpos);\n      ","\n      fragColor = texture(tex, vTexCoord) * opacity;\n\n      if (fragColor.a < ",") {\n        discard;\n      }\n\n      fragColor = highlightSlice(fragColor, vpos);\n      ","\n      ","\n    }\n    "])),e.multipassEnabled?"terrainDepthTest(depth);":"",y.H.float(d.F),e.transparencyPassType===g.A.ColorAlpha?(0,y.H)(r||(r=(0,l.Z)(["\n              fragColor = premultiplyAlpha(fragColor);\n              fragAlpha = fragColor.a;"]))):"",e.output===o.H_.ObjectAndLayerIdColor?(0,y.H)(s||(s=(0,l.Z)(["\n              fragColor = vec4(0,0,0,1);"]))):"")),t}var b=Object.freeze(Object.defineProperty({__proto__:null,build:P},Symbol.toStringTag,{value:"Module"}))},30494:function(e,t,n){n.d(t,{T:function(){return o}});var i=n(74165),a=n(1413),r=n(15861),s=n(76200),l=n(10064);function o(e,t,n,i,a,r,s){return u.apply(this,arguments)}function u(){return u=(0,r.Z)((0,i.Z)().mark((function e(t,n,r,o,u,c,p){var d,h,v,f,y,_;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=null,null==r){e.next=17;break}return h="".concat(t,"/nodepages/"),v=h+Math.floor(r.rootIndex/r.nodesPerPage),e.prev=3,e.next=6,(0,s.Z)(v,{query:(0,a.Z)((0,a.Z)({f:"json"},o),{},{token:u}),responseType:"json",signal:p});case 6:return e.t0=e.sent.data,e.t1=r.rootIndex,e.t2=r.nodesPerPage,e.t3=r.lodSelectionMetricType,e.t4=h,e.abrupt("return",{type:"page",rootPage:e.t0,rootIndex:e.t1,pageSize:e.t2,lodMetric:e.t3,urlPrefix:e.t4});case 14:e.prev=14,e.t5=e.catch(3),null!=c&&c.warn("#fetchIndexInfo()","Failed to load root node page. Falling back to node documents.",v,e.t5),d=e.t5;case 17:if(n){e.next=19;break}return e.abrupt("return",null);case 19:return f=null===n||void 0===n?void 0:n.split("/").pop(),y="".concat(t,"/nodes/"),_=y+f,e.prev=20,e.next=23,(0,s.Z)(_,{query:(0,a.Z)((0,a.Z)({f:"json"},o),{},{token:u}),responseType:"json",signal:p});case 23:return e.t6=e.sent.data,e.t7=y,e.abrupt("return",{type:"node",rootNode:e.t6,urlPrefix:e.t7});case 28:throw e.prev=28,e.t8=e.catch(20),new l.Z("sceneservice:root-node-missing","Root node missing.",{pageError:d,nodeError:e.t8,url:_});case 31:case"end":return e.stop()}}),e,null,[[3,14],[20,28]])}))),u.apply(this,arguments)}},98074:function(e,t,n){n.d(t,{p:function(){return d}});var i=n(15671),a=n(43144),r=n(60136),s=n(29388),l=n(27366),o=n(42537),u=n(67426),c=n(49861),p=(n(93169),n(32718),n(84936),n(69912)),d=function(e){var t=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).parent=null,e._userInteractive=!1,e._interactiveViewModelCount=0,e}return(0,a.Z)(n,[{key:"interactive",get:function(){return this._interactiveViewModelCount>0||this._userInteractive},set:function(e){this._userInteractive=e}},{key:"updating",get:function(){return!1}},{key:"visible",get:function(){return null==this.parent||this.parent.visible&&!this.parent.suspended},set:function(e){this._overrideIfSome("visible",e)}},{key:"forceInteractiveForViewModel",value:function(){var e=this;return this._interactiveViewModelCount++,(0,o.kB)((function(){return e._interactiveViewModelCount--}))}}]),n}((0,u.v)(e));return(0,l._)([(0,c.Cb)({constructOnly:!0})],t.prototype,"parent",void 0),(0,l._)([(0,c.Cb)({constructOnly:!0})],t.prototype,"view",void 0),(0,l._)([(0,c.Cb)({type:Boolean})],t.prototype,"interactive",null),(0,l._)([(0,c.Cb)()],t.prototype,"_userInteractive",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],t.prototype,"updating",null),(0,l._)([(0,c.Cb)()],t.prototype,"visible",null),(0,l._)([(0,c.Cb)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,l._)([(0,p.j)("esri.views.3d.analysis.AnalysisView3D")],t)}},94018:function(e,t,n){n.r(t),n.d(t,{default:function(){return le}});var i=n(15671),a=n(43144),r=n(60136),s=n(29388),l=n(27366),o=n(7138),u=(n(93169),n(92026)),c=n(49861),p=n(32718),d=(n(84936),n(69912)),h=n(98074),v=n(77372),f=n(94172),y=n(82218),_=n(30651),w=n(59147),g=n(38978),m=n(33906),P=n(41644);var b=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e))._internalChange=!1,a._currentSlicePlane=null,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles(this.analysis.excludedLayers.on("before-add",(function(t){var n=t.item;null!=n&&(n instanceof _.Z||n instanceof w.Z)?n instanceof _.Z&&function(e){switch(e.type){case"building-scene":case"catalog":case"catalog-dynamic-group":case"catalog-footprint":case"csv":case"dimension":case"feature":case"geo-rss":case"geojson":case"graphics":case"group":case"integrated-mesh":case"integrated-mesh-3dtiles":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-notes":case"ogc-feature":case"oriented-imagery":case"point-cloud":case"route":case"scene":case"stream":case"voxel":case"subtype-group":case"unknown":case"unsupported":case"wfs":case null:return!1;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"elevation":case"imagery":case"imagery-tile":case"map-image":case"media":case"open-street-map":case"tile":case"vector-tile":case"video":case"wcs":case"web-tile":case"wms":case"wmts":return!0;default:return(0,P.Bg)(e.type),!1}}(n)?(p.Z.getLogger(e).error("excludedLayers","Layer '".concat(n.title,", id:").concat(n.id,"' of type '").concat(n.type,"' can not be individually excluded from slicing. Use 'excludeGroundSurface' instead.")),t.preventDefault()):e.analysis.excludedLayers.includes(n)&&t.preventDefault():(p.Z.getLogger(e).error("excludedLayers","Invalid layer type, layer must derive from Layer or BuildingComponentSublayer"),t.preventDefault())}))),function(e,t){var n;C.has(e)||C.set(e,{all:[],activeController:null}),null===(n=C.get(e))||void 0===n||n.all.push(t)}(this.view,this),this.addHandles([(0,f.watch)((function(){return e.analysisViewData.plane}),(function(){e._internalChange||e._updateSlicePlaneFromBoundedPlane(),e._updateLayerViews()}),{sync:!0}),(0,f.watch)((function(){return e.analysis.excludeGroundSurface}),(function(){return e._updateLayerViews()}),{sync:!0}),this.analysis.excludedLayers.on("change",(function(){return e._updateLayerViews()})),(0,f.watch)((function(){return[e.analysisViewData.active,e.analysisViewData.visible]}),(function(){e._updateActiveController(),e._updateViewSlicePlane()}),{sync:!0}),(0,f.watch)((function(){return e._allLayerAndSubLayerViews}),(function(){return e._updateLayerViews()}))]),this.addHandles([(0,f.watch)((function(){return e.analysis.shape}),(function(){e._internalChange||(e._updateBoundedPlaneFromSlicePlane(),e._updateViewSlicePlane())}),{sync:!0})],"analysis"),this._updateActiveController(),this._updateBoundedPlaneFromSlicePlane(),this._updateViewSlicePlane()}},{key:"destroy",value:function(){this.analysisViewData.active&&(this.analysisViewData.active=!1,this.view.slicePlane=null,this._updateActiveController(),this._updateViewSlicePlane()),function(e,t){var n;if(!C.has(e))throw new Error("view expected in global slice register");var i=C.get(e),a=null!==(n=null===i||void 0===i?void 0:i.all.lastIndexOf(t))&&void 0!==n?n:-1;if(!i||-1===a)throw new Error("controller expected in global slice register");i.all.splice(a,1),0===i.all.length&&C.delete(e)}(this.view,this),this.set("view",null)}},{key:"_allLayerAndSubLayerViews",get:function(){var e=this.view.allLayerViews.items;return e.concat(e.filter(g.lR).flatMap((function(e){return e.sublayerViews.items})))}},{key:"_updateBoundedPlaneFromSlicePlane",value:function(){var e=this.analysis.shape,t=this._currentSlicePlane;if(!(null==t&&null==e||null!=t&&null!=e&&e.equals(t))){var n=null,i=null;if(null!=(null===e||void 0===e?void 0:e.position)){var a=e.position.spatialReference,r=(0,g.m3)(e,this.view);null==r&&(0,m.e)(this.analysis,a,p.Z.getLogger(this)),null!=(n=(0,g.oP)(r,this.view,{tiltEnabled:this.analysis.tiltEnabled},(0,y.a)()))&&(i={heading:e.heading,tilt:e.tilt,position:e.position,width:e.width,height:e.height})}this._currentSlicePlane=i,this._internalChange=!0,this.analysisViewData.plane=n,this._internalChange=!1}}},{key:"_updateSlicePlaneFromBoundedPlane",value:function(){var e=this.analysisViewData.plane,t=(0,g.Hq)(e,this.view,this.view.spatialReference,new v.Z),n=null;null!=t&&(n={heading:t.heading,tilt:t.tilt,position:t.position,width:t.width,height:t.height}),this._currentSlicePlane=n,this._internalChange=!0,this.analysis.shape=t,this._internalChange=!1,this._updateViewSlicePlane()}},{key:"_updateActiveController",value:function(){if(!k){var e=V(this.view);if(e)if(this.analysisViewData.active)null!=e.activeController&&e.activeController!==this?(k=!0,e.activeController.analysisViewData.active=!1,k=!1):null!=e.activeController&&e.activeController,this._updateLayerViews(),e.activeController=this;else{if(null!=e.activeController&&e.activeController!==this)return;null!=e.activeController&&e.activeController===this&&(e.activeController=null,this._updateLayerViews())}}}},{key:"_updateViewSlicePlane",value:function(){!function(e){var t=V(e),n=null===t||void 0===t?void 0:t.activeController;null!=(null===n||void 0===n?void 0:n.analysisViewData.plane)&&n.analysisViewData.visible?e.slicePlane=n.analysisViewData.plane:e.slicePlane=null}(this.view)}},{key:"_updateLayerViews",value:function(){var e=null!=this.analysisViewData.plane&&this.analysisViewData.visible&&this.analysisViewData.active,t=[];this.analysis.excludedLayers.forEach((function e(n){"layers"in n?n.layers.forEach(e):t.push(n)})),this.view.allLayerViews.forEach((function(n){n.destroyed||("slicePlaneEnabled"in n&&(n.slicePlaneEnabled=e&&!t.includes(n.layer)),"sublayerViews"in n&&n.sublayerViews.forEach((function(n){n.slicePlaneEnabled=e&&!t.includes(n.sublayer)})))})),null!=this.view.basemapTerrain&&(this.view.basemapTerrain.slicePlaneEnabled=e&&!this.analysis.excludeGroundSurface)}}]),n}(o.default);(0,l._)([(0,c.Cb)()],b.prototype,"view",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"analysis",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"analysisViewData",void 0),(0,l._)([(0,c.Cb)()],b.prototype,"_allLayerAndSubLayerViews",null),b=(0,l._)([(0,d.j)("esri.views.3d.analysis.Slice.SliceController")],b);var C=new Map,k=!1;function V(e){return C.get(e)}var E,M=n(1413),D=n(84702),T=n(99346),S=n(17842),x=n(29134),Z=n(32035),I=n(12400),R=n(86361),O=n(55652),A=n(40885),H=n(51378),G=n(11526),L=n(12350),U=n(37947),z=n(32909),N=n(61074),F=n(3319),j=n(83639),B=n(51328),W=n(81703),K=n(86509),q=n(74229),$=n(81298),X=n(72612),Y=E=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e))._clock=D.m,a._previewPlaneOpacity=1,a.removeIncompleteOnCancel=!1,a._layersMode="none",a.shiftManipulator=null,a.rotateHeadingManipulator=null,a.rotateTiltManipulator=null,a.resizeManipulators=null,a._frameTask=null,a._pointerMoveTimerMs=F.AN,a._prevPointerMoveTimeout=null,a._previewPlaneGridVisualElement=null,a._previewPlaneOutlineVisualElement=null,a._startPlane=(0,y.a)(),a._previewPlane=null,a._activeKeyModifiers={},a._lastCursorPosition=(0,S.vW)(),a._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],a._intersector=(0,$.w)(e.view.state.viewingMode),a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e,t=this;if(null==this.analysis)throw new Error("SliceTool requires valid analysis, but null was provided.");var n=function(e){t._updateManipulatorsInteractive(e),e.grabbing||(null!=t.analysisViewData.plane&&(0,y.c)(t.analysisViewData.plane,t._startPlane),t.inputState=null)},i=new N.K(this.view,N.l.CENTER_ON_ARROW);this.shiftManipulator=i,this.manipulators.add(i),this.addHandles([this._createShiftDragPipeline(i),i.events.on("grab-changed",(function(e){t._onShiftGrab(e),n(i)}))]);var a=!(null!==(e=this.view._stage)&&void 0!==e&&e.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result),r=new U.Z(this.view,(function(e,n){return(0,G.O)(t.view.textures,{accentColor:e,contrastColor:n,preMultiplyAlpha:a})}));this.rotateHeadingManipulator=r,this.manipulators.add(r),this.addHandles([this._createRotateHeadingDragPipeline(r),r.events.on("grab-changed",(function(e){t._onRotateHeadingGrab(e),n(r)}))]);var s=new U.Z(this.view,(function(e,n){return(0,G.s)(t.view.textures,{accentColor:e,contrastColor:n,preMultiplyAlpha:a})}));this.rotateTiltManipulator=s,this.manipulators.add(s),this.addHandles([this._createRotateTiltDragPipeline(s),s.events.on("grab-changed",(function(e){t._onRotateTiltGrab(e),n(s)}))]),this.resizeManipulators=this._resizeHandles.map((function(e,i){var a=new L.o(t.view,e);return t.addHandles([t._createResizeDragPipeline(a),a.events.on("grab-changed",(function(e){t._onResizeGrab(e,i),n(a)}))]),a})),this.manipulators.addMany(this.resizeManipulators),this._previewPlaneGridVisualElement=(0,g.R_)(this.view),this._previewPlaneOutlineVisualElement=(0,g.i3)(this.view),this._previewPlaneOutlineVisualElement.width=F.Lf,this.addHandles((0,f.watch)((function(){return[t.analysisViewData.plane,t.analysis.tiltEnabled]}),(function(){return t._updateManipulators()}),f.sync));var l=(0,f.watch)((function(){return t.state}),(function(e){"sliced"===e&&t.finishToolCreation()}),f.syncAndInitial);this.addHandles([l,(0,f.watch)((function(){return t.view.state.camera}),(function(){return t._onCameraChange()}))])}},{key:"destroy",value:function(){this._removeFrameTask(),this._clearPointerMoveTimeout(),this._previewPlaneOutlineVisualElement=(0,u.SC)(this._previewPlaneOutlineVisualElement),this._previewPlaneGridVisualElement=(0,u.SC)(this._previewPlaneGridVisualElement)}},{key:"state",get:function(){var e=!!this.analysisViewData.plane,t=!!this.inputState;return e?e&&t?"slicing":e&&!t?"sliced":"ready":"ready"}},{key:"cursor",get:function(){return this._isPlacingSlicePlane||"exclude"===this.layersMode?"crosshair":null!=this._creatingPointerId?"grabbing":null}},{key:"analysis",set:function(e){if(null==e)throw new Error("SliceTool requires valid analysis, but null was provided.");this.removeHandles("analysis"),this._set("analysis",e)}},{key:"layersMode",get:function(){return this._layersMode}},{key:"inputState",get:function(){return this._get("inputState")},set:function(e){this._set("inputState",e),this.analysisViewData.showGrid=null!=e&&"resize"===e.type,this._updateMaterials()}},{key:"_isPlacingSlicePlane",get:function(){return!this.inputState&&!this.analysisViewData.plane&&this.active}},{key:"_creatingPointerId",get:function(){return null!=this.inputState&&"shift"===this.inputState.type?this.inputState.creatingPointerId:null}},{key:"enterExcludeLayerMode",value:function(){null!=this.analysisViewData.plane&&(this._layersMode="exclude",this.active||(this.view.activeTool=this))}},{key:"exitExcludeLayerMode",value:function(){null!=this.analysisViewData.plane&&(this._layersMode="none",this.active&&(this.view.activeTool=null))}},{key:"onDeactivate",value:function(){this._updatePreviewPlane(null)}},{key:"onShow",value:function(){this._updateVisibility(!0)}},{key:"onHide",value:function(){this._updateVisibility(!1)}},{key:"_updateVisibility",value:function(e){this._updateManipulators(),e||this._clearPointerMoveTimeout()}},{key:"onInputEvent",value:function(e){switch(e.type){case"pointer-drag":if(!ee(e))return;this._isPlacingSlicePlane?this._onClickPlacePlane(e)&&e.stopPropagation():this._onPointerDrag(e)&&e.stopPropagation();break;case"pointer-move":this._onPointerMove(e);break;case"pointer-up":this._onPointerUp(e)&&e.stopPropagation();break;case"immediate-click":if(!ee(e))return;this._onClickPlacePlane(e)&&e.stopPropagation();break;case"click":if(!ee(e))return;this._onClickExcludeLayer(e)&&e.stopPropagation();break;case"drag":this.inputState&&e.stopPropagation();break;case"key-down":this._onKeyDown(e)&&e.stopPropagation();break;case"key-up":this._onKeyUp(e)&&e.stopPropagation()}}},{key:"onEditableChange",value:function(){this.analysisViewData.editable=this.internallyEditable}},{key:"_onPointerDrag",value:function(e){var t=this.inputState;if(e.pointerId===this._creatingPointerId&&null!=t&&"shift"===t.type){var n=(0,X.vT)(e);return this.shiftManipulator.events.emit("drag",{action:t.hasBeenDragged?"update":"start",pointerType:e.pointerType,start:n,screenPoint:n}),t.hasBeenDragged=!0,!0}return!1}},{key:"_onPointerMove",value:function(e){this._lastCursorPosition.x=e.x,this._lastCursorPosition.y=e.y,this._resetPointerMoveTimeout(),"touch"!==e.pointerType&&this._updatePreviewPlane((0,X.vT)(e),this._activeKeyModifiers)}},{key:"_onCameraChange",value:function(){this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),this._updateManipulators()}},{key:"_onPointerUp",value:function(e){if(e.pointerId===this._creatingPointerId&&null!=this.analysisViewData.plane){var t=(0,X.vT)(e);return this.shiftManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),(0,y.c)(this.analysisViewData.plane,this._startPlane),this.inputState=null,!0}return!1}},{key:"_onClickPlacePlane",value:function(e){if("exclude"===this.layersMode)return!1;if(this._isPlacingSlicePlane){var t=(0,X.vT)(e),n=(0,y.a)();if(this._pickPlane(t,!1,this._activeKeyModifiers,n)){if("pointer-drag"===e.type){var i=(0,W.j$)(this.view.state.camera,t,ne);this.inputState=Q(i,e.pointerId,n.origin,n)}return(0,y.c)(n,this._startPlane),this.analysis.shape=(0,g.Hq)(n,this.view,this.view.spatialReference,new v.Z),!0}}return!1}},{key:"_onClickExcludeLayer",value:function(e){var t=this;return!("exclude"!==this.layersMode||!this.created)&&(this.view.hitTest((0,X.vT)(e)).then((function(e){if(e.results.length){var n=e.results[0],i="graphic"===(null===n||void 0===n?void 0:n.type)&&n.graphic;if(i){var a=i.sourceLayer||i.layer;a&&t.analysis.excludedLayers.push(a)}}else e.ground.layer?t.analysis.excludedLayers.push(e.ground.layer):t.analysis.excludeGroundSurface=!0})),this.exitExcludeLayerMode(),!0)}},{key:"_onKeyDown",value:function(e){return(e.key===F.GI||e.key===F.tW)&&(this._activeKeyModifiers[e.key]=!0,null!=this._previewPlane&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)}},{key:"_onKeyUp",value:function(e){return!(e.key!==F.GI&&e.key!==F.tW||!this._activeKeyModifiers[e.key])&&(delete this._activeKeyModifiers[e.key],null!=this._previewPlane&&this._updatePreviewPlane(this._lastCursorPosition,this._activeKeyModifiers),!0)}},{key:"_onShiftGrab",value:function(e){if("start"===e.action&&null!=this.analysisViewData.plane&&e.screenPoint){var t=(0,W.j$)(this.view.state.camera,e.screenPoint,ne);(0,y.c)(this.analysisViewData.plane,this._startPlane),this.inputState=Q(t,null,this.shiftManipulator.renderLocation,this.analysisViewData.plane)}}},{key:"_createShiftDragPipeline",value:function(e){var t=this;return(0,q.Xd)(e,(function(e,n,i){var a=t.inputState;if(null!=a&&"shift"===a.type){var r=null!=t.analysisViewData.plane?(0,y.c)(t.analysisViewData.plane,(0,y.a)()):null;n.next((0,B._N)(t.view,a.shiftPlane)).next(t._shiftDragAdjustSensitivity(a)).next(t._shiftDragUpdatePlane(a)),i.next((function(){null!=r&&t._updateBoundedPlane(r)}))}}))}},{key:"_shiftDragAdjustSensitivity",value:function(e){var t=this;return function(n){if(null==t.analysisViewData.plane)return null;var i=Math.min((1-Math.abs((0,Z.m)((0,y.n)(t.analysisViewData.plane),n.ray.direction)/(0,Z.l)(n.ray.direction)))/.001,1),a=-(0,O.jH)(t._startPlane.plane,n.renderEnd),r=-(0,O.jH)(t._startPlane.plane,e.startPoint);return e.depth=e.depth*(1-i)+a*i-r,n}}},{key:"_shiftDragUpdatePlane",value:function(e){var t=this;return function(){if(null!=t.analysisViewData.plane){var n=(0,Z.c)(H.WM.get(),t._startPlane.origin),i=(0,Z.c)(H.WM.get(),(0,y.n)(t._startPlane));(0,Z.j)(i,i,-e.depth),(0,Z.g)(i,i,n);var a=(0,y.f)(i,t.analysisViewData.plane.basis1,t.analysisViewData.plane.basis2,(0,y.a)());t._updateBoundedPlane(a)}}}},{key:"_onRotateHeadingGrab",value:function(e){if("start"===e.action&&null!=this.analysisViewData.plane&&e.screenPoint){var t=(0,g.Rd)(this.analysisViewData.plane,this.view.renderCoordsHelper,g.aZ.HEADING,(0,O.Ue)()),n=(0,W.j$)(this.view.state.camera,e.screenPoint,ne),i=(0,I.Ue)();(0,O.BR)(t,n,i)&&((0,y.c)(this.analysisViewData.plane,this._startPlane),this.inputState={type:"rotate",rotatePlane:t,startPoint:i})}}},{key:"_createRotateHeadingDragPipeline",value:function(e){var t=this;return(0,q.Xd)(e,(function(e,n,i){var a=t.inputState;if(null!=a&&"rotate"===a.type){var r=null!=t.analysisViewData.plane?(0,y.c)(t.analysisViewData.plane,(0,y.a)()):null;n.next((0,B._N)(t.view,a.rotatePlane)).next(t._rotateDragRenderPlaneToRotate(a)).next(t._rotateDragUpdatePlaneFromRotate()),i.next((function(){null!=r&&t._updateBoundedPlane(r)}))}}))}},{key:"_onRotateTiltGrab",value:function(e){if("start"===e.action&&null!=this.analysisViewData.plane&&e.screenPoint){var t=(0,g.Rd)(this.analysisViewData.plane,this.view.renderCoordsHelper,g.aZ.TILT,(0,O.Ue)()),n=(0,W.j$)(this.view.state.camera,e.screenPoint,ne),i=(0,I.Ue)();(0,O.BR)(t,n,i)&&((0,y.c)(this.analysisViewData.plane,this._startPlane),this.inputState={type:"rotate",rotatePlane:t,startPoint:i})}}},{key:"_createRotateTiltDragPipeline",value:function(e){var t=this;return(0,q.Xd)(e,(function(e,n,i){var a=t.inputState;if(null!=a&&"rotate"===a.type){var r=null!=t.analysisViewData.plane?(0,y.c)(t.analysisViewData.plane,(0,y.a)()):null;n.next((0,B._N)(t.view,a.rotatePlane)).next(t._rotateDragRenderPlaneToRotate(a)).next(t._rotateDragUpdatePlaneFromRotate()),i.next((function(){null!=r&&t._updateBoundedPlane(r)}))}}))}},{key:"_rotateDragRenderPlaneToRotate",value:function(e){var t=this;return function(n){if(null==t.analysisViewData.plane)return null;var i=(0,O.st)(e.rotatePlane),a=(0,j.Gd)(e.startPoint,n.renderEnd,t.analysisViewData.plane.origin,i);return(0,M.Z)((0,M.Z)({},n),{},{rotateAxis:i,rotateAngle:a})}}},{key:"_rotateDragUpdatePlaneFromRotate",value:function(){var e=this;return function(t){if(null!=e.analysisViewData.plane){var n=(0,x.Us)(H.MP.get(),t.rotateAngle,t.rotateAxis);if(null!=n){var i=(0,Z.h)(H.WM.get(),e._startPlane.basis1,n),a=(0,Z.h)(H.WM.get(),e._startPlane.basis2,n),r=(0,y.f)(e.analysisViewData.plane.origin,i,a,(0,y.a)());e._updateBoundedPlane(r)}}}}},{key:"_onResizeGrab",value:function(e,t){if("start"===e.action&&null!=this.analysisViewData.plane&&e.screenPoint){var n=(0,W.j$)(this.view.state.camera,e.screenPoint,ne),i=H.WM.get();(0,O.BR)(this.analysisViewData.plane.plane,n,i)&&((0,y.c)(this.analysisViewData.plane,this._startPlane),this.inputState={type:"resize",activeHandleIdx:t,startPoint:(0,I.d9)(i)})}}},{key:"_createResizeDragPipeline",value:function(e){var t=this;return(0,q.Xd)(e,(function(e,n,i){var a=t.inputState;if(null!=a&&"resize"===a.type&&null!=t.analysisViewData.plane){var r=(0,y.c)(t.analysisViewData.plane,(0,y.a)());n.next((0,B._N)(t.view,t.analysisViewData.plane.plane)).next(t._resizeDragUpdatePlane(a)),i.next((function(){t._updateBoundedPlane(r)}))}}))}},{key:"_resizeDragUpdatePlane",value:function(e){var t=this;return function(n){if(null!=t.analysisViewData.plane){var i=t._resizeHandles[e.activeHandleIdx],a=(0,g.Q3)(i,e.startPoint,n.renderEnd,t.view.state.camera,t._startPlane,(0,y.c)(t.analysisViewData.plane));t._updateBoundedPlane(a)}}}},{key:"_updateBoundedPlane",value:function(e){var t=this.analysisViewData;if(null==t)throw new Error("valid internal object expected");t.plane=e}},{key:"_updatePreviewPlane",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this._previewPlane;if(this._previewPlane=null,null==e)return this._removeFrameTask(),void this._updateManipulators();if(!this.analysisViewData.plane&&this.active){var a=null!=i?i:(0,y.a)();if(i=null!=i?(0,y.c)(i,te):null,this._pickPlane(e,!0,n,a)){var r=F.ZE,s=!1;null!=i&&(s=(0,Z.m)((0,O.st)(i.plane),(0,O.st)(a.plane))<r||(0,Z.m)((0,Z.n)(H.WM.get(),i.basis1),(0,Z.n)(H.WM.get(),a.basis1))<r),s&&(this._previewPlaneOpacity=0),this._previewPlane=a}}null!=this._previewPlane&&null==this._frameTask&&0===this._previewPlaneOpacity?this._frameTask=(0,T.A)({update:function(e){var n=e.deltaTime;t._previewPlaneOpacity=Math.min(t._previewPlaneOpacity+n/(1e3*F.v9),1),t._updateManipulators(),1===t._previewPlaneOpacity&&t._removeFrameTask()}}):null==this._previewPlane&&null!=this._frameTask?this._removeFrameTask():null!=this._previewPlane&&this._updateManipulators()}},{key:"_removeFrameTask",value:function(){this._frameTask=(0,u.hw)(this._frameTask)}},{key:"_pickMinResult",value:function(e){var t=(0,S.md)(e,H.qW.get());return this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector),this._intersector.results.min}},{key:"_pickPlane",value:function(e,t,n,i){var a=this._pickMinResult(e),r=H.WM.get();if(!a.getIntersectionPoint(r))return!1;var s=a.getTransformedNormal(H.WM.get()),l=this.view.state.camera;(0,Z.m)(s,l.viewForward)>0&&(0,Z.j)(s,s,-1);var o=(0,g.fT)(r,l),u=(t?1:-1)*o*F.P3,c=(0,Z.j)(H.WM.get(),s,u);(0,Z.g)(c,c,r);var p=this.analysis.tiltEnabled?g.ww.TILTED:g.ww.HORIZONTAL_OR_VERTICAL,d=n[F.GI]?g.ww.VERTICAL:n[F.tW]?g.ww.HORIZONTAL:p;return(0,g.j6)(c,s,o,o,l,d,this.view.renderCoordsHelper,i),!0}},{key:"_clearPointerMoveTimeout",value:function(){this._prevPointerMoveTimeout=(0,u.hw)(this._prevPointerMoveTimeout)}},{key:"_resetPointerMoveTimeout",value:function(){var e=this;this._clearPointerMoveTimeout(),this.shiftManipulator.state|=g.do,this.rotateHeadingManipulator.state|=g.do,this.rotateTiltManipulator.state|=g.do,this._prevPointerMoveTimeout=this._clock.setTimeout((function(){e.shiftManipulator.state&=~g.do,e.rotateHeadingManipulator.state&=~g.do,e.rotateTiltManipulator.state&=~g.do}),this._pointerMoveTimerMs)}},{key:"_updateManipulators",value:function(){var e=this;if(!E.disableEngineLayers){var t,n=!1;if(null!=this.analysisViewData.plane)t=this.analysisViewData.plane,n=!1;else{if(null==this._previewPlane)return this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach((function(e){return e.available=!1})),this._previewPlaneOutlineVisualElement.visible=!1,void(this._previewPlaneGridVisualElement.visible=!1);t=this._previewPlane,n=!0}var i=(0,g.zY)(t,H.MP.get());n?(this.shiftManipulator.available=!1,this.rotateHeadingManipulator.available=!1,this.rotateTiltManipulator.available=!1,this.resizeManipulators.forEach((function(e){return e.available=!1})),this._previewPlaneOutlineVisualElement.attached=!0,this._previewPlaneGridVisualElement.attached=!0,this._previewPlaneOutlineVisualElement.visible=!0,this._previewPlaneGridVisualElement.visible=!0):(this.shiftManipulator.available=!0,this.rotateHeadingManipulator.available=!0,this.rotateTiltManipulator.available=this.analysis.tiltEnabled,this.resizeManipulators.forEach((function(e){return e.available=!0})),(0,g.tF)(this.shiftManipulator,i,t,this.view.state.camera),(0,g.A5)(this.rotateHeadingManipulator,i,t,this.view.renderCoordsHelper),(0,g.wj)(this.rotateTiltManipulator,i,t),this.resizeManipulators.forEach((function(n,a){return(0,g.EC)(n,e._resizeHandles[a],i,t)})),this._previewPlaneOutlineVisualElement.visible=!1,this._previewPlaneGridVisualElement.visible=!1);var a=(0,Z.s)(H.WM.get(),(0,Z.l)(t.basis1),(0,Z.l)(t.basis2),1),r=(0,x.xJ)(H.MP.get(),a),s=(0,x.Jp)(r,i,r);this._previewPlaneOutlineVisualElement.transform=s,this._previewPlaneGridVisualElement.transform=s,this._updateMaterials()}}},{key:"_updateMaterials",value:function(){var e=(0,z.bL)(this.view.effectiveTheme);e[3]*=this._previewPlaneOpacity;var t=(0,R.d9)(z.ku);t[3]*=this._previewPlaneOpacity,this._previewPlaneOutlineVisualElement.color=e,this._previewPlaneGridVisualElement.backgroundColor=t,this._previewPlaneGridVisualElement.gridColor=R.AG}},{key:"_updateManipulatorsInteractive",value:function(e){if(!e.grabbing)return this.shiftManipulator.interactive=!0,this.rotateHeadingManipulator.interactive=!0,this.rotateTiltManipulator.interactive=!0,void this.resizeManipulators.forEach((function(e){e.interactive=!0}));this.shiftManipulator.interactive=this.shiftManipulator===e,this.rotateHeadingManipulator.interactive=this.rotateHeadingManipulator===e,this.rotateTiltManipulator.interactive=this.rotateTiltManipulator===e,this.resizeManipulators.forEach((function(t){t.interactive=t===e}))}},{key:"testData",value:function(){var e=this;return{plane:this.analysisViewData.plane,setPointerMoveTimerMs:function(t){e._pointerMoveTimerMs=t}}}}]),n}(K.f);Y.disableEngineLayers=!1,(0,l._)([(0,c.Cb)()],Y.prototype,"_clock",void 0),(0,l._)([(0,c.Cb)({constructOnly:!0})],Y.prototype,"view",void 0),(0,l._)([(0,c.Cb)()],Y.prototype,"analysisViewData",void 0),(0,l._)([(0,c.Cb)({readOnly:!0})],Y.prototype,"state",null),(0,l._)([(0,c.Cb)({readOnly:!0})],Y.prototype,"cursor",null),(0,l._)([(0,c.Cb)()],Y.prototype,"analysis",null),(0,l._)([(0,c.Cb)()],Y.prototype,"removeIncompleteOnCancel",void 0),(0,l._)([(0,c.Cb)()],Y.prototype,"_layersMode",void 0),(0,l._)([(0,c.Cb)()],Y.prototype,"layersMode",null),(0,l._)([(0,c.Cb)({value:null})],Y.prototype,"inputState",null),(0,l._)([(0,c.Cb)()],Y.prototype,"_isPlacingSlicePlane",null),(0,l._)([(0,c.Cb)()],Y.prototype,"_creatingPointerId",null);var J=Y=E=(0,l._)([(0,d.j)("esri.views.3d.analysis.Slice.SliceTool")],Y);function Q(e,t,n,i){var a=(0,g.TA)(n,(0,y.n)(i),e.direction,(0,O.Ue)()),r=(0,I.Ue)();return(0,O.BR)(a,e,r)?{type:"shift",creatingPointerId:t,hasBeenDragged:!1,shiftPlane:a,depth:0,startPoint:r}:null}function ee(e){return"mouse"!==e.pointerType||0===e.button}var te=(0,y.a)(),ne=(0,A.Ue)(),ie=n(86700),ae=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e))._gridVisualElement=null,a._outlineVisualElement=null,a.showGrid=!1,a.preview=!0,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this,t=this.analysisViewData;if(null==t)throw new Error("expected internal object to be valid");this._gridVisualElement=(0,g.R_)(this.view),this._outlineVisualElement=(0,g.i3)(this.view),this.addHandles([(0,f.watch)((function(){var n=null!=t.plane&&e.analysisViewData.visible,i=e.analysisViewData.active,a=e.preview,r=e.showGrid,s=e.view.effectiveTheme;return{visible:n,active:i,preview:a,showGrid:r,gridColor:(0,z.CB)(s),outlineColor:(0,z.bL)(s)}}),(function(t){return e._updateMaterials(t)}),f.syncAndInitial),(0,f.watch)((function(){return t.plane}),(function(t){return e._updatePlane(t)}),f.syncAndInitial)],"internal")}},{key:"destroy",value:function(){this._gridVisualElement=(0,u.SC)(this._gridVisualElement),this._outlineVisualElement=(0,u.SC)(this._outlineVisualElement),this.set("view",null)}},{key:"_updatePlane",value:function(e){if(null!=e){this._gridVisualElement.attached=!0,this._outlineVisualElement.attached=!0;var t=(0,Z.s)(H.WM.get(),(0,Z.l)(e.basis1),(0,Z.l)(e.basis2),1),n=(0,x.xJ)(H.MP.get(),t),i=(0,g.zY)(e,H.MP.get()),a=(0,x.Jp)(n,i,n);this._outlineVisualElement.transform=a,this._gridVisualElement.transform=a}}},{key:"_updateMaterials",value:function(e){var t=e.visible,n=e.active,i=e.preview,a=e.showGrid,r=e.gridColor,s=e.outlineColor;this._outlineVisualElement.color=s,this._outlineVisualElement.width=i?F.Lf:F.fg,this._outlineVisualElement.stipplePattern=n?null:(0,ie.z5)(5),this._gridVisualElement.backgroundColor=z.ku,this._gridVisualElement.gridColor=a?r:R.AG,this._gridVisualElement.visible=t,this._outlineVisualElement.visible=t}}]),n}(o.default);(0,l._)([(0,c.Cb)()],ae.prototype,"view",void 0),(0,l._)([(0,c.Cb)()],ae.prototype,"analysis",void 0),(0,l._)([(0,c.Cb)()],ae.prototype,"analysisViewData",void 0),(0,l._)([(0,c.Cb)()],ae.prototype,"showGrid",void 0),(0,l._)([(0,c.Cb)()],ae.prototype,"preview",void 0),ae=(0,l._)([(0,d.j)("esri.views.3d.analysis.Slice.SliceVisualization")],ae);var re=n(70209),se=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e)).type="slice-view-3d",a.analysis=null,a.tool=null,a.analysisVisualization=null,a.analysisController=null,a.plane=null,a.active=!0,a}return(0,a.Z)(n,[{key:"initialize",value:function(){this.analysisVisualization=new ae({view:this.view,analysis:this.analysis,analysisViewData:this}),this.analysisController=new b({view:this.view,analysis:this.analysis,analysisViewData:this}),this.addHandles((0,re.Lp)(this,J))}},{key:"destroy",value:function(){(0,re.Yq)(this),this.analysisVisualization=(0,u.SC)(this.analysisVisualization),this.analysisController=(0,u.SC)(this.analysisController)}},{key:"showGrid",get:function(){var e,t;return null!==(e=null===(t=this.analysisVisualization)||void 0===t?void 0:t.showGrid)&&void 0!==e&&e},set:function(e){this.analysisVisualization&&(this.analysisVisualization.showGrid=e)}},{key:"editable",get:function(){return!this.analysisVisualization.preview},set:function(e){this.analysisVisualization.preview=!e}},{key:"testData",get:function(){}}]),n}((0,h.p)(o.default));(0,l._)([(0,c.Cb)({readOnly:!0})],se.prototype,"type",void 0),(0,l._)([(0,c.Cb)({constructOnly:!0,nonNullable:!0})],se.prototype,"analysis",void 0),(0,l._)([(0,c.Cb)()],se.prototype,"tool",void 0),(0,l._)([(0,c.Cb)()],se.prototype,"plane",void 0),(0,l._)([(0,c.Cb)()],se.prototype,"active",void 0),(0,l._)([(0,c.Cb)()],se.prototype,"showGrid",null),(0,l._)([(0,c.Cb)()],se.prototype,"editable",null);var le=se=(0,l._)([(0,d.j)("esri.views.3d.analysis.SliceAnalysisView3D")],se)},33906:function(e,t,n){n.d(t,{G:function(){return r},e:function(){return s}});var i=n(79803),a=n(77648);function r(e,t,n){var r,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(0,i.tryProjectWithZConversion)(e,t);return null==l?null:(l.hasZ&&!s||null==n||(l.z=null!==(r=(0,a.KO)(n,l))&&void 0!==r?r:0),l)}function s(e,t,n){n.warnOnce("Failed to project analysis geometry (id: '".concat(e.id,"'), projection from spatial reference (wkid: '").concat(t.wkid,"') to view spatial reference is not supported. Projection may be possible after calling projection.load()."))}},51328:function(e,t,n){n.d(t,{B2:function(){return M},G:function(){return k},J4:function(){return T},JA:function(){return V},Sp:function(){return E},_N:function(){return m},bB:function(){return P},cx:function(){return i},gv:function(){return S},zP:function(){return D}});var i,a=n(1413),r=(n(59486),n(17842)),s=n(32035),l=n(12400),o=n(79803),u=n(55652),c=n(40885),p=n(40927),d=n(51378),h=n(74509),v=n(81703),f=n(88153),y=n(54463),_=n(76783),w=n(74229),g=n(848);function m(e,t){return b(e,(function(){return t}))}function P(e){return b(e,(function(e){return e.plane}))}function b(e,t){var n=(0,l.Ue)(),i=(0,l.Ue)(),s=!1;return function(l){var o=t(l);if("start"===l.action){var c=(0,r.md)(l.screenStart,(0,r.c$)(d.qW.get())),p=(0,v.u4)(e.state.camera,c,I);null!=p&&(s=(0,u.BR)(o,p,n))}if(!s)return null;var h=(0,r.md)(l.screenEnd,(0,r.c$)(d.qW.get())),f=(0,v.u4)(e.state.camera,h,I);return null==f?null:(0,u.BR)(o,f,i)?(0,a.Z)((0,a.Z)({},l),{},{renderStart:n,renderEnd:i,plane:o,ray:f}):null}}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=null;return function(u){if("start"===u.action&&(null!=(l=e.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(u.screenStart.x,u.screenStart.y),t,n,s))&&null!=i&&!(0,o.projectPoint)(l,l,i)))return null;if(null==l)return null;var c=e.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(u.screenEnd.x,u.screenEnd.y),t,n,s);return null==c||null!=i&&!(0,o.projectPoint)(c,c,i)?null:(0,a.Z)((0,a.Z)({},u),{},{mapStart:l,mapEnd:c})}}function k(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return C(e,n,(0,h.Ou)(t,e,n),i,a)}function V(e,t,n,i){var a=n.toMap(e.screenStart);return null!=a?k(t,a,n.elevationInfo,i):null}function E(e,t,n){var i=null,a=new w.hM;return a.next(m(e,function(e,t){var n=x,i=Z,a=(0,u.Ue)();e.renderCoordsHelper.worldUpAtPosition(t,n);var r=(0,s.b)((0,u.st)(a),n,(0,s.f)(i,t,e.state.camera.eye));return(0,s.b)(r,r,n),(0,u.Yq)(t,r,a)}(e,t))).next(function(e,t){var n=(0,l.Ue)(),i=(0,s.l)(t);e.renderCoordsHelper.worldUpAtPosition(t,n);var a=(0,l.Ue)(),r=(0,l.Ue)(),o=function(a){return(0,s.f)(a,a,t),(0,p.nF)(n,a,a),"global"===e.viewingMode&&(0,s.l)(a)*Math.sign((0,s.m)(n,a))<.001-i&&(0,s.f)(a,(0,s.j)(a,n,.001),t),(0,s.g)(a,a,t),a};return function(e){return e.renderStart=o((0,s.c)(a,e.renderStart)),e.renderEnd=o((0,s.c)(r,e.renderEnd)),e}}(e,t)).next(D(e,n)).next((function(e){e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,i=e})),function(e){return i=null,a.execute(e),i}}function M(e,t){var n=function(n){var i=(0,r.md)(n,(0,r.c$)(d.qW.get())),a=(0,v.u4)(e.state.camera,i,I);return null==a?null:(0,c._w)(t,a,x,Z)[1]};return function(e){var t=n(e.screenStart);if(null==t)return null;var i=n(e.screenEnd);return null==i?null:(0,a.Z)((0,a.Z)({},e),{},{renderStart:t,renderEnd:i})}}function D(e,t){var n=e.renderCoordsHelper;return function(e){var i=n.fromRenderCoords(e.renderStart,new g.Z({spatialReference:t})),r=n.fromRenderCoords(e.renderEnd,new g.Z({spatialReference:t}));return null!=i&&null!=r?(0,a.Z)((0,a.Z)({},e),{},{mapStart:i,mapEnd:r}):null}}function T(e){var t=null;return function(n){switch(n.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":null!=t&&(t.remove(),t=null)}return n}}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=(0,f.Z8)(e.state.viewingMode);n.options.selectionMode=!0,n.options.store=y.eC.MIN,n.options.hud=!1;var s,o=(0,r.s1)(),u={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},c=(0,l.Ue)(),p=null!==t&&void 0!==t?t:e.spatialReference,d=function(t){e.map.ground&&e.map.ground.opacity<1?u.exclude.add(_.xX):u.exclude.delete(_.xX),e.sceneIntersectionHelper.intersectIntersectorScreen((0,r.md)(t,o),n,u);var a,s=n.results.min;if(s.getIntersectionPoint(c))a=s.intersector===y.q7.TERRAIN?i.GROUND:i.OTHER;else{if(!n.results.ground.getIntersectionPoint(c))return null;a=i.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(c,new g.Z({spatialReference:p})),surfaceType:a}};return function(e){if("start"===e.action){var t=d(e.screenStart);s=null!=t?t.location:null}if(null==s)return null;var n=d(e.screenEnd);return null!=(null===n||void 0===n?void 0:n.location)?(0,a.Z)((0,a.Z)({},e),{},{mapStart:s,mapEnd:n.location,surfaceType:n.surfaceType}):null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(i||(i={}));var x=(0,l.Ue)(),Z=(0,l.Ue)(),I=(0,c.Ue)()},33837:function(e,t,n){n.d(t,{r:function(){return _}});var i=n(37762),a=n(15671),r=n(43144),s=n(60136),l=n(29388),o=n(29134),u=n(7025),c=n(32035),p=n(12400),d=n(86361),h=n(52168),v=n(79685),f=n(56529),y=n(58901),_=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var r;return(0,a.Z)(this,n),(r=t.call(this,e))._hasExternalMaterial=!1,r._hasExternalMaterial=null!=i,r._material=null!=i?i:new y.U({width:1,color:(0,d.al)(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:f.yD.OccludeAndTransparent,isDecoration:!!e.isDecoration,writeDepth:!0}),r.applyProperties(e),r}return(0,r.Z)(n,[{key:"setGeometryFromRenderSpacePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.geometry=[[[e[0]-t,e[1],e[2]],[e[0]+t,e[1],e[2]]],[[e[0],e[1]-t,e[2]],[e[0],e[1]+t,e[2]]],[[e[0],e[1],e[2]-t],[e[0],e[1],e[2]+t]]]}},{key:"setGeometryFromExtent",value:function(e){var t=this.view.spatialReference,n=(0,p.Ue)(),i=(0,p.Ue)(),a=100,r=[];(0,c.s)(n,e[0],e[1],a),this.view.renderCoordsHelper.toRenderCoords(n,t,i),r.push([i[0],i[1],i[2]]),(0,c.s)(n,e[2],e[1],a),this.view.renderCoordsHelper.toRenderCoords(n,t,i),r.push([i[0],i[1],i[2]]),(0,c.s)(n,e[2],e[3],a),this.view.renderCoordsHelper.toRenderCoords(n,t,i),r.push([i[0],i[1],i[2]]),(0,c.s)(n,e[0],e[3],a),this.view.renderCoordsHelper.toRenderCoords(n,t,i),r.push([i[0],i[1],i[2]]),(0,c.s)(n,e[0],e[1],a),this.view.renderCoordsHelper.toRenderCoords(n,t,i),r.push([i[0],i[1],i[2]]),(0,c.s)(n,e[0],e[1],a),this.view.renderCoordsHelper.toRenderCoords(n,t,i),r.push([i[0],i[1],i[2]]),this.geometry=[r]}},{key:"setGeometryFromFrustum",value:function(e){var t=[];e.lines.forEach((function(e){t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}},{key:"setGeometryFromBoundedPlane",value:function(e){var t=[],n=e.origin,i=e.basis1,a=e.basis2,r=.5,s=(0,p.Ue)(),l=(0,p.Ue)(),o=(0,p.Ue)(),u=(0,p.Ue)();s[0]=n[0]-i[0]*r-a[0]*r,s[1]=n[1]-i[1]*r-a[1]*r,s[2]=n[2]-i[2]*r-a[2]*r,l[0]=n[0]-i[0]*r+a[0]*r,l[1]=n[1]-i[1]*r+a[1]*r,l[2]=n[2]-i[2]*r+a[2]*r,o[0]=n[0]+i[0]*r+a[0]*r,o[1]=n[1]+i[1]*r+a[1]*r,o[2]=n[2]+i[2]*r+a[2]*r,u[0]=n[0]+i[0]*r-a[0]*r,u[1]=n[1]+i[1]*r-a[1]*r,u[2]=n[2]+i[2]*r-a[2]*r,t.push([s[0],s[1],s[2]]),t.push([l[0],l[1],l[2]]),t.push([o[0],o[1],o[2]]),t.push([u[0],u[1],u[2]]),t.push([s[0],s[1],s[2]]),this.geometry=[t]}},{key:"setGeometryFromSegment",value:function(e){var t=e.endRenderSpace;this.transform=(0,o.vc)(w,t);var n=e.createRenderGeometry(t,this.view.renderCoordsHelper).points;this.geometry=[n]}},{key:"setGeometryFromSegments",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.AG;this.transform=(0,o.vc)(w,n),this.geometry=e.map((function(e){return e.createRenderGeometry(n,t.view.renderCoordsHelper).points}))}},{key:"getTransformedGeometry",value:function(){var e=this;return null==this._geometry?null:this._geometry.map((function(t){return t.map((function(t){return(0,c.h)((0,p.Ue)(),t,e.transform)}))}))}},{key:"renderOccluded",get:function(){return this._material.parameters.renderOccluded},set:function(e){this._material.setParameters({renderOccluded:e})}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return this._material.parameters.width},set:function(e){this._material.setParameters({width:e})}},{key:"color",get:function(){return this._material.parameters.color},set:function(e){var t=1===e[3];this._material.setParameters({color:(0,d.d9)(e),writeDepth:t})}},{key:"innerWidth",get:function(){return this._material.parameters.innerWidth},set:function(e){this._material.setParameters({innerWidth:e})}},{key:"innerColor",get:function(){return this._material.parameters.innerColor},set:function(e){this._material.setParameters({innerColor:null!=e?(0,d.d9)(e):null})}},{key:"stipplePattern",get:function(){return this._material.parameters.stipplePattern},set:function(e){null!=this._material&&this._material.setParameters({stipplePattern:e})}},{key:"stippleOffColor",get:function(){return this._material.parameters.stippleOffColor},set:function(e){this._material.setParameters({stippleOffColor:null!=e?(0,d.d9)(e):null})}},{key:"stipplePreferContinuous",get:function(){return this._material.parameters.stipplePreferContinuous},set:function(e){this._material.setParameters({stipplePreferContinuous:e})}},{key:"falloff",get:function(){return this._material.parameters.falloff},set:function(e){this._material.setParameters({falloff:e})}},{key:"polygonOffset",get:function(){return this._material.parameters.hasPolygonOffset},set:function(e){this._material.setParameters({hasPolygonOffset:e})}},{key:"createExternalResources",value:function(){}},{key:"destroyExternalResources",value:function(){}},{key:"createGeometries",value:function(e){var t,n=(0,i.Z)((0,v.c)(this.geometry));try{for(n.s();!(t=n.n()).done;){var a=t.value,r=(0,v.Y)(this._material,a);e.addGeometry(r)}}catch(s){n.e(s)}finally{n.f()}}},{key:"forEachExternalMaterial",value:function(e){this._hasExternalMaterial||e(this._material)}}]),n}(h._),w=(0,u.Ue)()},86244:function(e,t,n){n.d(t,{l:function(){return s}});var i=n(15671),a=n(43144),r=(n(93169),n(94172)),s=function(){function e(t){var n=this;(0,i.Z)(this,e),this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t.view,this._handle=(0,r.watch)((function(){return t.view.ready}),(function(e){n._resourcesCreated&&(e?n._createResources():n._destroyResources())}))}return(0,a.Z)(e,[{key:"isDecoration",get:function(){return this._isDecoration},set:function(e){this._isDecoration=e}},{key:"applyProperties",value:function(e){var t=!1;for(var n in e)n in this&&("attached"===n?t=e[n]:this[n]=e[n]);this.attached=t}},{key:"destroy",value:function(){this.attached=!1,this._handle.remove()}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}},{key:"onAttachedChange",value:function(e){}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}},{key:"_createResources",value:function(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}},{key:"_destroyResources",value:function(){this.destroyResources(),this._resourcesCreated=!1}}]),e}()},66156:function(e,t,n){n.d(t,{j:function(){return U}});var i=n(37762),a=n(1413),r=n(15671),s=n(43144),l=n(60136),o=n(29388),u=n(25158),c=n(37081),p=n(68401),d=n(17363),h=n(56529),v=n(78041),f=n(93822),y=n(97731),_=n(4760),w=n(12594),g=n(64642),m=n(11983),P=n(33236),b=n(88301),C=n(61120),k=n(27366),V=n(98634),E=n(82144),M=n(31132),D=n(33559),T=n(27627),S=n(50411),x=n(25920),Z=n(8883),I=n(32500),R=n(8548),O=n(36207),A=(V.K,function(e){(0,l.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"initializeProgram",value:function(e){return new T.$(e.rctx,n.shader.get().build(this.configuration),L)}},{key:"_setPipelineState",value:function(e,t){var n=this.configuration,i=e===x.A.NONE,a=e===x.A.FrontFace;return(0,O.sm)({blending:n.output===c.H_.Color&&n.transparent?i?H:(0,v.j7)(e):null,culling:(0,O.zp)(n.cullFace),depthTest:{func:(0,v.Bh)(e)},depthWrite:i?n.writeDepth?O.LZ:null:(0,v.K5)(e),drawBuffers:(0,v.V7)(e),colorWrite:O.BK,stencilWrite:n.hasOccludees?S.s3:null,stencilTest:n.hasOccludees?t?S.eD:S.RY:null,polygonOffset:i||a?null:(0,v.je)(n.enableOffset)})}},{key:"initializePipeline",value:function(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}},{key:"getPipeline",value:function(e){return e?this._occludeePipelineState:(0,b.Z)((0,C.Z)(n.prototype),"getPipeline",this).call(this)}}]),n}(M.A));A.shader=new E.J(I.I,(function(){return n.e(18957).then(n.bind(n,18957))}));var H=(0,O.if)(R.zi.ONE,R.zi.ONE_MINUS_SRC_ALPHA),G=function(e){(0,l.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).output=c.H_.Color,e.cullFace=p.Vr.None,e.hasSlicePlane=!1,e.transparent=!1,e.enableOffset=!0,e.writeDepth=!0,e.hasOccludees=!1,e.transparencyPassType=x.A.NONE,e.multipassEnabled=!1,e.cullAboveGround=!1,e.perspectiveInterpolation=!0,e}return(0,s.Z)(n)}(Z.W);(0,k._)([(0,D.o)({count:c.H_.COUNT})],G.prototype,"output",void 0),(0,k._)([(0,D.o)({count:p.Vr.COUNT})],G.prototype,"cullFace",void 0),(0,k._)([(0,D.o)()],G.prototype,"hasSlicePlane",void 0),(0,k._)([(0,D.o)()],G.prototype,"transparent",void 0),(0,k._)([(0,D.o)()],G.prototype,"enableOffset",void 0),(0,k._)([(0,D.o)()],G.prototype,"writeDepth",void 0),(0,k._)([(0,D.o)()],G.prototype,"hasOccludees",void 0),(0,k._)([(0,D.o)({count:x.A.COUNT})],G.prototype,"transparencyPassType",void 0),(0,k._)([(0,D.o)()],G.prototype,"multipassEnabled",void 0),(0,k._)([(0,D.o)()],G.prototype,"cullAboveGround",void 0),(0,k._)([(0,D.o)()],G.prototype,"perspectiveInterpolation",void 0),(0,k._)([(0,D.o)({constValue:!1})],G.prototype,"occlusionPass",void 0);var L=new Map([[_.T.POSITION,0],[_.T.UV0,2],[_.T.PERSPECTIVEDIVIDE,3]]),U=function(e){(0,l.Z)(n,e);var t=(0,o.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e,new F)).supportsEdges=!0,i.produces=new Map([[f.r.OPAQUE_MATERIAL,function(e){return(0,c.ou)(e)||(0,c.D5)(e)&&!i.parameters.transparent}],[f.r.TRANSPARENT_MATERIAL,function(e){return(0,c.D5)(e)&&i.parameters.transparent&&i.parameters.writeDepth}],[f.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,function(e){return(0,c.D5)(e)&&i.parameters.transparent&&!i.parameters.writeDepth}],[f.r.DRAPED_MATERIAL,function(e){return(0,c.D5)(e)||(0,c.ou)(e)}]]),i._vertexAttributeLocations=L,i._configuration=new G,i}return(0,s.Z)(n,[{key:"getConfiguration",value:function(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<v.ve,this._configuration.multipassEnabled=t.multipassEnabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}},{key:"createGLMaterial",value:function(e){return new z(e)}},{key:"createBufferWriter",value:function(){var e=g.W1.clone();return this.parameters.perspectiveInterpolation&&e.f32(_.T.PERSPECTIVEDIVIDE),new N(e)}}]),n}(m.c),z=function(e){(0,l.Z)(n,e);var t=(0,o.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,(0,a.Z)((0,a.Z)({},e),e.material.parameters))}return(0,s.Z)(n,[{key:"_updateParameters",value:function(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(A,e)}},{key:"_updateOccludeeState",value:function(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}},{key:"beginSlot",value:function(e){return this._output===c.H_.Color&&this._updateOccludeeState(e),this._updateParameters(e)}}]),n}(d.F),N=function(e){(0,l.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"write",value:function(e,t,n,a,r){var s,l=(0,i.Z)(this.vertexBufferLayout.fields.keys());try{for(l.s();!(s=l.n()).done;){var o=s.value,c=n.attributes.get(o);if(c)if(o===_.T.PERSPECTIVEDIVIDE){(0,y.hu)(1===c.size);var p=a.getField(o,u.ly);p&&(0,P.XW)(c,p,r)}else(0,P.i9)(o,c,e,t,a,r)}}catch(d){l.e(d)}finally{l.f()}}}]),n}(w.G),F=function(e){(0,l.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).transparent=!1,e.writeDepth=!0,e.hasSlicePlane=!1,e.cullFace=p.Vr.None,e.hasOccludees=!1,e.opacity=1,e.textureId=null,e.initTextureTransparent=!0,e.perspectiveInterpolation=!1,e}return(0,s.Z)(n)}(h.Mt)},70209:function(e,t,n){n.d(t,{Er:function(){return u},Lp:function(){return c},Yq:function(){return p}});var i=n(74165),a=n(15861),r=n(14921),s=n(92026),l=n(66978),o=n(94172);function u(e,t){e.interactive=!0;var n=e.tool,u=e.view;u.activeTool=n;var c=(0,l.fu)(t,(function(){u.activeTool===n&&(u.activeTool=null)}));return(0,r.vr)(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.whenOnce)((function(){return null==n||!n.active}),t);case 2:c=(0,s.hw)(c);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t)}function c(e,t){return(0,o.watch)((function(){return e.interactive}),(function(){return function(e,t){e.interactive?function(e,t){p(e);var n=e.view,i=e.analysis,a=new t({view:n,analysis:i,analysisViewData:e});e.tool=a,n.tools.add(a)}(e,t):p(e)}(e,t)}),o.syncAndInitial)}function p(e){var t=e.view,n=e.tool;null!=n&&(t.tools.remove(n),e.tool=null)}},86509:function(e,t,n){n.d(t,{f:function(){return c}});var i=n(15671),a=n(43144),r=n(60136),s=n(29388),l=n(27366),o=n(94172),u=(n(32718),n(93169),n(84936),n(10064),n(69912)),c=function(e){(0,r.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,i.Z)(this,n),t.call(this,e)}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,o.watch)((function(){return e.analysisViewData.visible}),(function(t){return e.visible=t}),o.syncAndInitial))}},{key:"deactivate",value:function(){this.onDeactivate(),this.created||this.analysis.clear()}},{key:"resetCreated",value:function(){this._set("created",!1)}}]),n}(n(45900).m);c=(0,l._)([(0,u.j)("esri.views.interactive.AnalysisToolBase")],c)},81298:function(e,t,n){n.d(t,{w:function(){return r}});var i=n(88153),a=n(54463);function r(e){var t=(0,i.Z8)(e);return t.options.store=a.eC.MIN,t.options.hud=!1,t}},24405:function(e,t,n){n.d(t,{V5:function(){return u},e7:function(){return l},zc:function(){return c}});var i=n(74165),a=n(93433),r=n(15861),s=n(37270);function l(e){return o.apply(this,arguments)}function o(){return o=(0,r.Z)((0,i.Z)().mark((function e(t){var n,r,l,o,u,c,p,d,h,v,f,y=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(l=y.length>1&&void 0!==y[1]?y[1]:t.popupTemplate)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,l.getRequiredFields(t.fieldsIndex);case 5:if(o=e.sent,u=l.lastEditInfoEnabled,c=t.objectIdField,p=t.typeIdField,d=t.globalIdField,h=t.relationships,!o.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:return v=u?(0,s.CH)(t):[],f=(0,s.Q0)(t.fieldsIndex,[].concat((0,a.Z)(o),(0,a.Z)(v))),e.abrupt("return",(p&&f.push(p),f&&c&&null!==(n=t.fieldsIndex)&&void 0!==n&&n.has(c)&&!f.includes(c)&&f.push(c),f&&d&&null!==(r=t.fieldsIndex)&&void 0!==r&&r.has(d)&&!f.includes(d)&&f.push(d),h&&h.forEach((function(e){var n,i=e.keyField;f&&i&&(null===(n=t.fieldsIndex)||void 0===n?void 0:n.has(i))&&!f.includes(i)&&f.push(i)})),f));case 15:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}function u(e,t){return e.popupTemplate?e.popupTemplate:null!=t&&t.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function c(e,t){return null!=u(e,{defaultPopupTemplateEnabled:t})}},94163:function(e,t,n){n.d(t,{SP:function(){return i},UG:function(){return p},dU:function(){return c},k0:function(){return o},xO:function(){return u}});n(16889);var i,a=n(13611),r=n(6644);function s(e,t){return e[0]*t[1]-e[1]*t[0]}function l(e,t,n){var i=(0,a.AK)(n,t)/(0,a.we)(n);return(0,a.bA)(e,n,i)}function o(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;return(0,a.$X)(h,i,n),(0,a.$X)(f,t,r),l(y,f,h),(0,a.IH)(e,r,y)}function u(e,t,n,i){(0,a.$X)(h,t,n);var r=i/(0,a.kE)(h);return(0,a.od)(e,n,h,r)}function c(e,t){var n=e.start,r=e.end,l=t.start,o=t.end,u=(0,a.$X)(h,r,n),c=(0,a.$X)(v,o,l),p=s(u,c);if(Math.abs(p)<=d)return[];var _=(0,a.$X)(f,n,l),w=s(c,_)/p,g=s(u,_)/p;if(w>=0){if(g>=0||t.type===i.LINE)return[(0,a.od)(y,n,u,w)]}else if(e.type===i.LINE&&(g>=0||t.type===i.LINE))return[(0,a.od)(y,n,u,w)];return[]}function p(e,t,n){var r=[],s=(0,a.$X)(h,e.end,e.start),l=(0,a.$X)(v,e.start,t),o=(0,a.we)(s),u=2*(0,a.AK)(s,l),c=u*u-4*o*((0,a.we)(l)-n*n);if(0===c){var p=-u/(2*o);(e.type===i.LINE||p>=0)&&r.push((0,a.od)(y,e.start,s,p))}else if(c>0){var d=Math.sqrt(c),_=(-u+d)/(2*o);(e.type===i.LINE||_>=0)&&r.push((0,a.od)(y,e.start,s,_));var w=(-u-d)/(2*o);(e.type===i.LINE||w>=0)&&r.push((0,a.od)(f,e.start,s,w))}return r}!function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"}(i||(i={}));var d=1e-6,h=(0,r.Ue)(),v=(0,r.Ue)(),f=(0,r.Ue)(),y=(0,r.Ue)()}}]);
//# sourceMappingURL=68796.e384d187.chunk.js.map