"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[18264],{18264:function(e,t,i){i.r(t),i.d(t,{default:function(){return je}});var n=i(4942),l=i(1413),r=i(15671),a=i(43144),s=i(60136),o=i(29388),u=i(27366),d=i(49861),c=i(89125),h=(i(84936),i(93169),i(69912)),v=i(33565),p=i(74165),_=i(15861),y=i(7138),f=i(80987),g=i(60354),b=i(32718),m=i(66978),w=i(94172),C=i(10743),k=i(56232),x=i(37762),L=function(e){return function(t){var i,n=e.toLowerCase();return null!==(i=t.sublayers.find((function(e){var t;return(null===(t=e.modelName)||void 0===t?void 0:t.toLowerCase())===n})))&&void 0!==i?i:null}},Z=L("fullmodel"),P=L("overview");function S(e){var t=Z(e);null!=t&&(t.visible=!0);var i=P(e);null!=i&&(i.visible=!1)}function V(e,t){var i,n=function(e,t){var i,n,l,r=null!==(i=null===(n=e.summaryStatistics)||void 0===n?void 0:n.fields)&&void 0!==i?i:[],a=t.toLowerCase();return null!==(l=r.find((function(e){var t;return(null===(t=e.modelName)||void 0===t?void 0:t.toLowerCase())===a})))&&void 0!==l?l:null}(e,t);if(null==n)return null;var l=n.fieldName;if(null==l||!l)return null;var r,a=function(e,t){var i,n=(0,x.Z)(e.allSublayers.items);try{for(n.s();!(i=n.n()).done;){var l,r=i.value,a="building-component"===r.type?null===(l=r.getFieldDomain)||void 0===l?void 0:l.call(r,t):null;if(a&&"coded-value"===a.type)return a}}catch(s){n.e(s)}finally{n.f()}return null}(e,l),s=new Map,o=(0,x.Z)(null!==(i=n.mostFrequentValues)&&void 0!==i?i:[]);try{for(o.s();!(r=o.n()).done;){var u=r.value;"number"==typeof u&&s.set(u,null!=a?a.getName(u):String(u))}}catch(d){o.e(d)}finally{o.f()}return{fieldName:l,fieldValueMap:s}}var E=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments)).id="root",e.parent=null,e.children=new f.Z,e.layers=new f.Z,e.level=0,e.collapsed=!0,e._childIds=new Set,e._layerUniqueIds=new Set,e}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles([this.layers.on("before-add",(function(t){e._layerUniqueIds.has(t.item.uid)?t.preventDefault():e._layerUniqueIds.add(t.item.uid)})),this.layers.on("after-add",(function(t){var i=t.item;e.addHandles([(0,w.watch)((function(){return i.visible}),(function(){return e.notifyChange("visible")}),w.initial),(0,w.watch)((function(){return i.title}),(function(){return e.notifyChange("title")}),w.initial)],i.uid)})),this.layers.on("before-remove",(function(t){var i=t.item;e.removeHandles(i.uid),e.notifyChange("title"),e.notifyChange("visible")})),this.children.on("before-add",(function(t){e._childIds.has(t.item.id)?t.preventDefault():(t.item._set("parent",e),e._childIds.add(t.item.id))}))])}},{key:"destroy",value:function(){this.children.forEach((function(e){return e.destroy()}))}},{key:"hasChildren",get:function(){return this.children.length>0}},{key:"isRoot",get:function(){return 0===this.level}},{key:"isLeaf",get:function(){return!this.hasChildren}},{key:"isDiscipline",get:function(){return 1===this.level}},{key:"visible",get:function(){return N(this.layers,(function(e){return e.visible}))}},{key:"title",get:function(){return N(this.layers,(function(e){return e.title}))||this.layers.items.map((function(e){return e.title})).join(", ")||null}},{key:"toggleVisibility",value:function(e){var t=void 0===e?!this.visible:e;this.layers.forEach((function(e){e.visible=t})),t&&null!=this.parent&&this.parent.toggleVisibility(!0)}},{key:"toggleCollapsed",value:function(e){this.collapsed=void 0===e?!this.collapsed:e}},{key:"expand",value:function(){this.collapsed=!1}},{key:"expandAll",value:function(){this.expand(),this.children.forEach((function(e){return e.expandAll()}))}},{key:"collapse",value:function(){this.collapsed=!0}},{key:"collapseAll",value:function(){this.collapse(),this.children.forEach((function(e){return e.collapseAll()}))}},{key:"toggleAllSiblingsVisibility",value:function(e){var t=void 0===e?!this.visible:e;this.toggleVisibility(t),null!=this.parent&&(this.parent.toggleVisibility(t),this.parent.children.forEach((function(e){return e.toggleVisibility(t)})))}}]),i}(y.default);function N(e,t){var i,n=null,l=(0,x.Z)(e.items);try{for(l.s();!(i=l.n()).done;){var r=t(i.value);if(null!=n&&n!==r)return null;n=r}}catch(a){l.e(a)}finally{l.f()}return n}function B(){var e=new AbortController;return function(){var t=(0,_.Z)((0,p.Z)().mark((function t(i){var n,l;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.abort(),e=new AbortController,n={signal:e.signal},l=i.toArray().map((function(e){return M(e,n)})),t.next=4,Promise.all(l);case 4:(0,m.k_)(n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function M(e,t){return F.apply(this,arguments)}function F(){return F=(0,_.Z)((0,p.Z)().mark((function e(t,i){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load(i);case 2:return e.next=4,t.loadAll();case 4:if((0,m.k_)(i),e.t0=t.summaryStatistics,!e.t0){e.next=9;break}return e.next=9,t.summaryStatistics.load(i);case 9:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}(0,u._)([(0,d.Cb)({nonNullable:!0})],E.prototype,"id",void 0),(0,u._)([(0,d.Cb)()],E.prototype,"parent",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0,readOnly:!0})],E.prototype,"children",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0,readOnly:!0})],E.prototype,"layers",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],E.prototype,"level",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],E.prototype,"collapsed",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],E.prototype,"hasChildren",null),(0,u._)([(0,d.Cb)({readOnly:!0})],E.prototype,"isRoot",null),(0,u._)([(0,d.Cb)({readOnly:!0})],E.prototype,"isLeaf",null),(0,u._)([(0,d.Cb)({readOnly:!0})],E.prototype,"isDiscipline",null),(0,u._)([(0,d.Cb)({readOnly:!0})],E.prototype,"visible",null),(0,u._)([(0,d.Cb)({readOnly:!0})],E.prototype,"title",null),E=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.support.LayerTreeNode")],E);var W=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).root=new E,n.state="disabled",n._loadLayers=B(),n.layers=new f.Z,n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles(this.layers.on("change",(function(){return e._onLayersChange()}))),this._onLayersChange()}},{key:"destroy",value:function(){this._set("state","disabled"),this.root.destroy()}},{key:"layers",set:function(e){var t=this._get("layers");this._set("layers",(0,g.Z)(e,t))}},{key:"_updateLayerTree",value:function(){var e=this;this.root.destroy(),this._set("root",new E({collapsed:!1}));var t=new Map,i=this.layers.length>1?"modelName":"id";return this.layers.forEach((function(n){var l=Z(n);e._addNodesForSublayers(null!==l&&void 0!==l?l:n,e.root,t,i)})),this}},{key:"_addNodeForLayer",value:function(e,t,i,n){var l=String(e[n]).toLowerCase();if(null!=l&&!e.isEmpty){var r="".concat(t.id,"/").concat(l),a=i.get(r);a||(a=new E({id:l,level:t.level+1}),i.set(r,a)),a.layers.push(e),t.children.push(a),this._addNodesForSublayers(e,a,i,n)}}},{key:"_addNodesForSublayers",value:function(e,t,i,n){var l=this;("building-scene"===e.type||"building-group"===e.type&&!e.isEmpty)&&e.sublayers.forEach((function(e){return l._addNodeForLayer(e,t,i,n)}))}},{key:"_onLayersChange",value:function(){var e=(0,_.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._set("state","loading"),0===this.layers.length){e.next=11;break}return e.prev=1,e.next=4,this._loadLayers(this.layers);case 4:this._updateLayerTree(),this._set("state","ready"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),(0,m.D_)(e.t0)||this._set("state","failed");case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()}]),i}(y.default);(0,u._)([(0,d.Cb)({readOnly:!0})],W.prototype,"root",void 0),(0,u._)([(0,d.Cb)({type:f.Z,nonNullable:!0})],W.prototype,"layers",null),(0,u._)([(0,d.Cb)({readOnly:!0,nonNullable:!0})],W.prototype,"state",void 0);var A=W=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingDisciplinesViewModel")],W),I=i(63780);function O(e){var t,i={fieldValueMap:new Map,allowedValues:[]},n=(0,x.Z)(e);try{var l=function(){var e=t.value.fieldValueMap,n=i.fieldValueMap;e.forEach((function(e,t){n.has(t)||(n.set(t,e),i.allowedValues.push(t))}))};for(n.s();!(t=n.n()).done;)l()}catch(r){n.e(r)}finally{n.f()}return i.allowedValues.sort((function(e,t){return e-t})),i}function R(e,t){return t.allowedValues.length>0?function(e,t){if(0===t.length)return e;if(e===1/0)return t[t.length-1];if(e===-1/0)return t[0];var i,n=t[0],l=Math.abs(n-e),r=(0,x.Z)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value,s=Math.abs(a-e);s<l&&(n=a,l=s)}}catch(o){r.e(o)}finally{r.f()}return n}(e,t.allowedValues):null}var D=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).state="disabled",n._valueBeforeReady=null,n._domainInfo=O([]),n._loadLayers=B(),n.layers=new f.Z,n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles(this.layers.on("change",(function(){return e._onLayersChange()}))),this._onLayersChange()}},{key:"destroy",value:function(){this._set("state","disabled")}},{key:"enabled",get:function(){return this.allowedValues.length>0&&this._get("enabled")},set:function(e){e!==this.enabled&&this.allowedValues.length>0&&this._set("enabled",e)}},{key:"value",get:function(){var e;return null!==(e="ready"===this.state?this._get("value"):this._valueBeforeReady)&&void 0!==e?e:0},set:function(e){if("ready"===this.state){if(e!==this.value){var t=R(e,this);null!=t&&this._set("value",t)}}else this._valueBeforeReady=e}},{key:"min",get:function(){return function(e){var t,i=null,n=(0,x.Z)(e);try{for(n.s();!(t=n.n()).done;){var l=t.value;i=null!=i?Math.min(i,l):l}}catch(r){n.e(r)}finally{n.f()}return i}(this.allowedValues)}},{key:"max",get:function(){return function(e){var t,i=null,n=(0,x.Z)(e);try{for(n.s();!(t=n.n()).done;){var l=t.value;i=null!=i?Math.max(i,l):l}}catch(r){n.e(r)}finally{n.f()}return i}(this.allowedValues)}},{key:"allowedValues",get:function(){return this._domainInfo.allowedValues},set:function(e){null==e?this._clearOverride("allowedValues"):this._override("allowedValues",e);var t=R(this.value,this);null!=t&&(this.value=t)}},{key:"hasNext",get:function(){if(!this.enabled)return!0;var e=this._valueIndex;return e>=0&&e<this.allowedValues.length-1}},{key:"hasPrevious",get:function(){return!this.enabled||this._valueIndex>0}},{key:"layers",set:function(e){var t=this._get("layers");this._set("layers",(0,g.Z)(e,t))}},{key:"filterExpressions",get:function(){return{solid:null,xRay:null}}},{key:"_valueIndex",get:function(){return(0,I.$A)(this.allowedValues,this.value)}},{key:"select",value:function(e){"ready"===this.state?null!=R(e,this)&&(this.enabled=!0,this.value=e):this._valueBeforeReady=e}},{key:"clear",value:function(){"ready"===this.state?this.enabled=!1:this._valueBeforeReady=null}},{key:"next",value:function(){var e=this.state,t=this.allowedValues,i=this.enabled,n=this.hasNext,l=this._valueIndex;if("ready"===e||null==this._valueBeforeReady){if(0!==t.length)return i?void(n&&(this.value=t[l+1])):(this.enabled=!0,void(this.value=t[0]))}else this._valueBeforeReady++}},{key:"previous",value:function(){var e=this.state,t=this.allowedValues,i=this.enabled,n=this.hasPrevious,l=this._valueIndex;if("ready"===e||null==this._valueBeforeReady){if(0!==t.length)return i?void(n&&(this.value=t[l-1])):(this.enabled=!0,void(this.value=t[t.length-1]))}else this._valueBeforeReady++}},{key:"getValueLabel",value:function(e){var t;return 0===this.layers.length?null:null!==(t=this._domainInfo.fieldValueMap.get(e))&&void 0!==t?t:null}},{key:"_onLayersChange",value:function(){var e=(0,_.Z)((0,p.Z)().mark((function e(){return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._set("state","loading"),this._domainInfo=O([]),0===this.layers.length){e.next=10;break}return e.prev=1,e.next=4,this._loadLayers(this.layers);case 4:this._setup(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),(0,m.D_)(e.t0)||this._set("state","failed");case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),i}(y.default);(0,u._)([(0,d.Cb)({value:!1,nonNullable:!0})],D.prototype,"enabled",null),(0,u._)([(0,d.Cb)({nonNullable:!0})],D.prototype,"value",null),(0,u._)([(0,d.Cb)({readOnly:!0})],D.prototype,"min",null),(0,u._)([(0,d.Cb)({readOnly:!0})],D.prototype,"max",null),(0,u._)([(0,d.Cb)()],D.prototype,"allowedValues",null),(0,u._)([(0,d.Cb)({readOnly:!0})],D.prototype,"hasNext",null),(0,u._)([(0,d.Cb)({readOnly:!0})],D.prototype,"hasPrevious",null),(0,u._)([(0,d.Cb)({type:f.Z,nonNullable:!0})],D.prototype,"layers",null),(0,u._)([(0,d.Cb)({nonNullable:!0})],D.prototype,"state",void 0),(0,u._)([(0,d.Cb)()],D.prototype,"_valueBeforeReady",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],D.prototype,"_valueIndex",null),(0,u._)([(0,d.Cb)()],D.prototype,"_domainInfo",void 0);var H=D=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingNumericFilterViewModel")],D),T=i(71907),z=i(32506),j=i(30857),U=i(67682),K="__BUILDING_EXPLORER_FILTER__";function q(e){var t="string"==typeof e?e:e.id;return!!t&&t.includes(K)}function X(e,t){var i,n=(0,x.Z)(e.items);try{for(n.s();!(i=n.n()).done;){var l,r=i.value,a=(0,x.Z)(r.filters.items);try{for(a.s();!(l=a.n()).done;){var s=l.value;if(q(s)){var o=t(s);if(null!=o)return o}}}catch(u){a.e(u)}finally{a.f()}}}catch(u){n.e(u)}finally{n.f()}return null}function G(e,t){e.forEach((function(e){var i=e.filters.filter((function(e){return!q(e)}));null!=t&&i.push(t),function(e,t){var i=t.length;if(null==e||e.length!==i)return!1;for(var n=0;n<i;++n){var l=t.at(n).toJSON(),r=e.at(n).toJSON();if(l.id="",r.id="",JSON.stringify(l)!==JSON.stringify(r))return!1}return!0}(e.filters,i)||(e.filters=i);var n=e.filters.find((function(e){return q(e)}));e.activeFilterId=null!=n?n.id:null}))}function J(e){return e.filter((function(e){return!!e})).map((function(e){return"(".concat(e,")")})).join(" AND ")}var Y=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments))._levelFieldName=null,e._parseValueFromFilter=function(t){var i,n,l,r=new RegExp("".concat(e._levelFieldName,"\\s*=\\s*(\\d+)"),"gi"),a=new RegExp("".concat(e._levelFieldName,"\\s*<\\s*(\\d+)"),"gi"),s=(0,x.Z)(null!==(i=null===(n=t.filterBlocks)||void 0===n?void 0:n.items)&&void 0!==i?i:[]);try{for(s.s();!(l=s.n()).done;){var o=l.value,u=o.filterMode,d=o.filterExpression;if(null!=d){var c=null;if("solid"===u.type?c=r.exec(d):"x-ray"===u.type&&(c=a.exec(d)),c)return parseInt(c[1],10)}}}catch(h){s.e(h)}finally{s.f()}return null},e}return(0,a.Z)(i,[{key:"filterExpressions",get:function(){return this.enabled&&this._levelFieldName?{xRay:"".concat(this._levelFieldName," < ").concat(this.value),solid:"".concat(this._levelFieldName," = ").concat(this.value)}:{solid:null,xRay:null}}},{key:"_firstValue",get:function(){var e=this.allowedValues;return e.length>0?e[0]:0}},{key:"_setup",value:function(){var e=this,t=[];this.layers.forEach((function(i){var n=V(i,"bldglevel");null!=n&&(e._levelFieldName=n.fieldName,t.push(n))})),this._domainInfo=O(t);var i=this._valueBeforeReady;this._set("state","ready"),this._valueBeforeReady=null;var n=null!==i&&void 0!==i?i:X(this.layers,this._parseValueFromFilter);null!=n?this.select(n):(this.enabled=!1,this.value=this._firstValue)}}]),i}(H);(0,u._)([(0,d.Cb)({readOnly:!0})],Y.prototype,"filterExpressions",null),(0,u._)([(0,d.Cb)()],Y.prototype,"_levelFieldName",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],Y.prototype,"_firstValue",null);var $=Y=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingLevel")],Y),Q=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments))._createdPhaseFieldName=null,e._demolishedPhaseFieldName=null,e._parseValueFromFilter=function(t){var i,n,l,r=e._createdPhaseFieldName,a=new RegExp("".concat(r,"\\s*<=\\s*(\\d+)\\s*OR\\s*").concat(r,"\\s*IS\\s*NULL"),"gi"),s=e._demolishedPhaseFieldName,o=new RegExp("".concat(s,"\\s*>\\s*(\\d+)\\s*OR\\s*").concat(s,"\\s*IS\\s*NULL"),"gi"),u=(0,x.Z)(null!==(i=null===(n=t.filterBlocks)||void 0===n?void 0:n.items)&&void 0!==i?i:[]);try{for(u.s();!(l=u.n()).done;){var d,c=l.value.filterExpression,h=c?null!==(d=a.exec(c))&&void 0!==d?d:o.exec(c):null;if(h)return parseInt(h[1],10)}}catch(v){u.e(v)}finally{u.f()}return null},e}return(0,a.Z)(i,[{key:"filterExpressions",get:function(){if(!this.enabled)return{solid:null,xRay:null};var e=[],t=this._createdPhaseFieldName;t&&e.push("(".concat(t," <= ").concat(this.value," OR ").concat(t," IS NULL)"));var i=this._demolishedPhaseFieldName;i&&e.push("(".concat(i," > ").concat(this.value," OR ").concat(i," IS NULL)"));var n=e.join(" AND ");return{solid:n,xRay:n}}},{key:"_lastValue",get:function(){var e=this.allowedValues;return e.length>0?e[e.length-1]:0}},{key:"_setup",value:function(){var e=this,t=[];this.layers.forEach((function(i){var n=V(i,"createdphase");null!=n&&(e._createdPhaseFieldName=n.fieldName,t.push(n));var l=V(i,"demolishedphase");null!=l&&(e._demolishedPhaseFieldName=l.fieldName,t.push(l))})),this._domainInfo=O(t);var i=this._valueBeforeReady;if(this._set("state","ready"),this._valueBeforeReady=null,this.allowedValues.length>0){var n=null!==i&&void 0!==i?i:X(this.layers,this._parseValueFromFilter);this.select(null!==n&&void 0!==n?n:this._lastValue)}else this.clear()}}]),i}(H);(0,u._)([(0,d.Cb)({readOnly:!0})],Q.prototype,"filterExpressions",null),(0,u._)([(0,d.Cb)()],Q.prototype,"_createdPhaseFieldName",void 0),(0,u._)([(0,d.Cb)()],Q.prototype,"_demolishedPhaseFieldName",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],Q.prototype,"_lastValue",null);var ee=Q=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingPhase")],Q),te=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).view=null,n.state="disabled",n.level=new $,n.phase=new ee,n.disciplines=new A,n._loadLayers=B(),n.layers=new f.Z,n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles([this.layers.on("change",(function(){return e._onLayersChange()})),(0,w.watch)((function(){return{state:e.state,layers:e.layers,filter:e._filter}}),(function(e){var t=e.state,i=e.layers,n=e.filter;"ready"===t&&G(i,n)}),{initial:!0})]),this._onLayersChange()}},{key:"destroy",value:function(){this.level.destroyed||this.level.destroy(),this.phase.destroyed||this.phase.destroy(),this.disciplines.destroyed||this.disciplines.destroy()}},{key:"isSupported",get:function(){var e;return"3d"===(null===(e=this.view)||void 0===e?void 0:e.type)}},{key:"layers",get:function(){return this._get("layers")},set:function(e){var t=e.filter((function(e){return e instanceof C.default}));t.length!==e.length&&b.Z.getLogger(this).error("Some layers are not BuildingSceneLayers but only BuildingSceneLayers can be passed to the widget."),this._set("layers",(0,g.Z)(t,this._get("layers")))}},{key:"_filter",get:function(){var e=this.level.filterExpressions,t=this.phase.filterExpressions,i=[],n=function(e){var t=J(e);return t?new z.Z({filterExpression:t,filterMode:new j.Z}):null}([e.solid,t.solid]);null!=n&&i.push(n);var l=function(e){var t=J(e);return t?new z.Z({filterExpression:t,filterMode:new U.Z}):null}([e.xRay,t.xRay]);return null!=l&&i.push(l),0===i.length?null:new k.Z({id:"".concat((0,T.DO)()).concat(K),name:"Building Explorer Filter",filterBlocks:i})}},{key:"_onLayersChange",value:function(){var e=(0,_.Z)((0,p.Z)().mark((function e(){var t,i=this;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.layers,this.level.layers=t,this.phase.layers=t,this.disciplines.layers=t,0===t.length){e.next=17;break}return this._set("state","loading"),e.prev=3,e.next=6,this._loadLayers(t);case 6:return e.next=8,Promise.all([(0,w.whenOnce)((function(){return"ready"===i.level.state})),(0,w.whenOnce)((function(){return"ready"===i.phase.state})),(0,w.whenOnce)((function(){return"ready"===i.disciplines.state}))]);case 8:t.forEach(S),this._set("state","ready"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),(0,m.D_)(e.t0)||this._set("state","failed");case 15:e.next=18;break;case 17:this._set("state","disabled");case 18:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(){return e.apply(this,arguments)}}()}]),i}(y.default);(0,u._)([(0,d.Cb)({value:null})],te.prototype,"view",void 0),(0,u._)([(0,d.Cb)()],te.prototype,"isSupported",null),(0,u._)([(0,d.Cb)({type:f.Z,nonNullable:!0})],te.prototype,"layers",null),(0,u._)([(0,d.Cb)({readOnly:!0})],te.prototype,"state",void 0),(0,u._)([(0,d.Cb)({readOnly:!0,type:$})],te.prototype,"level",void 0),(0,u._)([(0,d.Cb)({readOnly:!0,type:ee})],te.prototype,"phase",void 0),(0,u._)([(0,d.Cb)({readOnly:!0,type:A})],te.prototype,"disciplines",void 0),(0,u._)([(0,d.Cb)()],te.prototype,"_filter",null);var ie,ne=te=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingExplorerViewModel")],te),le="esri-building-explorer",re={base:le,panelError:"".concat(le,"__panel--error"),loadingContainer:"".concat(le,"__loading-container"),content:"".concat(le,"__content"),section:"".concat(le,"__section"),levels:"".concat(le,"__levels"),phases:"".concat(le,"__phases"),disciplines:"".concat(le,"__disciplines")},ae=i(33095),se=i(80975),oe=i(67005),ue={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},de="esri-building-disciplines-tree-node",ce={base:de,root:"".concat(de,"--root"),leaf:"".concat(de,"--leaf"),label:"".concat(de,"__label"),checkbox:"".concat(de,"__checkbox"),checkboxChecked:"".concat(de,"__checkbox--checked"),checkboxIndeterminate:"".concat(de,"__checkbox--indeterminate"),collapseToggle:"".concat(de,"__collapse-toggle"),collapseToggleCollapsed:"".concat(de,"__collapse-toggle--collapsed"),children:"".concat(de,"__children"),level:function(e){return"".concat(de,"--level-").concat(e)}},he=ie=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).messages=ue,n.toggleSiblingsVisibility=!1,n._childWidgets=[],n._updateChildWidgets=function(){n._destroyChildWidgets(),n._childWidgets=n.node.children.toArray().reverse().map((function(e){return new ie({node:e,messages:n.messages,toggleSiblingsVisibility:n.toggleSiblingsVisibility})}))},n}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,w.on)((function(){return e.node.children}),"after-changes",this._updateChildWidgets,{onListenerAdd:this._updateChildWidgets,onListenerRemove:this._updateChildWidgets}),(0,w.watch)((function(){return[e.messages,e.toggleSiblingsVisibility]}),this._updateChildWidgets,w.initial)])}},{key:"destroy",value:function(){this._destroyChildWidgets()}},{key:"render",value:function(){var e,t=this.node,i=t.isRoot,l=t.isLeaf;return t.isDiscipline&&l?(0,oe.u)("div",{key:"".concat(t.id,"-empty")}):(0,oe.u)("div",{"aria-expanded":t.collapsed?"false":"true",bind:this,class:this.classes(ce.base,ce.level(t.level),(e={},(0,n.Z)(e,ce.root,i),(0,n.Z)(e,ce.leaf,l),e)),key:t.id,onkeydown:this._onKeydown,role:"treeitem",tabIndex:l?void 0:0},(0,oe.u)("label",{bind:this,class:ce.label,onclick:this._onCheckboxToggle},this._renderCollapseToggle(),this._renderCheckbox(),(0,oe.u)("span",null,t.title)),this._renderChildren(t))}},{key:"_renderCheckbox",value:function(){var e,t,i,l=this.node.visible,r=!0===l,a=null===l,s=r?null===(e=this.messages)||void 0===e?void 0:e.hideSublayer:null===(t=this.messages)||void 0===t?void 0:t.showSublayer;return(0,oe.u)("button",{"aria-checked":r?"true":"false","aria-label":s,bind:this,class:this.classes(ce.checkbox,(i={},(0,n.Z)(i,ce.checkboxChecked,r),(0,n.Z)(i,ae.W.checkMark,r),(0,n.Z)(i,ce.checkboxIndeterminate,a),(0,n.Z)(i,ae.W.minus,a),i)),onclick:this._onCheckboxToggle,role:"checkbox",title:s,type:"button"})}},{key:"_renderCollapseToggle",value:function(){var e,t;if(!this.node.hasChildren)return null;var i=this.node.collapsed,l=i?null===(e=this.messages)||void 0===e?void 0:e.expand:null===(t=this.messages)||void 0===t?void 0:t.collapse;return(0,oe.u)("div",{"aria-label":l,bind:this,class:this.classes(ce.collapseToggle,ae.W.right,(0,n.Z)({},ce.collapseToggleCollapsed,i)),onclick:this._onCollapseToggle,title:l})}},{key:"_renderChildren",value:function(e){return!e.hasChildren||e.collapsed?null:(0,oe.u)("div",{class:ce.children},this._childWidgets.map((function(e){return e.render()})))}},{key:"_onKeydown",value:function(e){switch(e.key){case"Space":case"Enter":if(!e.target.classList.contains(ce.base))return;e.stopPropagation(),this.node.toggleVisibility();break;case"ArrowLeft":e.stopPropagation(),this.node.toggleCollapsed(!(0,se.dZ)(this.container));break;case"ArrowRight":e.stopPropagation(),this.node.toggleCollapsed((0,se.dZ)(this.container))}}},{key:"_onCheckboxToggle",value:function(e){e.preventDefault(),e.stopPropagation(),(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility?this.node.toggleAllSiblingsVisibility():this.node.toggleVisibility()}},{key:"_onCollapseToggle",value:function(e){e.preventDefault(),e.stopPropagation(),this.node.toggleCollapsed()}},{key:"_destroyChildWidgets",value:function(){this._childWidgets.forEach((function(e){return e.destroy()})),this._childWidgets=[]}}]),i}(v.Z);(0,u._)([(0,d.Cb)({type:E})],he.prototype,"node",void 0),(0,u._)([(0,d.Cb)()],he.prototype,"messages",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],he.prototype,"toggleSiblingsVisibility",void 0),(0,u._)([(0,d.Cb)()],he.prototype,"_childWidgets",void 0);var ve=he=ie=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],he),pe={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},_e="esri-building-disciplines-tree",ye=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).toggleSiblingsVisibility=!1,n}return(0,a.Z)(i,[{key:"render",value:function(){var e,t=this.vm,i=this.toggleSiblingsVisibility,n=null!==(e=this.messages)&&void 0!==e?e:pe;return(0,oe.u)("div",{class:_e,role:"tree"},t.root.children.toArray().reverse().map((function(e){return(0,oe.u)(ve,{messages:n,node:e,toggleSiblingsVisibility:i})})))}}]),i}(v.Z);(0,u._)([(0,d.Cb)()],ye.prototype,"vm",void 0),(0,u._)([(0,d.Cb)()],ye.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],ye.prototype,"toggleSiblingsVisibility",void 0);var fe=ye=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesTree")],ye),ge=i(97326),be=i(98928),me=i(16889),we=Object.freeze(Object.defineProperty({__proto__:null,alphaLevelDependencyFactor:30,alphaSpreadFactor:10,levelHeightDefault:14,levelHoveredExtraHeight:30,levelHoveredExtraWidth:20,levelWidthConstant:40,levelWidthMax:80,levelWidthMin:30,levelWidthNominator:100,levelsMarginFactor:2,levelsPadding:20,levelsPointerAdjustment:.035},Symbol.toStringTag,{value:"Module"})),Ce="esri-building-level-picker",ke={container:Ce,noLevel:"".concat(Ce,"--no-level"),animateLevel:"".concat(Ce,"--animate-level"),levelsContainer:"".concat(Ce,"__levels-container"),innerLevelsContainer:"".concat(Ce,"__inner-levels-container"),labelContainer:"".concat(Ce,"__label-container"),arrowUp:"".concat(Ce,"__arrow-up"),arrowDown:"".concat(Ce,"__arrow-down")},xe="esri-building-level-picker-label",Le={base:xe,active:"".concat(xe,"--active"),hover:"".concat(xe,"--hover"),empty:"".concat(xe,"--empty"),clearButton:"".concat(xe,"__clear-button")},Ze={clearLevel:"",selectLevel:""},Pe=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e,n){var l;return(0,r.Z)(this,i),(l=t.call(this,e,n)).level=null,l.active=!1,l.hovering=!1,l.onClear=function(){},l}return(0,a.Z)(i,[{key:"render",value:function(){var e,t,i=null!==(e=this.messages)&&void 0!==e?e:Ze;if(null==this.level)return(0,oe.u)("div",{class:Le.empty,title:i.selectLevel},i.selectLevel);var l=i.clearLevel;return(0,oe.u)("div",{"aria-label":l,bind:this,class:this.classes(Le.base,(t={},(0,n.Z)(t,Le.active,this.active),(0,n.Z)(t,Le.hover,this.hovering),t)),onclick:this.onClear,title:l},(0,oe.u)("span",null,this.level),(0,oe.u)("button",{bind:this,class:this.classes(Le.clearButton,ae.W.close),disabled:!this.active,onclick:this.onClear,type:"button"}))}}]),i}(v.Z);(0,u._)([(0,d.Cb)()],Pe.prototype,"level",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Pe.prototype,"active",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Pe.prototype,"hovering",void 0),(0,u._)([(0,d.Cb)()],Pe.prototype,"messages",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Pe.prototype,"onClear",void 0),Pe=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingLevelPicker.Label")],Pe);var Se="esri-building-level-picker-item",Ve={container:Se,base:"".concat(Se,"__base"),hover:"".concat(Se,"--hover"),active:"".concat(Se,"--active")},Ee=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e,n){var l;return(0,r.Z)(this,i),(l=t.call(this,e,n)).active=!1,l.hovering=!1,l.width=0,l.height=0,l.onSelect=function(){},l.onFocus=function(){},l.onBlur=function(){},l._baseElement=null,l}return(0,a.Z)(i,[{key:"render",value:function(){var e;return(0,oe.u)("div",{bind:this,class:this.classes(Ve.container,(e={},(0,n.Z)(e,Ve.active,this.active),(0,n.Z)(e,Ve.hover,this.hovering),e)),key:this,styles:{height:"".concat(this.height,"px")}},this._renderBase())}},{key:"focus",value:function(){null!=this._baseElement&&this._baseElement.focus()}},{key:"_renderBase",value:function(){var e,t=this.width,i=.8*this.width;return(0,oe.u)("div",{class:Ve.base,styles:{width:"".concat(Math.round(t),"px"),height:"".concat(Math.round(t),"px")}},(0,oe.u)("button",{afterCreate:se.Yo,"aria-label":this.label,bind:this,class:"rect","data-node-ref":"_baseElement",onblur:this.onBlur,onclick:this.onSelect,onfocus:this.onFocus,styles:{width:"".concat(Math.round(i),"px"),height:"".concat(Math.round(i),"px")},tabIndex:-1,title:null!==(e=this.label)&&void 0!==e?e:"",type:"button"}))}}]),i}(v.Z);(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"level",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"active",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"hovering",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"width",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"height",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"onSelect",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"onFocus",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],Ee.prototype,"onBlur",void 0),Ee=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingLevelPicker.LevelItem")],Ee);var Ne=i(7021),Be={selectLevel:"selectLevel",clearLevel:"clearLevel",nextLevel:"nextLevel",previousLevel:"previousLevel",currentLevel:"{{value}}"},Me=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e,n){var l;return(0,r.Z)(this,i),(l=t.call(this,e,n))._levelHandlesKey="levelHandles",l._levelEventHandlesKey="levelEventHandles",l._levelWidgets=[],l._labelWidget=new Pe({onClear:function(){return l.vm.clear()}}),l._hoveredLevel=null,l._expandedLevelsHeight=void 0,l._normalizedPointerPosition=0,l._hovering=!1,l._containerPosTop=null,l._levelsContainer=null,l._onPointerUp=function(){var e;if(null!==(e=window.getSelection())&&void 0!==e&&e.removeAllRanges(),null!=l._hoveredLevel){var t=(0,ge.Z)(l).vm;t.enabled&&l._hoveredLevel===t.value?t.clear():t.select(l._hoveredLevel)}},l._onPointerEnter=function(){var e;l._hovering||null==l._levelsContainer||(l._hovering=!0,l._containerPosTop=null!==(e=l._levelsContainer.getBoundingClientRect().top)&&void 0!==e?e:0)},l._onPointerLeave=function(){l._hovering&&(l._normalizedPointerPosition=0,l._hoveredLevel=null,l._hovering=!1)},l._onPointerMove=function(e){var t;if(!l._hovering)return!1;if(null!==(t=window.getSelection())&&void 0!==t&&t.removeAllRanges(),null!=l._containerPosTop){var i=l._containerPosTop,n=l._expandedLevelsMargin,r=l._levelsHeight,a=i+40+n,s=l._levelHeight/2;a+=s,r-=s;var o=(e.clientY-a)/r;o+=.035,l._normalizedPointerPosition=o}return!1},l}return(0,a.Z)(i,[{key:"postInitialize",value:function(){var e=this;this.addHandles([(0,w.watch)((function(){return e._levelsContainer}),(function(){return e._onContainerChange()}),w.initial),(0,w.watch)((function(){return e._levels}),(function(){return e._createLevelWidgets()}),w.initial),(0,w.watch)((function(){return e.messages}),(function(){var t;e._labelWidget.messages=null!==(t=e.messages)&&void 0!==t?t:Be}),w.initial)])}},{key:"destroy",value:function(){this._levelWidgets.forEach((function(e){return e.destroy()})),this._labelWidget.destroy()}},{key:"_levels",get:function(){return this.vm.allowedValues}},{key:"_numLevels",get:function(){return this._levels.length}},{key:"_levelsHeight",get:function(){return Math.round(this._levelHeight*this._numLevels)}},{key:"_expandedLevelsMargin",get:function(){var e;return Math.round(((null!==(e=this._expandedLevelsHeight)&&void 0!==e?e:0)-this._levelsHeight)/2)}},{key:"_levelWidth",get:function(){var e=we.levelWidthNominator,t=we.levelWidthConstant,i=e/Math.sqrt(this._numLevels)+t;return Math.round((0,me.uZ)(i,30,80))}},{key:"_levelHeight",get:function(){var e=28/Math.sqrt(this._numLevels);return Math.round((0,me.uZ)(e,2,14))}},{key:"_gaussianFactor",get:function(){var e=this._numLevels;return e/Math.log(30*e)*10}},{key:"_levelClosestToPointer",get:function(){if(!this._hovering)return null;var e=this._numLevels-1,t=this._normalizedPointerPosition;return e>=0&&null!=t?this._levels[Math.round((1-t)*e)]:null}},{key:"render",value:function(){var e,t=this._levelWidgets.length,i=t>1?this._levelWidgets.map((function(e){return e.render()})):null,l=this._levelsHeight,r=l+80;return(0,oe.u)("div",{bind:this,class:this.classes(Ne.z.widget,ke.container,(e={},(0,n.Z)(e,ke.animateLevel,!this._hovering),(0,n.Z)(e,ke.noLevel,t<2),e)),key:this,onkeydown:this._onKeyDown},this._renderLabelContainer(),(0,oe.u)("div",{afterCreate:se.Yo,bind:this,class:ke.levelsContainer,"data-node-ref":"_levelsContainer",onfocus:this._onFocus,styles:{height:"".concat(r,"px"),marginTop:"".concat(-20,"px"),marginBottom:"".concat(-20,"px")}},(0,oe.u)("div",{class:ke.innerLevelsContainer,styles:{height:"".concat(l,"px"),margin:20-this._expandedLevelsMargin+"px 0 0 0"}},i)))}},{key:"_renderLabelContainer",value:function(){var e,t=null!==(e=this.messages)&&void 0!==e?e:Be,i=t.previousLevel,n=t.nextLevel;return(0,oe.u)("div",{class:ke.labelContainer,tabIndex:0},(0,oe.u)("button",{"aria-label":n,bind:this,class:ke.arrowUp,disabled:!this.vm.hasNext,onclick:this._onArrowUpClick,title:n,type:"button"}),this._labelWidget.render(),(0,oe.u)("button",{"aria-label":i,bind:this,class:ke.arrowDown,disabled:!this.vm.hasPrevious,onclick:this._onArrowDownClick,title:i,type:"button"}))}},{key:"_updateComponents",value:function(){var e,t=this,i=null!==(e=this.messages)&&void 0!==e?e:Be,n=this.vm.enabled?this.vm.value:null,l=null!=this._hoveredLevel?this._hoveredLevel:n;this._levelWidgets.forEach((function(e){var l,r=t.vm.getValueLabel(e.level);e.label=null!=r?r:null===(l=i.currentLevel)||void 0===l?void 0:l.replace("{{level}}",String(e.level)),e.active=e.level===n,e.hovering=e.level===t._hoveredLevel})),this._labelWidget.level=l,this._labelWidget.active=l===n,this._labelWidget.hovering=null!=this._hoveredLevel}},{key:"_createLevelWidgets",value:function(){var e=this;this._levelWidgets.forEach((function(e){return e.destroy()})),this._levelWidgets=this._levels.map((function(t){return new Ee({level:t,onSelect:function(){return e._onLevelToggle(t)}})})),this.removeHandles(this._levelHandlesKey),this.addHandles([(0,w.watch)((function(){var t=e.vm;return[e.messages,null===t||void 0===t?void 0:t.value,null===t||void 0===t?void 0:t.enabled,e._hoveredLevel,e._hovering]}),(function(){return e._updateComponents()}),w.initial),(0,w.watch)((function(){return[e._normalizedPointerPosition,e._hovering]}),(function(){return e._onPointerPositionChange()}),w.initial),(0,w.watch)((function(){return e._levelWidth}),(function(t){return e._levelWidgets.forEach((function(e){return e.width=t}))}),w.initial)],this._levelHandlesKey)}},{key:"_onContainerChange",value:function(){var e=this._levelsContainer;null!=e&&(this.removeHandles(this._levelEventHandlesKey),this.addHandles([(0,be.on)(e,"pointerenter",this._onPointerEnter),(0,be.on)(e,"pointerover",this._onPointerEnter),(0,be.on)(e,"pointerleave",this._onPointerLeave),(0,be.on)(e,"pointerup",this._onPointerUp),(0,be.on)(e,"pointermove",this._onPointerMove)],this._levelEventHandlesKey))}},{key:"_onKeyDown",value:function(e){switch(e.key){case"ArrowDown":case"ArrowLeft":e.preventDefault(),e.stopPropagation(),this.vm.previous(),this._focusCurrentLevel();break;case"ArrowUp":case"ArrowRight":e.preventDefault(),e.stopPropagation(),this.vm.next(),this._focusCurrentLevel()}}},{key:"_focusCurrentLevel",value:function(){var e=this,t=this._levelWidgets.find((function(t){return t.level===e.vm.value}));null===t||void 0===t||t.focus()}},{key:"_onFocus",value:function(){this._hoveredLevel=this._levels.length>0?this._levels[0]:null}},{key:"_onLevelToggle",value:function(e){var t=this.vm;t.enabled&&t.value===e?t.clear():t.select(e)}},{key:"_onArrowUpClick",value:function(){this.vm.next()}},{key:"_onArrowDownClick",value:function(){this.vm.previous()}},{key:"_onPointerPositionChange",value:function(){var e=this,t=0;this._levelWidgets.forEach((function(i,n){var l=e._getLevelWidgetSize(n),r=l.width,a=l.height;i.height=a,i.width=r,t+=a})),this._hoveredLevel=this._levelClosestToPointer;var i=this._expandedLevelsHeight;(null==i||Math.abs(i-t)>30)&&(this._expandedLevelsHeight=t)}},{key:"_getLevelWidgetSize",value:function(e){var t={width:this._levelWidth,height:this._levelHeight};if(this._hovering){var i=this._getGaussianFactor(e,this._normalizedPointerPosition);t.width+=20*i,t.height+=30*i}return t}},{key:"_getGaussianFactor",value:function(e,t){var i=this._numLevels-1,n=(i-e)/i,l=this._gaussianFactor*(n-t);return Math.exp(-Math.pow(l,2))}}]),i}(v.Z);(0,u._)([(0,d.Cb)()],Me.prototype,"vm",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_levelWidgets",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_labelWidget",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_hoveredLevel",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_levels",null),(0,u._)([(0,d.Cb)()],Me.prototype,"_numLevels",null),(0,u._)([(0,d.Cb)({readOnly:!0})],Me.prototype,"_levelsHeight",null),(0,u._)([(0,d.Cb)()],Me.prototype,"_expandedLevelsHeight",void 0),(0,u._)([(0,d.Cb)({readOnly:!0})],Me.prototype,"_expandedLevelsMargin",null),(0,u._)([(0,d.Cb)({readOnly:!0})],Me.prototype,"_levelWidth",null),(0,u._)([(0,d.Cb)({readOnly:!0})],Me.prototype,"_levelHeight",null),(0,u._)([(0,d.Cb)({readOnly:!0})],Me.prototype,"_gaussianFactor",null),(0,u._)([(0,d.Cb)({readOnly:!0})],Me.prototype,"_levelClosestToPointer",null),(0,u._)([(0,d.Cb)({type:Number,range:{min:0,max:1}})],Me.prototype,"_normalizedPointerPosition",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_hovering",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_containerPosTop",void 0),(0,u._)([(0,d.Cb)()],Me.prototype,"_levelsContainer",void 0);var Fe=Me=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingLevelPicker.BuildingLevelPicker")],Me),We={nextPhase:"nextPhase",previousPhase:"previousPhase",currentPhase:"{{value}}"},Ae="esri-building-phase-picker",Ie={container:"".concat(Ae),phasesContainer:"".concat(Ae,"__phases-container"),phase:"".concat(Ae,"__phase"),phaseActive:"".concat(Ae,"__phase--active"),phaseCurrent:"".concat(Ae,"__phase--current"),divider:"".concat(Ae,"__divider"),dividerActive:"".concat(Ae,"__divider--active"),arrowLeft:"".concat(Ae,"__arrow-left"),arrowRight:"".concat(Ae,"__arrow-right")},Oe=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e,n){var l;return(0,r.Z)(this,i),(l=t.call(this,e,n))._phasesContainer=null,l._shouldScrollCurrentPhaseIntoView=!0,l._shouldFocusCurrentPhase=!1,l._onKeyDown=function(e){var t=(0,ge.Z)(l).vm;switch(e.key){case"ArrowDown":case"ArrowLeft":e.stopPropagation(),e.preventDefault(),t.previous(),l._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":e.stopPropagation(),e.preventDefault(),t.next(),l._shouldFocusCurrentPhase=!0}},l._onArrowLeftClick=function(){l.vm.previous()},l._onArrowRightClick=function(){l.vm.next()},l._onPhasesContainerAfterCreate=function(e){l._phasesContainer=e,requestAnimationFrame(l._scrollOrFocusPhase)},l._scrollOrFocusPhase=function(){var e=l._phasesContainer;if(!l.destroyed&&null!=e){var t=e.querySelector(".".concat(Ie.phaseCurrent));if(t){if(l._shouldScrollCurrentPhaseIntoView){var i=e.offsetWidth,n=t.offsetLeft,r=t.offsetWidth;e.scrollLeft=-i/2+n-r/2,l._shouldScrollCurrentPhaseIntoView=!1}l._shouldFocusCurrentPhase&&(t.focus(),l._shouldFocusCurrentPhase=!1)}}},l}return(0,a.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles((0,w.watch)((function(){return[e._currentPhase,e._phasesContainer,e.container]}),(function(){e._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(e._scrollOrFocusPhase)}),w.initial))}},{key:"_phases",get:function(){return this.vm.allowedValues}},{key:"_currentPhase",get:function(){var e=this.vm;return e.enabled?e.value:null}},{key:"render",value:function(){if(this._phases.length<2)return(0,oe.u)("div",{key:"no-phases"});var e=this.vm,t=this.container,i=this.messages,n=null!==i&&void 0!==i?i:We,l=n.previousPhase,r=n.nextPhase,a=(0,se.dZ)(t);return(0,oe.u)("div",{class:this.classes(Ne.z.widget,Ie.container),key:this,onkeydown:this._onKeyDown},(0,oe.u)("button",{"aria-label":l,class:a?Ie.arrowRight:Ie.arrowLeft,disabled:!e.hasPrevious,onclick:this._onArrowLeftClick,title:l,type:"button"}),(0,oe.u)("div",{afterCreate:this._onPhasesContainerAfterCreate,class:Ie.phasesContainer},this._renderPhaseButtons()),(0,oe.u)("button",{"aria-label":r,class:a?Ie.arrowLeft:Ie.arrowRight,disabled:!e.hasNext,onclick:this._onArrowRightClick,title:r,type:"button"}))}},{key:"_renderPhaseButtons",value:function(){for(var e=this._phases,t=this._currentPhase,i=[],n=0;n<e.length;++n){var l=e[n],r={phase:l,active:null!=t&&l<=t,current:null!=t&&l===t};n>0&&i.push(this._renderDivider(r)),i.push(this._renderPhaseButton(r))}return i}},{key:"_renderPhaseButton",value:function(e){var t,i=e.phase,l=e.active,r=e.current,a=this.vm,s=a.getValueLabel(i);return(0,oe.u)("button",{"aria-label":s,class:this.classes(Ie.phase,(t={},(0,n.Z)(t,Ie.phaseActive,l),(0,n.Z)(t,Ie.phaseCurrent,r),t)),key:"phase-".concat(i),onclick:function(){return a.select(i)},title:s,type:"button"},i)}},{key:"_renderDivider",value:function(e){var t=e.phase,i=e.active;return(0,oe.u)("div",{class:this.classes(Ie.divider,(0,n.Z)({},Ie.dividerActive,i)),key:"phase-divider-".concat(t)})}}]),i}(v.Z);(0,u._)([(0,d.Cb)({nonNullable:!0})],Oe.prototype,"vm",void 0),(0,u._)([(0,d.Cb)()],Oe.prototype,"messages",void 0),(0,u._)([(0,d.Cb)()],Oe.prototype,"_phases",null),(0,u._)([(0,d.Cb)()],Oe.prototype,"_currentPhase",null),(0,u._)([(0,d.Cb)()],Oe.prototype,"_phasesContainer",void 0);var Re=Oe=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],Oe),De=i(96919),He=i(80532),Te={levels:!0,phases:!0,disciplines:!0},ze=function(e){(0,s.Z)(i,e);var t=(0,o.Z)(i);function i(e,n){var a;return(0,r.Z)(this,i),(a=t.call(this,e,n))._defaultViewModel=new ne,a.viewModel=a._defaultViewModel,a.visibleElements=(0,l.Z)({},Te),a.headingLevel=3,a.messages=null,a.messagesCommon=null,a.toggleSiblingsVisibility=!1,a}return(0,a.Z)(i,[{key:"destroy",value:function(){this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"layers",get:function(){return this.viewModel.layers},set:function(e){this.viewModel.layers=e}},{key:"_castVisibleElements",value:function(e){return(0,l.Z)((0,l.Z)({},Te),e)}},{key:"icon",get:function(){return"organization"},set:function(e){this._overrideIfSome("icon",e)}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"render",value:function(){var e=this.viewModel,t="disabled"===e.state||!e.isSupported;return(0,oe.u)("div",{"aria-label":this.messages.widgetLabel,class:(0,se.Sh)(Ne.z.widget,re.base,Ne.z.panel,(0,n.Z)({},Ne.z.widgetDisabled,t)),key:this},this._renderContent())}},{key:"_renderContent",value:function(){var e=this.viewModel,t=this.messages;if(!e.isSupported)return(0,oe.u)("p",{class:re.panelError},t.unsupported);if(!e.layers.length)return(0,oe.u)("p",{class:re.panelError},t.noData);switch(e.state){case"loading":return this._renderLoadingIndicator();case"ready":return(0,oe.u)("div",{class:re.content,key:"content"},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return(0,oe.u)("p",{class:re.panelError},t.failed);default:return null}}},{key:"_renderLoadingIndicator",value:function(){var e=this.messagesCommon.loading;return(0,oe.u)("div",{"aria-label":e,class:re.loadingContainer,key:"loading-container",role:"presentation",title:e},(0,oe.u)("span",{"aria-hidden":"true",class:(0,se.Sh)(ae.W.loadingIndicator,Ne.z.rotating)}))}},{key:"_renderLevelPickerSection",value:function(){var e,t=this.viewModel.level,i="ready"===t.state,n=t.allowedValues.length>1;if(!this.visibleElements.levels||!i||!n)return null;var l=null===(e=this.messages)||void 0===e?void 0:e.level;return(0,oe.u)("div",{class:(0,se.Sh)(re.section,re.levels),key:"levels"},(0,oe.u)(De.X,{level:this.headingLevel},null===l||void 0===l?void 0:l.title),(0,oe.u)(Fe,{messages:l,vm:t}))}},{key:"_renderPhasePickerSection",value:function(){var e=this.viewModel.phase,t="ready"===e.state,i=e.allowedValues.length>1;if(!this.visibleElements.phases||!t||!i)return null;var n=this.messages.phase;return(0,oe.u)("div",{class:(0,se.Sh)(re.section,re.phases),key:"phases"},(0,oe.u)(De.X,{level:this.headingLevel},n.title),(0,oe.u)(Re,{messages:n,vm:e}))}},{key:"_renderDisciplinesSection",value:function(){var e,t=this.viewModel.disciplines,i="ready"===t.state,n=t.root.hasChildren;if(!this.visibleElements.disciplines||!i||!n)return null;var l=null===(e=this.messages)||void 0===e?void 0:e.disciplines;return(0,oe.u)("div",{class:(0,se.Sh)(re.section,re.disciplines),key:"disciplines"},(0,oe.u)(De.X,{level:this.headingLevel},l.title),(0,oe.u)(fe,{messages:l,toggleSiblingsVisibility:this.toggleSiblingsVisibility,vm:t}))}}]),i}(v.Z);(0,u._)([(0,d.Cb)({type:ne})],ze.prototype,"viewModel",void 0),(0,u._)([(0,d.Cb)()],ze.prototype,"view",null),(0,u._)([(0,d.Cb)()],ze.prototype,"layers",null),(0,u._)([(0,d.Cb)()],ze.prototype,"visibleElements",void 0),(0,u._)([(0,c.p)("visibleElements")],ze.prototype,"_castVisibleElements",null),(0,u._)([(0,d.Cb)()],ze.prototype,"headingLevel",void 0),(0,u._)([(0,d.Cb)()],ze.prototype,"icon",null),(0,u._)([(0,d.Cb)()],ze.prototype,"label",null),(0,u._)([(0,d.Cb)(),(0,He.H)("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],ze.prototype,"messages",void 0),(0,u._)([(0,d.Cb)(),(0,He.H)("esri/t9n/common")],ze.prototype,"messagesCommon",void 0),(0,u._)([(0,d.Cb)({nonNullable:!0})],ze.prototype,"toggleSiblingsVisibility",void 0),(0,u._)([(0,d.Cb)()],ze.prototype,"uiStrings",void 0);var je=ze=(0,u._)([(0,h.j)("esri.widgets.BuildingExplorer")],ze)},96919:function(e,t,i){i.d(t,{M:function(){return h},X:function(){return d}});var n=i(1413),l=i(44925),r=i(16889),a=i(7021),s=i(80975),o=i(67005),u=["level","class"];function d(e,t){var i=e.level,r=e.class,d=(0,l.Z)(e,u),h=c(i);return(0,o.u)("h".concat(h),(0,n.Z)((0,n.Z)({},d),{},{"aria-level":String(h),class:(0,s.Sh)(a.z.heading,r),role:"heading"}),t)}function c(e){return(0,r.uZ)(Math.ceil(e),1,6)}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return c(e+t)}},7021:function(e,t,i){i.d(t,{z:function(){return n}});var n={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"}},33095:function(e,t,i){i.d(t,{W:function(){return n}});var n={checkMark:"esri-icon-check-mark",close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",loadingIndicator:"esri-icon-loading-indicator",locateCircled:"esri-icon-locate-circled",minus:"esri-icon-minus",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"}}}]);
//# sourceMappingURL=18264.c320ca23.chunk.js.map