"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[1617],{39374:function(e,t,n){n.r(t),n.d(t,{default:function(){return ft}});var r=n(93433),i=n(37762),o=n(1413),a=n(29439),s=n(74165),l=n(15861),u=n(15671),c=n(43144),p=n(88301),d=n(61120),v=n(60136),h=n(29388),y=n(27366),f=n(19545),m=n(60762),w=n(62044),g=n(36721),b=n(80987),Z=n(10064),_=n(84652),k=n(54472),C=n(93002),S=n(32718),x=n(92026),I=n(97642),L=n(67426),A=n(66978),E=n(94172),T=n(35995),j=n(49861),M=(n(93169),n(38511)),R=n(69912),U=n(31201),P=n(15909),O=n(92562),V=n(53866),N=n(90724),q=n(79803),G=n(78952),W=n(5354),D=n(77981),F=n(92975),J=n(7575),B=n(98995),H=n(32698),z=n(73117),$=n(23037),K=n(1674),Y=n(83217);function Q(){return new Z.Z("webscene:failed-to-copy-embedded-resources","Copying of embedded resources is currently not supported")}function X(e){return new Z.Z("webscene:schema-validation","Failed to save webscene due to schema validation errors. See 'details.errors' for more detailed information",{errors:e})}var ee,te=n(50951),ne=n(92028),re=n(84933),ie=n(15946),oe=n(40739),ae=n(76926),se=n(9634),le=n(41537),ue=n(46784),ce=(n(84936),n(48193)),pe=ee=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).viewing=null,r}return(0,c.Z)(n,[{key:"clone",value:function(){var e,t;return new ee({viewing:null!==(e=null===(t=this.viewing)||void 0===t?void 0:t.clone())&&void 0!==e?e:null})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:ce.Z,json:{write:!0}})],pe.prototype,"viewing",void 0);var de,ve=pe=ee=(0,y._)([(0,R.j)("esri.webscene.ApplicationProperties")],pe),he=n(21147),ye=n(39328),fe=de=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).environment=new he.Z,r.spatialReference=null,r.viewpoint=null,r.timeExtent=null,r}return(0,c.Z)(n,[{key:"viewingMode",set:function(e){this._set("viewingMode",e)}},{key:"clone",value:function(){var e,t,n,r,i,o;return new de({environment:this.environment.clone(),spatialReference:null!==(e=null===(t=this.spatialReference)||void 0===t?void 0:t.clone())&&void 0!==e?e:null,viewingMode:this.viewingMode,viewpoint:null!==(n=null===(r=this.viewpoint)||void 0===r?void 0:r.clone())&&void 0!==n?n:null,timeExtent:null!==(i=null===(o=this.timeExtent)||void 0===o?void 0:o.clone())&&void 0!==i?i:null})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:he.Z,json:{write:{isRequired:!0}}})],fe.prototype,"environment",void 0),(0,y._)([(0,j.Cb)({type:G.Z})],fe.prototype,"spatialReference",void 0),(0,y._)([(0,j.Cb)({type:["local","global"]})],fe.prototype,"viewingMode",null),(0,y._)([(0,j.Cb)({type:g.Z,json:{write:{isRequired:!0}}})],fe.prototype,"viewpoint",void 0),(0,y._)([(0,j.Cb)(ye.v)],fe.prototype,"timeExtent",void 0);var me,we=fe=de=(0,y._)([(0,R.j)("esri.webscene.InitialViewProperties")],fe),ge=n(60354),be=n(89125),Ze=n(54557),_e=n(14921),ke=n(16889),Ce=n(25243),Se=n(32035),xe=n(12400),Ie=n(30651),Le=n(93463),Ae=n(26838),Ee=n(18814),Te=n(67808),je=me=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).text="",e}return(0,c.Z)(n,[{key:"clone",value:function(){return new me({text:this.text})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:String,json:{write:!0}})],je.prototype,"text",void 0);var Me,Re=je=me=(0,y._)([(0,R.j)("esri.webscene.support.Description")],je),Ue=n(3389),Pe=n(50902),Oe=n(23548),Ve=Me=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).lighting=new Ee.Z,e.weather=new Ue.Z,e}return(0,c.Z)(n,[{key:"clone",value:function(){return new Me({lighting:(0,_.d9)(this.lighting),weather:(0,_.d9)(this.weather)})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({types:Oe.j,json:{write:!0}})],Ve.prototype,"lighting",void 0),(0,y._)([(0,j.Cb)({types:Pe.Hr,json:{write:!0}})],Ve.prototype,"weather",void 0),Ve=Me=(0,y._)([(0,R.j)("esri.webscene.Environment")],Ve);var Ne,qe=n(62565),Ge=n(81219),We=Ne=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).opacity=null,e}return(0,c.Z)(n,[{key:"clone",value:function(){return new Ne({opacity:this.opacity})}},{key:"cloneAndApplyTo",value:function(e){var t,n;return null==this.opacity||((e=null!==(t=null===(n=e)||void 0===n?void 0:n.clone())&&void 0!==t?t:new qe.Z).opacity=this.opacity),e}}],[{key:"fromGround",value:function(e){return new Ne({opacity:e.opacity})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:Number,json:{type:Ce.z8,read:{reader:Ge.b,source:"transparency"},write:{writer:function(e,t){t.transparency=(0,Ge.a)(e)},target:"transparency"}}})],We.prototype,"opacity",void 0);var De,Fe,Je=We=Ne=(0,y._)([(0,R.j)("esri.webscene.support.SlideGround")],We),Be=De=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).id="",r.sublayerIds=null,r}return(0,c.Z)(n,[{key:"clone",value:function(){return new De({id:this.id,sublayerIds:(0,_.d9)(this.sublayerIds)})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:String,json:{write:!0}})],Be.prototype,"id",void 0),(0,y._)([(0,j.Cb)({type:[Ce.z8],json:{read:{source:"subLayerIds"},write:{target:"subLayerIds"}}})],Be.prototype,"sublayerIds",void 0),Be=De=(0,y._)([(0,R.j)("esri.webscene.support.SlideVisibleLayer")],Be);var He=Fe=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.apply(this,arguments)).text="",e}return(0,c.Z)(n,[{key:"clone",value:function(){return new Fe({text:this.text})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:String,json:{write:{isRequired:!0}}})],He.prototype,"text",void 0);var ze=He=Fe=(0,y._)([(0,R.j)("esri.webscene.support.Title")],He),$e=0,Ke=b.Z.ofType(Be),Ye=function(e){(0,v.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this,e)).id=Date.now().toString(16)+"-slide-"+$e++,n.title=new ze,n.description=new Re,n.hidden=!1,n.thumbnail=new Ae.A,n.viewpoint=null,n.basemap=null,n.ground=null,n.environment=new Ve,n.timeExtent=null,n.visibleLayers=new Ke,n}return(0,c.Z)(r,[{key:"destroy",value:function(){this.visibleLayers.removeAll(),this.basemap=null,this.thumbnail=(0,x.SC)(this.thumbnail),this.description=null,this.title=null,this.thumbnail=null}},{key:"castTitle",value:function(e){return"string"==typeof e?new ze({text:e}):(0,Ce.se)(ze,e)}},{key:"castDescription",value:function(e){return"string"==typeof e?new Re({text:e}):(0,Ce.se)(Re,e)}},{key:"castThumbnail",value:function(e){return"string"==typeof e?new Ae.A({url:e}):(0,Ce.se)(Ae.A,e)}},{key:"castBasemap",value:function(e){return(0,$.se)(e)}},{key:"visibleLayers",set:function(e){this._set("visibleLayers",(0,ge.Z)(e,this._get("visibleLayers"),Ke))}},{key:"castVisibleLayers",value:function(e){var t=this;return e&&"function"==typeof e.map?e.map((function(e){if("string"==typeof e)return{id:e};if(e instanceof Ie.Z){var n=et(e);return{id:e.id,sublayerIds:n}}return e.id?{id:e.id,sublayerIds:"sublayerIds"in e?e.sublayerIds:void 0}:(S.Z.getLogger(t).warn('Invalid visible layer, expected { id }, Layer or "id"'),e)})):null}},{key:"clone",value:function(){var e,t,n,r;return new(0,this.constructor)({id:this.id,title:this.title.clone(),thumbnail:this.thumbnail.clone(),description:this.description&&this.description.clone()||null,viewpoint:this.viewpoint&&this.viewpoint.clone()||null,basemap:(null===(e=this.basemap)||void 0===e?void 0:e.clone())||null,ground:(null===(t=this.ground)||void 0===t?void 0:t.clone())||null,visibleLayers:this.visibleLayers.clone(),environment:this.environment&&this.environment.clone()||null,hidden:this.hidden,timeExtent:null!==(n=null===(r=this.timeExtent)||void 0===r?void 0:r.clone())&&void 0!==n?n:null})}},{key:"_updateVisibleLayersFrom",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,Promise.allSettled(this._getLayers(t.map).map((function(e){return t.whenLayerView(e).then((function(t){if(t.visible){var r=et(e);n.push(new Be({id:t.layer.id,sublayerIds:r}))}}))})).toArray());case 3:this.visibleLayers.removeAll(),this.visibleLayers.addMany(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateFrom",value:function(e,t){var n=this,r=(0,o.Z)({format:"png",quality:80,width:120,height:75,disableDecorations:!0},null===t||void 0===t?void 0:t.screenshot);return e.when((function(){var t,r;return n.viewpoint=e.viewpoint.clone(),n.environment.lighting="virtual"===e.environment.lighting.type?Te.Z.prototype.clone.apply(e.environment.lighting):Ee.Z.prototype.clone.apply(e.environment.lighting),n.environment.weather=e.environment.weather.clone(),n.basemap=e.map.basemap&&e.map.basemap.clone()||null,n.ground=e.map.ground?Je.fromGround(e.map.ground):null,n.timeExtent=null!==(t=null===(r=e.timeExtent)||void 0===r?void 0:r.clone())&&void 0!==t?t:null,n._updateVisibleLayersFrom(e)})).then((function(){return e.takeScreenshot(r)})).then((function(e){return n.thumbnail=new Ae.A({url:e.dataUrl}),n}))}},{key:"applyTo",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,u,c,p,d,v,h=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!=this._applyToController&&this._applyToController.abort(),r=new AbortController,this._applyToController=r,i=(0,A.$F)(n,(function(){var e;return null===(e=r)||void 0===e?void 0:e.abort()})),a=function(){h._applyToController===r&&(h._applyToController=null),r=null,null===i||void 0===i||i.remove()},e.prev=4,e.next=7,(0,E.whenOnce)((function(){return t.ready}),r.signal);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),a(),e.t0;case 12:if(!r.signal.aborted){e.next=14;break}throw a(),(0,A.zE)();case 14:return u=t.resourceController.scheduler.registerTask(Le.T8.SLIDE),c=!1,p=(0,o.Z)((0,o.Z)({animate:!0},n),{},{signal:this._applyToController.signal}),d=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([u.schedule((0,l.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h._setViewpointOfInterest(t,p);case 2:return e.abrupt("return",c=e.sent);case 3:case"end":return e.stop()}}),e)})))),u.schedule((function(){return h._applyBasemap(t,p)}),p.signal)]);case 2:return e.next=4,h._loadLayersWithSublayerVisibility(t);case 4:return e.next=6,Promise.all([u.schedule((function(){return h._applyLayerVisibility(t)}),p.signal),u.schedule((function(){return h._applyGround(t)}),p.signal),u.schedule((function(){return h._applyViewpoint(t,p)}),p.signal),u.schedule((function(){var e,n;return t.timeExtent=null!==(e=null===(n=h.timeExtent)||void 0===n?void 0:n.clone())&&void 0!==e?e:null}),p.signal)]);case 6:return e.next=8,u.schedule((function(){return t.environment.weather=h.environment.weather.clone()}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=20,(0,_e.q6)(t.addUpdatingPromise(d()));case 20:if(v=e.sent,c&&(t.contentCamera=null),u.remove(),a(),!1!==v.ok){e.next=23;break}throw v.error;case 23:return e.abrupt("return",this);case 24:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyBasemap",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.basemap){e.next=11;break}return e.prev=1,e.next=4,this.basemap.load(n);case 4:e.next=10;break;case 6:if(e.prev=6,e.t0=e.catch(1),!(0,A.D_)(e.t0)){e.next=10;break}throw e.t0;case 10:t.map.basemap=(0,$.Py)(this.basemap,t.map.basemap);case 11:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyGround",value:function(e){this.ground&&(e.map.ground=this.ground.cloneAndApplyTo(e.map.ground))}},{key:"_getLayers",value:function(e){var t=new b.Z;return this._collectLayers(e,t),this._collectLayers(e.ground,t),t}},{key:"_collectLayers",value:function(e,t){var n=this;e.layers.forEach((function(e){e.persistenceEnabled&&(t.add(e),"layers"in e&&n._collectLayers(e,t))}))}},{key:"_loadLayersWithSublayerVisibility",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.visibleLayers,!e.t0){e.next=4;break}return e.next=4,Promise.allSettled(this._getLayers(t.map).items.map((function(e){var t;return(null===(t=n.visibleLayers.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.sublayerIds)?e.load():null})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_applyLayerVisibility",value:function(e){var t=this;this.visibleLayers&&this._getLayers(e.map).forEach((function(e){var n=t.visibleLayers.find((function(t){return t.id===e.id}));e.visible=null!=n;var r=null===n||void 0===n?void 0:n.sublayerIds,i=Xe(e);r&&i&&i.forEach((function(e){return e.visible=r.includes(e.id)}))}))}},{key:"_setViewpointOfInterest",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r){var i,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.state.fixedContentCamera||!this.viewpoint||null!==r&&void 0!==r&&r.ignoreViewpoint||null===r||void 0===r)&&r.useDestinationCamera){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,Promise.all([n.e(34470),n.e(89414),n.e(46316),n.e(90647),n.e(5508)]).then(n.bind(n,90647));case 4:return i=e.sent,o=i.toCameraAsync,e.next=8,o(t,this.viewpoint);case 8:return a=e.sent,e.abrupt("return",(t.contentCamera=a,null!=a));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyViewpoint",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._applyCachedCameraTrackingEnabled(t),!this.viewpoint||n.ignoreViewpoint){e.next=11;break}if(null!=this.viewpoint.camera&&(this.viewpoint.camera.fov=t.camera.fov),r=this.environment.lighting,!n.animate||"sun"!==r.type||!r.date){e.next=5;break}return e.abrupt("return",this._animateToLighting(t,n));case 5:if(e.t0=n.animate,!e.t0){e.next=10;break}return t.environment.applyLighting(r.clone()),e.next=10,t.goTo(this.viewpoint,n);case 10:t.viewpoint=this.viewpoint;case 11:t.environment.applyLighting(this.environment.lighting.clone());case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_animateToLighting",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,"virtual"!==t.environment.lighting.type&&"virtual"!==this.environment.lighting.type&&("global"===t.viewingMode&&(r=this._animateLightingWithCamera(t,t.environment.lighting,this.environment.lighting)),t.environment.cachedCameraTrackingEnabled=t.environment.lighting.cameraTrackingEnabled,t.environment.lighting.cameraTrackingEnabled=!1),t.environment.lighting.directShadowsEnabled=this.environment.lighting.directShadowsEnabled,"virtual"===this.environment.lighting.type||"virtual"===t.environment.lighting.type?(t.environment.applyLighting(this.environment.lighting.clone()),"virtual"!==t.environment.lighting.type&&(t.environment.cachedCameraTrackingEnabled=t.environment.lighting.cameraTrackingEnabled,t.environment.lighting.cameraTrackingEnabled=!1)):null!=this.environment.lighting.displayUTCOffset&&(t.environment.lighting.displayUTCOffset=this.environment.lighting.displayUTCOffset),e.abrupt("return",t.goTo(this.viewpoint,n).then((function(){i._applyCachedCameraTrackingEnabled(t),t.environment.applyLighting(i.environment.lighting.clone())})).catch((function(e){throw null==t.animation&&i._applyCachedCameraTrackingEnabled(t),e})).finally((function(){(0,x.hw)(r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_applyCachedCameraTrackingEnabled",value:function(e){null!=e.environment.cachedCameraTrackingEnabled&&(e.environment.lighting.cameraTrackingEnabled=e.environment.cachedCameraTrackingEnabled,e.environment.cachedCameraTrackingEnabled=null)}},{key:"_getTime",value:function(e){return[e.getTime(),3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()]}},{key:"_setTime",value:function(e,t,n){return e.setTime(t),e.setUTCHours(n/3600),e.setUTCMinutes(n%3600/60),e.setUTCSeconds(n%3600%60),e}},{key:"_animateLightingWithCamera",value:function(e,t,n){var r=this,i=new Date(t.date.toString()),o=this._getTime(i),s=(0,a.Z)(o,2),l=s[0],u=s[1],c=this._getTime(n.date),p=(0,a.Z)(c,2),d=p[0],v=p[1],h=function(e,t){var n=t-e;return n>nt&&(n-=tt),n<-nt&&(n+=tt),n}(u,v),y=e.renderCoordsHelper,f=(0,xe.Ue)();y.toRenderCoords(e.camera.position,f);var m=(0,xe.Ue)(),w=(0,xe.Ue)();null!=this.viewpoint.camera&&y.toRenderCoords(this.viewpoint.camera.position,m);var g=new Date;return(0,E.when)((function(){return e.camera}),(function(e){y.toRenderCoords(e.position,w);var n=(0,Se.a)(f,w),i=(0,Se.a)(m,w),o=0;n+i!==0&&(o=n/(n+i));var a=l+(d-l)*o,s=function(e,t){return(0,ke.HS)(e+t,tt)}(u,h*o);t.date=r._setTime(g,a,s)}))}}],[{key:"createFrom",value:function(e,t){return(new this).updateFrom(e,t)}}]),r}(ue.wq);(0,y._)([(0,j.Cb)({type:String,json:{write:{isRequired:!0}}})],Ye.prototype,"id",void 0),(0,y._)([(0,j.Cb)({type:ze,json:{default:function(){return new ze({text:""})},write:{isRequired:!0}}})],Ye.prototype,"title",void 0),(0,y._)([(0,be.p)("title")],Ye.prototype,"castTitle",null),(0,y._)([(0,j.Cb)({type:Re,json:{write:{overridePolicy:function(e){return{enabled:!(!e||!e.text)}}}}})],Ye.prototype,"description",void 0),(0,y._)([(0,be.p)("description")],Ye.prototype,"castDescription",null),(0,y._)([(0,j.Cb)({type:Boolean,nonNullable:!0,json:{write:!0,default:!1}})],Ye.prototype,"hidden",void 0),(0,y._)([(0,j.Cb)({type:Ae.A,json:{default:function(){return new Ae.A({url:""})},write:{isRequired:!0}}})],Ye.prototype,"thumbnail",void 0),(0,y._)([(0,be.p)("thumbnail")],Ye.prototype,"castThumbnail",null),(0,y._)([(0,j.Cb)({type:g.Z,nonNullable:!0,json:{write:{isRequired:!0}}})],Ye.prototype,"viewpoint",void 0),(0,y._)([(0,j.Cb)({type:Ze.default,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Ye.prototype,"basemap",void 0),(0,y._)([(0,be.p)("basemap")],Ye.prototype,"castBasemap",null),(0,y._)([(0,j.Cb)({type:Je,json:{write:!0}})],Ye.prototype,"ground",void 0),(0,y._)([(0,j.Cb)({type:Ke,json:{write:{isRequired:!0}}})],Ye.prototype,"visibleLayers",null),(0,y._)([(0,be.p)("visibleLayers")],Ye.prototype,"castVisibleLayers",null),(0,y._)([(0,j.Cb)({type:Ve,json:{write:!0}})],Ye.prototype,"environment",void 0),(0,y._)([(0,j.Cb)(ye.v)],Ye.prototype,"timeExtent",void 0);var Qe=Ye=(0,y._)([(0,R.j)("esri.webscene.Slide")],Ye);function Xe(e){if("building-scene"===e.type||"map-image"===e.type)return e.allSublayers.toArray()}function et(e){var t=Xe(e);if(t)return t.filter((function(e){return e.visible})).map((function(e){return e.id}))}var tt=86400,nt=43200;var rt=b.Z.ofType(Qe),it=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).slides=new rt,r}return(0,c.Z)(n,[{key:"destroy",value:function(){this.slides.forEach((function(e){return e.destroy()})),this.slides.removeAll()}},{key:"slides",set:function(e){e&&(e=e.filter((function(e){return!!e.viewpoint}))),this._set("slides",(0,ge.Z)(e,this._get("slides"),rt))}},{key:"clone",value:function(){return new(0,this.constructor)({slides:this.slides.clone()})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:rt,nonNullable:!0,json:{write:!0}}),(0,be.p)(ge.R)],it.prototype,"slides",null);var ot,at=it=(0,y._)([(0,R.j)("esri.webscene.Presentation")],it),st=ot=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,c.Z)(n,[{key:"clone",value:function(){return new ot({name:this.name,path:this.path,title:this.title})}}]),n}(ue.wq);(0,y._)([(0,j.Cb)({type:String,json:{write:!0}})],st.prototype,"name",void 0),(0,y._)([(0,j.Cb)({type:String,json:{write:!0}})],st.prototype,"path",void 0),(0,y._)([(0,j.Cb)({type:String,json:{write:!0}})],st.prototype,"title",void 0);var lt,ut=st=ot=(0,y._)([(0,R.j)("esri.webscene.TransportationNetwork")],st),ct=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e,r){return(0,u.Z)(this,n),t.call(this,e,r,"webscene")}return(0,c.Z)(n,[{key:"supportsGround",get:function(){return this.since(1,8)}},{key:"supportsVisibleElevationLayersInSlides",get:function(){return this.lessThan(1,8)}}]),n}(n(49901).G),pt=null;function dt(){return pt}var vt=new ct(1,34),ht="Web Scene",yt=function(e){(0,v.Z)(y,e);var t=(0,h.Z)(y);function y(e){var n;return(0,u.Z)(this,y),(n=t.call(this,e))[lt]=!0,n._layersIdGCTimeoutId=void 0,n._updateFromPromise=null,n.applicationProperties=null,n.clippingArea=null,n.clippingEnabled=!1,n.floorInfo=null,n.heightModelInfo=void 0,n.sourceVersion=null,n.transportationNetworks=null,n.presentation=new at,n.initialViewProperties=new we,n.portalItem=null,n.resourceInfo=null,n.widgets=null,n._debouncedSaveOperations=(0,A.Ds)(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r,i){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===re.x.SAVE?3:e.t0===re.x.SAVE_AS?4:5;break;case 3:return e.abrupt("return",n._saveImpl(r));case 4:return e.abrupt("return",n._saveAsImpl(i,r));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),n._resourceReferences={portalItem:null,paths:[]},n.authoringApp=null,n.authoringAppVersion=null,n._isAuthoringAppSetByUser=!1,n._isAuthoringAppVersionSetByUser=!1,n}return(0,c.Z)(y,[{key:"initialize",value:function(){var e=this;if(this.when().catch((function(t){S.Z.getLogger(e).error("#load()","Failed to load web scene",t)})),this.resourceInfo){var t;try{t=this._validateJSON(this.resourceInfo)}catch(n){return void this.addResolvingPromise(Promise.reject(n))}this.read(t),this.addResolvingPromise(this._validateSpatialReference()),this.addResolvingPromise(this._validateHeightModelInfo())}this.addHandles((0,E.on)((function(){return e.allLayers}),"change",(function(){return e._scheduleLayersIdGC()})))}},{key:"destroy",value:function(){this._unscheduleLayersIdGC(),this.presentation&&this.presentation.destroy(),this.portalItem=(0,x.SC)(this.portalItem)}},{key:"writeClippingArea",value:function(e,t){t.clippingArea||(t.clippingArea={}),t.clippingArea.geometry=e.toJSON()}},{key:"readClippingEnabled",value:function(e,t){return!!t.clippingArea&&!!t.clippingArea.clip}},{key:"writeClippingEnabled",value:function(e,t){this.clippingArea&&(t.clippingArea||(t.clippingArea={}),t.clippingArea.clip=e)}},{key:"writeLayers",value:function(e,t,n,r){t[n]=this._layersToJSON(e,"operational-layers",r)}},{key:"readSourceVersion",value:function(e,t){var n=t.version.split("."),r=(0,a.Z)(n,2),i=r[0],o=r[1];return new ct(parseInt(i,10),parseInt(o,10))}},{key:"writeSourceVersion",value:function(e,t,n){t[n]="".concat(vt.major,".").concat(vt.minor)}},{key:"writeTables",value:function(e,t,n,r){var i=this._layersToJSON(e,"tables",r);i.length&&(t[n]=i)}},{key:"thumbnailUrl",get:function(){var e,t;return null!==(e=null===(t=this.portalItem)||void 0===t?void 0:t.thumbnailUrl)&&void 0!==e?e:null},set:function(e){e?this._override("thumbnailUrl",e):(this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}},{key:"authoringApp",set:function(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}},{key:"writeAuthoringApp",value:function(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript"}},{key:"authoringAppVersion",set:function(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}},{key:"writeAuthoringAppVersion",value:function(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=f.i8}},{key:"writeGround",value:function(e,t,n,r){t[n]=e?e.write({},r):{transparency:0,layers:[]}}},{key:"readInitialViewProperties",value:function(e,t){var n,r,i,o,a={};null!==(n=t.initialState)&&void 0!==n&&n.environment&&(a.environment=he.Z.fromJSON(t.initialState.environment)),a.spatialReference=t.spatialReference?G.Z.fromJSON(t.spatialReference):G.Z.WebMercator,a.viewingMode=null!==(r=t.viewingMode)&&void 0!==r?r:"global",(null===(i=t.initialState)||void 0===i?void 0:i.viewpoint)&&(a.viewpoint=g.Z.fromJSON(t.initialState.viewpoint));var s=null===(o=t.initialState)||void 0===o?void 0:o.timeExtent;return null!=s&&(a.timeExtent=w.Z.fromArray(s)),new we(a)}},{key:"spatialReference",get:function(){var e,t;return null!==(e=null===(t=this.initialViewProperties)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:G.Z.WebMercator}},{key:"viewingMode",get:function(){var e,t;return null!==(e=null===(t=this.initialViewProperties)||void 0===t?void 0:t.viewingMode)&&void 0!==e?e:"global"}},{key:"load",value:function(e){var t=this,n=this.ground;return this.addResolvingPromise(this._loadFromSource().then((function(){n&&n!==t.ground&&n.destroy()}))),Promise.resolve(this)}},{key:"loadAll",value:function(){var e=this;return(0,C.G)(this,(function(t){var n=e.presentation&&e.presentation.slides;t(e.ground,e.basemap,e.layers,n&&n.map((function(e){return e.basemap})),e.tables)}))}},{key:"read",value:function(e,t){var n,r=this;t=(0,o.Z)((0,o.Z)({},t),{},{origin:"web-scene"});var i=this._isAuthoringAppVersionSetByUser,a=this._isAuthoringAppSetByUser;if((0,O.$)(this,e,(function(t){return(0,p.Z)((0,d.Z)(y.prototype),"read",r).call(r,e,t)}),t),a||(this._isAuthoringAppSetByUser=!1),i||(this._isAuthoringAppVersionSetByUser=!1),e.baseMap&&Array.isArray(e.baseMap.elevationLayers)&&null!==(n=this.sourceVersion)&&void 0!==n&&n.supportsVisibleElevationLayersInSlides){var s=e.baseMap.elevationLayers.map((function(e){return{id:e.id}})),l=this.presentation.slides,u=s.filter((function(e){return!l.some((function(t){return function(e,t){return e.visibleLayers.some((function(e){return e.id===t}))}(t,e.id)}))}));l.forEach((function(e){e.visibleLayers.addMany(u)}))}}},{key:"_writeBasemapElevationLayers",value:function(e){var t,n=null===(t=e.ground)||void 0===t?void 0:t.layers;!e.baseMap&&null!==n&&void 0!==n&&n.length&&(e.baseMap={title:"Basemap",baseMapLayers:[]}),e.baseMap&&(e.baseMap.elevationLayers=(0,_.d9)(n))}},{key:"_layersToJSON",value:function(e,t,n){var r=this,i=(0,o.Z)((0,o.Z)({},n),{},{layerContainerType:t});return e.map((function(e){return r._verifyWritableLayer(e,n)?e.write({},i):null})).filter((function(e){return!!e})).toArray()}},{key:"_verifyWritableLayer",value:function(e,t){return!!e.persistenceEnabled&&("write"in e||(null!==t&&void 0!==t&&t.messages&&t.messages.push(new Z.Z("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted in web scenes"),{layer:e})),!1))}},{key:"write",value:function(e,t){var n;if("loaded"!==this.loadStatus){var r=new Z.Z("webscene:not-loaded","Web scene must be loaded before it can be serialized");throw S.Z.getLogger(this).error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),r}this._runLayersIdGC();var i=!(null!==(n=t)&&void 0!==n&&n.messages);t=(0,o.Z)((0,o.Z)({messages:[]},t),{},{origin:"web-scene"});var a=(0,p.Z)((0,d.Z)(y.prototype),"write",this).call(this,e,t);if(i){var s,l,u=null!==(s=null===(l=t.messages)||void 0===l?void 0:l.filter((function(e){return"web-document-write:property-required"===e.name})))&&void 0!==s?s:[];if(u.length){var c=new Z.Z("web-document:property-required","One or more properties that are required in the webscene JSON are missing, see details for the specific errors",{errors:u});throw S.Z.getLogger(this).error("#toJSON()","One or more properties that are required in the webscene JSON are missing",u),c}}return this._writeBasemapElevationLayers(a),a}},{key:"save",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._debouncedSaveOperations(re.x.SAVE,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_saveImpl",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,i,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.portalItem){e.next=2;break}throw new Z.Z("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene");case 2:if((0,ae.w)(this.portalItem),(null===(n=this.portalItem)||void 0===n?void 0:n.type)===ht){e.next=4;break}throw new Z.Z("webscene:portal-item-wrong-type",'Portal item needs to have type "'.concat(ht,'"'));case 4:return r=this._updateFromPromise,e.next=7,this._ensureLoadBeforeSave();case 7:return i=this._enableVerifyItemRelativeUrls((0,H.Y)(this.portalItem,"web-scene",!0)),o=this.write({},i),e.next=10,Promise.all(i.resources.pendingOperations);case 10:return e.next=12,this._verifySave(o,i,t);case 12:return this._updateTypeKeywords(this.portalItem),e.next=15,(0,oe.b)(this.portalItem,o,this._resourceReferences,i);case 15:if((0,P.D)(i),e.t0=r,!e.t0){e.next=20;break}return e.next=20,r;case 20:return e.next=22,this._saveThumbnail();case 22:return e.abrupt("return",this.portalItem);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveAs",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._debouncedSaveOperations(re.x.SAVE_AS,n,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_saveAsImpl",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i,o,a,l,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=B.default.from(t)){e.next=3;break}throw new Z.Z("webscene:portal-item-required","saveAs requires a portal item to save to");case 3:return(0,ae.w)(r),r.id&&((r=r.clone()).id=null),i=r.portal||J.Z.getDefault(),e.next=7,this._ensureLoadBeforeSave();case 7:return r.type=ht,r.portal=i,o=this._enableVerifyItemRelativeUrls((0,H.Y)(r,"web-scene",!0)),a=this.write({},o),e.next=12,Promise.all(o.resources.pendingOperations);case 12:return e.next=14,this._verifySaveAs(a,o,n);case 14:return l=this.thumbnailUrl,u=!this._isOverridden("thumbnailUrl"),this._updateTypeKeywords(r),e.next=18,i.signIn();case 18:if(i.user){e.next=20;break}throw new Z.Z("webscene:user-not-signed-in","saveAs requires a user to be signed in to the portal");case 20:return e.next=22,i.user.addItem({item:r,folder:null===n||void 0===n?void 0:n.folder,data:a});case 22:return e.next=24,(0,oe.H)(this._resourceReferences,o);case 24:return this.portalItem=r,I.w.prototype.read.call(this,{version:a.version,authoringApp:a.authoringApp,authoringAppVersion:a.authoringAppVersion},{name:"web-scene",ignoreDefaults:!0,url:r.itemUrl?(0,T.mN)(r.itemUrl):void 0}),(0,P.D)(o),l&&(this.thumbnailUrl=u?(0,T.ZN)(l,"w","8192"):l),o.portalItem=r,e.next=31,this._saveThumbnail();case 31:return e.abrupt("return",r);case 32:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_saveThumbnail",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._isOverridden("thumbnailUrl"),!e.t0){e.next=6;break}return e.next=4,null===(t=this.portalItem)||void 0===t?void 0:t.updateThumbnail({thumbnail:this.thumbnailUrl});case 4:this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_verifySave",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n,r){var i,o,a,l,u,c,p,d,v,h=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=h.length>3&&void 0!==h[3]&&h[3],(0,F.N$)(this.spatialReference)){e.next=3;break}throw new Z.Z("webscene:unsupported-spatial-reference","Webscenes using spatial reference systems from Mars or Moon can not be saved currently.");case 3:if(a=(o=r||{}).ignoreUnsupported,l=o.requiredPropertyChecksDisabled,u=o.strictSchemaValidationEnabled,(0,se.z)(n,{errorName:"webscene:save"},{ignoreUnsupported:a,supplementalUnsupportedErrors:["scenemodification:unsupported"],requiredPropertyChecksDisabled:l}),c=dt(),!u||!c){e.next=16;break}return e.next=9,c();case 9:if((p=e.sent.validate(t)).length){e.next=12;break}return e.abrupt("return");case 12:throw d="webscene did not validate:\n".concat(p.join("\n")),S.Z.getLogger(this).error("".concat(i?"saveAs":"save","(): ").concat(d)),v=p.map((function(e){return new Z.Z("webscene:schema-validation",e)})),X(v);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_verifySaveAs",value:function(e,t,n){return this.canNotSaveAs(t)?Promise.reject(Q()):this._verifySave(e,t,n,!0)}},{key:"verifySaveAs",value:function(e){var t=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),n=this.write({},t);return this._verifySaveAs(n,t,e)}},{key:"canNotSaveAs",value:function(e){var t,n,r;return e||(e=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write({},e)),(null!==(t=null===(n=e.verifyItemRelativeUrls)||void 0===n||null===(r=n.writtenUrls)||void 0===r?void 0:r.length)&&void 0!==t?t:0)>0}},{key:"updateFrom",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=this._updateFrom(t,n),this._updateFromPromise=r,e.next=5,r;case 5:this._updateFromPromise===r&&(this._updateFromPromise=null);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateFrom",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,o,a,l,u,c,p,d,v,h=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.length>1&&void 0!==h[1]?h[1]:{},e.next=3,t.whenReady();case 3:if(!a.environmentExcluded&&t.environment&&(this.initialViewProperties.environment=he.Z.prototype.clone.apply(t.environment)),!a.viewpointExcluded&&t.viewpoint&&(this.initialViewProperties.viewpoint=t.viewpoint.clone()),this.initialViewProperties.spatialReference=t.spatialReference.clone(),this.initialViewProperties.viewingMode=t.viewingMode,this.initialViewProperties.timeExtent=null!==(n=null===(r=t.timeExtent)||void 0===r?void 0:r.clone())&&void 0!==n?n:null,null!=t.clippingArea?t.clippingArea!==this.clippingArea&&(this.clippingArea=t.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1,t.heightModelInfo&&(this.heightModelInfo=t.heightModelInfo.clone()),t.map!==this){e.next=13;break}l=(0,i.Z)(t.allLayerViews);try{for(l.s();!(u=l.n()).done;)c=u.value,(p="visible")in c&&p in c.layer&&c._isOverridden(p)&&(c.layer[p]=c[p])}catch(s){l.e(s)}finally{l.f()}case 13:if(!a.widgetsExcluded){d=(0,i.Z)(t.persistableViewModels);try{for(d.s();!(v=d.n()).done;)v.value.updateWebDocument(this)}catch(s){d.e(s)}finally{d.f()}}if(e.t0=!1===a.thumbnailExcluded||null==a.thumbnailExcluded&&!a.viewpointExcluded,!e.t0){e.next=18;break}return e.next=18,this._updateFromThumbnail(t,null!==(o=a.thumbnailSize)&&void 0!==o?o:void 0);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateFromThumbnail",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,n){var r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,le.w)(t,n),e.next=3,t.takeScreenshot({format:"jpg",width:r.width,height:r.height,disableDecorations:!0});case 3:i=e.sent,this.thumbnailUrl=i.dataUrl;case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_loadFromSource",value:function(){var e;return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-scene"}):null!==(e=this.portalItem)&&void 0!==e&&e.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()}},{key:"_readAndLoadFromJSON",value:function(e,t){var n=this._validateJSON(e);return this.read(n,t),this._loadFromJSON(n,t)}},{key:"_extractOperationalLayers",value:function(e){var t,n=this,r=[];if((null===(t=this.sourceVersion)||void 0===t||!t.supportsGround)&&e.baseMap&&Array.isArray(e.baseMap.elevationLayers)){var o,a=(0,i.Z)(e.baseMap.elevationLayers);try{for(a.s();!(o=a.n()).done;){var s=o.value;r.push(s)}}catch(u){a.e(u)}finally{a.f()}}var l=[];return{operationalLayers:e.operationalLayers?e.operationalLayers.filter((function e(t){var r;return t.layers&&(t.layers=t.layers.filter(e)),"ArcGISTiledElevationServiceLayer"!==t.layerType||(null!==(r=n.sourceVersion)&&void 0!==r&&r.supportsGround||l.push(t),!1)})):[],operationalElevationLayers:l,basemapElevationLayers:r}}},{key:"_loadFromJSON",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r){var i,a,l,u,c,p,d,v,h,y,f,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new b.Z,e.next=3,this._validateSpatialReference();case 3:return e.next=5,this._validateHeightModelInfo();case 5:return e.next=7,Promise.all([n.e(46727),n.e(43139),n.e(20519)]).then(n.bind(n,20519));case 7:return l=e.sent,u=l.populateOperationalLayers,c=this._extractOperationalLayers(t),p=c.operationalLayers,d=c.operationalElevationLayers,v=c.basemapElevationLayers,h=[],y={context:(0,o.Z)((0,o.Z)({},r),{},{layerContainerType:"operational-layers"})},this.portalItem&&(y.context.portal=this.portalItem.portal||J.Z.getDefault()),v.length>0&&((f=(0,o.Z)((0,o.Z)({},y),{},{context:(0,o.Z)((0,o.Z)({},y.context),{},{layerContainerType:"ground"})})).defaultLayerType="ArcGISTiledElevationServiceLayer",h.push(u(this.ground.layers,v,f))),d.length>0&&((m=(0,o.Z)((0,o.Z)({},y),{},{context:(0,o.Z)((0,o.Z)({},y.context),{},{layerContainerType:"ground"})})).defaultLayerType="ArcGISTiledElevationServiceLayer",h.push(u(a,d,m))),p&&p.length>0&&h.push(u(this.layers,p,y)),null!==(i=t.tables)&&void 0!==i&&i.length&&h.push(u(this.tables,t.tables,(0,o.Z)((0,o.Z)({},y),{},{context:(0,o.Z)((0,o.Z)({},y.context),{},{layerContainerType:"tables"}),defaultLayerType:"ArcGISFeatureLayer"}))),e.next=21,Promise.allSettled(h);case 21:return e.next=23,this._loadObjectsWithLayers();case 23:this.ground.layers.addMany(a.filter((function(e){return"base-elevation"===e.type||"elevation"===e.type})));case 24:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_ensureLoadBeforeSave",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var t,n,o,a,l,u,c,p,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.next=4,this._loadObjectsWithLayers();case 4:t=[],n=(0,r.Z)(this.allLayers.items),o=(0,i.Z)(this.presentation.slides.items);try{for(o.s();!(a=o.n()).done;)(l=a.value.basemap)&&(n.push.apply(n,(0,r.Z)(l.baseLayers.items)),n.push.apply(n,(0,r.Z)(l.referenceLayers.items)))}catch(s){o.e(s)}finally{o.f()}u=(0,i.Z)(n);try{for(u.s();!(c=u.n()).done;)"beforeSave"in(p=c.value)&&"function"==typeof p.beforeSave&&(d=p.beforeSave())&&t.push(d)}catch(s){u.e(s)}finally{u.f()}return e.next=11,Promise.allSettled(t);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadObjectsWithLayers",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.ground&&t.push(this.ground.load()),this.basemap&&t.push(this.basemap.load()),this.presentation.slides.forEach((function(e){e.basemap&&t.push(e.basemap.load())})),e.next=6,Promise.allSettled(t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadFromItem",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var n,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load().catch((function(e){throw new Z.Z("webscene:load-portal-item","Failed to load portal item",{error:e})}));case 2:if("Web Scene"===t.type){e.next=4;break}throw new Z.Z("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:t.type});case 4:return e.next=6,t.fetchData();case 6:return r=e.sent,this.resourceInfo=r,i={origin:"web-scene",url:(0,T.mN)(t.itemUrl),portal:t.portal||J.Z.getDefault(),portalItem:t,readResourcePaths:[]},e.next=11,this._readAndLoadFromJSON(r,i);case 11:this._resourceReferences={portalItem:t,paths:null!==(n=i.readResourcePaths)&&void 0!==n?n:[]};case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_validateSpatialReference",value:function(){var e,t=this.initialViewProperties,n=this._sceneSpatialReference;if("local"!==t.viewingMode){if(!(0,ne.D)(n,te.JY.Global))return Promise.reject(new Z.Z("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported",{spatialReference:n,viewingMode:t.viewingMode}));e=function(e){return!e||(0,q.canProjectWithoutEngine)(e,n)}}else{if(!(0,ne.D)(n,te.JY.Local))return Promise.reject(new Z.Z("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",{spatialReference:n,viewingMode:t.viewingMode}));e=function(e){return!e||e.equals(n)}}var r=function(e){var t,n,r;return null!==(t=null===e||void 0===e||null===(n=e.camera)||void 0===n?void 0:n.position.spatialReference)&&void 0!==t?t:null===e||void 0===e||null===(r=e.targetGeometry)||void 0===r?void 0:r.spatialReference},i=t.viewpoint,o=r(i);if(o&&!e(o))return Promise.reject(new Z.Z("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:o,sceneSpatialReference:n,viewingMode:t.viewingMode}));var a=this.presentation.slides.find((function(t){return!e(r(t.viewpoint))}));if(a){var s=r(a.viewpoint);return Promise.reject(new Z.Z("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{slideSpatialReference:s,sceneSpatialReference:n,viewingMode:t.viewingMode}))}return Promise.resolve()}},{key:"_validateHeightModelInfo",value:function(){var e=this._sceneSpatialReference,t=(0,W.vu)(this.heightModelInfo,e);return t?Promise.reject(t):Promise.resolve()}},{key:"_validateJSON",value:function(e){var t=ct.parse(e.version||"","webscene");return vt.validate(t),e.version="".concat(t.major,".").concat(t.minor),1===t.major&&t.minor<=2&&(e.spatialReference=G.Z.WebMercator.toJSON()),e}},{key:"_updateTypeKeywords",value:function(e){(0,z.IW)(e,z.hz.LOCAL_SCENE,"local"===this.initialViewProperties.viewingMode),(0,z.IW)(e,z.hz.DEVELOPER_BASEMAP,(0,$.zb)(this.basemap)||this.presentation.slides.some((function(e){var t=e.basemap;return!!t&&(0,$.zb)(t)}))),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((function(e,t,n){return n.indexOf(e)===t})))}},{key:"_sceneSpatialReference",get:function(){return this.initialViewProperties.spatialReference||G.Z.WebMercator}},{key:"_verifyItemRelativeRootPath",get:function(){var e;return null!==(e=this.portalItem)&&void 0!==e&&e.itemUrl?(0,T.mN)(this.portalItem.itemUrl).path:null}},{key:"_enableVerifyItemRelativeUrls",value:function(e){var t=this._verifyItemRelativeRootPath;return t&&(e.verifyItemRelativeUrls={rootPath:t,writtenUrls:[]}),e}},{key:"_unscheduleLayersIdGC",value:function(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)}},{key:"_scheduleLayersIdGC",value:function(){var e=this;this._unscheduleLayersIdGC(),this._layersIdGCTimeoutId=setTimeout((function(){e._layersIdGCTimeoutId=0,e._runLayersIdGC()}),3e3)}},{key:"_runLayersIdGC",value:function(){var e,t,n=this;this._unscheduleLayersIdGC();var r=null===(e=this.applicationProperties)||void 0===e||null===(t=e.viewing)||void 0===t?void 0:t.search,i=function(e){return n.allLayers.some((function(t){return t.id===e&&t.persistenceEnabled}))};(null===r||void 0===r?void 0:r.layers)&&(r.layers=r.layers.filter((function(e){return i(e.id)})));var o=this.presentation&&this.presentation.slides;o&&o.forEach((function(e){e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((function(e){return i(e.id)})))}))}}],[{key:"fromJSON",value:function(e){if(!e)throw new Z.Z("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}}]),y}(k.Z.LoadableMixin((0,L.v)((0,I.R)(m.Z))));lt=Y.x,yt.version="".concat(vt.major,".").concat(vt.minor),(0,y._)([(0,j.Cb)({type:ve,json:{write:!0}})],yt.prototype,"applicationProperties",void 0),(0,y._)([(0,j.Cb)({type:V.Z,json:{read:{source:"clippingArea.geometry",reader:D.im},write:{target:"clippingArea.geometry"}}})],yt.prototype,"clippingArea",void 0),(0,y._)([(0,U.c)("clippingArea")],yt.prototype,"writeClippingArea",null),(0,y._)([(0,j.Cb)({type:Boolean,json:{write:{target:"clippingArea.clip"}}})],yt.prototype,"clippingEnabled",void 0),(0,y._)([(0,M.r)("clippingEnabled",["clippingArea"])],yt.prototype,"readClippingEnabled",null),(0,y._)([(0,U.c)("clippingEnabled")],yt.prototype,"writeClippingEnabled",null),(0,y._)([(0,j.Cb)({type:K.Z,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],yt.prototype,"floorInfo",void 0),(0,y._)([(0,j.Cb)({type:N.Z,json:{write:!0}})],yt.prototype,"heightModelInfo",void 0),(0,y._)([(0,j.Cb)({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],yt.prototype,"layers",void 0),(0,y._)([(0,U.c)("layers")],yt.prototype,"writeLayers",null),(0,y._)([(0,j.Cb)({readOnly:!0,type:ct,json:{type:function(){for(var e=[],t=vt.major,n=8;n<=vt.minor;n++)e.push("".concat(t,".").concat(n));return e}(),write:{ignoreOrigin:!0,target:"version",isRequired:!0,overridePolicy:function(){return{enabled:!0,allowNull:!0,ignoreOrigin:!0}}}}})],yt.prototype,"sourceVersion",void 0),(0,y._)([(0,M.r)("sourceVersion",["version"])],yt.prototype,"readSourceVersion",null),(0,y._)([(0,U.c)("sourceVersion")],yt.prototype,"writeSourceVersion",null),(0,y._)([(0,j.Cb)({json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],yt.prototype,"tables",void 0),(0,y._)([(0,U.c)("tables")],yt.prototype,"writeTables",null),(0,y._)([(0,j.Cb)()],yt.prototype,"thumbnailUrl",null),(0,y._)([(0,j.Cb)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],yt.prototype,"authoringApp",null),(0,y._)([(0,U.c)("authoringApp")],yt.prototype,"writeAuthoringApp",null),(0,y._)([(0,j.Cb)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],yt.prototype,"authoringAppVersion",null),(0,y._)([(0,U.c)("authoringAppVersion")],yt.prototype,"writeAuthoringAppVersion",null),(0,y._)([(0,j.Cb)({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],yt.prototype,"ground",void 0),(0,y._)([(0,U.c)("ground")],yt.prototype,"writeGround",null),(0,y._)([(0,j.Cb)({type:b.Z.ofType(ut),json:{write:!0}})],yt.prototype,"transportationNetworks",void 0),(0,y._)([(0,j.Cb)({type:at,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:function(e,t,n,r){if(e.slides&&e.slides.length>0){var i=(0,o.Z)((0,o.Z)({},r),{},{isPresentation:!0});t.presentation=e.write({},i)}}}}})],yt.prototype,"presentation",void 0),(0,y._)([(0,j.Cb)({type:we,nonNullable:!0,json:{write:{target:"initialState",isRequired:!0,ignoreOrigin:!0},default:function(){return new we({viewingMode:"global",spatialReference:G.Z.WebMercator})}}})],yt.prototype,"initialViewProperties",void 0),(0,y._)([(0,M.r)("initialViewProperties",["initialState.timeExtent","initialState.environment","initialState.viewpoint","spatialReference","viewingMode"])],yt.prototype,"readInitialViewProperties",null),(0,y._)([(0,j.Cb)({type:G.Z,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],yt.prototype,"spatialReference",null),(0,y._)([(0,j.Cb)({type:["local","global"],json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],yt.prototype,"viewingMode",null),(0,y._)([(0,j.Cb)({type:B.default})],yt.prototype,"portalItem",void 0),(0,y._)([(0,j.Cb)()],yt.prototype,"resourceInfo",void 0),(0,y._)([(0,j.Cb)({type:ie.Z,json:{write:!0}})],yt.prototype,"widgets",void 0);var ft=yt=(0,y._)([(0,R.j)("esri.WebScene")],yt)},76432:function(e,t,n){n.d(t,{t:function(){return u}});var r=n(15671),i=n(43144),o=n(84652),a=n(39052),s=n(56885),l=function(){function e(t,n){(0,r.Z)(this,e),this._observable=new s.s,this._value=t,this._equalityFunction=n}return(0,i.Z)(e,[{key:"value",get:function(){return(0,a.it)(this._observable),this._value},set:function(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}},{key:"mutate",value:function(e){e(this._value),this._observable.notify()}}]),e}();function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.y7;return new l(e,t)}},5354:function(e,t,n){n.d(t,{Ku:function(){return d},Wt:function(){return u},qC:function(){return f},vu:function(){return l}});n(93169);var r,i,o=n(10064),a=n(90724),s=n(25899);function l(e,t){if(!e)return null;if(!p(e))return new o.Z("webscene:unsupported-height-model-info","The vertical coordinate system of the scene is not supported",{heightModelInfo:e});var n=e.heightUnit,r=a.Z.deriveUnitFromSR(e,t).heightUnit;return n!==r?new o.Z("webscene:incompatible-height-unit","The vertical units of the scene (".concat(n,") must match the horizontal units of the scene (").concat(r,")"),{verticalUnit:n,horizontalUnit:r}):null}function u(e,t,n){var i,s=d(e),l=t,u=c(s,l,n);if(s){var p=a.Z.deriveUnitFromSR(s,e.spatialReference).heightUnit;if(!n&&p!==s.heightUnit){var v=new o.Z("layerview:unmatched-height-unit","The vertical units of the layer must match the horizontal units (".concat(p,")"),{horizontalUnit:p});return new o.Z("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:s,error:v})}}if(!("heightModelInfo"in(i=e)&&null!=i.heightModelInfo||null!=i.spatialReference)&&y(i)||u===r.Unsupported)return new o.Z("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:s});switch(u){case r.Units:var h=(null===s||void 0===s?void 0:s.heightUnit)||"unknown",f=(null===l||void 0===l?void 0:l.heightUnit)||"unknown",m=new o.Z("layerview:incompatible-height-unit","The vertical units of the layer (".concat(h,") must match the vertical units of the scene (").concat(f,")"),{layerUnit:h,sceneUnit:f});return new o.Z("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:s,sceneHeightModelInfo:l,error:m});case r.HeightModel:var w=(null===s||void 0===s?void 0:s.heightModel)||"unknown",g=(null===l||void 0===l?void 0:l.heightModel)||"unknown",b=new o.Z("layerview:incompatible-height-model","The height model of the layer (".concat(w,") must match the height model of the scene (").concat(g,")"),{layerHeightModel:w,sceneHeightModel:g});return new o.Z("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:s,sceneHeightModelInfo:l,error:b});case r.CRS:var Z=(null===s||void 0===s?void 0:s.vertCRS)||"unknown",_=(null===l||void 0===l?void 0:l.vertCRS)||"unknown",k=new o.Z("layerview:incompatible-vertical-datum","The vertical datum of the layer (".concat(Z,") must match the vertical datum of the scene (").concat(_,")"),{layerDatum:Z,sceneDatum:_});return new o.Z("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:s,sceneHeightModelInfo:l,error:k})}return null}function c(e,t,n){if(!p(e)||!p(t))return r.Unsupported;if(null==e||null==t)return r.Ok;if(!n&&e.heightUnit!==t.heightUnit)return r.Units;if(e.heightModel!==t.heightModel)return r.HeightModel;switch(e.heightModel){case"gravity-related-height":return r.Ok;case"ellipsoidal":return e.vertCRS===t.vertCRS?r.Ok:r.CRS;default:return r.Unsupported}}function p(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function d(e){var t;if("integrated-mesh-3dtiles"===e.type)return null;var n=e.url?(0,s.Qc)(e.url):void 0;return(null!=(null===(t=e.spatialReference)||void 0===t?void 0:t.vcsWkid)||null==n||"ImageServer"!==n.serverType)&&v(e)&&e.heightModelInfo?e.heightModelInfo:y(e)?a.Z.deriveUnitFromSR(w,e.spatialReference):null}function v(e){return"heightModelInfo"in e}function h(e){if("unknown"===e.type||!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function y(e){return h(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):m(e)}function f(e){return null!=e.layers||m(e)||h(e)||v(e)}function m(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(i=r||(r={}))[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported";var w=new a.Z({heightModel:"gravity-related-height"})},83217:function(e,t,n){n.d(t,{x:function(){return r}});var r=Symbol("WebScene")},90868:function(e,t,n){n.d(t,{Z:function(){return h}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(27135)),d=n(69912),v=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="cloudy",r.cloudCover=.5,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r({cloudCover:this.cloudCover})}}]),n}(u.wq);(0,l._)([(0,p.J)({cloudy:"cloudy"})],v.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"cloudCover",void 0);var h=v=r=(0,l._)([(0,d.j)("esri.views.3d.environment.CloudyWeather")],v)},89110:function(e,t,n){n.d(t,{Z:function(){return h}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(27135)),d=n(69912),v=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="foggy",r.fogStrength=.5,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r({fogStrength:this.fogStrength})}}]),n}(u.wq);(0,l._)([(0,p.J)({foggy:"foggy"})],v.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"fogStrength",void 0);var h=v=r=(0,l._)([(0,d.j)("esri.views.3d.environment.FoggyWeather")],v)},61052:function(e,t,n){n.d(t,{Z:function(){return h}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(27135)),d=n(69912),v=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="rainy",r.cloudCover=.5,r.precipitation=.5,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r({cloudCover:this.cloudCover,precipitation:this.precipitation})}}]),n}(u.wq);(0,l._)([(0,p.J)({rainy:"rainy"})],v.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"cloudCover",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"precipitation",void 0);var h=v=r=(0,l._)([(0,d.j)("esri.views.3d.environment.RainyWeather")],v)},37063:function(e,t,n){n.d(t,{Z:function(){return h}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(27135)),d=n(69912),v=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="snowy",r.cloudCover=.5,r.precipitation=.5,r.snowCover="disabled",r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}}]),n}(u.wq);(0,l._)([(0,p.J)({snowy:"snowy"})],v.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"cloudCover",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"precipitation",void 0),(0,l._)([(0,c.Cb)({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],v.prototype,"snowCover",void 0);var h=v=r=(0,l._)([(0,d.j)("esri.views.3d.environment.SnowyWeather")],v)},3389:function(e,t,n){n.d(t,{Z:function(){return h}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(27135)),d=n(69912),v=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="sunny",r.cloudCover=.5,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r({cloudCover:this.cloudCover})}}]),n}(u.wq);(0,l._)([(0,p.J)({sunny:"sunny"})],v.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"cloudCover",void 0);var h=v=r=(0,l._)([(0,d.j)("esri.views.3d.environment.SunnyWeather")],v)},50902:function(e,t,n){n.d(t,{$T:function(){return d},Hr:function(){return l},T$:function(){return u},b8:function(){return c},nq:function(){return p}});var r=n(90868),i=n(89110),o=n(61052),a=n(37063),s=n(3389),l={key:"type",base:s.Z,typeMap:{sunny:s.Z,cloudy:r.Z,rainy:o.Z,snowy:a.Z,foggy:i.Z}},u=Object.keys(l.typeMap);function c(e,t){return!!u.includes(e)||(t.error('"'.concat(e,'" is not a valid weather type')),!1)}var p=1e4,d=1e5},50951:function(e,t,n){var r;function i(e){return"global"===e?r.Global:r.Local}function o(e){return e===r.Global?"global":"local"}n.d(t,{JY:function(){return r},M7:function(){return o},wg:function(){return i}}),function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"}(r||(r={}))},92028:function(e,t,n){n.d(t,{D:function(){return o}});var r=n(72619),i=n(50951);function o(e,t){return null!=e&&(null==t||(t===i.JY.Local?!e.isGeographic||e.isWGS84||e.wkid===r.W.CGCS2000:e.isWebMercator||e.isWGS84||e.wkid===r.W.CGCS2000||e.wkid===r.W.GCSMARS2000||e.wkid===r.W.GCSMARS2000_SPHERE||e.wkid===r.W.GCSMOON2000))}},9634:function(e,t,n){n.d(t,{P:function(){return s},z:function(){return c}});var r=n(74165),i=n(37762),o=n(15861),a=n(10064);function s(e){return l.apply(this,arguments)}function l(){return l=(0,o.Z)((0,r.Z)().mark((function e(t){var n,o,a,s,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=(0,i.Z)(t.allLayers);try{for(o.s();!(a=o.n()).done;)"beforeSave"in(s=a.value)&&"function"==typeof s.beforeSave&&(l=s.beforeSave())&&n.push(l)}catch(r){o.e(r)}finally{o.f()}return e.next=5,Promise.allSettled(n);case 5:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var u=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function c(e,t,n){var r,i=(null!==(r=e.messages)&&void 0!==r?r:[]).filter((function(e){return"error"===e.type})).map((function(e){var t=e.name,n=e.message,r=e.details;return new a.Z(t,n,r)}));if(e.blockedRelativeUrls&&(i=i.concat(e.blockedRelativeUrls.map((function(e){return new a.Z("url:unsupported","Relative url '".concat(e,"' is not supported"))})))),n){var o=n.ignoreUnsupported,s=n.supplementalUnsupportedErrors,l=void 0===s?[]:s,c=n.requiredPropertyChecksDisabled;o&&(i=i.filter((function(e){var t=e.name;return!(u.has(t)||l.includes(t))}))),c&&(i=i.filter((function(e){return"web-document-write:property-required"!==e.name})))}if(i.length>0)throw new a.Z(t.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:i})}},21147:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(15671),i=n(43144),o=n(60136),a=n(29388),s=n(27366),l=n(46784),u=n(84652),c=n(32718),p=n(49861),d=(n(93169),n(69912)),v=n(3389),h=n(50902),y=n(23548),f=n(18814),m=n(67808),w=n(2581),g=n(13910),b={base:w.Z,key:"type",typeMap:{color:g.Z}};var Z,_,k={types:b,json:{read:(Z=b,function(e,t,n){if(!e)return e;for(var r in Z.typeMap)if(e.type===r){var i=new Z.typeMap[r];return i.read(e,n),i}}),write:{overridePolicy:function(e,t,n){return{enabled:!(null!==n&&void 0!==n&&n.isPresentation)}}}}},C=function(e,t,n){return{enabled:!(null!==n&&void 0!==n&&n.isPresentation)}},S=_=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).lighting=new f.Z,i.background=null,i.atmosphereEnabled=!0,i.starsEnabled=!0,i}return(0,i.Z)(n,[{key:"weather",set:function(e){(0,h.b8)(null===e||void 0===e?void 0:e.type,c.Z.getLogger(this))&&this._set("weather",e)}},{key:"clone",value:function(){return new _(this.cloneConstructProperties())}},{key:"cloneConstructProperties",value:function(){return{lighting:this.lighting&&"virtual"===this.lighting.type?m.Z.prototype.clone.call(this.lighting):f.Z.prototype.clone.call(this.lighting),background:(0,u.d9)(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,weather:this.weather.clone()}}}]),n}(l.wq);(0,s._)([(0,p.Cb)({types:y.j,nonNullable:!0,json:{write:!0}})],S.prototype,"lighting",void 0),(0,s._)([(0,p.Cb)(k)],S.prototype,"background",void 0),(0,s._)([(0,p.Cb)({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:C}}})],S.prototype,"atmosphereEnabled",void 0),(0,s._)([(0,p.Cb)({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:C}}})],S.prototype,"starsEnabled",void 0),(0,s._)([(0,p.Cb)({types:h.Hr,nonNullable:!0,json:{write:!0},value:new v.Z})],S.prototype,"weather",null);var x=S=_=(0,s._)([(0,d.j)("esri.webscene.Environment")],S)},18814:function(e,t,n){n.d(t,{Z:function(){return y}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(38511)),d=n(69912),v=n(31201),h=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="sun",r.date=null,r.directShadowsEnabled=!1,r.displayUTCOffset=null,r}return(0,o.Z)(n,[{key:"readDate",value:function(e,t){return null!=t.datetime&&new Date(t.datetime)||null}},{key:"writeDate",value:function(e,t,n){t[n]=e.getTime()}},{key:"readDirectShadowsEnabled",value:function(e,t){return!!t.directShadows}},{key:"writedirectShadowsEnabled",value:function(e,t,n){e&&(t[n]=e)}},{key:"writeDisplayUTCOffset",value:function(e,t){null!=e&&(t.displayUTCOffset=e)}},{key:"clone",value:function(){return new r(this.cloneConstructProperties())}},{key:"cloneConstructProperties",value:function(){var e={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null};return null!=this.date&&(e.date=new Date(this.date.getTime())),e}}]),n}(u.wq);(0,l._)([(0,c.Cb)({readOnly:!0,type:["sun"],json:{write:!0}})],h.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Date,json:{type:Number,write:{target:"datetime"}}})],h.prototype,"date",void 0),(0,l._)([(0,p.r)("date",["datetime"])],h.prototype,"readDate",null),(0,l._)([(0,v.c)("date")],h.prototype,"writeDate",null),(0,l._)([(0,c.Cb)({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],h.prototype,"directShadowsEnabled",void 0),(0,l._)([(0,p.r)("directShadowsEnabled",["directShadows"])],h.prototype,"readDirectShadowsEnabled",null),(0,l._)([(0,v.c)("directShadowsEnabled")],h.prototype,"writedirectShadowsEnabled",null),(0,l._)([(0,c.Cb)({type:Number,json:{write:!0}})],h.prototype,"displayUTCOffset",void 0),(0,l._)([(0,v.c)("displayUTCOffset")],h.prototype,"writeDisplayUTCOffset",null);var y=h=r=(0,l._)([(0,d.j)("esri.webscene.SunLighting")],h)},67808:function(e,t,n){n.d(t,{Z:function(){return v}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(27366),u=n(46784),c=n(49861),p=(n(93169),n(32718),n(84936),n(69912)),d=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="virtual",r.directShadowsEnabled=!1,r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r(this.cloneConstructProperties())}},{key:"cloneConstructProperties",value:function(){return{directShadowsEnabled:this.directShadowsEnabled}}}]),n}(u.wq);(0,l._)([(0,c.Cb)({readOnly:!0,type:["virtual"],json:{write:!0}})],d.prototype,"type",void 0),(0,l._)([(0,c.Cb)({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],d.prototype,"directShadowsEnabled",void 0);var v=d=r=(0,l._)([(0,p.j)("esri.webscene.VirtualLighting")],d)},2581:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(15671),i=n(43144),o=n(60136),a=n(29388),s=n(27366),l=n(46784),u=n(49861),c=(n(93169),n(32718),n(84936),n(69912)),p=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){return(0,r.Z)(this,n),t.call(this,e)}return(0,i.Z)(n,[{key:"clone",value:function(){throw new Error("Subclasses of Background should implement their own clone method.")}}]),n}(l.wq);(0,s._)([(0,u.Cb)({readOnly:!0,json:{read:!1}})],p.prototype,"type",void 0);var d=p=(0,s._)([(0,c.j)("esri.webscene.background.Background")],p)},13910:function(e,t,n){n.d(t,{Z:function(){return w}});var r,i=n(15671),o=n(43144),a=n(60136),s=n(29388),l=n(1413),u=n(27366),c=n(51995),p=n(49861),d=(n(93169),n(32718),n(84936),n(27135)),v=n(69912),h=n(70271),y=n(2581),f=(0,l.Z)((0,l.Z)({},h.a),{},{nonNullable:!0}),m=r=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).type="color",r.color=new c.Z([0,0,0,1]),r}return(0,o.Z)(n,[{key:"clone",value:function(){return new r(this.cloneProperties())}},{key:"cloneProperties",value:function(){return{color:this.color.clone()}}}]),n}(y.Z);(0,u._)([(0,d.J)({color:"color"},{readOnly:!0})],m.prototype,"type",void 0),(0,u._)([(0,p.Cb)(f)],m.prototype,"color",void 0);var w=m=r=(0,u._)([(0,v.j)("esri.webscene.background.ColorBackground")],m)},23548:function(e,t,n){n.d(t,{j:function(){return o}});var r=n(18814),i=n(67808),o={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:r.Z,virtual:i.Z}}}}]);
//# sourceMappingURL=1617.ec5c4849.chunk.js.map