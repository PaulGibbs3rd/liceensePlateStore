"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[38856],{87072:function(e,t,n){function r(e){var t,n=e.layer;return"floorInfo"in n&&null!==(t=n.floorInfo)&&void 0!==t&&t.floorField&&"floors"in e.view?a(e.view.floors,n.floorInfo.floorField):null}function i(e,t){var n;return"floorInfo"in t&&null!==(n=t.floorInfo)&&void 0!==n&&n.floorField?a(e,t.floorInfo.floorField):null}function a(e,t){if(null===e||void 0===e||!e.length)return null;var n=e.filter((function(e){return""!==e})).map((function(e){return"'".concat(e,"'")}));return n.push("''"),"".concat(t," IN (").concat(n.join(","),") OR ").concat(t," IS NULL")}n.d(t,{c:function(){return r},f:function(){return i}})},87888:function(e,t,n){n.d(t,{G7:function(){return v},Kj:function(){return d},Lk:function(){return p},Sn:function(){return f},T6:function(){return h}});var r=n(37762),i=n(15671),a=n(43144),o=n(63780),u=n(42537),s=n(77427),l=n(1614),c=n(67750),f={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},d={toggle:"Control"},h={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},p={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:c.C,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:"z",redo:"r"},v=function(){function e(){(0,i.Z)(this,e),this._bindings=new Map}return(0,a.Z)(e,[{key:"add",value:function(e,t){return this.addToggle(e,(function(e){"key-down"===e.type&&t(e)}))}},{key:"addToggle",value:function(e,t){var n=y.fromDefinition(e,t),r=(0,s.s1)(this._bindings,n.key,(function(){return[]}));return r.push(n),(0,u.kB)((function(){return(0,o.Od)(r,n)}))}},{key:"register",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.f.WIDGET;return(0,u.AL)([e.on("key-down",(function(n){return t.dispatch(e.inputManager,n)}),n),e.on("key-up",(function(n){return t.dispatch(e.inputManager,n)}),n)])}},{key:"dispatch",value:function(e,t){var n=t.key,i=this._bindings.get(n);if(i){var a,o=(0,r.Z)(i);try{for(o.s();!(a=o.n()).done;){a.value.process(e,t)}}catch(u){o.e(u)}finally{o.f()}}}}]),e}(),y=function(){function e(t,n,r,a,o){(0,i.Z)(this,e),this.key=t,this.modifiers=n,this.repeats=r,this.continuePropagation=a,this.callback=o}return(0,a.Z)(e,[{key:"process",value:function(e,t){if(!(t.key!==this.key||"repeat"in t&&t.repeat&&!this.repeats)){var n,i=(0,r.Z)(this.modifiers);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(!e.isModifierKeyDown(a))return}}catch(o){i.e(o)}finally{i.f()}this.continuePropagation||t.stopPropagation(),this.callback(t)}}}],[{key:"fromDefinition",value:function(t,n){if("string"==typeof t)return new e(t,[],!1,!1,n);var r=t.key,i=t.modifier,a=t.repeats,o=t.continuePropagation;return new e(r,i?Array.isArray(i)?i:[i]:[],!!a,!!o,n)}}]),e}()},44179:function(e,t,n){n.d(t,{Hk:function(){return x},M8:function(){return B},SP:function(){return F},Vy:function(){return J},aU:function(){return D},f2:function(){return le},jg:function(){return G},kt:function(){return C},ku:function(){return L},lY:function(){return X},wp:function(){return fe}});var r=n(29439),i=n(37762),a=n(60136),o=n(29388),u=n(15671),s=n(43144),l=n(63780),c=n(16889),f=n(13611),d=n(6644),h=n(32035),p=n(12400),v=n(19093),y=n(86361),g=n(38516),b=n(15559),_=n(55652),Z=n(23470),S=n(80064),w=n(38054),E=n(55793),m=n(94163),k=function(){function e(){(0,u.Z)(this,e)}return(0,s.Z)(e,[{key:"intersect",value:function(e){return W(this,e)}},{key:"closestPoints",value:function(e){return[this.closestTo(e)]}}]),e}(),x=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).point=e,r}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||fe(e)&&(0,h.e)(this.point,e.point)}},{key:"closestTo",value:function(){return(0,w.d9)(this.point)}}]),n}(k),R=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),(a=t.call(this)).start=e,a.end=r,a.lineLike={start:e,end:r,type:i},a}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||de(e)&&this.lineLike.type===e.lineLike.type&&(0,h.e)(this.start,e.start)&&(0,h.e)(this.end,e.end)}},{key:"closestTo",value:function(e){var t=(0,w.by)();return(0,E.ZE)(e,this.lineLike,t),t}}]),n}(k),L=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,u.Z)(this,n),t.call(this,e,r,m.SP.LINE)}return(0,s.Z)(n)}(R),T=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,u.Z)(this,n),t.call(this,e,r,m.SP.RAY)}return(0,s.Z)(n)}(R),P=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).constraints=e,r}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||ce(e)&&(0,l.fS)(this.constraints,e.constraints,(function(e,t){return e.equals(t)}))}},{key:"closestTo",value:function(e){var t,n,r,a=1/0,o=(0,i.Z)(this.constraints);try{for(o.s();!(r=o.n()).done;){var u=r.value.closestTo(e),s=(0,h.a)(e,u);s<a&&(a=s,n=u)}}catch(l){o.e(l)}finally{o.f()}return(0,w.d9)(null!==(t=n)&&void 0!==t?t:e)}},{key:"closestPoints",value:function(e){var t=this;return this.constraints.flatMap((function(n){return n===t?[]:n.closestPoints(e)}))}}]),n}(k),C=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this)).center=e,i.radius=r,i}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||ve(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}},{key:"closestTo",value:function(e){var t=(0,w.by)();return(0,E.sc)(e,this.center,this.radius,t),t}}]),n}(k),N=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this)).center=e,i.radius=r,i}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||ye(e)&&(0,h.e)(this.center,e.center)&&this.radius===e.radius}},{key:"closestTo",value:function(e){var t=(0,w.by)();return(0,E.sc)(e,this.center,this.radius,t),t[2]=this.center[2],t}},{key:"asCircle",value:function(){return new A((0,w.d9)(this.center),this.radius,(0,w.al)(0,0,1))}}]),n}(k),A=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;return(0,u.Z)(this,n),(a=t.call(this)).center=e,a.radius=r,a.normal=i,a.slicePlane=o,a}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||ge(e)&&(0,h.e)(this.center,e.center)&&(0,h.e)(this.normal,e.normal)&&this.radius===e.radius}},{key:"closestTo",value:function(e){var t=this.center,n=this.radius;(0,_.nF)(this.getPlane(j),e,M);var r=(0,h.z)(M,M,t),i=(0,h.q)(r);if((0,E.hA)(i,0))return(0,w.d9)(e);var a=n/Math.sqrt(i),o=(0,w.by)();(0,h.r)(o,t,r,a);var u=this.slicePlane;if(u&&!(0,E.zf)(u,o)){var s,l=ee(u,this);return null!==(s=null===l||void 0===l?void 0:l.closestTo(e))&&void 0!==s?s:(0,w.d9)(e)}return o}},{key:"getPlane",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,_.Ue)();return(0,_.Yq)(this.center,this.normal,e)}}]),n}(k),M=(0,p.Ue)(),j=(0,_.Ue)(),F=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).z=e,r}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||he(e)&&this.z===e.z}},{key:"closestTo",value:function(e){return(0,w.al)(e[0],e[1],this.z)}},{key:"getPlane",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,_.Ue)();return(0,h.s)(I,0,0,this.z),(0,_.Yq)(I,p.eG,e)}}]),n}(k),I=(0,p.Ue)(),U=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),(a=t.call(this)).start=e,a.end=r,a.planeLike={start:(0,w.eR)(e),end:(0,w.eR)(r),type:i},a}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||pe(e)&&this.planeLike.type===e.planeLike.type&&(0,h.e)(this.start,e.start)&&(0,h.e)(this.end,e.end)}},{key:"closestTo",value:function(e){var t=(0,w.by)();return(0,E.z9)(e,this.planeLike,t),t}},{key:"closestEndTo",value:function(e){var t=this.planeLike,n=t.start,r=t.end;return Math.sign((0,f.AK)((0,f.$X)(V,r,n),(0,f.$X)(z,(0,w.eR)(e),n)))>0?this.end:this.start}},{key:"getPlane",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,_.Ue)(),t=(0,h.c)(O,this.end);return t[2]+=1,(0,_.zk)(this.start,this.end,t,e)}},{key:"getSlicePlane",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,_.Ue)(),t=this.planeLike,n=t.start,r=t.end,i=t.type;if(i!==E.Jk.PLANE){var a=(0,h.s)(O,n[0],n[1],0),o=(0,h.s)(q,r[0],r[1],0),u=(0,h.f)(q,o,a);return(0,_.Yq)(a,u,e),e}}}]),n}(k),V=(0,d.Ue)(),z=(0,d.Ue)(),O=(0,p.Ue)(),q=(0,p.Ue)(),D=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,u.Z)(this,n),t.call(this,e,r,E.Jk.HALF_PLANE)}return(0,s.Z)(n)}(U),G=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,u.Z)(this,n),t.call(this,e,r,E.Jk.PLANE)}return(0,s.Z)(n)}(U),H=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i;return(0,u.Z)(this,n),(i=t.call(this)).sphere=(0,Z.k)(e,r),i}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||be(e)&&(0,Z.l)(this.sphere,e.sphere)}},{key:"closestTo",value:function(e){var t=(0,w.by)();return(0,Z.p)(this.sphere,e,t),t}},{key:"center",get:function(){return(0,Z.g)(this.sphere)}},{key:"radius",get:function(){return this.sphere[3]}}]),n}(k),B=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),(a=t.call(this)).start=e,a.end=r,a.getZ=i,a.planeLike={start:(0,w.eR)(e),end:(0,w.eR)(r),type:E.Jk.PLANE},a}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||_e(e)&&(0,h.e)(this.start,e.start)&&(0,h.e)(this.end,e.end)&&this.getZ===e.getZ}},{key:"closestTo",value:function(e){return function(e,t){var n,r=(0,w.by)();return(0,E.z9)(t,e.planeLike,r),r[2]=null!==(n=e.getZ(r[0],r[1]))&&void 0!==n?n:we,r}(this,e)}},{key:"addIfOnTheGround",value:function(e,t){var n,r=(0,i.Z)(t);try{for(r.s();!(n=r.n()).done;){var a,o=n.value,u=null!==(a=this.getZ(o[0],o[1]))&&void 0!==a?a:0;(0,E.hA)(o[2],u)&&(o[2]=u,e.push(o))}}catch(s){r.e(s)}finally{r.f()}}}]),n}(k),X=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i){var a;return(0,u.Z)(this,n),(a=t.call(this))._x=e,a._y=r,a._z=i,a}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||Se(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}},{key:"closestTo",value:function(e){var t,n,i,a=(0,r.Z)(e,3),o=a[0],u=a[1],s=a[2];return(0,w.Ue)(null!==(t=this._x)&&void 0!==t?t:o,null!==(n=this._y)&&void 0!==n?n:u,null!==(i=this._z)&&void 0!==i?i:s)}}]),n}(k),J=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,r,i,a,o){var s;return(0,u.Z)(this,n),(s=t.call(this))._origin=e,s._spatialReference=r,s._distanceMeters=i,s._elevationMeters=a,s._directionDegrees=o,s}return(0,s.Z)(n,[{key:"equals",value:function(e){return this===e||Ze(e)&&(0,f.I6)(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._elevationMeters===e._elevationMeters&&this._directionDegrees===e._directionDegrees}},{key:"closestTo",value:function(e){var t,n=(0,r.Z)(e,3),i=n[0],a=n[1],o=n[2];return(0,f.t8)(Y,i,a),(0,f.I6)(Y,this._origin)||this._applyDirectionAndDistance(Y),(0,w.Ue)(Y[0],Y[1],null!==(t=this._elevationMeters)&&void 0!==t?t:o)}},{key:"_applyDirectionAndDistance",value:function(e){if(null!=this._directionDegrees&&null!=this._distanceMeters)(0,b.TB)(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(null!=this._directionDegrees)!function(e,t,n,r,i){var a,o=(0,b.cA)(K,t,r,i),u=o.azimuth,s=o.distance;null!==(a=u)&&void 0!==a||(u=0);var l=s*Math.cos((u-n)*g.Yr);l=Math.max(0,l),(0,b.TB)(e,t,n,l,i)}(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(null!=this._distanceMeters){var t=(0,b.cA)($,this._origin,e,this._spatialReference).azimuth;(0,b.TB)(e,this._origin,null!==t&&void 0!==t?t:0,this._distanceMeters,this._spatialReference)}}}]),n}(k),Y=[0,0],$=new b._q;var K=new b._q;function W(e,t){if(ce(e)){var n,a=[],o=(0,i.Z)(e.constraints);try{for(o.s();!(n=o.n()).done;){var u=n.value.intersect(t);u&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return le(a)}if(ce(t))return W(t,e);if(_e(e))return ae(e,t);if(_e(t))return ae(t,e);if(fe(e)){var s=e.point;if(fe(t))return(0,h.e)(s,t.point)?e:void 0;var l=t.closestTo(s);return(0,h.G)(l,s)?e:void 0}if(de(e)){if(fe(t))return W(t,e);if(de(t))return ue((0,E.Au)(e.lineLike,t.lineLike));if(he(t))return Q(e,t);if(pe(t))return ue((0,E.fK)(t.planeLike,e.lineLike));if(ve(t))return ue((0,E.CJ)(e.lineLike,t.center,t.radius));if(ge(t))return ue((0,E.UG)(e.lineLike,t));if(ye(t))return function(e,t){var n=e.lineLike,r=t.center,i=t.radius,a=r[2];return ue((0,E.CJ)(n,r,i).filter((function(e){return(0,E.hA)(e[2],a)})))}(e,t);if(be(t))return function(e,t){var n=e.lineLike,r=t.sphere;return ue((0,Z.m)(r,n.start,n.end))}(e,t)}else if(he(e)){if(fe(t)||de(t))return W(t,e);if(he(t))return function(e,t){return(0,E.hA)(e.z,t.z)?e:void 0}(e,t);if(pe(t))return function(e,t){var n=e.z,i=t.planeLike,a=(0,r.Z)(i.start,2),o=a[0],u=a[1],s=(0,r.Z)(i.end,2),l=s[0],c=s[1],f=(0,w.al)(o,u,n),d=(0,w.al)(l,c,n);return i.type===E.Jk.PLANE?new L(f,d):new T(f,d)}(e,t);if(ve(t))return function(e,t){var n=(0,r.Z)(t.center,2),i=n[0],a=n[1];return new N((0,w.al)(i,a,e.z),t.radius)}(e,t);if(ge(t))return te(e,t);if(ye(t))return function(e,t){return(0,E.hA)(t.center[2],e.z)?t:void 0}(e,t);if(be(t))return function(e,t){var n=t.center,r=t.radius,i=Math.abs(n[2]-e.z);if(i>r&&!(0,E.hA)(i,r))return;var a=(0,w.al)(n[0],n[1],e.z),o=Math.sqrt(Math.pow(r,2)-Math.pow(i,2));return(0,E.hA)(o,0)?void 0:new N(a,o)}(e,t)}else if(pe(e)){if(fe(t)||de(t)||he(t))return W(t,e);if(pe(t))return oe((0,E.Nn)(e.planeLike,t.planeLike));if(ve(t))return oe((0,E.SD)(e.planeLike,t.center,t.radius));if(ge(t))return re(e,t);if(ye(t))return ne(e,t);if(be(t))return ie(e,t)}else if(ve(e)){if(fe(t)||de(t)||he(t)||pe(t))return W(t,e);if(ve(t))return oe((0,E.Yf)((0,w.eR)(e.center),e.radius,(0,w.eR)(t.center),t.radius));if(ge(t))return;if(ye(t))return function(e,t){var n=(0,f.bI)((0,w.eR)(e.center),(0,w.eR)(t.center));return(0,E.hA)(n,0)&&(0,E.hA)(e.radius,t.radius)?t:se((0,E.Yf)((0,w.eR)(e.center),e.radius,(0,w.eR)(t.center),t.radius),t.center[2])}(e,t);if(be(t))return}else if(ge(e)){if(fe(t)||de(t)||he(t)||pe(t)||ve(t))return W(t,e);if(ge(t))return;if(ye(t))return void t.asCircle();if(be(t))return}else if(ye(e)){if(fe(t)||de(t)||he(t)||pe(t)||ve(t)||ge(t))return W(t,e);if(ye(t))return function(e,t){if(!(0,E.$7)(e.center,t.center))return;var n=(0,f.bI)((0,w.eR)(e.center),(0,w.eR)(t.center));return(0,E.hA)(n,0)&&(0,E.hA)(e.radius,t.radius)?e:se((0,E.Yf)((0,w.eR)(e.center),e.radius,(0,w.eR)(t.center),t.radius),e.center[2])}(t,e);if(be(t))return}else if(be(e)){if(fe(t)||de(t)||he(t)||pe(t)||ve(t)||ye(t))return W(t,e);if(be(t))return}}var Q=function(){var e=(0,_.Ue)();return function(t,n){var r=t.start,i=t.end;if((0,E.$7)(r,i)&&(0,E.hA)(r[2],n.z))return t;var a=(0,w.by)();return(0,_.fn)(n.getPlane(e),r,i,a)?new x(a):void 0}}();var ee=function(){var e=(0,y.Ue)(),t=(0,p.Ue)(),n=(0,p.Ue)();return function(r,i,a){var o=i.normal,u=i.center,s=i.radius;(0,S._F)(o,t,n);var l=(0,_.st)(r),f=s*(0,h.m)(l,t),d=s*(0,h.m)(l,n);(0,v.s)(e,u[0],u[1],u[2],1);var y=(0,v.g)(r,e),g=Math.hypot(f,d),b=(0,E.hA)(g,0);if((0,E.hA)((0,_.TE)(r,u),0)){if(b)return i;if((0,E.hA)(s,0))return!a||(0,E.zf)(a,u)?new x((0,w.d9)(u)):void 0;(0,h.b)(t,l,o),(0,h.n)(t,t);var Z=new Array,m=(0,p.d9)(u);(0,h.r)(m,m,t,s),a&&!(0,E.zf)(a,m)||Z.push(m);var k=(0,p.d9)(u);return(0,h.r)(k,k,t,-s),a&&!(0,E.zf)(a,k)||Z.push(k),ue(Z)}if(!b){var R=-y/g;if(!(Math.abs(R)>1||(0,E.hA)(R,1))){var L=Math.atan(f/d),T=(0,c.Kt)(R)-L,P=Math.PI-T,C=new Array,N=(0,p.Ue)();(0,h.r)(N,u,t,s*Math.cos(T)),(0,h.r)(N,N,n,s*Math.sin(T)),C.push(N);var A=(0,p.Ue)();return(0,h.r)(A,u,t,s*Math.cos(P)),(0,h.r)(A,A,n,s*Math.sin(P)),C.push(A),ue(a?(0,E.rq)(a,C):C)}}}}();var te=function(){var e=(0,_.Ue)();return function(t,n){return ee(t.getPlane(e),n,n.slicePlane)}}();var ne=function(){var e=(0,_.Ue)();return function(t,n){var a=n.center,o=n.radius,u=(0,E.SD)(t.planeLike,a,o),s=a[2];t.getSlicePlane(e);var l,c=new Array,f=(0,i.Z)(u);try{for(f.s();!(l=f.n()).done;){var d=(0,r.Z)(l.value,2),h=[d[0],d[1],s];(0,E.zf)(e,h)&&c.push(h)}}catch(p){f.e(p)}finally{f.f()}return ue(c)}}(),re=function(){var e=(0,_.Ue)(),t=(0,_.Ue)();return function(n,r){return ee(n.getPlane(e),r,n.getSlicePlane(t))}}(),ie=function(){var e=(0,_.Ue)();return function(t,n){var r=n.center,i=n.radius,a=t.getPlane(e),o=(0,_.jH)(a,r),u=Math.abs(o);if(!(u>i)||(0,E.hA)(u,i)){var s=Math.sqrt(Math.pow(i,2)-Math.pow(o,2));if((0,E.hA)(s,0)){var l=(0,w.by)();return(0,_.nF)(a,r,l),new x(l)}var c=(0,w.by)(),f=(0,p.d9)((0,_.st)(a));return(0,h.r)(c,r,f,o),new A(c,s,f,t.getSlicePlane())}}}();function ae(e,t){var n=e.planeLike,a=e.getZ,o=new Array;if(fe(t))e.addIfOnTheGround(o,(0,E.hm)(n,t.point));else if(de(t))e.addIfOnTheGround(o,(0,E.fK)(n,t.lineLike));else if(ve(t)){var u,s=(0,i.Z)((0,E.SD)(n,t.center,t.radius));try{for(s.s();!(u=s.n()).done;){var l=(0,r.Z)(u.value,2),c=l[0],f=l[1],d=a(c,f);null!=d&&o.push((0,p.al)(c,f,d))}}catch(S){s.e(S)}finally{s.f()}}else if(pe(t)||_e(t)){var h,v=(0,i.Z)((0,E.Nn)(n,t.planeLike));try{for(v.s();!(h=v.n()).done;){var y,g=(0,r.Z)(h.value,2),b=g[0],_=g[1],Z=null!==(y=a(b,_))&&void 0!==y?y:we;o.push((0,p.al)(b,_,Z))}}catch(S){v.e(S)}finally{v.f()}}return ue(o)}function oe(e){return le(e.map((function(e){var t=(0,r.Z)(e,2),n=t[0],i=t[1],a=(0,w.al)(n,i,0),o=(0,w.al)(n,i,1);return new L(a,o)})))}function ue(e){return le(e.map((function(e){return e?new x((0,w.uo)(e)):void 0})))}function se(e,t){return ue(e.map((function(e){var n=(0,r.Z)(e,2);return[n[0],n[1],t]})))}function le(e){var t;if(0!==e.length)return 1===e.length?null!==(t=e[0])&&void 0!==t?t:void 0:new P(e.filter(l.pC))}function ce(e){return e instanceof P}function fe(e){return e instanceof x}function de(e){return e instanceof R}function he(e){return e instanceof F}function pe(e){return e instanceof U}function ve(e){return e instanceof C}function ye(e){return e instanceof N}function ge(e){return e instanceof A}function be(e){return e instanceof H}function _e(e){return e instanceof B}function Ze(e){return e instanceof J}function Se(e){return e instanceof X}var we=0},38054:function(e,t,n){n.d(t,{Ju:function(){return b},SN:function(){return g},Ue:function(){return s},Vx:function(){return Z},aK:function(){return _},al:function(){return d},by:function(){return l},d9:function(){return h},eR:function(){return f},hx:function(){return v},j7:function(){return y},s:function(){return p},uo:function(){return c}});var r,i=n(29439),a=n(12400),o=n(55946),u=n(74509);function s(e,t,n){return l(e,t,n)}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,a.al)(e,t,n)}function c(e){return e}function f(e){return e}function d(e,t,n){return(0,a.al)(e,t,n)}function h(e){var t=(0,i.Z)(e,3),n=t[0],r=t[1],a=t[2];return e.length>3?[n,r,a,e[3]]:[n,r,a]}function p(e){var t;return e[3]=(null!==(t=e.length>3?e[3]:void 0)&&void 0!==t?t:r.NONE)|r.TARGET,e}function v(e){var t;return Boolean((null!==(t=e.length>3?e[3]:void 0)&&void 0!==t?t:r.NONE)&r.TARGET)}function y(e,t,n,r){var i=n.coordinateHelper,a=n.elevationInfo;return e?g(i.vectorToDehydratedPoint(e,S),t,a,r):null}function g(e,t,n){var r,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l();return a[0]=e.x,a[1]=e.y,a[2]=null!==(r=e.z)&&void 0!==r?r:0,null==t||("2d"===t.type?a[2]=0:a[2]=null!==(i=(0,u.vQ)(t,e,n,u.jG))&&void 0!==i?i:0),a}function b(e,t,n){return n?((0,o.y)(n,e[0],e[1],e[2],t),n):(0,o.T)(e[0],e[1],e[2],t)}function _(e,t,n,r,a){var s,l=n.z,c=n.m,f=r.spatialReference,d=r.elevationInfo;if(null==l&&null==c)s=void 0;else if(null==t||"2d"===t.type)s=null!==l&&void 0!==l?l:void 0;else{var h;s=null!==(h=(0,u.zx)(t,e,f,u.jG,d))&&void 0!==h?h:0}var p=(0,i.Z)(e,2),v=p[0],y=p[1];return a?(0,o.y)(a,v,y,s,f):a=(0,o.T)(v,y,s,f),null!=c&&(a.m=c,a.hasM=!0),a}function Z(e,t,n,a){var o,s,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l(),f=(0,i.Z)(e,2),d=f[0],h=f[1];return c[0]=d,c[1]=h,e.length>3&&(c[3]=null!==(o=e[3])&&void 0!==o?o:r.NONE),"3d"!==(null===n||void 0===n?void 0:n.type)?(c[2]=t.value,c):(c[2]=null!==(s=(0,u.O3)(n,d,h,t.value,a,t.elevationInfo,u.jG))&&void 0!==s?s:0,c)}!function(e){e[e.NONE=0]="NONE",e[e.TARGET=1]="TARGET"}(r||(r={}));var S=(0,o.T)(0,0,0,null)},27357:function(e,t,n){n.d(t,{U:function(){return D}});var r=n(74165),i=n(15861),a=n(37762),o=n(15671),u=n(43144),s=n(60136),l=n(29388),c=n(27366),f=n(7138),d=n(63780),h=n(42537),p=(n(93169),n(66978)),v=n(94172),y=n(68860),g=n(49861),b=n(32718),_=n(69912),Z=n(13611),S=n(32035),w=n(12400),E=n(24204),m=n(46634),k=n(74509),x=n(44179),R=n(38054),L=n(1413),T=n(76672),P=(n(84936),n(18661)),C=n(87072),N=n(37933),A=n(64674),M=n(69787),j=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e)).layer=null,r.snappingSource=null,r.rulesTable=null,r._valid=null,r}return(0,u.Z)(n,[{key:"attributeRulesEnabled",set:function(e){this._set("attributeRulesEnabled",e),e&&this.loadRules()}},{key:"layerView",get:function(){var e,t,n=this;return null===(e=this.view)||void 0===e||null===(t=e.allLayerViews)||void 0===t?void 0:t.find((function(e){return e.layer===n.layer}))}},{key:"valid",get:function(){var e=this._valid,t=this.snappingSource,n=this.layer;return!(!t||!n)&&e}},{key:"subtypeFilter",get:function(){var e,t,n,r=this,i=this.layer,a=this.snappingSource;if(!(0,N.e9)(i)||null===(e=i.subtypes)||void 0===e||!e.length||!a)return{mode:"not-in-use",filter:null};var o=a.layerSource.sublayerSources.filter((function(e){var t;return e.enabled&&e.layer.visible&&(0,M.rs)(null===(t=r.view)||void 0===t?void 0:t.scale,e.layer.effectiveScaleRange.minScale,e.layer.effectiveScaleRange.maxScale)})).map((function(e){return e.layer.subtypeCode}));if(!o.length)return{mode:"none-visible",filter:null};if(o.length===i.subtypes.length)return{mode:"all-visible",filter:null};var u=null!==(t=null===(n=i.fieldsIndex.get(i.subtypeField))||void 0===n?void 0:n.name)&&void 0!==t?t:i.subtypeField;return 1===o.length?{mode:"in-use",filter:"".concat(u," = ").concat(o.getItemAt(0))}:{mode:"in-use",filter:"".concat(u," IN (").concat(o.join(", "),")")}}},{key:"floorFilter",get:function(){var e=this.view,t=this.layer;return e&&t?(0,C.c)({view:e,layer:t}):null}},{key:"initialize",value:function(){if(this.snappingSource&&this.layer){var e=this.layer,t=this.snappingSource;if("refresh"in e){var n=e;this.addHandles(n.on("refresh",(function(){return t.refresh()})))}this.loadRules(),this.addHandles([(0,v.watch)((function(){return t.updating}),(function(e){return t.layerSource.updating=e}),v.syncAndInitial),(0,v.watch)((function(){return t.availability}),(function(e){return t.layerSource.availability=e}),v.syncAndInitial)])}else this._valid=!1}},{key:"getFetchCandidatesParameters",value:function(e,t,n){var r,i,a,o,u;if(!this.valid)return[];var s=this.layer,l=this.layerView,c=this.floorFilter,f=this.rulesTable,d=this.subtypeFilter,h=(0,L.Z)((0,L.Z)({distance:n,mode:null!==(r=null===(i=this.view)||void 0===i?void 0:i.type)&&void 0!==r?r:"2d",point:e,coordinateHelper:t.coordinateHelper},{returnEdge:!0,vertexMode:"all"}),{},{filter:l&&"filter"in l?l.filter:null});if(c&&(h.filter=F(h.filter,c)),"not-in-use"!==d.mode&&"all-visible"!==d.mode){if("none-visible"===d.mode)return[];h.filter?h.filter.where=(0,T._)(h.filter.where,d.mode):h.filter=new P.Z({where:d.filter})}if(!this.attributeRulesEnabled)return[h];var p=t.feature,v="subtype-sublayer"===(null===p||void 0===p||null===(a=p.sourceLayer)||void 0===a?void 0:a.type)?p.sourceLayer.parent:null===p||void 0===p?void 0:p.sourceLayer;if(f&&p&&(0,A.n0)(null===(o=this.view)||void 0===o?void 0:o.map)&&((0,N.Te)(s)||(0,N.e9)(s))&&s.layerId&&((0,N.Te)(v)||(0,N.e9)(v))&&null!==(u=this.view.map.utilityNetworks)&&void 0!==u&&u.find((function(e){return e.isUtilityLayer(v)}))){var y;if("loaded"!==f.loadStatus)return[];var g=[],b=s.layerId,_=null===(y=f.getFeatureSQL(v,p))||void 0===y?void 0:y[b];if(!_)return[];var Z=_.anyVertex,S=_.endVertex;return S&&Z&&S===Z&&(S=""),S&&g.push((0,L.Z)((0,L.Z)({},h),{},{returnEdge:!1,vertexMode:"ends",filter:F(h.filter,S)})),Z&&g.push((0,L.Z)((0,L.Z)({},h),{},{returnEdge:!1,vertexMode:"all",filter:F(h.filter,Z)})),g}return[h]}},{key:"loadRules",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var t,n,i,a,o,u,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._valid=null,t=this.layer,n=this.view,!(this.attributeRulesEnabled&&t&&n&&(0,A.n0)(null===n||void 0===n?void 0:n.map)&&((0,N.Te)(t)||(0,N.e9)(t)))){e.next=19;break}return e.prev=3,e.next=6,Promise.allSettled(null!==(i=null===(a=n.map.utilityNetworks)||void 0===a?void 0:a.map((function(e){return e.load()})))&&void 0!==i?i:[]);case 6:if(s=null===(o=n.map.utilityNetworks)||void 0===o?void 0:o.find((function(e){return e.isUtilityLayer(t)})),e.t0=s,!e.t0){e.next=14;break}return e.next=11,s.getRulesTable();case 11:return this.rulesTable=e.sent,e.next=14,null===(u=this.rulesTable)||void 0===u?void 0:u.load();case 14:e.next=19;break;case 16:return e.prev=16,e.t1=e.catch(3),e.abrupt("return",(this._valid=!1,void b.Z.getLogger("esri.views.interactive.snapping.FeatureSnappingSourceInfo").error("Failed to load rules table for snapping source",t.title)));case 19:this._valid=!0;case 20:case"end":return e.stop()}}),e,this,[[3,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"remove",value:function(){this.destroy()}},{key:"destroy",value:function(){var e;null===(e=this.snappingSource)||void 0===e||e.destroy()}}]),n}(f.default);function F(e,t){return null==e?new P.Z({where:t}):e.where?new P.Z({where:(0,T._)(e.where,t)}):new P.Z({where:t})}(0,c._)([(0,g.Cb)({constructOnly:!0})],j.prototype,"layer",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],j.prototype,"snappingSource",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],j.prototype,"view",void 0),(0,c._)([(0,g.Cb)({value:!1})],j.prototype,"attributeRulesEnabled",null),(0,c._)([(0,g.Cb)()],j.prototype,"layerView",null),(0,c._)([(0,g.Cb)()],j.prototype,"rulesTable",void 0),(0,c._)([(0,g.Cb)()],j.prototype,"valid",null),(0,c._)([(0,g.Cb)()],j.prototype,"subtypeFilter",null),(0,c._)([(0,g.Cb)()],j.prototype,"floorFilter",null),(0,c._)([(0,g.Cb)()],j.prototype,"_valid",void 0),j=(0,c._)([(0,_.j)("esri.views.interactive.snapping.FeatureSnappingSourceInfo")],j);var I=n(80371),U=n(97760),V=n(95905),z=n(75691),O=n(19824),q=n(11208),D=function(e){(0,s.Z)(c,e);var t=(0,l.Z)(c);function c(e){var n;return(0,o.Z)(this,c),(n=t.call(this,e)).options=null,n._domain=I.B.FEATURE,n._updatingHandles=new m.R,n._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}},n}return(0,u.Z)(c,[{key:"updating",get:function(){return this._snappingSources.some((function(e){var t;return null==(null===e||void 0===e?void 0:e.valid)||!0===e.valid&&!0===(null===(t=e.snappingSource)||void 0===t?void 0:t.updating)}))||this._updatingHandles.updating}},{key:"initialize",value:function(){var e=this,t=(0,v.mapCollectionAsync)((function(){var t;return null===(t=e.options)||void 0===t?void 0:t._effectiveFeatureSources}),(function(t,n){return e._createSourceInfo(t,n)}));this._snappingSources=t,this.addHandles([(0,h.ed)(t),(0,v.watch)((function(){var t;return{rulesEnabled:!(null===(t=e.options)||void 0===t||!t.attributeRulesEnabled),sources:e._snappingSources.filter(d.pC)}}),(function(e){var t,n=e.rulesEnabled,r=e.sources,i=(0,a.Z)(r);try{for(i.s();!(t=i.n()).done;){t.value.attributeRulesEnabled=n}}catch(o){i.e(o)}finally{i.f()}}),v.sync)])}},{key:"destroy",value:function(){this._set("options",null),this._updatingHandles.destroy()}},{key:"fetchCandidates",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,i,o){var u,s,l,c,f,d,h=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled){e.next=2;break}return e.abrupt("return",[]);case 2:u=[],s=this._computeScreenSizeDistanceParameters(t,i),l=(0,a.Z)(this._snappingSources),e.prev=4,f=function(){var e,n,r,l=c.value;if(null===l||void 0===l||!l.valid||null===(e=l.snappingSource)||void 0===e||null===(n=e.layerSource)||void 0===n||!n.enabled||null!==(r=l.layerView)&&void 0!==r&&r.suspended)return"continue";var f,d=l.getFetchCandidatesParameters(t,i,s),p=(0,a.Z)(d);try{for(p.s();!(f=p.n()).done;){var v=f.value;u.push(l.snappingSource.fetchCandidates(v,o).then((function(e){return e.filter((function(e){return!h._candidateIsExcluded(l.snappingSource,e,i.excludeFeature)}))})))}}catch(y){p.e(y)}finally{p.f()}},l.s();case 7:if((c=l.n()).done){e.next=13;break}if("continue"!==f()){e.next=11;break}return e.abrupt("continue",11);case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),l.e(e.t0);case 18:return e.prev=18,l.f(),e.finish(18);case 21:return e.next=23,(0,p.OT)(u);case 23:return d=e.sent.flat(),e.abrupt("return",(this._addRightAngleCandidates(d,t,s,i),(0,p.k_)(o),(0,A.lQ)(t,d),d));case 25:case"end":return e.stop()}}),e,this,[[4,15,18,21]])})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_addRightAngleCandidates",value:function(e,t,n,r){for(var i,a,o,u,s,l,c,f,d=null!=r.vertexHandle?null===(i=r.vertexHandle.rightEdge)||void 0===i||null===(a=i.rightVertex)||void 0===a?void 0:a.pos:null!=r.editGeometryOperations&&"polygon"===r.editGeometryOperations.data.type?null===(o=r.editGeometryOperations.data.components[0])||void 0===o||null===(u=o.getFirstVertex())||void 0===u?void 0:u.pos:null,h=null!=r.vertexHandle?null===(s=r.vertexHandle.leftEdge)||void 0===s||null===(l=s.leftVertex)||void 0===l?void 0:l.pos:null!=r.editGeometryOperations?null===(c=r.editGeometryOperations.data.components[0])||void 0===c||null===(f=c.getLastVertex())||void 0===f?void 0:f.pos:null,p=this.view,v=(0,R.j7)(d,p,r),y=(0,R.j7)(h,p,r),g=e.length,b=0;b<g;b++)this._addRightAngleCandidate(e[b],y,t,n,e),this._addRightAngleCandidate(e[b],v,t,n,e)}},{key:"_addRightAngleCandidate",value:function(e,t,n,r,i){if(null!=t&&function(e){return(e instanceof V.L||e instanceof U.k)&&!function(e){var t=e.constraint,n=t.start,r=t.end,i=(0,S.a)(n,r),a=(0,Z.bI)((0,R.eR)(n),(0,R.eR)(r));return i<(0,E.bn)()||a/i<X}(e)}(e)){var a=e.constraint.closestTo(t),o=(a[0]-n[0])/r.x,u=(a[1]-n[1])/r.y,s=e.constraint,l=s.start,c=s.end;if(o*o+u*u<=1){var f=(0,Z.bI)((0,R.eR)(a),(0,R.eR)(l))>(0,Z.bI)((0,R.eR)(a),(0,R.eR)(c))?l:c,d=new O.A1({targetPoint:(0,R.s)(a),otherVertex:t,otherVertexType:O.YJ.NEXT,previousVertex:f,constraint:new x.aU(t,a),objectId:e.objectId,isDraped:e.isDraped,domain:I.B.FEATURE});i.push(d)}}}},{key:"_computeScreenSizeDistanceParameters",value:function(e,t){var n=null!=this.options?this.options.distance*("touch"===t.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:n,y:n,z:n,distance:n}:"2d"===this.view.type?{x:n*=this.view.resolution,y:n,z:n,distance:n}:this._computeScreenSizeDistanceParameters3D(e,n,this.view,t)}},{key:"_computeScreenSizeDistanceParameters3D",value:function(e,t,n,r){var i=r.spatialReference;n.renderCoordsHelper.toRenderCoords(e,i,H);var a=n.state.camera.computeScreenPixelSizeAt(H),o=a*n.renderCoordsHelper.unitInMeters,u=o/(0,y.c9)(i),s=o/(0,y._R)(i),l=t*u,c=t*s,f=(0,q.Rs)(e,i,k.jG,n),d=f?G(f,e,u,0,0,n,r):0,h=f?G(f,e,0,u,0,n,r):0,p=f?G(f,e,0,0,s,n,r):0;return{x:0===d?0:l/d,y:0===h?0:l/h,z:0===p?0:c/p,distance:a*t}}},{key:"_candidateIsExcluded",value:function(e,t,n){if(null==n)return!1;var r=this._getCandidateObjectId(t);if(null==r)return!1;var i=e.layerSource.layer;return"graphics"===i.type?n.uid===r:n.sourceLayer===i&&!(!n.attributes||!("objectIdField"in i))&&n.attributes[i.objectIdField]===r}},{key:"_getCandidateObjectId",value:function(e){return e instanceof z.a?e.objectId:null}},{key:"_createSourceInfo",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.layer,e.t0=i.loaded,e.t0){e.next=6;break}return e.next=5,i.load();case 5:(0,p.k_)(n);case 6:return a=this.view,e.next=9,this._createFeatureSnappingSourceType(t);case 9:return o=e.sent,e.abrupt("return",((0,p.k_)(n),new j(null==o?{}:{snappingSource:o,view:a,layer:i})));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_createFeatureSnappingSourceType",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.layer.type,e.next="feature"===e.t0||"geojson"===e.t0||"csv"===e.t0||"oriented-imagery"===e.t0||"subtype-group"===e.t0||"wfs"===e.t0?3:"graphics"===e.t0?4:"map-notes"===e.t0?5:"scene"===e.t0||"building-scene"===e.t0?6:7;break;case 3:return e.abrupt("return",this._createFeatureSnappingSourceFeatureLayer(t));case 4:return e.abrupt("return",this._createFeatureSnappingSourceGraphicsLayer(t));case 5:return e.abrupt("return",this._createFeatureSnappingSourceMapNotesLayer(t));case 6:return e.abrupt("return",this._createFeatureSnappingSourceSceneLayer(t));case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createFeatureSnappingSourceSceneLayer",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.view)&&"3d"===n.type){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this._getSourceModule("scene");case 5:return e.t0=e.sent.SceneLayerSnappingSource,e.t1={layerSource:t,view:n},e.abrupt("return",new e.t0(e.t1));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createFeatureSnappingSourceFeatureLayer",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=null===(n=t.layer.source)||void 0===n?void 0:n.type,e.next="feature-layer"===e.t0||"oriented-imagery"===e.t0?3:"memory"===e.t0||"csv"===e.t0||"geojson"===e.t0||"wfs"===e.t0?8:15;break;case 3:return e.next=5,this._getSourceModule("featureService");case 5:return e.t1=e.sent.FeatureServiceSnappingSource,e.t2={spatialReference:this.spatialReference,view:this.view,layerSource:t},e.abrupt("return",new e.t1(e.t2));case 8:if("mesh"!==t.layer.geometryType){e.next=10;break}return e.abrupt("return",null);case 10:return e.next=12,this._getSourceModule("featureCollection");case 12:return e.t3=e.sent.FeatureCollectionSnappingSource,e.t4={layerSource:t,view:this.view},e.abrupt("return",new e.t3(e.t4));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createFeatureSnappingSourceGraphicsLayer",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSourceModule("graphics");case 2:return e.t0=e.sent.GraphicsSnappingSource,e.t1={getGraphicsLayers:function(){return[t.layer]},spatialReference:this.spatialReference,view:this.view,layerSource:t},e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createFeatureSnappingSourceMapNotesLayer",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSourceModule("notes");case 2:return e.t0=e.sent.GraphicsSnappingSource,e.t1={getGraphicsLayers:function(){var e,n;return null!==(e=null===(n=t.layer.sublayers)||void 0===n?void 0:n.toArray())&&void 0!==e?e:[]},spatialReference:this.spatialReference,view:this.view,layerSource:t},e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getSourceModule",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,a,o,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this._sourceModules[t]).loader){e.next=9;break}return i=this._loadSourceModule(t),a={module:null,loader:i},this._sourceModules[t]=a,e.next=6,i;case 6:return o=e.sent,u={module:o,loader:i},e.abrupt("return",(this._sourceModules[t]=u,o));case 9:return e.abrupt("return",null==n.module?n.loader:n.module);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_loadSourceModule",value:function(e){var t=this._updatingHandles;switch(e){case"featureService":return t.addPromise(n.e(5532).then(n.bind(n,5532)));case"featureCollection":return t.addPromise(Promise.all([n.e(98441),n.e(26823)]).then(n.bind(n,26823)));case"graphics":case"notes":return t.addPromise(Promise.all([n.e(83406),n.e(45026),n.e(54557),n.e(59008),n.e(93463),n.e(54054),n.e(71486),n.e(14346),n.e(68928),n.e(74579),n.e(98441),n.e(16313)]).then(n.bind(n,33518)));case"scene":return t.addPromise(Promise.all([n.e(25158),n.e(79762),n.e(1312)]).then(n.bind(n,92767)))}}},{key:"test",get:function(){}}]),c}(f.default);function G(e,t,n,r,i,a,o){var u=o.spatialReference,s=(0,S.c)(B,t);s[0]+=n,s[1]+=r,s[2]+=i;var l=(0,q.Rs)(s,u,k.jG,a);return l?(0,A.fG)(l,e):1/0}(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"spatialReference",void 0),(0,c._)([(0,g.Cb)({constructOnly:!0})],D.prototype,"view",void 0),(0,c._)([(0,g.Cb)()],D.prototype,"options",void 0),(0,c._)([(0,g.Cb)({readOnly:!0})],D.prototype,"updating",null),(0,c._)([(0,g.Cb)()],D.prototype,"_snappingSources",void 0),D=(0,c._)([(0,_.j)("esri.views.interactive.snapping.FeatureSnappingEngine")],D);var H=(0,w.Ue)(),B=(0,w.Ue)(),X=1e-4},22006:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(43144),i=n(15671),a=n(60136),o=n(29388),u=n(27366),s=n(7138),l=n(80987),c=n(49861),f=(n(93169),n(32718),n(84936),n(69912)),d=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).layer=null,r.enabled=!0,r.updating=!1,r.availability=1,r.sublayerSources=new l.Z,r}return(0,r.Z)(n)}(s.default);(0,u._)([(0,c.Cb)({constructOnly:!0})],d.prototype,"layer",void 0),(0,u._)([(0,c.Cb)()],d.prototype,"enabled",void 0),(0,u._)([(0,c.Cb)()],d.prototype,"updating",void 0),(0,u._)([(0,c.Cb)()],d.prototype,"availability",void 0),(0,u._)([(0,c.Cb)()],d.prototype,"sublayerSources",void 0);var h=d=(0,u._)([(0,f.j)("esri.views.interactive.snapping.FeatureSnappingLayerSource")],d)},76014:function(e,t,n){n.d(t,{c:function(){return p}});var r=n(43144),i=n(15671),a=n(60136),o=n(29388),u=n(27366),s=n(51995),l=n(46784),c=n(49861),f=n(69912),d=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).enabled=!0,e}return(0,r.Z)(n)}(l.wq);(0,u._)([(0,c.Cb)({type:Boolean})],d.prototype,"enabled",void 0),d=(0,u._)([(0,f.j)("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],d);var h=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).lineSnapper=new d,r.parallelLineSnapper=new d,r.rightAngleSnapper=new d,r.rightAngleTriangleSnapper=new d,r.shortLineThreshold=15,r.distance=5,r.pointThreshold=1e-6,r.intersectionParallelLineThreshold=1e-6,r.parallelLineThreshold=1e-6,r.verticalLineThresholdMeters=.3,r.touchSensitivityMultiplier=1.5,r.pointOnLineThreshold=1e-6,r.orange=new s.Z([255,127,0]),r.orangeTransparent=new s.Z([255,127,0,.5]),r.lineHintWidthReference=3,r.lineHintWidthTarget=3,r.lineHintFadedExtensions=.3,r.parallelLineHintWidth=2,r.parallelLineHintLength=24,r.parallelLineHintOffset=1.5,r.rightAngleHintSize=24,r.rightAngleHintOutlineSize=1.5,r.satisfiesConstraintScreenThreshold=1,r}return(0,r.Z)(n)}(l.wq);(0,u._)([(0,c.Cb)({type:d,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"lineSnapper",void 0),(0,u._)([(0,c.Cb)({type:d,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"parallelLineSnapper",void 0),(0,u._)([(0,c.Cb)({type:d,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"rightAngleSnapper",void 0),(0,u._)([(0,c.Cb)({type:d,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"rightAngleTriangleSnapper",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],h.prototype,"shortLineThreshold",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],h.prototype,"distance",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],h.prototype,"pointThreshold",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],h.prototype,"intersectionParallelLineThreshold",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],h.prototype,"parallelLineThreshold",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],h.prototype,"verticalLineThresholdMeters",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"touchSensitivityMultiplier",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],h.prototype,"pointOnLineThreshold",void 0),(0,u._)([(0,c.Cb)({type:s.Z,nonNullable:!0})],h.prototype,"orange",void 0),(0,u._)([(0,c.Cb)({type:s.Z,nonNullable:!0})],h.prototype,"orangeTransparent",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"lineHintWidthReference",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"lineHintWidthTarget",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],h.prototype,"lineHintFadedExtensions",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"parallelLineHintWidth",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],h.prototype,"parallelLineHintLength",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],h.prototype,"parallelLineHintOffset",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],h.prototype,"rightAngleHintSize",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],h.prototype,"rightAngleHintOutlineSize",void 0),(0,u._)([(0,c.Cb)({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],h.prototype,"satisfiesConstraintScreenThreshold",void 0);var p=new(h=(0,u._)([(0,f.j)("esri.views.interactive.snapping.Settings.Defaults")],h))},80371:function(e,t,n){var r;n.d(t,{B:function(){return r}}),function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"}(r||(r={}))},38856:function(e,t,n){n.d(t,{N:function(){return ce}});var r=n(74165),i=n(15861),a=n(93433),o=n(37762),u=n(15671),s=n(43144),l=n(60136),c=n(29388),f=n(27366),d=n(7138),h=n(91505),p=(n(93169),n(66978)),v=n(94172),y=n(49861),g=(n(32718),n(84936),n(69912)),b=n(79803),_=n(74509),Z=n(38054),S=n(76014),w=n(80371),E=n(27357),m=n(80987),k=n(17768),x=n(47898),R=n(12400),L=n(68860),T=n(13611),P=n(64674),C=n(11208),N=function(){function e(t,n){(0,u.Z)(this,e),this.view=t,this.options=n,this.squaredShortLineThreshold=S.c.shortLineThreshold*S.c.shortLineThreshold}return(0,s.Z)(e,[{key:"snap",value:function(e,t){return null!=t.vertexHandle?"vertex"!==t.vertexHandle.type?[]:this.snapExistingVertex(e,t):this.snapNewVertex(e,t)}},{key:"edgeExceedsShortLineThreshold",value:function(e,t){return this.exceedsShortLineThreshold((0,Z.j7)(e.leftVertex.pos,this.view,t),(0,Z.j7)(e.rightVertex.pos,this.view,t),t)}},{key:"exceedsShortLineThreshold",value:function(e,t,n){var r=n.spatialReference;return 0===this.squaredShortLineThreshold||(0,P.Bb)((0,C.Rs)(t,r,_.jG,this.view),(0,C.Rs)(e,r,_.jG,this.view))>this.squaredShortLineThreshold}},{key:"isVertical",value:function(e,t,n){var r=n.spatialReference,i=(0,L.c9)(r);return(0,T.TE)((0,Z.eR)(e),(0,Z.eR)(t))*i<S.c.verticalLineThresholdMeters}},{key:"squaredProximityThreshold",value:function(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}},{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){var e=this.options,t=e.distance*e.touchSensitivityMultiplier;return t*t}}]),e}(),A=n(44179),M=n(92605),j=n(53397),F=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r,i=e.lineStart,a=e.lineEnd,o=e.targetPoint,s=e.isDraped;return(0,u.Z)(this,n),(r=t.call(this,o,new A.jg(i,a),s,w.B.SELF))._referenceLineHint=new j.w(P.ze.REFERENCE_EXTENSION,i,a,s,r.domain),r}return(0,s.Z)(n,[{key:"hints",get:function(){return[this._referenceLineHint,new j.w(P.ze.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}},{key:"_lineEndClosestToTarget",value:function(){return this.constraint.closestEndTo(this.targetPoint)}}]),n}(M.j),I=n(73840),U=n(13615),V=n(55793),z=n(94163),O=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"snapNewVertex",value:function(e,t){var n=t.editGeometryOperations.data.components[0],r=n.edges.length,i=[];if(r<1)return i;var a=t.spatialReference,o=(0,C.Rs)(e,a,_.jG,this.view),u=this.view,s=n.edges[r-1],l=s;do{if(this.edgeExceedsShortLineThreshold(l,t)){var c=(0,P._j)(l,u,t);this._processCandidateProposal(c.left,c.right,e,o,t,i)}l=l.leftVertex.leftEdge}while(l&&l!==s);return i}},{key:"snapExistingVertex",value:function(e,t){var n=[],r=t.vertexHandle,i=r.component;if(i.edges.length<2)return n;var a=this.view,o=t.spatialReference,u=(0,C.Rs)(e,o,_.jG,a),s=r.leftEdge,l=r.rightEdge;s&&l&&this.edgeExceedsShortLineThreshold(s,t)&&this.edgeExceedsShortLineThreshold(l,t)&&this._processCandidateProposal((0,Z.j7)(s.leftVertex.pos,a,t),(0,Z.j7)(l.rightVertex.pos,a,t),e,u,t,n);var c=i.edges[0],f=c;do{if(f!==r.leftEdge&&f!==r.rightEdge&&this.edgeExceedsShortLineThreshold(f,t)){var d=(0,P._j)(f,a,t);this._processCandidateProposal(d.left,d.right,e,u,t,n)}f=f.rightVertex.rightEdge}while(f&&f!==c);return n}},{key:"_processCandidateProposal",value:function(e,t,n,r,i,a){var o,u=i.spatialReference,s=i.pointer,l=(0,R.Ue)();!function(e,t,n,r,i){(function(e,t,n,r,i){var a=i.spatialReference,o=(0,I.n6)(t,n,a,a);if(null==o)return!1;var u=(0,I.n6)(n,r,a,a);if(null==u)return!1;var s=(0,U.FB)(n,r,a);if(null==s)return!1;var l=Math.abs(k.Q4.shortestSignedDiff(o,u))>Math.PI/2?k.c5.normalize(o+Math.PI):o;return(0,I.LH)(e,n,a,(0,x.mE)(s,"meters"),(0,x.GJ)(l,"radians","geographic"),"geodesic"),e[2]=r[2],!0})(e,t,n,r,i)||function(e,t,n,r){(0,V.ZE)(t,{start:n,end:r,type:z.SP.LINE},e),e[2]=t[2]}(e,r,t,n)}(l,e,t,n,i);var c=(0,Z.s)((0,Z.uo)(l));(0,P.Bb)(r,(0,C.Rs)(c,u,_.jG,this.view))<this.squaredProximityThreshold(s)&&a.push(new F({lineStart:e,lineEnd:t,targetPoint:c,isDraped:"on-the-ground"===(null===(o=i.elevationInfo)||void 0===o?void 0:o.mode)}))}}]),n}(N);var q=n(6644),D=n(32035),G=n(5916),H=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r,i=e.referenceLine,a=e.lineStart,o=e.targetPoint,s=e.isDraped;(0,u.Z)(this,n);var l=(0,R.d9)(a),c=i.left,f=i.right;return(0,D.f)(l,(0,D.g)(l,l,f),c),(r=t.call(this,o,new A.jg(a,(0,Z.uo)(l)),s,w.B.SELF))._referenceLines=[{edge:i,fadeLeft:!0,fadeRight:!0}],r}return(0,s.Z)(n,[{key:"hints",get:function(){var e=this;return[new j.w(P.ze.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new G.L(this.constraint.start,this.targetPoint,this.isDraped,this.domain)].concat((0,a.Z)(this._referenceLines.map((function(t){return new j.w(P.ze.REFERENCE,t.edge.left,t.edge.right,e.isDraped,e.domain,t.fadeLeft,t.fadeRight)}))))}},{key:"addReferenceLine",value:function(e){var t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((function(n){(0,D.e)(e.right,n.edge.left)&&(n.fadeLeft=!1,t.fadeRight=!1),(0,D.e)(e.right,n.edge.right)&&(n.fadeRight=!1,t.fadeRight=!1),(0,D.e)(e.left,n.edge.right)&&(n.fadeRight=!1,t.fadeLeft=!1),(0,D.e)(e.left,n.edge.left)&&(n.fadeLeft=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}]),n}(M.j),B=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"snapNewVertex",value:function(e,t){var n=t.editGeometryOperations.data.components[0],r=n.edges.length,i=n.vertices.length,a=[];if(r<2)return a;var o=this.view,u=(0,C.Rs)(e,t.spatialReference,_.jG,o),s=(0,Z.j7)(n.vertices[i-1].pos,o,t),l=(0,Z.j7)(n.vertices[0].pos,o,t),c=n.edges[r-1],f=c;do{if(this.edgeExceedsShortLineThreshold(f,t)){var d=(0,P._j)(f,o,t);this._checkEdgeForParallelLines(d,s,e,u,t,a),this._checkEdgeForParallelLines(d,l,e,u,t,a)}f=f.leftVertex.leftEdge}while(f&&f!==c);return a}},{key:"snapExistingVertex",value:function(e,t){var n=[],r=t.vertexHandle,i=r.component;if(i.edges.length<3)return n;var a=this.view,o=(0,C.Rs)(e,t.spatialReference,_.jG,a),u=r.leftEdge,s=r.rightEdge,l=i.vertices[0],c=(0,Z.j7)(l.pos,a,t),f=i.vertices.length,d=i.vertices[f-1],h=(0,Z.j7)(d.pos,a,t),p=i.edges[0],v=p;do{if(v!==u&&v!==s&&this.edgeExceedsShortLineThreshold(v,t)){var y=(0,P._j)(v,a,t);u&&this._checkEdgeForParallelLines(y,(0,Z.j7)(u.leftVertex.pos,a,t),e,o,t,n),s&&this._checkEdgeForParallelLines(y,(0,Z.j7)(s.rightVertex.pos,a,t),e,o,t,n),r===l?this._checkEdgeForParallelLines(y,h,e,o,t,n):r===d&&this._checkEdgeForParallelLines(y,c,e,o,t,n)}v=v.rightVertex.rightEdge}while(v&&v!==p);return n}},{key:"_checkEdgeForParallelLines",value:function(e,t,n,r,i,a){var u=e.left,s=e.right;if((0,z.k0)(X,(0,Z.eR)(t),(0,Z.eR)(u),(0,Z.eR)(s)),!((0,T.bI)(X,(0,Z.eR)(t))<S.c.parallelLineThreshold)){(0,z.k0)(X,(0,Z.eR)(n),(0,Z.eR)(u),(0,Z.eR)(s),(0,Z.eR)(t));var l=i.spatialReference,c=i.pointer,f=(0,Z.s)((0,Z.al)(X[0],X[1],n[2]));if((0,P.Bb)(r,(0,C.Rs)(f,l,_.jG,this.view))<this.squaredProximityThreshold(c)){var d;if(this.isVertical(f,t,i)||this.isVertical(u,s,i))return;if(function(e,t){var n,r=e.left,i=e.right,a=(0,o.Z)(t);try{for(a.s();!(n=a.n()).done;){var u=n.value;if((0,z.k0)(X,(0,Z.eR)(i),(0,Z.eR)(u.constraint.start),(0,Z.eR)(u.constraint.end),(0,Z.eR)(r)),(0,T.bI)(X,(0,Z.eR)(i))<S.c.parallelLineThreshold)return u.addReferenceLine(e),!0}}catch(s){a.e(s)}finally{a.f()}return!1}(e,a))return;a.push(new H({referenceLine:e,lineStart:t,targetPoint:f,isDraped:"on-the-ground"===(null===(d=i.elevationInfo)||void 0===d?void 0:d.mode)}))}}}}]),n}(N);var X=(0,q.Ue)(),J=n(19824),Y=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"snapNewVertex",value:function(e,t){var n=t.editGeometryOperations.data.components[0],r=[];if(n.vertices.length<2)return r;var i=this.view,a=(0,C.Rs)(e,t.spatialReference,_.jG,i),o=n.vertices.at(-1);this._checkForSnappingCandidate(J.dq.LastVertex,r,o.leftEdge,o,o.leftEdge.leftVertex,e,a,t);var u=n.vertices[0];return this._checkForSnappingCandidate(J.dq.FirstVertex,r,u.rightEdge,u,u.rightEdge.rightVertex,e,a,t),r}},{key:"snapExistingVertex",value:function(e,t){var n=[],r=t.vertexHandle;if(r.component.vertices.length<3)return n;var i=this.view,a=(0,C.Rs)(e,t.spatialReference,_.jG,i),o=r.leftEdge,u=r.rightEdge;if(null!==o&&void 0!==o&&o.leftVertex.leftEdge){var s=o.leftVertex.leftEdge;this._checkForSnappingCandidate(J.dq.ExistingEdge,n,s,s.rightVertex,s.leftVertex,e,a,t)}if(null!==u&&void 0!==u&&u.rightVertex.rightEdge){var l=u.rightVertex.rightEdge;this._checkForSnappingCandidate(J.dq.ExistingEdge,n,l,l.leftVertex,l.rightVertex,e,a,t)}return n}},{key:"_checkForSnappingCandidate",value:function(e,t,n,r,i,a,o,u){if(this.edgeExceedsShortLineThreshold(n,u)){var s=this.view,l=(0,Z.j7)(r.pos,s,u),c=(0,Z.j7)(i.pos,s,u);(function(e,t,n,r,i){(function(e,t,n,r,i){var a=i.spatialReference,o=(0,I.n6)(t,n,a,a);if(null==o)return!1;var u=(0,I.n6)(n,r,a,a);if(null==u)return!1;var s=Math.sign(k.c5.shortestSignedDiff(o,u))*Math.PI*.5,l=(0,x.GJ)(o+s,"radians","geographic"),c=(0,R.Ue)(),f=(0,U.FB)(n,r,a);return null!=f&&((0,I.LH)(c,n,a,(0,x.mE)(f,"meters"),l,"geodesic"),(0,D.f)(e,c,n),!0)})(e,t,n,r,i)||function(e,t,n){var r=(0,T.$X)($,(0,Z.eR)(n),(0,Z.eR)(t));(0,D.s)(e,r[1],-r[0],0)}(e,t,n)})(K,c,l,a,u),this._checkForSnappingCandidateAlongProjectedRay(e,t,c,l,K,a,o,u)}}},{key:"_checkForSnappingCandidateAlongProjectedRay",value:function(e,t,n,r,i,a,o,u){var s,l=u.spatialReference,c=u.pointer,f=(0,T.$X)($,(0,Z.eR)(a),(0,Z.eR)(r)),d=(0,T.AK)(i,f)/(0,T.we)(i),h=(0,T.od)($,(0,Z.eR)(r),i,d),p=(0,Z.s)((0,Z.al)(h[0],h[1],a[2]));if(!((0,P.Bb)(o,(0,C.Rs)(p,l,_.jG,this.view))>this.squaredProximityThreshold(c)||this.isVertical(p,r,u)||this.isVertical(r,n,u))){var v=(0,D.r)((0,R.Ue)(),r,i,Math.sign(d));t.push(new J.A1({targetPoint:p,constraint:new A.aU(r,(0,Z.uo)(v)),previousVertex:n,otherVertex:r,otherVertexType:J.YJ.CENTER,selfSnappingType:e,isDraped:"on-the-ground"===(null===(s=u.elevationInfo)||void 0===s?void 0:s.mode)}))}}}]),n}(N);var $=(0,q.Ue)(),K=(0,R.Ue)(),W=n(41216),Q=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r,i=e.targetPoint,a=e.point1,o=e.point2,s=e.isDraped;return(0,u.Z)(this,n),(r=t.call(this,i,new A.kt((0,Z.uo)((0,D.o)((0,R.Ue)(),a,o,.5)),.5*(0,T.TE)((0,Z.eR)(a),(0,Z.eR)(o))),s,w.B.SELF))._p1=a,r._p2=o,r}return(0,s.Z)(n,[{key:"hints",get:function(){return[new j.w(P.ze.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new j.w(P.ze.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new W.y(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}]),n}(M.j),ee=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"snapNewVertex",value:function(e,t){var n=t.editGeometryOperations.data.components[0],r=[],i=n.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||i<2)return r;var a=this.view,o=n.vertices[0],u=n.vertices[i-1],s=(0,Z.j7)(o.pos,a,t),l=(0,Z.j7)(u.pos,a,t);return this._processCandidateProposal(s,l,e,t,r),r}},{key:"snapExistingVertex",value:function(e,t){var n=[],r=t.vertexHandle,i=r.component;if(i.edges.length<2)return n;if("polyline"===t.editGeometryOperations.data.type&&(0===r.index||r.index===i.vertices.length-1))return n;var a=this.view,o=(0,Z.j7)(r.leftEdge.leftVertex.pos,a,t),u=(0,Z.j7)(r.rightEdge.rightVertex.pos,a,t);return this._processCandidateProposal(o,u,e,t,n),n}},{key:"_processCandidateProposal",value:function(e,t,n,r,i){if(this.exceedsShortLineThreshold(e,t,r)){var a=(0,T.t7)(te,(0,Z.eR)(e),(0,Z.eR)(t),.5),o=.5*(0,T.TE)((0,Z.eR)(e),(0,Z.eR)(t)),u=(0,z.xO)(te,(0,Z.eR)(n),a,o),s=(0,Z.s)((0,Z.al)(u[0],u[1],n[2])),l=r.spatialReference,c=r.pointer,f=(0,C.Rs)(n,l,_.jG,this.view);if((0,P.Bb)(f,(0,C.Rs)(s,l,_.jG,this.view))<this.squaredProximityThreshold(c)){var d;if(this.isVertical(e,s,r)||this.isVertical(s,t,r))return;i.push(new Q({targetPoint:s,point1:e,point2:t,isDraped:"on-the-ground"===(null===(d=r.elevationInfo)||void 0===d?void 0:d.mode)}))}}}}]),n}(N),te=(0,q.Ue)(),ne=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).updating=!1,r._snappers=new m.Z,r._domain=w.B.SELF,r}return(0,s.Z)(n,[{key:"initialize",value:function(){this._snappers.push(new B(this.view,this.options),new O(this.view,this.options),new Y(this.view,this.options),new ee(this.view,this.options))}},{key:"options",set:function(e){this._set("options",e);var t,n=(0,o.Z)(this._snappers);try{for(n.s();!(t=n.n()).done;){t.value.options=e}}catch(r){n.e(r)}finally{n.f()}}},{key:"fetchCandidates",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,i){var a,u,s,l,c,f,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&this._domain&&this.options.effectiveSelfEnabled){e.next=2;break}return e.abrupt("return",[]);case 2:a=[],u=(0,o.Z)(this._snappers.items);try{for(u.s();!(s=u.n()).done;){l=s.value,c=(0,o.Z)(l.snap(t,i));try{for(c.s();!(f=c.n()).done;)d=f.value,a.push(d)}catch(r){c.e(r)}finally{c.f()}}}catch(r){u.e(r)}finally{u.f()}return e.abrupt("return",((0,P.lQ)(t,a),a));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(d.default);function re(e,t){return[new ne({view:e,options:t}),new E.U({view:e,options:t,spatialReference:e.spatialReference})]}(0,f._)([(0,y.Cb)({readOnly:!0})],ne.prototype,"updating",void 0),(0,f._)([(0,y.Cb)({constructOnly:!0})],ne.prototype,"view",void 0),(0,f._)([(0,y.Cb)()],ne.prototype,"options",null),ne=(0,f._)([(0,g.j)("esri.views.interactive.snapping.SelfSnappingEngine")],ne);var ie,ae=n(98173),oe=n(97760),ue=n(95905),se=n(90609),le=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e,r,i,a){var o;return(0,u.Z)(this,n),(o=t.call(this,e,new A.Hk(e),a,w.B.ALL)).first=r,o.second=i,o}return(0,s.Z)(n,[{key:"hints",get:function(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[].concat((0,a.Z)(this.first.hints),(0,a.Z)(this.second.hints),[new se.w(this.targetPoint,this.isDraped,this.domain)])}}]),n}(M.j),ce=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).options=new ae.Z,r.snappingEnginesFactory=re,r._engines=[],r._currentMainCandidate=null,r._currentOtherActiveCandidates=[],r._currentSnappedType=ie.MAIN,r}return(0,s.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,v.watch)((function(){var t=e.options;return{effectiveFeatureEnabled:t.effectiveFeatureEnabled,effectiveSelfEnabled:t.effectiveSelfEnabled,touchSensitivityMultiplier:t.touchSensitivityMultiplier,distance:t.distance}}),(function(){e.doneSnapping(),e.emit("changed")}),v.sync),(0,v.watch)((function(){return e.options}),(function(t){var n,r=(0,o.Z)(e._engines);try{for(r.s();!(n=r.n()).done;){n.value.options=t}}catch(i){r.e(i)}finally{r.f()}}),v.sync),(0,v.watch)((function(){return{viewReady:e.view.ready,viewSpatialReference:e.view.spatialReference,snappingEnginesFactory:e.snappingEnginesFactory}}),(function(t){var n=t.viewReady,r=t.snappingEnginesFactory;return e._recreateEngines(n,r)}),v.syncAndInitial)])}},{key:"destroy",value:function(){this._destroyEngines()}},{key:"updating",get:function(){return this._engines.some((function(e){return e.updating}))}},{key:"_recreateEngines",value:function(e,t){if(this._destroyEngines(),e){var n=this.view,r=this.options;this._engines=t(n,r)}}},{key:"_destroyEngines",value:function(){var e,t=(0,o.Z)(this._engines);try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(n){t.e(n)}finally{t.f()}this._engines=[]}},{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){var e=this.options,t=e.distance*e.touchSensitivityMultiplier;return t*t}},{key:"snap",value:function(e){return function(e){return null!=e.scenePoint}(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}},{key:"update",value:function(e){var t=e.point,n=e.context;this._removeVisualization();var r=this._currentMainCandidate;if(null==r)return t;var i=this._selectUpdateInput(e);if(null==i)return t;var u=n.spatialReference,s=(0,b.project)(i,u);if(null==s)return t;var l=this.view,c=n.elevationInfo,f=n.visualizer,d=[],h=(0,Z.SN)(s,l,c),p=r.constraint.closestTo(h);if(!this._arePointsWithinScreenThreshold(h,p,n)||!de(r,n.drawConstraints))return this._resetSnappingState(),t;r.targetPoint=(0,Z.s)(p),d.push.apply(d,(0,a.Z)(r.hints));var v,y=(0,o.Z)(this._currentOtherActiveCandidates);try{for(y.s();!(v=y.n()).done;){var g=v.value;de(g,n.drawConstraints)&&(g.targetPoint=(0,Z.s)(p),d.push.apply(d,(0,a.Z)(g.hints)))}}catch(_){y.e(_)}finally{y.f()}return null!=f&&this.addHandles(f.draw(d,{spatialReference:u,elevationInfo:pe(n),view:l,selfSnappingZ:n.selfSnappingZ}),fe),(0,Z.aK)(p,l,t,n)}},{key:"doneSnapping",value:function(){this._removeVisualization(),this._resetSnappingState()}},{key:"_selectUpdateInput",value:function(e){var t=e.point,n=e.scenePoint;switch(this._currentSnappedType){case ie.MAIN:return t;case ie.SCENE:return n}}},{key:"_resetSnappingState",value:function(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=ie.MAIN}},{key:"_removeVisualization",value:function(){this.removeHandles(fe)}},{key:"_snapSinglePoint",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,a,o,u,s,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.point,i=t.context,a=t.signal,o=this.view,u=i.elevationInfo,s=(0,Z.SN)(n,o,u),e.next=6,this._fetchCandidates(s,w.B.ALL,i,a);case 6:return l=e.sent,e.abrupt("return",this._createSnapResult(s,ie.MAIN,l,o,n,i,a));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_snapMultiPoint",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var n,i,o,u,s,l,c,f,d,h,p,v,y,g,_,S;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.point,u=t.scenePoint,s=t.context,l=t.signal,c=this.view,f=s.coordinateHelper,d=s.elevationInfo,h=s.spatialReference,e.next=4,(0,b.initializeProjection)(u.spatialReference,h);case 4:return p=(0,b.project)(u,h),v=(0,Z.SN)(p,c,d),e.next=8,this._fetchCandidates(v,w.B.FEATURE,s,l);case 8:if(!((y=e.sent).length>0)){e.next=14;break}return e.next=12,this._fetchCandidates(v,w.B.SELF,s,l);case 12:return g=e.sent,e.abrupt("return",this._createSnapResult(v,ie.SCENE,[].concat((0,a.Z)(y),(0,a.Z)(g)),c,p,s,l));case 14:return _=(0,Z.SN)(o,c,d),e.next=17,this._fetchCandidates(_,w.B.SELF,s,l);case 17:return S=e.sent,e.abrupt("return",this._createSnapResult(_,ie.MAIN,S,c,{z:f.hasZ()&&o.hasZ?null!==(n=o.z)&&void 0!==n?n:0:void 0,m:f.hasM()&&o.hasM?null!==(i=o.m)&&void 0!==i?i:0:void 0},s,l));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchCandidates",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n,i,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._engines.map((function(e){return e.fetchCandidates(t,n,i,a)})));case 2:return e.abrupt("return",e.sent.flat());case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_createSnapResult",value:function(e,t,n,r,i,a,o){var u=this;return{get valid(){return!(0,p.Hc)(o)},apply:function(){var o=a.spatialReference,s=u._processCandidates(e,t,n,a),l=s.snappedPoint,c=s.hints;return u._removeVisualization(),null!=a.visualizer&&u.addHandles(a.visualizer.draw(c,{spatialReference:o,elevationInfo:_.jG,view:r,selfSnappingZ:a.selfSnappingZ}),fe),(0,Z.aK)(l,r,i,a)}}}},{key:"_processCandidates",value:function(e,t,n,r){if(n.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),(0,P.lQ)(e,n);var i=this._currentMainCandidate;if(null!=i){var a=function(e,t){return e instanceof le?he(t,e.first)>=0&&he(t,e.second)>=0?0:-1:he(t,e)}(i,n);if(a>=0){if(!(n[a]instanceof le))return this._intersectWithOtherCandidates(a,n,e,t,r);if(this._arePointsWithinScreenThreshold(e,i.targetPoint,r))return this._updateSnappingCandidate(i,t,n,r)}}return this._intersectWithOtherCandidates(0,n,e,t,r)}},{key:"_intersectWithOtherCandidates",value:function(e,t,n,r,i){for(var a=i.coordinateHelper,u=t[e],s=[],l=0;l<t.length;++l)if(l!==e){var c=t[l],f=u.constraint.intersect(c.constraint);if(f){var d,h=(0,o.Z)(f.closestPoints(u.targetPoint));try{for(h.s();!(d=h.n()).done;){var p=d.value;s.push([new le((0,Z.s)(p),u,c,c.isDraped),this._squaredScreenDistance(n,p,a)])}}catch(v){h.e(v)}finally{h.f()}}}return s.length>0&&(s.sort((function(e,t){return e[1]-t[1]})),s[0][1]<this._squaredPointProximityThreshold(i.pointer))?this._updateSnappingCandidate(s[0][0],r,t,i):de(u,i.drawConstraints)?this._updateSnappingCandidate(u,r,t,i):{snappedPoint:n,hints:[]}}},{key:"_updateSnappingCandidate",value:function(e,t,n,r){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;var i=this._currentMainCandidate.targetPoint,u=[];u.push.apply(u,(0,a.Z)(e.hints));var s,l=(0,o.Z)(n);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(e instanceof le){if(c.constraint.equals(e.first.constraint)||c.constraint.equals(e.second.constraint))continue}else if(c.constraint.equals(e.constraint))continue;var f=c.constraint.closestTo(i);this._squaredScreenDistance(f,i,r.coordinateHelper)<S.c.satisfiesConstraintScreenThreshold*S.c.satisfiesConstraintScreenThreshold&&(c.targetPoint=i,this._currentOtherActiveCandidates.push(c),u.push.apply(u,(0,a.Z)(c.hints)))}}catch(d){l.e(d)}finally{l.f()}return{snappedPoint:i,hints:u}}},{key:"_squaredPointProximityThreshold",value:function(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}},{key:"_arePointsWithinScreenThreshold",value:function(e,t,n){return this._squaredScreenDistance(e,t,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}},{key:"_squaredScreenDistance",value:function(e,t,n){return(0,P.Bb)(this._toScreen(e,n),this._toScreen(t,n))}},{key:"_toScreen",value:function(e,t){return(0,C.Rs)(e,t.spatialReference,_.jG,this.view)}},{key:"test",get:function(){}}]),n}(h.Z.EventedMixin(d.default));(0,f._)([(0,y.Cb)({constructOnly:!0})],ce.prototype,"view",void 0),(0,f._)([(0,y.Cb)()],ce.prototype,"options",void 0),(0,f._)([(0,y.Cb)({readOnly:!0})],ce.prototype,"updating",null),(0,f._)([(0,y.Cb)()],ce.prototype,"snappingEnginesFactory",void 0),(0,f._)([(0,y.Cb)()],ce.prototype,"_engines",void 0),(0,f._)([(0,y.Cb)()],ce.prototype,"_squaredMouseProximityThreshold",null),(0,f._)([(0,y.Cb)()],ce.prototype,"_squaredTouchProximityThreshold",null),ce=(0,f._)([(0,g.j)("esri.views.interactive.snapping.SnappingManager")],ce),function(e){e[e.MAIN=0]="MAIN",e[e.SCENE=1]="SCENE"}(ie||(ie={}));var fe="visualization-handle";function de(e,t){return!t||null==t.direction&&null==t.distance||!(e instanceof oe.k||e instanceof ue.L||e instanceof F||e instanceof H||e instanceof Q)&&(!(e instanceof J.A1)||null==t.direction&&e.selfSnappingType===J.dq.LastVertex)}function he(e,t){for(var n=-1,r=0;r<e.length;++r)if(t.constraint.equals(e[r].constraint)){n=r;break}return n}function pe(e){var t=e.coordinateHelper,n=e.elevationInfo;return t.hasZ()?_.jG:n}},98173:function(e,t,n){n.d(t,{Z:function(){return _}});var r=n(93433),i=n(37762),a=n(15671),o=n(43144),u=n(60136),s=n(29388),l=n(27366),c=n(7138),f=n(63780),d=n(80987),h=n(32718),p=n(49861),v=(n(93169),n(69912)),y=n(22006),g=n(76014),b=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).enabled=!1,r.enabledToggled=!1,r.forceDisabled=!1,r.selfEnabled=!0,r.featureEnabled=!0,r.attributeRulesEnabled=!1,r.featureSources=new d.Z,r.distance=g.c.distance,r.touchSensitivityMultiplier=g.c.touchSensitivityMultiplier,r}return(0,o.Z)(n,[{key:"effectiveEnabled",get:function(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}},{key:"_effectiveFeatureSources",get:function(){var e,t,n,a=this.featureSources;a.some(Z)&&h.Z.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");var o,u=a.filter(w),s=null!==(e=null===(t=this._get("_effectiveFeatureSources"))||void 0===t?void 0:t.filter(Z))&&void 0!==e?e:new d.Z,l=(0,i.Z)(u);try{var c=function(){var e=o.value,t=s.find((function(t){return t.layer===e.layer.parent}));if(t)t.sublayerSources.includes(e)||t.sublayerSources.add(e);else if(e.layer.parent){var n=new y.Z({layer:e.layer.parent});n.sublayerSources.add(e),s.add(n)}};for(l.s();!(o=l.n()).done;)c()}catch(R){l.e(R)}finally{l.f()}var p,v=(0,i.Z)(s);try{for(v.s();!(p=v.n()).done;){var g=p.value,b=g.sublayerSources.filter((function(e){return!u.includes(e)}));g.sublayerSources.removeMany(b)}}catch(R){v.e(R)}finally{v.f()}s.removeMany(s.filter((function(e){return 0===e.sublayerSources.length})));var _=a.filter(S),E=null!==(n=this._get("_effectiveFeatureSources"))&&void 0!==n?n:new d.Z,m=(0,f.e5)(E.toArray(),[].concat((0,r.Z)(_),(0,r.Z)(s))),k=m.added,x=m.removed;return E.removeMany(x),E.addMany(k),E}}]),n}(c.default);(0,l._)([(0,p.Cb)()],b.prototype,"enabled",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"enabledToggled",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"forceDisabled",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"selfEnabled",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"featureEnabled",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"attributeRulesEnabled",void 0),(0,l._)([(0,p.Cb)({type:d.Z.ofType(y.Z)})],b.prototype,"featureSources",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"distance",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"touchSensitivityMultiplier",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],b.prototype,"effectiveEnabled",null),(0,l._)([(0,p.Cb)({readOnly:!0})],b.prototype,"effectiveSelfEnabled",null),(0,l._)([(0,p.Cb)({readOnly:!0})],b.prototype,"effectiveFeatureEnabled",null),(0,l._)([(0,p.Cb)({readOnly:!0})],b.prototype,"_effectiveFeatureSources",null);var _=b=(0,l._)([(0,v.j)("esri.views.interactive.snapping.SnappingOptions")],b);function Z(e){return"subtype-group"===e.layer.type}function S(e){return"subtype-group"!==e.layer.type}function w(e){return"subtype-sublayer"===e.layer.type}},97760:function(e,t,n){n.d(t,{k:function(){return d}});var r=n(1413),i=n(15671),a=n(43144),o=n(60136),u=n(29388),s=n(44179),l=n(64674),c=n(75691),f=n(53397),d=function(e){(0,o.Z)(n,e);var t=(0,u.Z)(n);function n(e){return(0,i.Z)(this,n),t.call(this,(0,r.Z)((0,r.Z)({},e),{},{isDraped:!0,constraint:new s.M8(e.edgeStart,e.edgeEnd,e.getGroundElevation)}))}return(0,a.Z)(n,[{key:"hints",get:function(){return[new f.w(l.ze.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]),n}(c.a)},95905:function(e,t,n){n.d(t,{L:function(){return d}});var r=n(1413),i=n(15671),a=n(43144),o=n(60136),u=n(29388),s=n(44179),l=n(64674),c=n(75691),f=n(53397),d=function(e){(0,o.Z)(n,e);var t=(0,u.Z)(n);function n(e){return(0,i.Z)(this,n),t.call(this,(0,r.Z)((0,r.Z)({},e),{},{constraint:new s.ku(e.edgeStart,e.edgeEnd)}))}return(0,a.Z)(n,[{key:"hints",get:function(){return[new f.w(l.ze.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]),n}(c.a)},75691:function(e,t,n){n.d(t,{a:function(){return s}});var r=n(43144),i=n(15671),a=n(60136),o=n(29388),u=n(80371),s=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r,a=e.targetPoint,o=e.objectId,s=e.constraint,l=e.isDraped;return(0,i.Z)(this,n),(r=t.call(this,a,s,l,u.B.FEATURE)).objectId=o,r}return(0,r.Z)(n)}(n(92605).j)},19824:function(e,t,n){n.d(t,{A1:function(){return p},YJ:function(){return r},dq:function(){return i}});var r,i,a=n(15671),o=n(43144),u=n(60136),s=n(29388),l=n(80371),c=n(64674),f=n(92605),d=n(53397),h=n(41216),p=function(e){(0,u.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r,o=e.targetPoint,u=e.constraint,s=e.previousVertex,c=e.otherVertex,f=e.otherVertexType,d=e.isDraped,h=e.selfSnappingType,p=e.objectId,v=e.domain;return(0,a.Z)(this,n),(r=t.call(this,o,u,d,null!==v&&void 0!==v?v:l.B.SELF)).previousVertex=s,r.otherVertex=c,r.otherVertexType=f,r.selfSnappingType=null!==h&&void 0!==h?h:i.None,r.objectId=null!==p&&void 0!==p?p:null,r}return(0,o.Z)(n,[{key:"hints",get:function(){var e=this.previousVertex,t=this.otherVertexType===r.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===r.CENTER?this.targetPoint:this.otherVertex;return[new d.w(c.ze.TARGET,t,n,this.isDraped,this.domain),new d.w(c.ze.REFERENCE,e,t,this.isDraped,this.domain),new h.y(this.previousVertex,t,n,this.isDraped,this.domain)]}}]),n}(f.j);!function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"}(r||(r={})),function(e){e[e.None=0]="None",e[e.LastVertex=1]="LastVertex",e[e.FirstVertex=2]="FirstVertex",e[e.ExistingEdge=3]="ExistingEdge"}(i||(i={}))},92605:function(e,t,n){n.d(t,{j:function(){return a}});var r=n(43144),i=n(15671),a=(0,r.Z)((function e(t,n,r,a){(0,i.Z)(this,e),this.targetPoint=t,this.constraint=n,this.isDraped=r,this.domain=a}))},90609:function(e,t,n){n.d(t,{w:function(){return l}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),u=n(32035),s=n(80371),l=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,i){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.B.ALL;return(0,r.Z)(this,n),(a=t.call(this,i,o)).intersectionPoint=e,a}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,u.e)(this.intersectionPoint,e.intersectionPoint)}}]),n}(n(55054).r)},53397:function(e,t,n){n.d(t,{w:function(){return l}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),u=(n(93169),n(32718),n(32035)),s=n(80371),l=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,i,a,o){var u,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.B.ALL,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],f=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,r.Z)(this,n),(u=t.call(this,o,l)).type=e,u.lineStart=i,u.lineEnd=a,u.fadeLeft=c,u.fadeRight=f,u}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&this.type===e.type&&(0,u.e)(this.lineStart,e.lineStart)&&(0,u.e)(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}},{key:"length",get:function(){return(0,u.p)(this.lineStart,this.lineEnd)}}]),n}(n(55054).r)},5916:function(e,t,n){n.d(t,{L:function(){return l}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),u=(n(93169),n(32718),n(32035)),s=n(80371),l=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.B.ALL;return(0,r.Z)(this,n),(o=t.call(this,a,u)).lineStart=e,o.lineEnd=i,o}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,u.e)(this.lineStart,e.lineStart)&&(0,u.e)(this.lineEnd,e.lineEnd)}}]),n}(n(55054).r)},41216:function(e,t,n){n.d(t,{y:function(){return l}});var r=n(15671),i=n(43144),a=n(60136),o=n(29388),u=(n(93169),n(32718),n(32035)),s=n(80371),l=function(e){(0,a.Z)(n,e);var t=(0,o.Z)(n);function n(e,i,a,o){var u,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.B.ALL;return(0,r.Z)(this,n),(u=t.call(this,o,l)).previousVertex=e,u.centerVertex=i,u.nextVertex=a,u}return(0,i.Z)(n,[{key:"equals",value:function(e){return e instanceof n&&(0,u.e)(this.previousVertex,e.previousVertex)&&(0,u.e)(this.centerVertex,e.centerVertex)&&(0,u.e)(this.nextVertex,e.nextVertex)}}]),n}(n(55054).r)},55054:function(e,t,n){n.d(t,{r:function(){return a}});var r=n(43144),i=n(15671),a=(0,r.Z)((function e(t,n){(0,i.Z)(this,e),this.isDraped=t,this.domain=n}))},64674:function(e,t,n){n.d(t,{Bb:function(){return v},ML:function(){return Z},Ob:function(){return w},_j:function(){return _},fG:function(){return y},lQ:function(){return g},n0:function(){return E},rh:function(){return b},ze:function(){return r}});var r,i=n(94172),a=n(92377),o=n(76672),u=n(86710),s=n(32035),l=n(55946),c=n(21149),f=n(1614),d=n(87888),h=n(38054),p=n(38675);function v(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function y(e,t){return Math.sqrt(v(e,t))}function g(e,t){t.sort((function(t,n){return(0,s.a)(t.targetPoint,e)-(0,s.a)(n.targetPoint,e)}))}function b(e,t,n){var r=e.point,i=e.distance,s=e.returnEdge,f=e.vertexMode,d=e.coordinateHelper.spatialReference,h=e.filter;return n=null!=n?n.clone():new c.Z({where:"1=1"}),h&&(n.geometry=h.geometry,n.distance=h.distance,n.spatialRelationship=h.spatialRelationship,n.where=(0,o._)(n.where,h.where),n.timeExtent=(0,u.Ov)(n.timeExtent,h.timeExtent),n.objectIds=function(e,t){return e||t?t?e?Array.from((0,a.jV)(new Set(e),new Set(t))):t:e:null}(n.objectIds,h.objectIds)),{point:(0,l.T)(r[0],r[1],r[2],d.toJSON()),mode:t,distance:i,returnEdge:s,vertexMode:f,query:n.toJSON()}}function _(e,t,n){return{left:(0,h.j7)(e.leftVertex.pos,t,n),right:(0,h.j7)(e.rightVertex.pos,t,n)}}function Z(e){return e.createQuery()}!function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"}(r||(r={}));var S=Symbol("snapping-toggle");function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=(0,i.watch)((function(){return{view:e.view,snappingOptions:e.snappingOptions}}),(function(n){var r=n.view,i=n.snappingOptions;if(e.removeHandles(S),r&&i){var a=f.f.TOOL,o=[r.on("key-down",(function(e){e.key!==d.Kj.toggle||e.repeat||(i.enabledToggled=!0,t())}),a),r.on("key-up",(function(e){e.key===d.Kj.toggle&&(i.enabledToggled=!1,t())}),a),r.on("pointer-move",(function(e){var n=e.native.ctrlKey;i.enabledToggled!==n&&(i.enabledToggled=n,t())}),a)];e.addHandles(o,S)}}),i.syncAndInitial);e.addHandles(n)}function E(e){var t;return(0,p.s)(e)&&"utilityNetworks"in e&&!(null===(t=e.utilityNetworks)||void 0===t||!t.length)}},73840:function(e,t,n){n.d(t,{Ci:function(){return _},LH:function(){return S},Lm:function(){return p},d3:function(){return Z},ib:function(){return E},n6:function(){return y},uE:function(){return r},yd:function(){return w},zS:function(){return g}});var r,i=n(17768),a=n(47898),o=n(68860),u=n(13611),s=n(6644),l=n(32035),c=n(12400),f=n(5986),d=n(15559),h=n(92975);function p(e,t){if(null!=e&&null!=t){var n=v(e,t);return null!=n?(0,a.GJ)(n,"radians","geographic"):void 0}}!function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"}(r||(r={}));var v=function(){var e=(0,c.Ue)(),t=(0,c.Ue)();return function(n,r){var i,a;return(0,l.s)(e,n.x,n.y,null!==(i=n.z)&&void 0!==i?i:0),(0,l.s)(t,r.x,r.y,null!==(a=r.z)&&void 0!==a?a:0),y(e,t,n.spatialReference,r.spatialReference)}}(),y=function(){var e=(0,s.Ue)(),t=(0,c.Ue)(),n=(0,c.Ue)();return function(r,i,a,c){if(!(0,l.e)(r,i)){var p=(0,d.Lc)(a),v=(0,d.Lc)(c);if(p&&v&&(0,h.fS)(p,v)&&(0,f.S)(r,a,t,p)&&(0,f.S)(i,c,n,v)){var y=(0,d.cA)(k,t,n,p).azimuth;return null!=y?(0,o.En)(y,"degrees","radians"):void 0}e[0]=i[0]-r[0],e[1]=i[1]-r[1];var g=(0,u.EU)(s.IO,e);return e[0]<0&&(g=x-g),g}}}();function g(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.Absolute;if(t&&n)switch(i){case r.Absolute:return p(t,n);case r.Relative:return _(b(e,t,n),r.Relative);case r.RelativeBilateral:return _(b(e,t,n),r.RelativeBilateral)}}function b(e,t,n){if(e&&t&&n){var r=v(e,t),i=v(t,n);return null!=r&&null!=i?(0,a.GJ)(i-r,"radians","geographic"):void 0}}function _(e,t){if(null!=e)switch(t){case r.Absolute:return Z(e);case r.Relative:var n=w(e),i=L.normalize(n,0,!0);return-180===i&&(i=180),(0,a.GJ)(i,"degrees","geographic");case r.RelativeBilateral:var o=w(e),u=Math.abs(L.normalize(o,0,!0));return(0,a.GJ)(u,"degrees","geographic")}}function Z(e){var t=w(e),n=R.normalize(t,0,!0);return(0,a.GJ)(n,"degrees","geographic")}var S=function(){var e=(0,c.Ue)();return function(t,n,r,i,u){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"geodesic";(0,l.c)(e,n);var c=w(u);if("geodesic"===s){var h=(0,d.Lc)(r);if(h&&(0,f.S)(e,r,e,h))return(0,d.TB)(t,e,c,i,h),t[2]=n[2],!!(0,f.S)(t,h,t,r)}var p=(0,a.hw)(c,"geographic","arithmetic"),v=(0,o.En)(p,"degrees","radians"),y=n[0]+i*Math.cos(v),g=n[1]+i*Math.sin(v),b=n[2];return(0,l.s)(t,y,g,b),!0}}();function w(e){if(null!=e)return(0,a.hw)(m(e),e.rotationType,"geographic")}function E(e){if(null!=e)return(0,a.hw)(m(e),e.rotationType,"arithmetic")}function m(e){return(0,o.En)(e.value,e.unit,"degrees")}var k=new d._q,x=2*Math.PI,R=i.BV,L=new i.pE(-180,180)},94163:function(e,t,n){n.d(t,{SP:function(){return r},UG:function(){return f},dU:function(){return c},k0:function(){return s},xO:function(){return l}});n(16889);var r,i=n(13611),a=n(6644);function o(e,t){return e[0]*t[1]-e[1]*t[0]}function u(e,t,n){var r=(0,i.AK)(n,t)/(0,i.we)(n);return(0,i.bA)(e,n,r)}function s(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n;return(0,i.$X)(h,r,n),(0,i.$X)(v,t,a),u(y,v,h),(0,i.IH)(e,a,y)}function l(e,t,n,r){(0,i.$X)(h,t,n);var a=r/(0,i.kE)(h);return(0,i.od)(e,n,h,a)}function c(e,t){var n=e.start,a=e.end,u=t.start,s=t.end,l=(0,i.$X)(h,a,n),c=(0,i.$X)(p,s,u),f=o(l,c);if(Math.abs(f)<=d)return[];var g=(0,i.$X)(v,n,u),b=o(c,g)/f,_=o(l,g)/f;if(b>=0){if(_>=0||t.type===r.LINE)return[(0,i.od)(y,n,l,b)]}else if(e.type===r.LINE&&(_>=0||t.type===r.LINE))return[(0,i.od)(y,n,l,b)];return[]}function f(e,t,n){var a=[],o=(0,i.$X)(h,e.end,e.start),u=(0,i.$X)(p,e.start,t),s=(0,i.we)(o),l=2*(0,i.AK)(o,u),c=l*l-4*s*((0,i.we)(u)-n*n);if(0===c){var f=-l/(2*s);(e.type===r.LINE||f>=0)&&a.push((0,i.od)(y,e.start,o,f))}else if(c>0){var d=Math.sqrt(c),g=(-l+d)/(2*s);(e.type===r.LINE||g>=0)&&a.push((0,i.od)(y,e.start,o,g));var b=(-l-d)/(2*s);(e.type===r.LINE||b>=0)&&a.push((0,i.od)(v,e.start,o,b))}return a}!function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"}(r||(r={}));var d=1e-6,h=(0,a.Ue)(),p=(0,a.Ue)(),v=(0,a.Ue)(),y=(0,a.Ue)()},55793:function(e,t,n){n.d(t,{$7:function(){return T},Au:function(){return x},CJ:function(){return k},Jk:function(){return E},Nn:function(){return _},SD:function(){return y},UG:function(){return m},Yf:function(){return R},ZE:function(){return w},fK:function(){return g},hA:function(){return P},hm:function(){return b},rq:function(){return C},sc:function(){return S},z9:function(){return Z},zf:function(){return N}});var r,i=n(4942),a=n(37762),o=n(29439),u=n(16889),s=n(13611),l=n(6644),c=n(32035),f=n(12400),d=n(24204),h=n(55652),p=n(80064),v=n(94163);function y(e,t,n){var r=e.start,i=e.end,a=e.type,o=[],u=(0,s.$X)(M,i,r),c=(0,s.$X)(j,r,t),f=(0,s.we)(u),d=2*(0,s.AK)(u,c),h=d*d-4*f*((0,s.we)(c)-n*n);if(0===h){var p=-d/(2*f);(a===E.PLANE||p>=0)&&o.push((0,s.od)((0,l.Ue)(),r,u,p))}else if(h>0){var v=Math.sqrt(h),y=(-d+v)/(2*f);(a===E.PLANE||y>=0)&&o.push((0,s.od)((0,l.Ue)(),r,u,y));var g=(-d-v)/(2*f);(a===E.PLANE||g>=0)&&o.push((0,s.od)((0,l.Ue)(),r,u,g))}return o}function g(e,t){var n=e.start,r=e.end,i=(0,s.$X)(M,r,n),a=(0,c.s)(I,-i[1],i[0],0),o=t.start,u=t.end,l=(0,c.z)(U,u,o),h=(0,c.m)(l,a),p=(0,c.s)(V,n[0],n[1],0),y=(0,c.z)(z,p,o),g=(0,c.m)(y,a),b=(0,d.bn)();if(Math.abs(h)<b)return Math.abs(g),[];var _=(0,c.r)(O,o,l,g/h);if(t.type===v.SP.RAY){var Z=(0,c.z)(q,_,o);if((0,c.m)(Z,l)<-b)return[]}if(e.type===E.HALF_PLANE){var S=(0,s.lu)(j,_,n);if((0,s.AK)(S,i)<-b)return[]}return[(0,f.d9)(_)]}function b(e,t){return function(e,t){var n=e.start,r=e.end,i=e.type,a=(0,c.z)(F,t,n),o=(0,c.z)(I,r,n),u=(0,c.b)(U,o,a),s=(0,c.x)(u)/(0,c.x)(o),l=(0,d.bn)();if(s<l)switch(i){case v.SP.LINE:return[(0,f.d9)(t)];case v.SP.RAY:return(0,c.m)(o,a)<-l?[]:[(0,f.d9)(t)]}return[]}(L(G,t[2],e),t)}function _(e,t){return x(L(G,0,e),L(H,0,t)).map((function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];return(0,l.al)(n,r)}))}function Z(e,t,n){return w(e,L(G,e[2],t),n)}function S(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(0,f.Ue)(),i=(0,s.$X)(M,e,t),a=(0,s.kE)(i);return(0,s.od)(r,t,i,0===a?1:n/a),r[2]=e[2],r}function w(e,t){var n=t.start,r=t.end,i=t.type,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,f.Ue)(),o=(0,c.z)(F,e,n),u=(0,c.z)(I,r,n),s=(0,c.m)(o,u)/(0,c.m)(u,u);return(0,c.r)(a,n,u,i===v.SP.RAY?Math.max(s,0):s)}var E,m=function(){var e=(0,f.Ue)(),t=(0,f.Ue)(),n=(0,f.Ue)();return function(r,i){var u=r.start,d=r.end,y=i.center,g=i.radius,b=i.normal,_=i.slicePlane,Z=(0,h.Yq)(y,b,D);if(P((0,h.TE)(Z,u),0)&&P((0,h.TE)(Z,d),0)){(0,p._F)(b,e,t);var S,w=function(r,i){return(0,c.f)(n,i,y),(0,s.t8)(r,(0,c.m)(n,e),(0,c.m)(n,t)),r},E=(0,v.UG)({start:w(M,u),end:w(j,d),type:v.SP.LINE},l.AG,g),m=[],k=(0,a.Z)(E);try{for(k.s();!(S=k.n()).done;){var x=(0,o.Z)(S.value,2),R=x[0],L=x[1],T=(0,c.c)((0,f.Ue)(),y);(0,c.r)(T,T,e,R),(0,c.r)(T,T,t,L),_&&!N(_,T)||m.push(T)}}catch(A){k.e(A)}finally{k.f()}return m}var C=(0,f.Ue)();return(0,h.fn)(Z,u,d,C)?!P((0,c.p)(C,y),g)||_&&!N(_,C)?[]:[C]:[]}}();function k(e,t,n){var r=e.start,i=e.end,a=e.type,o=[],u=(0,c.f)(F,i,r),l=(0,s.$X)(j,r,t),d=(0,s.we)(u),h=2*(0,s.AK)(u,l),p=h*h-4*d*((0,s.we)(l)-n*n);if(0===p){var y=-h/(2*d);(a===v.SP.LINE||y>=0)&&o.push((0,c.r)((0,f.Ue)(),r,u,y))}else if(p>0){var g=Math.sqrt(p),b=(-h+g)/(2*d);(a===v.SP.LINE||b>=0)&&o.push((0,c.r)((0,f.Ue)(),r,u,b));var _=(-h-g)/(2*d);(a===v.SP.LINE||_>=0)&&o.push((0,c.r)((0,f.Ue)(),r,u,_))}return o}function x(e,t){var n=e.start,r=e.end,i=t.start,a=t.end,o=(0,c.z)(F,r,n),u=(0,c.z)(I,a,i),s=(0,c.z)(U,i,n),l=(0,c.b)(V,o,u);if(!P((0,c.m)(s,l),0))return[];var h=(0,c.x)(l);if(P(h,0))return[];var p=(0,c.b)(z,s,u),y=(0,c.m)(p,l)/h,g=(0,c.r)(O,n,o,y);if(e.type===v.SP.RAY){var b=(0,c.z)(q,g,n);if((0,c.m)(o,b)<-(0,d.bn)())return[]}if(t.type===v.SP.RAY){var _=(0,c.z)(q,g,i);if((0,c.m)(u,_)<-(0,d.bn)())return[]}return[(0,f.d9)(g)]}function R(e,t,n,r){var i=(0,o.Z)(e,2),a=i[0],u=i[1],c=(0,o.Z)(n,2),f=c[0]-a,d=c[1]-u,h=f*f+d*d,p=Math.sqrt(h);if(p>t+r)return[];if(p<Math.abs(t-r))return[];if(P(p,0)&&P(t,r))return[];var v=(t*t-r*r+h)/(2*p),y=Math.sqrt(t*t-v*v),g=y*d/p,b=y*f/p,_=(0,s.t7)(M,e,n,v/p),Z=(0,o.Z)(_,2),S=Z[0],w=Z[1];return P(g,b)?[(0,l.al)(S,w)]:[(0,l.al)(S+g,w-b),(0,l.al)(S-g,w+b)]}function L(e,t,n){var r=n.start,i=n.end,a=n.type;return(0,c.s)(e.start,r[0],r[1],t),(0,c.s)(e.end,i[0],i[1],t),e.type=A[a],e}function T(e,t){return P(e[2],t[2])}function P(e,t){return(0,u.W8)(Math.abs(e-t),0,(0,d.bn)())}function C(e,t){return t.filter((function(t){return N(e,t)}))}function N(e,t){return(0,h.Ac)(e,t)}!function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"}(E||(E={}));var A=(r={},(0,i.Z)(r,E.PLANE,v.SP.LINE),(0,i.Z)(r,E.HALF_PLANE,v.SP.RAY),r),M=(0,l.Ue)(),j=(0,l.Ue)(),F=(0,f.Ue)(),I=(0,f.Ue)(),U=(0,f.Ue)(),V=(0,f.Ue)(),z=(0,f.Ue)(),O=(0,f.Ue)(),q=(0,f.Ue)(),D=(0,h.Ue)(),G={start:(0,f.Ue)(),end:(0,f.Ue)(),type:v.SP.LINE},H={start:(0,f.Ue)(),end:(0,f.Ue)(),type:v.SP.LINE}},38675:function(e,t,n){function r(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass}n.d(t,{s:function(){return r}})}}]);
//# sourceMappingURL=38856.83c7d605.chunk.js.map