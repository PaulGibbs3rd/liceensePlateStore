"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[22705],{22705:function(e,t,r){r.r(t),r.d(t,{default:function(){return y}});var n=r(74165),i=r(93433),a=r(37762),o=r(15861),c=r(15671),s=r(43144),u=(r(59486),r(52639)),l=r(63780),p=r(66978),f=r(25243),v=r(63899),d=r(79803),m=r(27474),w=r(64248),h=r(8835),b=r(28429),g=r(848),y=function(){function e(t){var r=this;(0,c.Z)(this,e),this.viewModel=t,this.createFootprints=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var o,c,s,f,h,g,y,x,Z,k,R,F,C,M,V,A,I,P;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=r.viewModel,c=o.coverageFrustums,s=o.currentBestFeature,f=o.isAdditionalCoverageVisible,h=o.view,g=c.filter(l.pC),y=(0,a.Z)(g),e.prev=2,y.s();case 4:if((x=y.n()).done){e.next=26;break}if(Z=x.value,k=Z.clone(),h.spatialReference.equals(k.spatialReference)){e.next=23;break}if(F=(R=k).components,C=R.spatialReference,M=R.origin,V=R.vertexAttributes,"local"!==R.vertexSpace.type){e.next=16;break}return e.next=12,(0,d.projectWithZConversion)(M,h.spatialReference,t);case 12:A=e.sent,(0,p.k_)(t),k.centerAt(A),e.next=23;break;case 16:return I=V.position,e.t0=Float64Array,e.next=20,(0,w.DC)((0,i.Z)(I),C.clone(),h.spatialReference.clone(),t);case 20:e.t1=e.sent,P=e.t0.from.call(e.t0,e.t1),(0,p.k_)(t),k=new v.Z({vertexAttributes:new m.Q({position:P}),components:F,spatialReference:h.spatialReference.clone()});case 23:Z.imageID===s.attributes.objectId?r.viewModel.bestFeatureFootprint=new u.Z({attributes:{imageID:Z.imageID},geometry:k,symbol:b.RS.clone(),visible:!1}):r.viewModel.additionalFootprints.push(new u.Z({attributes:{imageID:Z.imageID},geometry:k,symbol:b.TU.clone(),visible:f}));case 24:e.next=4;break;case 26:e.next=31;break;case 28:e.prev=28,e.t2=e.catch(2),y.e(e.t2);case 31:return e.prev=31,y.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[2,28,31,34]])})));return function(t){return e.apply(this,arguments)}}(),this.updateFootprint=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,i){var a,c,s,m,g,y,Z,k,R,F,C,M,V,A,I,P,z,S,D,O,j,_,B;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.viewModel,c=a.currentBestFeature,s=a.imagePointsInView,m=a.activeViewer,g=a.footprintExtent,y=a.view,Z=(0,f.se)(v.Z,r.viewModel.getCurrentBestFeaturePolygon().geometry),k=null===m||void 0===m?void 0:m.imageSize,c&&Z&&s&&k&&g){e.next=3;break}return e.abrupt("return");case 3:return R=c.attributes,F=R.cameraHeight,C=R.location,M=R.cameraPitch,V=R.horizontalFieldOfView,A=R.verticalFieldOfView,I=R.cameraRoll,P=R.imageRotation,z=C.toArray(),S=Z.vertexAttributes.position,D=Z.spatialReference,e.next=16,x(S,D,C.spatialReference);case 16:return O=e.sent,e.next=19,(0,h.y)(t,{feature:c,imageProperties:{width:k[0],height:k[1]},options:i,footprintExtent:g});case 19:if(j=e.sent,(0,p.k_)(i),(_=j.filter(l.pC)).length){e.next=24;break}return e.abrupt("return");case 24:if(e.t0=_[0].spatialReference.equals(C.spatialReference),e.t0){e.next=29;break}return e.next=28,Promise.all(_.map(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.projectWithZConversion)(t,C.spatialReference,i);case 2:return r=e.sent,e.abrupt("return",((0,p.k_)(i),r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 28:_=e.sent;case 29:return e.next=31,(0,w.Ff)(s.slice(0,4).map((function(e){return[e.x,e.y]})),_.slice(0,4).map((function(e){return e.toArray()})),{cameraHeight:F,cameraLocation:z,cameraPitch:M,frustumVertices:O,horizontalFieldOfView:V,imageHeight:k[1],imageWidth:k[0],inSRS:{wkid:C.spatialReference.wkid},outSRS:{wkid:y.spatialReference.wkid},verticalFieldOfView:A,cameraRoll:null!==I&&void 0!==I?I:0,imageRotation:null!==P&&void 0!==P?P:0,options:i});case 31:B=e.sent,r.viewModel.updateCurrentCoveragePolygon(new u.Z({attributes:{imageID:c.attributes.objectId},geometry:B,symbol:b.RS.clone(),visible:r.viewModel.currentCoverageVisible}));case 33:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.updateFootprintPanorama=function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t,i){var a,o,c,s,l,f,v,d,m;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.Yn)(i);case 2:if(o=t.horizontalFieldOfView,c=t.pitch,s=t.verticalFieldOfView,l=t.yaw,f=null===(a=r.viewModel.currentBestFeature)||void 0===a?void 0:a.clone()){e.next=5;break}return e.abrupt("return");case 5:(v=f.attributes).orientedImageryType=null,v.cameraHeading=(l+v.cameraHeading)%360,v.cameraPitch=c,v.horizontalFieldOfView=o,v.verticalFieldOfView=s,v.cameraRoll=0,d=(0,w.QX)(v),(m=d.frustum)&&r.viewModel.updateCurrentCoveragePolygon(new u.Z({attributes:{imageID:v.objectId},geometry:m,symbol:b.RS.clone(),visible:r.viewModel.currentCoverageVisible}));case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}return(0,s.Z)(e,[{key:"updateGroundElevation",value:function(e,t){var r=this.viewModel.currentBestFeature.geometry,n=t.queryElevation(r);e.forEach((function(e){var t,r,i=e.geometry;switch(null===i||void 0===i?void 0:i.type){case"mesh":for(var a=i.vertexAttributes.position,o=Math.floor(a.length/3),c=0;c<o;c+=1){var s;a[3*c+2]+=null!==(s=null===n||void 0===n?void 0:n.z)&&void 0!==s?s:0}break;case"point":i.z=(null!==(t=i.z)&&void 0!==t?t:0)+(null!==(r=null===n||void 0===n?void 0:n.z)&&void 0!==r?r:0)}}))}}]),e}();function x(e,t,r,n){return Z.apply(this,arguments)}function Z(){return Z=(0,o.Z)((0,n.Z)().mark((function e(t,r,i,a){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Float64Array,e.next=3,Promise.all(t.reduce((function(e,t,r){var n,i=Math.floor(r/3);return e[i]=null!==(n=e[i])&&void 0!==n?n:[],e[i].push(t),e}),new Array).map(function(){var e=(0,o.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.projectWithZConversion)(new g.Z(t,r),i,a);case 2:return e.abrupt("return",e.sent.toArray());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.t1=e.sent.flat(),e.abrupt("return",e.t0.from.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}}}]);
//# sourceMappingURL=22705.57eae7f7.chunk.js.map