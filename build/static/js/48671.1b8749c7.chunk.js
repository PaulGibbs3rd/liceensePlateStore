"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[48671],{35609:function(e,t,n){function r(){var e=new Float32Array(6);return e[0]=1,e[3]=1,e}function i(e,t,n,r){var i=t[r],a=t[r+1];e[r]=n[0]*i+n[2]*a+n[4],e[r+1]=n[1]*i+n[3]*a+n[5]}function a(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,s=a||t.length/l,o=r;o<s;o++)i(e,t,n,o*l)}n.d(t,{Ue:function(){return r},Zz:function(){return a}});Object.freeze(Object.defineProperty({__proto__:null,clone:function(e){var t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},create:r,createView:function(e,t){return new Float32Array(e,t,6)},fromValues:function(e,t,n,r,i,a){var l=new Float32Array(6);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=a,l},transform:i,transformMany:a},Symbol.toStringTag,{value:"Module"}))},50264:function(e,t,n){n.d(t,{Iu:function(){return c},Jp:function(){return s},U1:function(){return o},U_:function(){return l},Us:function(){return d},bA:function(){return u},t8:function(){return a},vc:function(){return y},xJ:function(){return f},yR:function(){return i}});var r=n(24204);function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function a(e,t,n,r,i,a,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=l,e}function l(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],l=t[4],s=t[5],o=n*a-r*i;return o?(o=1/o,e[0]=a*o,e[1]=-r*o,e[2]=-i*o,e[3]=n*o,e[4]=(i*s-a*l)*o,e[5]=(r*l-n*s)*o,e):null}function s(e,t,n){var r=t[0],i=t[1],a=t[2],l=t[3],s=t[4],o=t[5],u=n[0],c=n[1],d=n[2],f=n[3],y=n[4],v=n[5];return e[0]=r*u+a*c,e[1]=i*u+l*c,e[2]=r*d+a*f,e[3]=i*d+l*f,e[4]=r*y+a*v+s,e[5]=i*y+l*v+o,e}function o(e,t,n){var r=t[0],i=t[1],a=t[2],l=t[3],s=t[4],o=t[5],u=Math.sin(n),c=Math.cos(n);return e[0]=r*c+a*u,e[1]=i*c+l*u,e[2]=r*-u+a*c,e[3]=i*-u+l*c,e[4]=s,e[5]=o,e}function u(e,t,n){var r=t[0],i=t[1],a=t[2],l=t[3],s=t[4],o=t[5],u=n[0],c=n[1];return e[0]=r*u,e[1]=i*u,e[2]=a*c,e[3]=l*c,e[4]=s,e[5]=o,e}function c(e,t,n){var r=t[0],i=t[1],a=t[2],l=t[3],s=t[4],o=t[5],u=n[0],c=n[1];return e[0]=r,e[1]=i,e[2]=a,e[3]=l,e[4]=r*u+a*c+s,e[5]=i*u+l*c+o,e}function d(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e}function f(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function y(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function v(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}var h=s,p=v;Object.freeze(Object.defineProperty({__proto__:null,add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},equals:function(e,t){var n=e[0],i=e[1],a=e[2],l=e[3],s=e[4],o=e[5],u=t[0],c=t[1],d=t[2],f=t[3],y=t[4],v=t[5],h=(0,r.bn)();return Math.abs(n-u)<=h*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-c)<=h*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-d)<=h*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(l-f)<=h*Math.max(1,Math.abs(l),Math.abs(f))&&Math.abs(s-y)<=h*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(o-v)<=h*Math.max(1,Math.abs(o),Math.abs(v))},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},fromRotation:d,fromScaling:f,fromTranslation:y,identity:i,invert:l,mul:h,multiply:s,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e},multiplyScalarAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e},rotate:o,scale:u,set:a,str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},sub:p,subtract:v,translate:c},Symbol.toStringTag,{value:"Module"}))},82582:function(e,t,n){n.d(t,{D9:function(){return o},DE:function(){return s},dp:function(){return l},o2:function(){return u},yZ:function(){return a}});var r=n(16889),i=n(68860);function a(e,t){var n=t||e.extent,r=e.width,a=(0,i.c9)(null===n||void 0===n?void 0:n.spatialReference);return n&&r?n.width/r*a*i.hd*96:0}function l(e,t){return e/((0,i.c9)(t)*i.hd*96)}function s(e){return e/(96*i.hd)}function o(e,t){var n=e.extent,r=e.width-(e.padding?e.padding.left+e.padding.right:0),i=l(t,n.spatialReference);return n.clone().expand(i*r/n.width)}function u(e,t,n){return function(e,t){return 0===t||(0,r.W8)(e,t)||e<t}(e,t)&&function(e,t){return 0===t||(0,r.W8)(e,t)||e>t}(e,n)}},41978:function(e,t,n){n.d(t,{AM:function(){return b}});var r=n(93433),i=n(15671),a=n(43144),l=n(60136),s=n(29388),o=n(27366),u=n(7138),c=n(93169),d=n(84652),f=n(32718),y=n(49861),v=n(69912),h=n(85411),p=n(32551),m=-1,b=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._from=null,r._to=null,r._final=null,r._current=[],r._time=0,r.duration=(0,c.Z)("mapview-transitions-duration"),r.effects=[],r}return(0,a.Z)(n,[{key:"effect",set:function(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(g(e))}catch(t){this._transitionTo([]),f.Z.getLogger(this).warn("Invalid Effect",{effect:e,error:t})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(e){this._updateForScale(e)}},{key:"transitioning",get:function(){return null!==this._to}},{key:"canTransitionTo",value:function(e){try{return this.scale>0&&_(this._current,g(e),this.scale)}catch(t){return!1}}},{key:"transitionStep",value:function(e,t){this._applyTimeTransition(e),this._updateForScale(t)}},{key:"endTransitions",value:function(){this._applyTimeTransition(this.duration)}},{key:"_transitionTo",value:function(e){this.scale>0&&_(this._current,e,this.scale)?(this._final=e,this._to=(0,d.d9)(e),function(e,t,n){for(var i,a,l=e.length>t.length?e:t,s=e.length>t.length?t:e,o=s[s.length-1],u=null!==(i=null===o||void 0===o?void 0:o.scale)&&void 0!==i?i:n,c=null!==(a=null===o||void 0===o?void 0:o.effects)&&void 0!==a?a:[],d=s.length;d<l.length;d++)s.push({scale:u,effects:(0,r.Z)(c)});for(var f=0;f<l.length;f++)s[f].scale=s[f].scale===m?n:s[f].scale,l[f].scale=l[f].scale===m?n:l[f].scale,(0,p.uF)(s[f].effects,l[f].effects)}(this._current,this._to,this.scale),this._from=(0,d.d9)(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?(0,d.d9)(this._current[0].effects):[])}},{key:"_applyTimeTransition",value:function(e){if(this._to&&this._from&&this._current&&this._final){this._time+=e;for(var t=Math.min(1,this._time/this.duration),n=0;n<this._current.length;n++){var r=this._current[n],i=this._from[n],a=this._to[n];r.scale=L(i.scale,a.scale,t);for(var l=0;l<r.effects.length;l++){var s=r.effects[l],o=i.effects[l],u=a.effects[l];s.interpolate(o,u,t)}}1===t&&(this._current=this._final,this._set("effects",this._current[0]?(0,d.d9)(this._current[0].effects):[]),this._from=this._to=this._final=null)}}},{key:"_updateForScale",value:function(e){if(this._set("scale",e),0!==this._current.length){var t,n,r=this._current,i=this._current.length-1,a=1;if(1===r.length||e>=r[0].scale)n=t=r[0].effects;else if(e<=r[i].scale)n=t=r[i].effects;else for(var l=0;l<i;l++){var s=r[l],o=r[l+1];if(s.scale>=e&&o.scale<=e){a=(e-s.scale)/(o.scale-s.scale),t=s.effects,n=o.effects;break}}for(var u=0;u<this.effects.length;u++)this.effects[u].interpolate(t[u],n[u],a)}}}]),n}(u.default);function g(e){var t=(0,h.Q)(e)||[];return function(e){var t=e[0];return!!t&&"type"in t}(t)?[{scale:m,effects:t}]:t}function _(e,t,n){var r,i,a,l;return null===(r=e[0])||void 0===r||!r.effects||null===(i=t[0])||void 0===i||!i.effects||!(((null===(a=e[0])||void 0===a?void 0:a.scale)===m||(null===(l=t[0])||void 0===l?void 0:l.scale)===m)&&(e.length>1||t.length>1)&&n<=0)&&(0,p.AS)(e[0].effects,t[0].effects)}function L(e,t,n){return e+(t-e)*n}(0,o._)([(0,y.Cb)()],b.prototype,"_to",void 0),(0,o._)([(0,y.Cb)()],b.prototype,"duration",void 0),(0,o._)([(0,y.Cb)({value:""})],b.prototype,"effect",null),(0,o._)([(0,y.Cb)({readOnly:!0})],b.prototype,"effects",void 0),(0,o._)([(0,y.Cb)({readOnly:!0})],b.prototype,"hasEffects",null),(0,o._)([(0,y.Cb)({value:0})],b.prototype,"scale",null),(0,o._)([(0,y.Cb)({readOnly:!0})],b.prototype,"transitioning",null),b=(0,o._)([(0,v.j)("esri.layers.effects.EffectView")],b)},44041:function(e,t,n){n.d(t,{R:function(){return m}});var r=n(1413),i=n(15671),a=n(43144),l=n(60136),s=n(29388),o=n(27366),u=n(7138),c=n(76672),d=n(49861),f=(n(93169),n(32718),n(84936),n(69912)),y=n(82582),v=n(87072),h=n(58132),p={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"},m=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).floors=null,r.scale=0,r}return(0,a.Z)(n,[{key:"destroy",value:function(){this.layer=null}},{key:"dynamicLayers",get:function(){var e=this;if(!this.hasDynamicLayers)return null;var t=this.visibleSublayers.map((function(t){var n=(0,v.f)(e.floors,t);return t.toExportImageJSON(n)}));return t.length?JSON.stringify(t):null}},{key:"hasDynamicLayers",get:function(){return this.layer&&(0,h.FN)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("sublayer-update",(function(e){return t.notifyChange(p[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){var e=this.visibleSublayers;return e?e.length?"show:"+e.map((function(e){return e.id})).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var e,t=this,n=!(null===(e=this.floors)||void 0===e||!e.length),r=this.visibleSublayers.filter((function(e){return null!=e.definitionExpression||n&&null!=e.floorInfo}));return r.length?JSON.stringify(r.reduce((function(e,n){var r=(0,v.f)(t.floors,n),i=(0,c._)(r,n.definitionExpression);return null!=i&&(e[n.id]=i),e}),{})):null}},{key:"version",get:function(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers");var e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=[];if(!this.layer)return e;var t=this.layer.sublayers,n=this.scale;t&&t.forEach((function t(r){r.visible&&(0===n||(0,y.o2)(n,r.minScale,r.maxScale))&&(r.sublayers?r.sublayers.forEach(t):e.unshift(r))}));var r=this._get("visibleSublayers");return!r||r.length!==e.length||r.some((function(t,n){return e[n]!==t}))?e:r}},{key:"toJSON",value:function(){var e=this.layer,t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t=(0,r.Z)((0,r.Z)({},t),{},{layers:this.layers,layerDefs:this.layerDefs}),t}}]),n}(u.default);(0,o._)([(0,d.Cb)({readOnly:!0})],m.prototype,"dynamicLayers",null),(0,o._)([(0,d.Cb)()],m.prototype,"floors",void 0),(0,o._)([(0,d.Cb)({readOnly:!0})],m.prototype,"hasDynamicLayers",null),(0,o._)([(0,d.Cb)()],m.prototype,"layer",null),(0,o._)([(0,d.Cb)({readOnly:!0})],m.prototype,"layers",null),(0,o._)([(0,d.Cb)({readOnly:!0})],m.prototype,"layerDefs",null),(0,o._)([(0,d.Cb)({type:Number})],m.prototype,"scale",void 0),(0,o._)([(0,d.Cb)({readOnly:!0})],m.prototype,"version",null),(0,o._)([(0,d.Cb)({readOnly:!0})],m.prototype,"visibleSublayers",null),m=(0,o._)([(0,f.j)("esri.layers.support.ExportImageParameters")],m)},87072:function(e,t,n){function r(e){var t,n=e.layer;return"floorInfo"in n&&null!==(t=n.floorInfo)&&void 0!==t&&t.floorField&&"floors"in e.view?a(e.view.floors,n.floorInfo.floorField):null}function i(e,t){var n;return"floorInfo"in t&&null!==(n=t.floorInfo)&&void 0!==n&&n.floorField?a(e,t.floorInfo.floorField):null}function a(e,t){if(null===e||void 0===e||!e.length)return null;var n=e.filter((function(e){return""!==e})).map((function(e){return"'".concat(e,"'")}));return n.push("''"),"".concat(t," IN (").concat(n.join(","),") OR ").concat(t," IS NULL")}n.d(t,{c:function(){return r},f:function(){return i}})},92089:function(e,t,n){n.d(t,{Ao:function(){return s},DV:function(){return l},JQ:function(){return a},rL:function(){return i}});var r={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function i(e){var t;return null!==(t=r[e])&&void 0!==t?t:[-34028234663852886e22,34028234663852886e22]}function a(e,t){return null==e||null==t?"s32":e<0?e>=-128&&t<128?"s8":e>=-32768&&t<32768?"s16":"s32":t<256?"u8":t<65536?"u16":"u32"}function l(e){var t;return null!==(t=(null===e||void 0===e?void 0:e.startsWith("s"))||(null===e||void 0===e?void 0:e.startsWith("u")))&&void 0!==t&&t}function s(e,t,n){var r,a;if(!(e.depthCount&&e.depthCount>1)){for(var l=e.pixels,s=e.statistics,o=e.pixelType,u=l[0].length,c=null!==(r=e.bandMasks)&&void 0!==r?r:[],d=null!==(a=e.mask)&&void 0!==a?a:new Uint8Array(u).fill(255),f="f32"===o||"f64"===o,y=i(o),v=!1,h=0;h<l.length;h++){var p,m,b,g,_="number"==typeof t?t:t[h];if(null!=_){var L=null!==(p=null===s||void 0===s||null===(m=s[h])||void 0===m?void 0:m.minValue)&&void 0!==p?p:y[0],w=null!==(b=null===s||void 0===s||null===(g=s[h])||void 0===g?void 0:g.maxValue)&&void 0!==b?b:y[1];if(!(L>_+Number.EPSILON||w<_-Number.EPSILON)){var S=c[h]||d.slice(),k=l[h],x=null===n||void 0===n?void 0:n.customFloatTolerance;if(f&&0!==x){var C=x;C||(C=Math.abs(_)>=9999999e31?2e-7*Math.abs(_):"f32"===o?Math.pow(2,-23):Number.EPSILON);for(var I=0;I<k.length;I++)S[I]&&Math.abs(k[I]-_)<C&&(k[I]=0,S[I]=0,d[I]=0,v=!0)}else for(var E=0;E<k.length;E++)S[E]&&k[E]===_&&(k[E]=0,S[E]=0,d[E]=0,v=!0);c[h]=S}}}v&&(e.bandMasks=e.bandMasks||e.pixels.length>1?c:null,e.mask=d),v&&"updateStatistics"in e&&e.updateStatistics()}}},58132:function(e,t,n){n.d(t,{FN:function(){return l},QV:function(){return a},ac:function(){return o}});var r=n(37762),i=n(25265);function a(e,t,n){return t.flatten((function(e){return e.sublayers})).length!==e.length||(!!e.some((function(e){return e.originIdOf("minScale")>n||e.originIdOf("maxScale")>n||e.originIdOf("renderer")>n||e.originIdOf("labelingInfo")>n||e.originIdOf("opacity")>n||e.originIdOf("labelsVisible")>n||e.originIdOf("source")>n}))||!s(e,t))}function l(e,t,n){return!!e.some((function(e){var t=e.source,r=!t||"map-layer"===t.type&&t.mapLayerId===e.id&&(null==t.gdbVersion||t.gdbVersion===n);return e.commitProperty("renderer"),e.commitProperty("labelingInfo"),e.commitProperty("opacity"),e.commitProperty("labelsVisible"),!r||e.originIdOf("renderer")>i.s3.SERVICE||e.originIdOf("labelingInfo")>i.s3.SERVICE||e.originIdOf("opacity")>i.s3.SERVICE||e.originIdOf("labelsVisible")>i.s3.SERVICE}))||!s(e,t)}function s(e,t){if(null===e||void 0===e||!e.length||null==t)return!0;var n=t.slice().reverse().flatten((function(e){var t=e.sublayers;return t&&t.toArray().reverse()})).map((function(e){return e.id})).toArray();if(e.length>n.length)return!1;var i,a=0,l=n.length,s=(0,r.Z)(e);try{for(s.s();!(i=s.n()).done;){for(var o=i.value.id;a<l&&n[a]!==o;)a++;if(a>=l)return!1}}catch(u){s.e(u)}finally{s.f()}return!0}function o(e){return!!e&&e.some((function(e){var t;return null!=e.minScale||null!=(null===(t=e.layerDefinition)||void 0===t?void 0:t.minScale)}))}},61029:function(e,t,n){n.d(t,{e:function(){return s},s:function(){return o}});var r=n(1413),i=n(63780),a=(n(93169),n(10064)),l=n(23707);function s(e){return null==e||"simple"===e.type||"unique-value"===e.type||"class-breaks"===e.type||"dictionary"===e.type||"heatmap"===e.type}function o(e,t){if(null==e)return null;if(!s(e))return new a.Z("renderer-conversion-3d:unsupported-renderer","Unsupported renderer of type '".concat(e.type||e.declaredClass,"'"),{renderer:e});switch(e.type){case"simple":return function(e,t){var n=(0,r.Z)((0,r.Z)((0,r.Z)({},l.K),t),{},{cimFallbackEnabled:!0});return u(e,(0,l.q)(e.symbol,n).error)}(e,t);case"unique-value":return function(e,t){var n,a=(0,r.Z)((0,r.Z)((0,r.Z)({},l.K),t),{},{cimFallbackEnabled:!0}),s=null===(n=e.uniqueValueInfos)||void 0===n?void 0:n.map((function(e){return(0,l.q)(e.symbol,a).error})).filter(i.pC),o=(0,l.q)(e.defaultSymbol,a);return o.error&&null!==s&&void 0!==s&&s.unshift(o.error),u(e,s)}(e,t);case"class-breaks":return function(e,t){var n=(0,r.Z)((0,r.Z)((0,r.Z)({},l.K),t),{},{cimFallbackEnabled:!0}),a=e.classBreakInfos.map((function(e){return(0,l.q)(e.symbol,n).error})).filter(i.pC),s=(0,l.q)(e.defaultSymbol,n);return s.error&&a.unshift(s.error),u(e,a)}(e,t);case"dictionary":case"heatmap":return null}return null}function u(e,t){if(!t)return null;var n;if((n=Array.isArray(t)?t:[t]).length>0){var r=n.map((function(e){return e.details.symbol.type||e.details.symbol.declaredClass})).filter((function(e){return!!e}));r.sort();var i=[];return r.forEach((function(e,t){0!==t&&e===r[t-1]||i.push(e)})),new a.Z("renderer-conversion-3d:unsupported-symbols","Renderer contains symbols (".concat(i.join(", "),") which are not supported in 3D"),{renderer:e,symbolErrors:n})}return null}},74184:function(e,t,n){function r(e,t){var n=e.featureReduction;return n&&"selection"!==n.type&&(!("maxScale"in n)||!n.maxScale||n.maxScale<t.scale)?n:null}n.d(t,{g:function(){return r}})},9720:function(e,t,n){n.r(t),n.d(t,{default:function(){return Yt}});var r=n(1413),i=n(15671),a=n(43144),l=n(60136),s=n(29388),o=n(27366),u=n(94172),c=n(49861),d=n(89125),f=(n(84936),n(93169),n(69912)),y=n(33565),v=(n(59166),n(7138)),h=n(80987),p=n(32718),m=n(693),b=n(74184),g=n(4942),_=n(29439),L=n(93433),w=n(74165),S=n(37762),k=n(15861),x=n(51995),C=n(19545),I=n(76200),E=(n(51508),n(63780)),R=n(43404),Z=n(66978),V=n(17842),F=n(76672),z=n(35995),A=n(25265),T=n(41978),M=n(60676),D=n(44041),N=n(37933),O=n(92089),P=n(9014),B=n(61029),H=n(7635),U=n(12726),q=n(57996),j=n(49729),W=n(37817),G=n(69157),J=n(86828),Q=n(74579);var X=n(226),K=n(41586),Y=n(44085),$=n(66128),ee=n(75434),te=n(89773),ne=n(16072),re=n(61459),ie=n(41201),ae=n(8704),le=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,se=new R.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),oe=new ne.default({size:6,outline:{color:[128,128,128,.5],width:.5}}),ue=new re.default({style:"solid"});function ce(e){return"flow"===e.type}function de(e){return"vector-field"===e.type}function fe(e){return"raster-colormap"===e.type}function ye(e){return"raster-stretch"===e.type}function ve(e){return"raster-shaded-relief"===e.type}function he(e){return"esri.renderers.SimpleRenderer"===e.declaredClass}function pe(e){return"esri.renderers.ClassBreaksRenderer"===e.declaredClass}function me(e){return"esri.renderers.UniqueValueRenderer"===e.declaredClass}function be(e){return"esri.renderers.HeatmapRenderer"===e.declaredClass}function ge(e){return _e(e)||Le(e)||we(e)||function(e){return"esri.renderers.PointCloudRGBRenderer"===e.declaredClass}(e)}function _e(e){return"esri.renderers.PointCloudClassBreaksRenderer"===e.declaredClass}function Le(e){return"esri.renderers.PointCloudStretchRenderer"===e.declaredClass}function we(e){return"esri.renderers.PointCloudUniqueValueRenderer"===e.declaredClass}function Se(e){return"esri.renderers.DotDensityRenderer"===e.declaredClass}function ke(e){return"esri.renderers.PieChartRenderer"===e.declaredClass}function xe(e,t){return he(e)||pe(e)||me(e)||be(e)||Se(e)||ke(e)?"2d"===t.type||(0,B.e)(e):ye(e)||fe(e)||ve(e)||_e(e)||Le(e)||we(e)||de(e)||ce(e)}function Ce(e){return"esri.layers.BuildingSceneLayer"===e.declaredClass}function Ie(e){return"esri.layers.SubtypeGroupLayer"===e.declaredClass}function Ee(e){return"esri.layers.VoxelLayer"===e.declaredClass}function Re(e){return"esri.layers.WMSLayer"===e.declaredClass}function Ze(e){return"esri.layers.WMTSLayer"===e.declaredClass}function Ve(e){return"esri.layers.MapImageLayer"===e.declaredClass}function Fe(e){return"esri.layers.TileLayer"===e.declaredClass}function ze(e){return"esri.layers.ImageryLayer"===e.declaredClass}function Ae(e){return"esri.layers.ImageryTileLayer"===e.declaredClass}function Te(e){return"esri.layers.WCSLayer"===e.declaredClass}function Me(e){return"stretch-ramp"===e.type}function De(e){var t="authoringInfo"in e?null===e||void 0===e?void 0:e.authoringInfo:null;return"univariate-color-size"===(null===t||void 0===t?void 0:t.type)}function Ne(e){var t="authoringInfo"in e?null===e||void 0===e?void 0:e.authoringInfo:null;return"univariate-color-size"===(null===t||void 0===t?void 0:t.type)&&"above-and-below"===(null===t||void 0===t?void 0:t.univariateTheme)}function Oe(e){return"sublayers"in e}function Pe(e,t){return Be.apply(this,arguments)}function Be(){return Be=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ie.ME)("esri/widgets/Legend/t9n/Legend");case 2:return r=e.sent,e.abrupt("return",("previewTemplateAriaLabel"!==t||n||(t="previewAriaLabel"),(0,ae.n)(r[t],{label:n})));case 4:case"end":return e.stop()}}),e)}))),Be.apply(this,arguments)}var He=new ne.default({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}}),Ue={},qe=function(e){(0,l.Z)(o,e);var t=(0,s.Z)(o);function o(e){var n;return(0,i.Z)(this,o),(n=t.call(this,e))._hasColorRamp=!1,n._hasOpacityRamp=!1,n._hasSizeRamp=!1,n._webStyleSymbolCache=new Map,n._dotDensityUrlCache=new Map,n._scaleDrivenSizeVariable=null,n._hasClusterSizeVariable=!1,n._layerDefinitionExpressionClause=null,n.children=new h.Z,n.layerView=null,n.layer=null,n.legendElements=[],n.parent=null,n.hideLayersNotInCurrentView=!1,n.keepCacheOnDestroy=!1,n.respectLayerDefinitionExpression=!1,n.respectLayerVisibility=!0,n.sublayerIds=[],n.title=null,n.view=null,n}return(0,a.Z)(o,[{key:"initialize",value:function(){var e=this,t=function(){return e.notifyChange("ready")};this.addHandles([(0,u.on)((function(){return e.children}),"change",(function(n){var r=n.added,i=n.removed;r.forEach((function(n){var r="activeLayerInfo-ready-watcher-".concat(n.layer.uid);e.addHandles((0,u.watch)((function(){return n.ready}),t,u.initial),r)})),i.forEach((function(t){return e.removeHandles(t.layer.uid)})),t()}))]),this.keepCacheOnDestroy||(Ue={})}},{key:"destroy",value:function(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(Ue=null),this._layerDefinitionExpressionClause=null}},{key:"effectList",get:function(){var e=this.layer,t=null;return"effect"in e&&e.effect&&((t=new T.AM).effect=e.effect,t.endTransitions(),t.scale=this.scale),t}},{key:"opacity",get:function(){var e,t=this.layer.opacity,n=null===(e=this.parent)||void 0===e?void 0:e.opacity,r=this.layer.parent,i=r&&"uid"in r?this._getParentLayerOpacity(r):null;return null!=n?n*t:null!=i?i*t:t}},{key:"ready",get:function(){return null===this.layer||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}},{key:"scale",get:function(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.scale)&&void 0!==e?e:0}},{key:"isScaleDriven",get:function(){var e=this.layer;if(null===e)return!1;if("effect"in e&&e.effect&&Array.isArray(e.effect))return!0;if("featureReduction"in e&&e.featureReduction){if("cluster"===e.featureReduction.type)return!0;if("binning"===e.featureReduction.type&&"renderer"in e.featureReduction&&e.featureReduction.renderer)return this._isRendererScaleDriven(e.featureReduction.renderer)}return"renderer"in e&&e.renderer?this._isRendererScaleDriven(e.renderer):this._isLayerScaleDriven(this.layer)}},{key:"version",get:function(){return this._get("version")+1}},{key:"buildLegendElementsForFeatureCollections",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l,s,o,u,c,d,f=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!this.hideLayersNotInCurrentView,e.t0){e.next=5;break}return e.next=4,this._isLayerInCurrentView();case 4:e.t0=e.sent;case 5:if(e.t0){e.next=7;break}return e.abrupt("return",(this.legendElements=[],void this.notifyChange("ready")));case 7:return n=Array.from(t,(function(e){var t;if((0,N.Te)(e))return f._getRendererLegendElements(e.renderer,{title:e.title});if(null!==(t=e.featureSet)&&void 0!==t&&t.features.length){var n=e.layerDefinition,r=null===n||void 0===n?void 0:n.drawingInfo,i=r&&(0,P.i)(r.renderer),a=se.read(n.geometryType);return i?f._getRendererLegendElements(i,{title:e.name,geometryType:a}):(p.Z.getLogger(f).warn("drawingInfo not available!"),null)}return null})),e.prev=8,r=[],e.next=12,Promise.allSettled(n);case 12:i=e.sent,a=(0,S.Z)(i);try{for(a.s();!(l=a.n()).done;)if("fulfilled"===(s=l.value).status){u=(0,S.Z)(null!==(o=s.value)&&void 0!==o?o:[]);try{for(u.s();!(c=u.n()).done;)d=c.value,r.push(d)}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}this.legendElements=r,this.notifyChange("ready"),e.next=21;break;case 18:e.prev=18,e.t1=e.catch(8),p.Z.getLogger(this).warn("error while building legend for layer!",e.t1);case 21:case"end":return e.stop()}}),e,this,[[8,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"buildLegendElementsForRenderer",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=!this.hideLayersNotInCurrentView,e.t0){e.next=6;break}return e.next=5,this._isLayerInCurrentView();case 5:e.t0=e.sent;case 6:if(!e.t0){e.next=13;break}return e.next=10,this._getRendererLegendElements(t);case 10:e.t1=e.sent,e.next=14;break;case 13:e.t1=[];case 14:this.legendElements=e.t1,this.notifyChange("ready"),e.next=21;break;case 18:e.prev=18,e.t2=e.catch(0),p.Z.getLogger(this).warn("error while building legend for layer!",e.t2);case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"buildLegendElementsForFeatureReduction",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=!this.hideLayersNotInCurrentView,e.t0){e.next=6;break}return e.next=5,this._isLayerInCurrentView();case 5:e.t0=e.sent;case 6:if(!e.t0){e.next=13;break}return e.next=10,this._getLegendElementsForFeatureReduction(t);case 10:e.t1=e.sent,e.next=14;break;case 13:e.t1=[];case 14:this.legendElements=e.t1,this.notifyChange("ready"),e.next=21;break;case 18:e.prev=18,e.t2=e.catch(0),p.Z.getLogger(this).warn("error while building legend for layer!",e.t2);case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"buildLegendElementsForTools",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(){var t,n,r,i,a,l=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee(t=this.layer)){e.next=5;break}this._constructLegendElementsForVoxelLayer(),e.next=31;break;case 5:if(!Ze(t)){e.next=9;break}this._constructLegendElementsForWMTSlayer(),e.next=31;break;case 9:if(!Re(t)){e.next=14;break}return e.next=12,this._constructLegendElementsForWMSSublayers();case 12:case 17:case 22:e.next=31;break;case 14:if(!Ce(t)){e.next=19;break}return e.next=17,this._constructLegendElementsForBuildingSceneLayer();case 19:if(!(Ve(t)||Fe(t)||Ie(t))){e.next=24;break}return e.next=22,this._constructLegendElementsForSublayers();case 24:if(this.removeHandles("imageryLayers-watcher"),n="default",ze(t)&&(n=((null===(a=t)||void 0===a||null===(r=a.rasterFunction)||void 0===r?void 0:r.functionName)||"default")+"_"+(null!==(i=t.bandIds)&&void 0!==i&&i.length?t.bandIds.join(""):"###")),!Ae(t)){e.next=29;break}return e.abrupt("return");case 29:return e.next=31,this._getLegendLayers("".concat(t.uid,"-").concat(n)).then(function(){var e=(0,k.Z)((0,w.Z)().mark((function e(n){var r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.legendElements=[],l.notifyChange("ready"),r=n.map(function(){var e=(0,k.Z)((0,w.Z)().mark((function e(n){var r,i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ze(t)&&(r=(0,u.watch)((function(){return["renderingRule"in t&&t.rasterFunction,t.bandIds]}),(function(){return(0,Z.Ds)((0,k.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ue.default=null,!t.renderer){e.next=6;break}return e.next=4,l.buildLegendElementsForRenderer(t.renderer);case 4:e.next=8;break;case 6:return e.next=8,l.buildLegendElementsForTools();case 8:case"end":return e.stop()}}),e)}))))()})),l.addHandles(r,"imageryLayers-watcher")),null!==(i=l._generateSymbolTableElementForLegendLayer(n))&&void 0!==i&&i.infos.length&&(ze(t)&&(i.title=t.title),l.legendElements.push(i)),l.notifyChange("ready");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.allSettled(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){p.Z.getLogger(l).warn("Request to server for legend has failed!",e)}));case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_isLayerInCurrentView",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(){var t,n,r,i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.layer,n=this.layerView,(r=n&&"createQuery"in n&&"queryFeatureCount"in n)||n&&"createQuery"in t&&"queryFeatureCount"in t){e.next=3;break}return e.abrupt("return",!0);case 3:return e.next=5,(0,u.whenOnce)((function(){return!n.updating}));case 5:if(i=r?"createQuery"in n&&n.createQuery():"createQuery"in t&&t.createQuery()){e.next=8;break}return e.abrupt("return",!0);case 8:if(i.geometry=this.view.extent,!r){e.next=18;break}if(e.t1="queryFeatureCount"in n,!e.t1){e.next=15;break}return e.next=14,n.queryFeatureCount(i);case 14:e.t1=e.sent;case 15:e.t0=e.t1,e.next=24;break;case 18:if(e.t2="queryFeatureCount"in t,!e.t2){e.next=23;break}return e.next=22,t.queryFeatureCount(i);case 22:e.t2=e.sent;case 23:e.t0=e.t2;case 24:return e.t3=e.t0,e.abrupt("return",0!==e.t3);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getParentLayerOpacity",value:function(e){var t=1,n=e.parent;return n&&"uid"in n&&(t=this._getParentLayerOpacity(n)),e.opacity*t}},{key:"_isGroupActive",value:function(){return this.children.some((function(e){return e.ready}))}},{key:"_isRendererScaleDriven",value:function(e){var t=this;if("dot-density"===e.type)return!0;var n="valueExpression"in e?e.valueExpression:null;if(le.test(n))return!0;var r="visualVariables"in e?e.visualVariables:null;return!(null===r||void 0===r||!r.some((function(e){return t._isScaleDrivenSizeVariable(e)})))||this._hasScaleDrivenSymbols(e)}},{key:"_hasScaleDrivenSymbols",value:function(e){var t,n=this;switch(e.type){case"simple":return this._isScaleDrivenSymbol(e.symbol);case"class-breaks":return this._isScaleDrivenSymbol(e.defaultSymbol)||e.classBreakInfos.some((function(e){return n._isScaleDrivenSymbol(e.symbol)}));case"unique-value":return this._isScaleDrivenSymbol(e.defaultSymbol)||!(null===(t=e.uniqueValueInfos)||void 0===t||!t.some((function(e){return n._isScaleDrivenSymbol(e.symbol)})))}return!1}},{key:"_isScaleDrivenSymbol",value:function(e){if("cim"===(null===e||void 0===e?void 0:e.type)){var t,n=e.data,r=n.primitiveOverrides,i=n.minScale,a=n.maxScale,l=null!==(t=null===r||void 0===r?void 0:r.some((function(e){var t;return/\$view\.scale/.test((null===(t=e.valueExpressionInfo)||void 0===t?void 0:t.expression)||"")})))&&void 0!==t&&t;return null!=i||null!=a||l}return!1}},{key:"_isScaleDrivenSizeVariable",value:function(e){if(e&&"size"!==e.type)return!1;var t=e,n=t.minSize,r=t.maxSize;return!("object"!=typeof n||!n||!this._isScaleDrivenSizeVariable(n))||!("object"!=typeof r||!r||!this._isScaleDrivenSizeVariable(r))||le.test(t.valueExpression)}},{key:"_isLayerScaleDriven",value:function(e){var t=this;if("minScale"in e&&e.minScale>0||"maxScale"in e&&e.maxScale>0)return!0;if("sublayers"in e&&e.sublayers)return e.sublayers.some((function(e){return t._isLayerScaleDriven(e)}));var n=e.parent;if(!1===e.loaded&&n&&Ve(n)&&"source"in e&&e.source&&"map-layer"===e.source.type){var r,i,a=(0,S.Z)(null!==(r=n.sourceJSON.layers)&&void 0!==r?r:[]);try{for(a.s();!(i=a.n()).done;){var l=i.value;if(l.id===e.source.mapLayerId&&(l.minScale>0||l.maxScale>0))return!0}}catch(s){a.e(s)}finally{a.f()}}return!1}},{key:"_constructLegendElementsForVoxelLayer",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(){var t,n,r,i,a,l,s,o,c,d,f,y,v,h=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable"),n=this.layer,this.addHandles((0,u.watch)((function(){return n.currentVariableId}),(function(){return h._constructLegendElementsForVoxelLayer()})),"voxel-current-variable"),this.addHandles((0,u.watch)((function(){return n.getVariableStyles()}),(function(){return h._constructLegendElementsForVoxelLayer()})),"voxel-style-watcher"),r=n.getVariableStyle(null),i=[],!r){e.next=26;break}if(null===(t=r.uniqueValues)||void 0===t||!t.length){e.next=10;break}a=[],r.uniqueValues.forEach((function(e){e.enabled&&a.push({label:e.label||"".concat(e.value),value:e.value,symbol:new re.default({color:e.color,outline:null})})})),a.length&&i.push({type:"symbol-table",title:r.label,infos:a}),e.next=26;break;case 10:if(!r.transferFunction){e.next=26;break}return l=r.transferFunction,s=l.colorStops,o=l.stretchRange,c=s.toArray().reverse(),d=o.map((function(e,t){return"".concat(0===t?ee.specialCharsLessThan:ee.specialCharsGreaterThan," ").concat((0,te.P5)(e))})).reverse(),f=c.map((function(e){return{color:e.color,value:null,label:null}})),f[0].label=d[0],f[f.length-1].label=d[1],e.t0=i,e.t1=r.label,e.t2=f,e.t3=J.jT,e.t4=c.map((function(e){return e.color})),e.next=21,Pe("previewColorRampAriaLabel");case 21:e.t5=e.sent,e.t6={ariaLabel:e.t5},e.t7=(0,e.t3)(e.t4,e.t6),e.t8={type:"color-ramp",title:e.t1,infos:e.t2,preview:e.t7},e.t0.push.call(e.t0,e.t8);case 26:return y=n.opacity,v=i.reduce((function(e,t){return[].concat((0,L.Z)(e),(0,L.Z)(h._getAllInfos(t)))}),[]).filter((function(e){return!(null===e||void 0===e||!e.symbol)})).map((function(e){return h._getSymbolPreview(e,y)})),e.next=29,Promise.allSettled(v);case 29:this.legendElements=i,this.notifyChange("ready");case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_constructLegendElementsForWMTSlayer",value:function(){var e,t,n=this;this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");var r=this.layer.activeLayer;this.addHandles((0,u.watch)((function(){var e=n.layer;return e&&"activeLayer"in e&&e.activeLayer}),(function(){return n._constructLegendElementsForWMTSlayer()})),"wmts-activeLayer-watcher");var i=r.styleId?null===(e=r.styles)||void 0===e||null===(t=e.find((function(e){return e.id===r.styleId})))||void 0===t?void 0:t.legendUrl:void 0;i&&(this.legendElements=[{type:"symbol-table",title:r.title,infos:[{src:i,opacity:this.opacity}]}]),this.notifyChange("ready")}},{key:"_constructLegendElementsForWMSSublayers",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(){var t,n,i=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.legendElements=[],this.removeHandles("wms-sublayers-watcher"),t=this.layer,n=null,(t.customParameters||t.customLayerParameters)&&(n=(0,r.Z)((0,r.Z)({},t.customParameters),t.customLayerParameters)),this.addHandles((0,u.watch)((function(){var e=i.layer;return e&&"sublayers"in e&&e.sublayers}),(function(){return i._constructLegendElementsForWMSSublayers()})),"wms-sublayers-watcher"),e.next=7,this._generateLegendElementsForWMSSublayers(t.sublayers,n);case 7:this.legendElements=e.sent,this.notifyChange("ready");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_generateLegendElementsForWMSSublayers",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i,a,l,s,o,c,d,f,y,v=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=this.layer,s=[],this.addHandles(t.on("change",(function(){return v._constructLegendElementsForWMSSublayers()})),"wms-sublayers-watcher"),o=null!==(r=null===(i=this.sublayerIds)||void 0===i||null===(a=i.map((function(e){return l.findSublayerById(e)})))||void 0===a?void 0:a.filter(E.pC))&&void 0!==r?r:[],c=o.length?o:t.toArray(),d=(0,S.Z)(c),e.prev=4,y=(0,w.Z)().mark((function e(){var t,r,i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.value,r=(0,u.watch)((function(){return[t.title,t.visible,t.legendEnabled]}),(function(){return v._constructLegendElementsForWMSSublayers()})),v.addHandles(r,"wms-sublayers-watcher"),!(!v.respectLayerVisibility||t.visible&&t.legendEnabled)){e.next=7;break}return e.next=5,v._generateSymbolTableElementForWMSSublayer(t,n);case 5:(null===(i=e.sent)||void 0===i?void 0:i.infos.length)&&s.unshift(i);case 7:case"end":return e.stop()}}),e)})),d.s();case 7:if((f=d.n()).done){e.next=11;break}return e.delegateYield(y(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),d.e(e.t1);case 16:return e.prev=16,d.f(),e.finish(16);case 19:return e.abrupt("return",s);case 20:case"end":return e.stop()}}),e,this,[[4,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_generateSymbolTableElementForWMSSublayer",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.legendUrl||!t.sublayers){e.next=5;break}return e.next=3,this._generateLegendElementsForWMSSublayers(t.sublayers,n);case 3:return r=e.sent.filter((function(e){return e})),e.abrupt("return",{type:"symbol-table",title:t.title,infos:r});case 5:return e.abrupt("return",this._generateSymbolTableElementForLegendUrl(t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_generateSymbolTableElementForLegendUrl",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i,a,l,s,o;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.legendUrl){e.next=3;break}return e.abrupt("return");case 3:return l={type:"symbol-table",title:t.title||t.name||String(null!==(r=t.id)&&void 0!==r?r:""),infos:[]},n&&(a=(0,z.fl)(a,n)),s=null,o=null===(i=t.layer)||void 0===i?void 0:i.opacity,e.prev=7,e.next=10,(0,I.Z)(a,{responseType:"image"});case 10:(s=e.sent.data)&&(s.style.opacity=o),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(7);case 16:return e.abrupt("return",(l.infos.push({src:a,preview:s,opacity:o}),l));case 17:case"end":return e.stop()}}),e,null,[[7,14]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getLegendLayers",value:function(e,t){var n=Ue&&Ue[e];return n?Promise.resolve(n):this._legendRequest(t).then((function(t){var n=t.layers;return Ue[e]=n,n}))}},{key:"_legendRequest",value:function(e){var t=this.layer,n={f:"json",dynamicLayers:e};if(ze(t)){var i,a=t.exportImageServiceParameters.rasterFunction;if(a&&(n.renderingRule=JSON.stringify((null===(i=a.functionDefinition)||void 0===i?void 0:i.toJSON())||a.toJSON())),t.bandIds&&(n.bandIds=t.bandIds.join()),t.raster||t.viewId||t.customParameters){var l=t.raster,s=t.viewId,o=t.customParameters;n=(0,r.Z)((0,r.Z)({raster:l,viewId:s},n),o)}}var u=t.url.replace(/(\/)+$/,"");if("version"in t&&+t.version>=10.01){var c=u.indexOf("?");c>-1?u=u.substring(0,c)+"/legend"+u.substring(c):u+="/legend"}else{var d=u.toLowerCase().indexOf("/rest/"),f=u.substring(0,d)+u.substring(d+5,u.length);u="https://utility.arcgis.com/sharing/tools/legend?soapUrl="+encodeURI(f)+"&returnbytes=true"}return(0,I.Z)(u,{query:n}).then((function(e){return e.data}))}},{key:"_constructLegendElementsForBuildingSceneLayer",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(){var t,n=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.legendElements=[],this.removeHandles("sublayers-watcher"),t=this.layer,this.addHandles((0,u.watch)((function(){return t.sublayers}),(function(){return n._constructLegendElementsForBuildingSceneLayer()})),"sublayers-watcher"),e.prev=3,e.next=6,this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity);case 6:this.legendElements=e.sent,this.notifyChange("ready"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),p.Z.getLogger(this).warn("Request to server for legend has failed!",e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"_generateLegendElementsForBuildingSublayers",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i,a,l,s,o=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],this.addHandles(t.on("change",(function(){return o._constructLegendElementsForBuildingSceneLayer()})),"sublayers-watcher"),i=t.toArray(),a=(0,S.Z)(i),e.prev=4,s=(0,w.Z)().mark((function e(){var t,i,a,s,c,d,f;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.value,i=(0,u.watch)((function(){return["renderer"in t&&t.renderer,t.opacity,t.title,t.visible]}),(function(){return o._constructLegendElementsForBuildingSceneLayer()})),o.addHandles(i,"sublayers-watcher"),o.respectLayerVisibility&&!t.visible){e.next=21;break}if(a=null!=(null===t||void 0===t?void 0:t.opacity)?t.opacity:null,s=null!=a?a*n:n,"building-group"!==t.type){e.next=12;break}return d={type:"symbol-table",title:t.title,infos:[]},e.next=8,o._generateLegendElementsForBuildingSublayers(t.sublayers,s);case 8:f=e.sent,(c=d.infos).push.apply(c,(0,L.Z)(f)),r=[d].concat((0,L.Z)(r)),e.next=21;break;case 12:if(!t.renderer){e.next=21;break}return e.t0=[],e.t1=L.Z,e.next=17,o._getRendererLegendElements(t.renderer,{title:t.title,opacity:s,sublayer:t});case 17:e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=(0,L.Z)(r),r=e.t0.concat.call(e.t0,e.t3,e.t4);case 21:case"end":return e.stop()}}),e)})),a.s();case 7:if((l=a.n()).done){e.next=11;break}return e.delegateYield(s(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),a.e(e.t1);case 16:return e.prev=16,a.f(),e.finish(16);case 19:return e.abrupt("return",r.filter((function(e){return!!e&&(!("infos"in e)||!e.infos||e.infos.length>0)})));case 20:case"end":return e.stop()}}),e,this,[[4,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_constructLegendElementsForSublayers",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(){var t,n=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.legendElements=[],this.removeHandles("sublayers-watcher"),!(Ve(t=this.layer)||Fe(t)||Ie(t))){e.next=14;break}return this.addHandles((0,u.watch)((function(){return t.sublayers}),(function(){return n._constructLegendElementsForSublayers})),"sublayers-watcher"),e.prev=4,e.next=7,this._generateLegendElementsForSublayers(t.sublayers,this.opacity);case 7:this.legendElements=e.sent,this.notifyChange("ready"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),p.Z.getLogger(this).warn("Request to server for legend has failed!",e.t0);case 14:case"end":return e.stop()}}),e,this,[[4,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"_generateLegendElementsForSublayers",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n,r){var i,a,l,s,o,c,d=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.layer,a=[],this.addHandles(t.on("change",(function(){return d._constructLegendElementsForSublayers()})),"sublayers-watcher"),l=t.toArray(),!r&&this.sublayerIds&&this.sublayerIds.length&&(l=Ie(i)?this.sublayerIds.map((function(e){return i.findSublayerForSubtypeCode(e)})).filter(E.pC):this.sublayerIds.map((function(e){return i.findSublayerById(e)})).filter(E.pC)),s=(0,S.Z)(l),e.prev=6,c=(0,w.Z)().mark((function e(){var t,i,l,s,c,f;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.value,i=(0,u.watch)((function(){return[t.renderer,t.opacity,t.title,t.visible,t.legendEnabled]}),(function(){return d._constructLegendElementsForSublayers()})),d.addHandles(i,"sublayers-watcher"),d.respectLayerVisibility&&!(t.visible&&t.legendEnabled&&d._isSublayerInScale(t))){e.next=22;break}if(l=null!=(null===t||void 0===t?void 0:t.opacity)?t.opacity:null,s=null!=l?l*n:n,c=!Oe(t)||t.originIdOf("renderer")>A.s3.SERVICE&&!t.sublayers,!t.renderer||!c){e.next=17;break}return e.next=7,t.load();case 7:return e.t0=[],e.t1=L.Z,e.next=11,d._getRendererLegendElements(t.renderer,{title:t.title,opacity:s,sublayer:t});case 11:e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=(0,L.Z)(a),a=e.t0.concat.call(e.t0,e.t3,e.t4),e.next=22;break;case 17:if(!Oe(t)){e.next=22;break}return e.next=20,d._generateSymbolTableElementForSublayer(t,s,r);case 20:(f=e.sent)&&a.unshift(f);case 22:case"end":return e.stop()}}),e)})),s.s();case 9:if((o=s.n()).done){e.next=13;break}return e.delegateYield(c(),"t0",11);case 11:e.next=9;break;case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(6),s.e(e.t1);case 18:return e.prev=18,s.f(),e.finish(18);case 21:return e.abrupt("return",a.filter((function(e){return!!e&&(!("infos"in e)||!e.infos||e.infos.length>0)})));case 22:case"end":return e.stop()}}),e,this,[[6,15,18,21]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_generateSymbolTableElementForSublayer",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n,r){var i,a,l,s,o,u,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=9;break}return r=new Map,i=this.layer,a=t.source,l=null,(a&&("map-layer"!==a.type||a.mapLayerId!==t.id||a.gdbVersion&&a.gdbVersion!==("gdbVersion"in i&&i.gdbVersion))||t.originIdOf("renderer")>A.s3.SERVICE||t.originIdOf("labelingInfo")>A.s3.SERVICE||t.originIdOf("labelsVisible")>A.s3.SERVICE)&&(s=new D.R({layer:this.layer}),l=s.hasDynamicLayers?s.dynamicLayers:null,s.destroy()),o=l||"".concat(i.uid,"-default"),e.next=8,this._getLegendLayers(o,l);case 8:e.sent.forEach((function(e){return r.set(e.layerId,e)}));case 9:if(!(!(u=r.get(t.id))||null!==u&&void 0!==u&&u.subLayerIds&&u.defaultVisibility)||!t.sublayers){e.next=15;break}return e.next=13,this._generateLegendElementsForSublayers(t.sublayers,n,r);case 13:return c=e.sent,e.abrupt("return",{type:"symbol-table",title:t.title,infos:c});case 15:return e.abrupt("return",this._generateSymbolTableElementForLegendLayer(u,t,n));case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_generateSymbolTableElementForLegendLayer",value:function(e,t,n){var r=this;if(null===e||void 0===e||!e.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(e,t))return null;var i=null===t||void 0===t?void 0:t.renderer,a=(null===t||void 0===t?void 0:t.title)||e.layerName;if(i&&(!t||(null===t||void 0===t?void 0:t.originIdOf("renderer"))>A.s3.SERVICE)){var l=(null===t||void 0===t?void 0:t.title)||this._getRendererTitle(i,t);l&&(a&&"string"!=typeof l&&"title"in l&&(l.title=a),a=l)}var s={type:"symbol-table",title:a,legendType:e.legendType||null,infos:[]},o=t?this._sanitizeLegendForSublayer(e.legend.slice(),t):e.legend;return e.legendGroups&&e.legendGroups.length>0?e.legendGroups.forEach((function(t){var i,a={type:"symbol-table",title:t.heading,legendType:e.legendType||null,infos:r._generateSymbolTableElementInfosForLegendLayer(o.filter((function(e){return e.groupId===t.id})),e.layerId,n)};(null===(i=a.infos)||void 0===i?void 0:i.length)>0&&s.infos.push(a)})):s.infos=this._generateSymbolTableElementInfosForLegendLayer(o,e.layerId,n),s.infos.length>0?s:null}},{key:"_generateSymbolTableElementInfosForLegendLayer",value:function(e,t,n){var r=this;return e.map((function(e){var i=e.url;if(e.imageData&&e.imageData.length>0)i="data:image/png;base64,".concat(e.imageData);else{if(0===i.indexOf("http"))return null;i=(0,C.Dp)("".concat(r.layer.url,"/").concat(t,"/images/").concat(i))}return{label:e.label,src:i,opacity:null!==n&&void 0!==n?n:r.opacity,width:e.width,height:e.height}})).filter(E.pC)}},{key:"_isSublayerInScale",value:function(e){var t=e.minScale||0,n=e.maxScale||0;return!(t>0&&t<this.scale||n>this.scale)}},{key:"_isLegendLayerInScale",value:function(e,t){var n=t||this.layer,r=null,i=null,a=!0;return!n.minScale&&0!==n.minScale||!n.maxScale&&0!==n.maxScale?(0===e.minScale&&n.tileInfo&&(r=n.tileInfo.lods[0].scale),0===e.maxScale&&n.tileInfo&&(i=n.tileInfo.lods[n.tileInfo.lods.length-1].scale)):(r=Math.min(n.minScale,e.minScale)||n.minScale||e.minScale,i=Math.max(n.maxScale,e.maxScale)),(r>0&&r<this.scale||i>this.scale)&&(a=!1),a}},{key:"_sanitizeLegendForSublayer",value:function(e,t){if("version"in this.layer&&+this.layer.version<10.1||0===e.length)return e;var n=t.renderer,r=e.some((function(e){return e.values})),i=0,a=null;return r&&e.some((function(e,t){return e.values||(i=t,(a=e).label||(a.label="others")),null!=a})),n?"unique-value"===n.type?a&&(e.splice(i,1),e.push(a)):"class-breaks"===n.type&&(a&&e.splice(i,1),e.reverse(),a&&e.push(a)):a&&(e.splice(i,1),e.push(a)),e}},{key:"_getRendererLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i=arguments;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},xe(t,this.view)){e.next=3;break}return e.abrupt("return",(p.Z.getLogger(this).warn("Renderer of type '".concat(t.type,"' not supported!")),[]));case 3:if(!ge(t)){e.next=5;break}return e.abrupt("return",this._constructPointCloudRendererLegendElements(t,n));case 5:if(!Se(t)){e.next=7;break}return e.abrupt("return",this._constructDotDensityRendererLegendElements(t));case 7:return e.next=9,this._loadRenderer(t);case 9:return r=e.sent,e.abrupt("return",ke(r)?this._constructPieChartRendererLegendElements(r):this._constructRendererLegendElements(r,n));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getLegendElementsForFeatureReduction",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.abrupt("return",("binning"===t.type?n=t.renderer:"cluster"===t.type&&(n=this._getClusterRenderer(t)),n?this._getRendererLegendElements(n):[]));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getPointCloudRendererTitle",value:function(e){var t,n;return null!==(t=(null===(n=e.legendOptions)||void 0===n?void 0:n.title)||e.field)&&void 0!==t?t:""}},{key:"_constructPointCloudRendererLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l,s,o,u,c,d,f,y,v,h,p,m,b=this,g=arguments;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=g.length>1&&void 0!==g[1]?g[1]:{},l=a.title,s=[],o=null,u=null,!_e(t)){e.next=7;break}o={type:"symbol-table",title:l||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach((function(e){o.infos.unshift({label:e.label||e.minValue+" - "+e.maxValue,value:[e.minValue,e.maxValue],symbol:b._getAppliedCloneSymbol(oe,e.color)})})),e.next=26;break;case 7:if(!Le(t)){e.next=25;break}return f=t.stops,y=null,null!==f&&void 0!==f&&f.length&&(1===f.length&&(y=f[0].color),!y)&&(v=f[0].value,h=f[f.length-1].value,null!=v&&null!=h&&(y=(0,X.getColorFromPointCloudStops)(v+(h-v)/2,f))),o={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(oe,y||oe.color)}]},p=null!==(c=(0,X.getRampStopsForPointCloud)(null!==(d=t.stops)&&void 0!==d?d:[]))&&void 0!==c?c:[],e.t0=l||this._getPointCloudRendererTitle(t),e.t1=p,e.t2=J.jT,e.t3=p.map((function(e){return e.color})),e.next=19,Pe("previewColorRampAriaLabel");case 19:e.t4=e.sent,e.t5={ariaLabel:e.t4},e.t6=(0,e.t2)(e.t3,e.t5),u={type:"color-ramp",title:e.t0,infos:e.t1,preview:e.t6},e.next=26;break;case 25:we(t)&&(o={type:"symbol-table",title:l||this._getPointCloudRendererTitle(t),infos:[]},null===(n=t.colorUniqueValueInfos)||void 0===n||n.forEach((function(e){o.infos.push({label:e.label||e.values.join(", "),value:e.values.join(", "),symbol:b._getAppliedCloneSymbol(oe,e.color)})})));case 26:return null!==(r=o)&&void 0!==r&&r.infos.length&&s.push(o),(null===(i=u)||void 0===i?void 0:i.infos.length)&&s.push(u),m=s.reduce((function(e,t){var n;return[].concat((0,L.Z)(e),(0,L.Z)(null!==(n=t.infos)&&void 0!==n?n:[]))}),[]).filter((function(e){return!!e.symbol})).map((function(e){return b._getSymbolPreview(e,b.opacity,{symbolConfig:{applyColorModulation:!!t.colorModulation}})})),e.next=30,Promise.allSettled(m);case 30:return e.abrupt("return",s);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getElementInfoForDotDensity",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i,a,l,s,o,u,c,d,f,y,v,h,p,m;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.color,i=n.label,a=n.valueExpressionTitle,l=t.backgroundColor,s=t.outline,o=t.dotSize,u=this.effectList,c=null===u||void 0===u?void 0:u.effects.map((function(e){return e.toJSON()})),d=(0,M.rM)(c),e.next=11,Pe("previewTemplateAriaLabel",i||a);case 11:return f=e.sent,y=o+"-"+r+"-"+l+"-"+(s&&JSON.stringify(s.toJSON()))+"-"+d,v=this._dotDensityUrlCache,h=v.has(y)?v.get(y):(0,J.k)(t,r,{ariaLabel:f}),v.set(y,h),p={shape:{type:"image",x:0,y:0,width:h.width,height:h.height,src:h.src},fill:null,stroke:null,offset:[0,0]},m=(0,G.wh)([[p]],[h.width,h.height],{effectView:this.effectList,ariaLabel:f}),e.abrupt("return",{opacity:1,src:h.src,preview:m,width:h.width,height:h.height});case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_constructDotDensityRendererLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l,s,o,u;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.calculateDotValue(this.view.scale),i=null===(n=t.legendOptions)||void 0===n?void 0:n.unit,a={type:"symbol-table",title:{value:r&&Math.round(r),unit:i||""},infos:[]},l=(0,S.Z)(t.attributes),e.prev=2,l.s();case 4:if((s=l.n()).done){e.next=12;break}return o=s.value,e.next=8,this._getElementInfoForDotDensity(t,o);case 8:(u=e.sent).label=o.label||o.valueExpressionTitle||o.field,a.infos.push(u);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),l.e(e.t0);case 17:return e.prev=17,l.f(),e.finish(17);case 20:return e.abrupt("return",[a]);case 21:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_constructPieChartRendererLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l,s,o,u,c,d,f,y,v,h,p,m=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.layer.opacity,l=[],s=null,o=t.outline,t.attributes.forEach((function(e){var t=new ne.default({color:e.color,outline:o}),n=e.label||e.valueExpressionTitle||e.field;l.push({label:n,symbol:t})})),u=l.length?[].concat(l):[],null!==(n=t.othersCategory)&&void 0!==n&&n.color&&0!==(null===(r=t.othersCategory)||void 0===r?void 0:r.threshold)&&(c=new ne.default({color:t.othersCategory.color,outline:o}),s=t.othersCategory.label||"Other",l.push({label:s,symbol:c})),null!==(i=t.defaultColor)&&void 0!==i&&i.a&&(d=new ne.default({color:t.defaultColor,outline:o}),l.push({label:t.defaultLabel,symbol:d})),e.next=9,this._getVisualVariableLegendElements(t,this.layer);case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0=[];case 12:if(f=e.t0,!l.length){e.next=28;break}return f.unshift({type:"symbol-table",title:null,infos:l}),v=u.filter((function(e){return e.label!==s})).map((function(e){return e.symbol.color})).filter(Boolean),e.t1=J.LC,e.t2=v,e.t3=t.holePercentage,e.t4=null===(y=t.backgroundFillSymbol)||void 0===y?void 0:y.color,e.t5=this.effectList,e.t6=o,e.next=24,Pe("previewPieChartAriaLabel");case 24:e.t7=e.sent,e.t8={holePercentage:e.t3,backgroundColor:e.t4,effectList:e.t5,outline:e.t6,ariaLabel:e.t7},h=(0,e.t1)(e.t2,e.t8),f.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:l,preview:h});case 28:return p=f.reduce((function(e,t){return[].concat((0,L.Z)(e),(0,L.Z)(m._getAllInfos(t)))}),[]).filter((function(e){return!(null===e||void 0===e||!e.symbol)&&!(null!==e&&void 0!==e&&e.preview)})).map((function(e){return m._getSymbolPreview(e,a,{effectList:m.effectList})})),e.next=31,Promise.allSettled(p);case 31:return e.abrupt("return",f);case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_constructRendererLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l,s,o,u,c,d,f,y,v,h,p,m,b,g,k,x,C,I,E,R,Z,V,z,A,T,M,D,N,P,B,H,U,j,W,G,Q,X,$,te,ne,re,ie,ae,le,se,oe,ge,_e,Le,we,Se,ke,xe,Ce,Ie,Ee,Re,Ze,Ve,Fe,Oe,Be,Ue,qe,je,We,Ge,Je,Qe,Xe,Ke,Ye,$e,et,tt,nt,rt,it,at,lt,st,ot,ut=this,ct=arguments;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=ct.length>1&&void 0!==ct[1]?ct[1]:{},r=n.title,i=n.sublayer,a=i||this.layer,l=(0,ee.getReferenceSizeAuthoringInfoVisualVariable)(t),e.t0="definitionExpression"in a&&a.definitionExpression&&!this._layerDefinitionExpressionClause&&this.respectLayerDefinitionExpression,!e.t0){e.next=7;break}return e.next=6,(0,F.E)(a.definitionExpression,a.fieldsIndex);case 6:this._layerDefinitionExpressionClause=e.sent;case 7:return this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null,e.next=13,this._getVisualVariableLegendElements(t,a);case 13:if(e.t1=e.sent,e.t1){e.next=16;break}e.t1=[];case 16:if(s=e.t1,o={type:"symbol-table",title:r||this._getRendererTitle(t,a),infos:[]},u=null,c=!1,d=new Set,!ce(t)||this._hasSizeRamp){e.next=27;break}return e.next=23,(0,ee.getSymbolForFlowRenderer)(t);case 23:f=e.sent,o.infos.push({label:null,symbol:f}),e.next=144;break;case 27:if(!De(t)){e.next=33;break}y=r,v=Ne(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",h=s.findIndex((function(e){return"color-ramp"===e.type})),p=-1!==h?s.splice(h,1)[0]:null,m=s.findIndex((function(e){return"size-ramp"===e.type})),b=-1!==m?s.splice(m,1)[0]:null,g=[],p&&(y=p.title,g.push(p)),b&&(y=b.title,g.push(b)),g.length>0&&s.push({type:v,title:y,infos:g}),e.next=144;break;case 33:if(!be(t)){e.next=50;break}return k=(0,K.h)(t),e.t2=s,e.t3=r||this._getRendererTitle(t,a),e.t4=k,e.t5=J.jT,e.t6=k.map((function(e){return e.color})),e.t7=this.effectList,e.next=43,Pe("previewColorRampAriaLabel");case 43:e.t8=e.sent,e.t9={effectList:e.t7,ariaLabel:e.t8},e.t10=(0,e.t5)(e.t6,e.t9),e.t11={type:"heatmap-ramp",title:e.t3,infos:e.t4,preview:e.t10},e.t2.push.call(e.t2,e.t11),e.next=144;break;case 50:if(!me(t)){e.next=56;break}if((x=t&&t.authoringInfo)&&"relationship"===x.type){if(C=x.numClasses,I=x.field1,E=x.field2,R=x.focus,C&&I&&E){for(V=[I,E],z=(0,Y.N_)(R)||0,A=0,T=V;A<T.length;A++)M=T[A],D=M.field,N=M.normalizationField,P=M.label,B=P||{field:this._getFieldAlias(D,a),normField:N&&this._getFieldAlias(N,a)},(H=He.clone()).angle=z,o.infos.push({label:B,symbol:H}),d.add(H),z+=90;U=(0,Y.mg)({focus:R,numClasses:C,infos:null!==(Z=t.uniqueValueInfos)&&void 0!==Z?Z:[]}),s.unshift(U)}}else ze(this.layer)||Ae(this.layer)?(G=(W=t).field,Q=W.field2,null===(j=t.uniqueValueInfos)||void 0===j||j.forEach((function(e){e.symbol&&(G&&ut._checkDefinitionExpression(G,e.value)||Q)&&o.infos.push({label:e.label||e.value,value:e.value,symbol:e.symbol})}))):(te=($=t).field,ne=$.field2,re=$.field3,ie=$.fieldDelimiter,ae=$.valueExpression,le=$.defaultSymbol,se=!(!te&&!ae||!ne&&!re),oe=[],null!==(X=t.uniqueValueGroups)&&void 0!==X&&X.forEach((function(e){var t,n={type:"symbol-table",title:e.heading,infos:[]};null!==(t=e.classes)&&void 0!==t&&t.forEach((function(e){var t=e.symbol,r=e.values;if(t){var i,s=[],o=[],u=(0,S.Z)(null!==r&&void 0!==r?r:[]);try{for(u.s();!(i=u.n()).done;){var c=i.value,d=c.value,f=c.value2,y=c.value3,v=[],h=[];(te||ae)&&(v.push(d),h.push(ut._getDomainName(te,d,a))),ne&&(v.push(f),h.push(ut._getDomainName(ne,f,a))),re&&(v.push(y),h.push(ut._getDomainName(re,y,a))),s.push(se?v.join(ie||""):v[0]),o.push(h.join(" - "))}}catch(_){u.e(_)}finally{u.f()}var p=s.join(", "),m=e.label;if(!m){var b=o.filter(Boolean);m=b.length?b.join(", "):p}var g=t.clone();"cim"===g.type&&l&&(0,q.r6)(g,{innerDotSize:8,outerRingSize:16}),(ut._checkDefinitionExpression(te,p)||ne)&&n.infos.push({label:m,value:p,symbol:g})}})),n.infos.length&&oe.push(n)})),oe.length&&(Se=oe[0],1===oe.length&&"title"in Se&&!Se.title?(ge=o.infos).push.apply(ge,(0,L.Z)(null!==(_e=Se.infos)&&void 0!==_e?_e:[])):(le&&(oe.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:le}]}),c=!0),(Le=o.infos).push.apply(Le,oe)),r||(null===(we=t.legendOptions)||void 0===we?void 0:we.title)||t.valueExpressionTitle||(o.title=null)));t.defaultSymbol&&!c&&(o.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),c=!0),e.next=144;break;case 56:if(!pe(t)){e.next=60;break}if(!l){if(!(u=this._isUnclassedRenderer(t))||!this._hasSizeRamp){ke=t.classBreakInfos.filter((function(e){return e.symbol})),xe=(0,S.Z)(ke);try{for(xe.s();!(Ce=xe.n()).done;)Ie=Ce.value,Ee=Ie.label,Re=Ie.minValue,Ze=Ie.maxValue,Ve=Ie.symbol,o.infos.unshift({label:Ee||(u?null:"".concat(Re," - ").concat(Ze)),value:[Re,Ze],symbol:Ve})}catch(w){xe.e(w)}finally{xe.f()}u&&(o.title=null),this._updateInfosForClassedSizeRenderer(t,o.infos)}t.defaultSymbol&&!u&&(o.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),c=!0)}e.next=144;break;case 60:if(!ye(t)){e.next=113;break}if(!Ae(this.layer)&&!Te(this.layer)){e.next=68;break}return e.next=64,this._constructTileImageryStretchRendererElements(t);case 64:Me(Fe=e.sent)?s.push(Fe):o.infos=Fe,e.next=111;break;case 68:if(Be=this.layer,null!==(Oe=t.statistics)&&void 0!==Oe&&Oe.length&&(Ge=t.statistics[0],(0,ee.isRasterBandStatistics)(Ge)?(Ue=Ge.min,qe=Ge.max):(je=Ge,We=(0,_.Z)(je,2),Ue=We[0],qe=We[1])),Je=[],Qe=Be.serviceRasterInfo,!Be.rasterFunction){e.next=80;break}return e.prev=72,e.next=75,Be.generateRasterInfo(Be.rasterFunction);case 75:Qe=e.sent,e.next=80;break;case 78:e.prev=78,e.t12=e.catch(72);case 80:if(Xe=(0,O.rL)(Qe.pixelType),1!==Qe.bandCount){e.next=96;break}if(Ye=(null===(Ke=Be.bandIds)||void 0===Ke?void 0:Ke[0])||0,Ue=null!=Ue?Ue:Qe.statistics?Qe.statistics[Ye].min:Xe[0],qe=null!=qe?qe:Qe.statistics?Qe.statistics[Ye].max:Xe[1],!Ue&&!qe){e.next=93;break}return e.t13=s,e.next=89,this._getStretchLegendElements(t,{min:Ue,max:qe});case 89:e.t14=e.sent,e.t13.push.call(e.t13,e.t14),e.next=94;break;case 93:this._getServerSideLegend();case 94:e.next=111;break;case 96:if(!Be.bandIds||1!==Be.bandIds.length){e.next=110;break}if(Ue=null!=Ue?Ue:Qe.statistics?Qe.statistics[Be.bandIds[0]].min:Xe[0],qe=null!=qe?qe:Qe.statistics?Qe.statistics[Be.bandIds[0]].max:Xe[1],!Ue&&!qe){e.next=107;break}return e.t15=s,e.next=103,this._getStretchLegendElements(t,{min:Ue,max:qe});case 103:e.t16=e.sent,e.t15.push.call(e.t15,e.t16),e.next=108;break;case 107:this._getServerSideLegend();case 108:e.next=111;break;case 110:Qe.bandCount>=3?($e=Qe.bandInfos,et=Be.bandIds,$e.length>=Qe.bandCount?3===(null===et||void 0===et?void 0:et.length)?(Je=et.map((function(e){return $e[e].name})),o.infos=this._createSymbolTableElementMultiBand(Je)):"lerc"===Be.format?(Je=[0,1,2].map((function(e){return $e[e].name})),o.infos=this._createSymbolTableElementMultiBand(Je)):this._getServerSideLegend():"lerc"===Be.format?(Je=["band1","band2","band3"],o.infos=this._createSymbolTableElementMultiBand(Je)):this._getServerSideLegend()):this._getServerSideLegend();case 111:e.next=144;break;case 113:if(!fe(t)){e.next=117;break}t.colormapInfos.forEach((function(e){o.infos.push({label:e.label,value:e.value,symbol:ut._getAppliedCloneSymbol(ue,e.color)})})),e.next=144;break;case 117:if(!he(t)){e.next=131;break}tt=t.symbol,e.t17=n.geometryType,e.next="point"===e.t17?122:"polyline"===e.t17?124:"polygon"===e.t17?126:127;break;case 122:return tt="pointSymbol"in a?a.pointSymbol:null,e.abrupt("break",127);case 124:return tt="lineSymbol"in a?a.lineSymbol:null,e.abrupt("break",127);case 126:tt="polygonSymbol"in a?a.polygonSymbol:null;case 127:nt=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp,t.symbol&&nt&&o.infos.push({label:t.label,symbol:tt}),e.next=144;break;case 131:if(!de(t)){e.next=137;break}t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),o.title=t.attributeField,null!==(rt=t.getClassBreakInfos())&&void 0!==rt&&rt.length?rt.forEach((function(e){o.infos.push({label:e.minValue+" - "+e.maxValue,symbol:e.symbol})})):o.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()}),e.next=144;break;case 137:if(e.t18=ve(t),!e.t18){e.next=144;break}return e.t19=s,e.next=142,this._getStretchLegendElements(t,{min:0,max:255});case 142:e.t20=e.sent,e.t19.push.call(e.t19,e.t20);case 144:return!(it=t.defaultSymbol)||c||he(t)||u&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||s.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:it}]}),o.infos.length&&s.unshift(o),at=null==n.opacity?this.opacity:n.opacity,lt=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),st=ze(this.layer)||Ae(this.layer),ot=s.reduce((function(e,t){return[].concat((0,L.Z)(e),(0,L.Z)(ut._getAllInfos(t)))}),[]).filter((function(e){return!(null===e||void 0===e||!e.symbol)})).filter((function(e){if("cim"===e.symbol.type){var t=e.symbol.data,n=t.minScale,r=t.maxScale;if(n&&n<ut.scale||r&&r>ut.scale)return!1}return!0})).map((function(e){return ut._getSymbolPreview(e,at,{isDefault:e.symbol===it,applyScaleDrivenSize:!d.has(e.symbol),symbolConfig:{isTall:lt,isSquareFill:st},effectList:d.has(e.symbol)?null:ut.effectList})})),t=null,e.next=150,Promise.allSettled(ot);case 150:return e.abrupt("return",s);case 151:case"end":return e.stop()}}),e,this,[[72,78]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkDefinitionExpression",value:function(e,t){return!e||"string"!=typeof e||!this._layerDefinitionExpressionClause||this._layerDefinitionExpressionClause.testFeature((0,g.Z)({},e,t))}},{key:"_getServerSideLegend",value:function(){var e=this;setTimeout((function(){return e.buildLegendElementsForTools()}),0)}},{key:"_getAllInfos",value:function(e){var t=this,n=null===e||void 0===e?void 0:e.infos;return n?n.reduce((function(e,n){return e.concat(t._getAllInfos(n))}),[]):[e]}},{key:"_constructTileImageryStretchRendererElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l,s,o,u,c,d,f,y,v,h;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=this.layer,s=null!==(n=l.symbolizer.rasterInfo)&&void 0!==n?n:l.raster.rasterInfo,(c=null!==t&&void 0!==t&&null!==(r=t.statistics)&&void 0!==r&&r.length?t.statistics:null===s||void 0===s?void 0:s.statistics)?(y=c[0],(0,ee.isRasterBandStatistics)(y)?(o=y.min,u=y.max):(d=y,f=(0,_.Z)(d,2),o=f[0],u=f[1])):(v=(0,O.rL)(s.pixelType),o=v[0],u=v[1]),l.hasStandardTime()&&(o=l.getStandardTimeValue(o),u=l.getStandardTimeValue(u)),1!==s.bandCount&&1!==(null===(i=l.bandIds)||void 0===i?void 0:i.length)){e.next=5;break}return e.abrupt("return",this._getStretchLegendElements(t,{min:o,max:u}));case 5:return h=(null!==l&&void 0!==l&&null!==(a=l.bandIds)&&void 0!==a&&a.length?l.bandIds:Array.from(Array(Math.min(s.bandCount,3)).keys())).map((function(e){return s.bandInfos[e].name})),e.abrupt("return",(h.length<3?h.push(h[1]):h.length>3&&h.splice(3),this._createSymbolTableElementMultiBand(h)));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getStretchLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.colorRamp,i=(0,X.getStretchRampStops)(r,n),e.t0=i,e.t1=J.jT,e.t2=i.map((function(e){return e.color})),e.next=6,Pe("previewColorRampAriaLabel");case 6:return e.t3=e.sent,e.t4={ariaLabel:e.t3},e.t5=(0,e.t1)(e.t2,e.t4),e.abrupt("return",{type:"stretch-ramp",title:"",infos:e.t0,preview:e.t5});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getClusterSymbol",value:function(){var e,t=this.layer,n="featureReduction"in t&&t.featureReduction,r=n&&"symbol"in n&&n.renderer;return r&&!0!==(null===r||void 0===r||null===(e=r.authoringInfo)||void 0===e?void 0:e.isAutoGenerated)?null:n&&"symbol"in n?n.symbol:null}},{key:"_getSizeLegendElement",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n,r,i){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this._hasClusterSizeVariable?this._getClusterTitle(n):t,e.t1=$.getRampStops,e.t2=r,e.t3=n,e.next=6,(0,ee.getMedianColor)(r);case 6:return e.t4=e.sent,e.t5=this.scale,e.t6=this.view,e.t7=i,e.t8=this._hasClusterSizeVariable?this._getClusterSymbol():null,e.next=13,(0,e.t1)(e.t2,e.t3,e.t4,e.t5,e.t6,e.t7,e.t8);case 13:return e.t9=e.sent,e.abrupt("return",{type:"size-ramp",title:e.t0,infos:e.t9});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"_createSymbolTableElementMultiBand",value:function(e){var t=this,n=[],r=["red","green","blue"];return e.forEach((function(e,i){var a;n.push({label:{colorName:r[i],bandName:e},src:ee.rgbImgSource[i],opacity:null!==(a=t.opacity)&&void 0!==a?a:1})})),n}},{key:"_updateInfosForClassedSizeRenderer",value:function(e,t){var n=e.authoringInfo&&"class-breaks-size"===e.authoringInfo.type,r=e.classBreakInfos.some((function(e){return(0,Q.YW)(e.symbol)}));if(n&&r){var i=$.realWorldMaxSize,a=$.realWorldMinSize,l=e.classBreakInfos.length,s=(i-a)/(l>1?l-1:l);t.forEach((function(e,t){e.size=i-s*t}))}}},{key:"_isTallSymbol",value:function(e){var t=!1,n=!1;if(e)for(var r=0;r<e.length&&(!t||!n);r++){var i=e[r];"size"===i.type&&("height"===i.axis&&(t=!0),"width-and-depth"===i.axis&&(n=!0))}return t&&n}},{key:"_getSymbolPreview",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,r,i){var a,l,s,o,u,c,d;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=null!==i&&void 0!==i&&i.isDefault||null!=t.size||!this._hasSizeRamp?t.size:(0,V.Wz)(W.b_.size),!this._scaleDrivenSizeVariable||null===i||void 0===i||!i.applyScaleDrivenSize){e.next=7;break}return e.next=4,Promise.resolve().then(n.bind(n,56011));case 4:u=e.sent,c=u.getSize,o=c(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===t.symbol.type?t.symbol.style:null});case 7:if(d=!(null!==i&&void 0!==i&&i.isDefault)&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||null===i||void 0===i||!i.applyScaleDrivenSize),e.t0=J.l3,e.t1=t.symbol,e.t2=o,e.t3=r,e.t4=!1,e.t5=null===i||void 0===i?void 0:i.symbolConfig,e.t6=null===i||void 0===i?void 0:i.effectList,e.t7={allowScalingUp:d,viewParams:this.isScaleDriven?{viewingMode:"2d"===(null===(a=this.view)||void 0===a?void 0:a.type)?"map":null===(l=this.view)||void 0===l?void 0:l.viewingMode,scale:null===(s=this.view)||void 0===s?void 0:s.scale}:null},!t.label||"string"==typeof t.label){e.next=20;break}e.t8=null,e.next=23;break;case 20:return e.next=22,Pe("previewTemplateAriaLabel",t.label);case 22:e.t8=e.sent;case 23:return e.t9=e.t8,e.t10={size:e.t2,opacity:e.t3,scale:e.t4,symbolConfig:e.t5,effectView:e.t6,style:"legend",cimOptions:e.t7,ariaLabel:e.t9},e.abrupt("return",(0,e.t0)(e.t1,e.t10).then((function(e){return t.preview=e,t})).catch((function(){return t.preview=null,t})));case 26:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_getClusterRenderer",value:function(e){var t;this._hasClusterSizeVariable=!1;var n="renderer"in this.layer?this.layer.renderer:null,r=(null===(t=e.renderer)||void 0===t?void 0:t.clone())||(null===n||void 0===n?void 0:n.clone()),i=function(e,t,n){var r=e.effectiveClusterRenderer;if(!r||!("visualVariables"in r)||!r.visualVariables)return null;var i=r.visualVariables.find((function(e){return"size"===e.type}));if(!("stops"in i)||!i.stops)return null;var a=i.stops.find((function(e){return e.useMinValue})),l=i.stops.find((function(e){return e.useMaxValue}));if(null==a||null==l)return null;var s=n.featuresTilingScheme.getClosestInfoForScale(n.scale).level,o=i.field,u=t.getDisplayStatistics(s,o);return u?new H.Z({field:i.field,minSize:e.clusterMinSize,minDataValue:u.minValue,maxSize:e.clusterMaxSize,maxDataValue:u.maxValue}):null}(e,this.layerView,this.view);if(i&&null!=r&&"visualVariables"in r){var a,l=null===(a=r.visualVariables)||void 0===a?void 0:a.some((function(e){return"size"===e.type&&"outline"!==e.target&&!le.test(e.valueExpression)}));if(!l){if("clusterMinSize"in e&&"clusterMaxSize"in e){var s=e.clusterMinSize,o=e.clusterMaxSize;i.legendOptions=new U.Z({showLegend:s!==o})}var u=r.visualVariables||[];r.visualVariables=u.concat([i]),this._hasClusterSizeVariable=!0}}return r}},{key:"_loadRenderer",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t){var n,r,i,a,l=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r=t.clone(),e.next=4,(0,ee.getMedianColor)(r);case 4:return i=e.sent,(pe(r)||me(r))&&(a=(r.classBreakInfos||r.uniqueValueInfos).map((function(e){return l._fetchSymbol(e.symbol,i).then((function(t){e.symbol=t})).catch((function(){e.symbol=null}))})),Array.prototype.push.apply(n,a)),n.push(this._fetchSymbol(r.symbol||r.defaultSymbol,r.defaultSymbol?null:i).then((function(e){l._applySymbolToRenderer(r,e,he(r))})).catch((function(){l._applySymbolToRenderer(r,null,he(r))}))),e.next=9,Promise.allSettled(n);case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_applySymbolToRenderer",value:function(e,t,n){n?e.symbol=t:e.defaultSymbol=t}},{key:"_fetchSymbol",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error;case 2:if("web-style"!==t.type){e.next=14;break}return r=this._webStyleSymbolCache,e.prev=4,e.next=7,"2d"===this.view.type?t.fetchCIMSymbol({cache:r}):t.fetchSymbol({cache:r});case 7:return i=e.sent,e.abrupt("return",this._getAppliedCloneSymbol(i,n));case 11:throw e.prev=11,e.t0=e.catch(4),p.Z.getLogger(this).warn("Fetching web-style failed!"),new Error;case 14:return e.abrupt("return",this._getAppliedCloneSymbol(t,n));case 15:case"end":return e.stop()}}),e,this,[[4,11]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getAppliedCloneSymbol",value:function(e,t){if(!e||!t)return e;var n=e.clone(),r=t&&t.toRgba();return n.type.includes("3d")?this._applyColorTo3dSymbol(n,r):"cim"===n.type?(0,j.ZB)(n,t):n.color&&(n.color=new x.Z(r||n.color)),n}},{key:"_applyColorTo3dSymbol",value:function(e,t){t&&e.symbolLayers.forEach((function(e){e&&(e.material||(e.material={}),e.material.color=new x.Z(t))}))}},{key:"_getVisualVariableLegendElements",value:function(){var e=(0,k.Z)((0,w.Z)().mark((function e(t,n){var r,i,a,l,s,o,u,c,d,f,y,v,h,p,m,b,g,L,x,C,I,R=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("visualVariables"in t&&"vector-field"!==t.type){e.next=2;break}return e.abrupt("return",null);case 2:a=null!==(r=t.visualVariables)&&void 0!==r?r:[],l=[],s=[],o=[],2===(null===(u=(0,ee.getReferenceSizeAuthoringInfoVisualVariable)(t))||void 0===u||null===(i=u.sizeStops)||void 0===i?void 0:i.length)&&(pe(t)||me(t))&&(d=(0,_.Z)(u.sizeStops,2),f=d[0],y=d[1],s.push(new H.Z({field:null!==(c=u.field)&&void 0!==c?c:void 0,normalizationField:u.normalizationField,minSize:f.size,maxSize:y.size,minDataValue:f.value,maxDataValue:y.value}))),v=(0,S.Z)(a);try{for(v.s();!(h=v.n()).done;)"color"===(p=h.value).type?l.push(p):"size"===p.type?s.push(p):"opacity"===p.type&&o.push(p)}catch(Z){v.e(Z)}finally{v.f()}return m=[].concat(l,s,o),0===l.length&&pe(t)&&t.classBreakInfos&&1===t.classBreakInfos.length&&(L=t.classBreakInfos[0],b=L&&L.symbol),0===l.length&&he(t)&&(b=t.symbol),b&&(b.type.includes("3d")?"water"===(C=b.symbolLayers.at(0)).type?null!=C.color&&(g=C.color):null!=(null===(x=C.material)||void 0===x?void 0:x.color)&&(g=C.material.color):b.url||(g=b.color)),I=this.effectList,e.next=12,Promise.all(m.map(function(){var e=(0,k.Z)((0,w.Z)().mark((function e(r){var i,a,l,s,o,u,c,d;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.legendOptions&&!1===r.legendOptions.showLegend){e.next=68;break}if(a=ce(t)?r.field:R._getRampTitle(r,n),l=null,s=(0,ee.getDateFormatOptions)(n,r,R.view.timeZone),"color"!==r.type){e.next=31;break}return e.next=7,(0,X.getRampStops)(r,null,s);case 7:if(e.t1=o=e.sent,e.t0=null!==e.t1,!e.t0){e.next=11;break}e.t0=void 0!==o;case 11:if(!e.t0){e.next=15;break}e.t2=o,e.next=16;break;case 15:e.t2=[];case 16:return u=e.t2,e.t3=a,e.t4=u,e.t5=J.jT,e.t6=u.map((function(e){return e.color})),e.t7=I,e.next=24,Pe("previewColorRampAriaLabel");case 24:e.t8=e.sent,e.t9={effectList:e.t7,ariaLabel:e.t8},e.t10=(0,e.t5)(e.t6,e.t9),l={type:"color-ramp",title:e.t3,infos:e.t4,preview:e.t10},R._hasColorRamp||(R._hasColorRamp=u.length>0),e.next=67;break;case 31:if("size"!==r.type||"outline"===r.target){e.next=42;break}if(!le.test(r.valueExpression)){e.next=36;break}R._hasClusterSizeVariable||(R._scaleDrivenSizeVariable=r),e.next=40;break;case 36:return e.next=38,R._getSizeLegendElement(a,r,t,s);case 38:l=e.sent,R._hasSizeRamp||(R._hasSizeRamp=!(null==l.infos||!l.infos.length));case 40:e.next=67;break;case 42:if("opacity"!==r.type){e.next=67;break}return e.next=45,(0,X.getRampStops)(r,g,s);case 45:if(e.t12=c=e.sent,e.t11=null!==e.t12,!e.t11){e.next=49;break}e.t11=void 0!==c;case 49:if(!e.t11){e.next=53;break}e.t13=c,e.next=54;break;case 53:e.t13=[];case 54:return d=e.t13,e.t14=a,e.t15=d,e.t16=J.jT,e.t17=d.map((function(e){return e.color})),e.t18=I,e.next=62,Pe("previewColorRampAriaLabel");case 62:e.t19=e.sent,e.t20={effectList:e.t18,ariaLabel:e.t19},e.t21=(0,e.t16)(e.t17,e.t20),l={type:"opacity-ramp",title:e.t14,infos:e.t15,preview:e.t21},R._hasOpacityRamp||(R._hasOpacityRamp=d.length>0);case 67:return e.abrupt("return",null!==(i=l)&&void 0!==i&&i.infos?l:null);case 68:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return e.abrupt("return",e.sent.filter(E.pC));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getDomainName",value:function(e,t,n){if(e&&"function"!=typeof e){var r,i="getField"in n&&(null===(r=n.getField)||void 0===r?void 0:r.call(n,e)),a=i&&"getFieldDomain"in n&&n.getFieldDomain?n.getFieldDomain(i.name):null;return"coded-value"===(null===a||void 0===a?void 0:a.type)?a.getName(t):null}return null}},{key:"_getClusterTitle",value:function(e){var t=this.layer,n=e.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type){var r=t.featureReduction,i="popupTemplate"in r&&r.popupTemplate,a=i&&i.fieldInfos;if(a){var l,s=(0,S.Z)(a);try{for(s.s();!(l=s.n()).done;){var o=l.value;if(o.fieldName===n)return"cluster_count"===n?o.label||{showCount:!0}:o.label}}catch(u){s.e(u)}finally{s.f()}}}return{showCount:!0}}},{key:"_getRampTitle",value:function(e,t){var n,r=e.field,i=e.normalizationField,a=!1,l=!1,s=!1,o=null;r="function"==typeof r?null:r,i="function"==typeof i?null:i;var u=null===(n=e.legendOptions)||void 0===n?void 0:n.title;if(null!=u)o=u;else if(e.valueExpressionTitle)o=e.valueExpressionTitle;else{var c;if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&null!==(c=t.renderer.authoringInfo)&&void 0!==c&&c.visualVariables)for(var d=t.renderer.authoringInfo.visualVariables,f=0;f<d.length;f++){var y=d[f];if("color"===y.type){if("ratio"===y.style){a=!0;break}if("percent"===y.style){l=!0;break}if("percent-of-total"===y.style){s=!0;break}}}o={field:r&&this._getFieldAlias(r,t),normField:i&&this._getFieldAlias(i,t),ratio:a,ratioPercent:l,ratioPercentTotal:s}}return o}},{key:"_getRendererTitle",value:function(e,t){var n,r=e;if(null!==(n=r.legendOptions)&&void 0!==n&&n.title)return r.legendOptions.title;if(r.valueExpressionTitle)return r.valueExpressionTitle;var i=r.field,a=null,l=null;if(pe(r)&&(a=r.normalizationField,l="percent-of-total"===r.normalizationType),i="function"==typeof i?null:i,a="function"==typeof a?null:a,me(r)){var s=r.field2,o=r.field3,u=r.fieldDelimiter,c=i&&this._getFieldAlias(i,t);return s&&(c="<".concat(c,">").concat(u,"<").concat(this._getFieldAlias(s,t),">"),o&&(c="".concat(c).concat(u,"<").concat(this._getFieldAlias(o,t),">"))),c}var d=null;return(i||a)&&(d={field:i&&this._getFieldAlias(i,t),normField:a&&this._getFieldAlias(a,t),normByPct:l}),d}},{key:"_getFieldAlias",value:function(e,t){var n,r,i,a,l,s,o="popupTemplate"in t?t.popupTemplate:null,u=null===o||void 0===o?void 0:o.fieldInfos,c=null===u||void 0===u?void 0:u.find((function(t){return e===t.fieldName})),d=null;"getField"in t&&t.getField?d=t.getField(e):"fieldsIndex"in t&&t.fieldsIndex&&(d=t.fieldsIndex.get(e));var f=null,y="featureReduction"in t&&t.featureReduction;y&&(null!==(n=c)&&void 0!==n||(c="popupTemplate"in y?null===(r=y.popupTemplate)||void 0===r||null===(i=r.fieldInfos)||void 0===i?void 0:i.find((function(t){var n;return(null===e||void 0===e?void 0:e.toLowerCase())===(null===(n=t.fieldName)||void 0===n?void 0:n.toLowerCase())})):void 0),"fields"in y&&y.fields&&(f=y.fields.find((function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===(null===e||void 0===e?void 0:e.toLowerCase())}))));var v=c||d||f,h=null;return v&&(h=(null===(a=c)||void 0===a?void 0:a.label)||(null===(l=d)||void 0===l?void 0:l.alias)||(null===(s=f)||void 0===s?void 0:s.alias)||"name"in v&&v.name||"fieldName"in v&&v.fieldName||null),h}},{key:"_isUnclassedRenderer",value:function(e){var t=e.visualVariables,n=!1;return pe(e)&&e.classBreakInfos&&1===e.classBreakInfos.length&&t&&(n=e.field?t.some((function(t){return!(!t||e.field!==t.field||(e.normalizationField||t.normalizationField)&&e.normalizationField!==t.normalizationField)})):!!t.length),n}}]),o}(v.default);(0,o._)([(0,c.Cb)()],qe.prototype,"children",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],qe.prototype,"effectList",null),(0,o._)([(0,c.Cb)()],qe.prototype,"layerView",void 0),(0,o._)([(0,c.Cb)()],qe.prototype,"layer",void 0),(0,o._)([(0,c.Cb)()],qe.prototype,"legendElements",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],qe.prototype,"opacity",null),(0,o._)([(0,c.Cb)()],qe.prototype,"parent",void 0),(0,o._)([(0,c.Cb)({readOnly:!0,dependsOn:[]})],qe.prototype,"ready",null),(0,o._)([(0,c.Cb)()],qe.prototype,"hideLayersNotInCurrentView",void 0),(0,o._)([(0,c.Cb)()],qe.prototype,"keepCacheOnDestroy",void 0),(0,o._)([(0,c.Cb)()],qe.prototype,"respectLayerDefinitionExpression",void 0),(0,o._)([(0,c.Cb)()],qe.prototype,"respectLayerVisibility",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],qe.prototype,"scale",null),(0,o._)([(0,c.Cb)()],qe.prototype,"sublayerIds",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],qe.prototype,"isScaleDriven",null),(0,o._)([(0,c.Cb)()],qe.prototype,"title",void 0),(0,o._)([(0,c.Cb)({readOnly:!0,dependsOn:["ready"],value:0})],qe.prototype,"version",null),(0,o._)([(0,c.Cb)()],qe.prototype,"view",void 0);var je=qe=(0,o._)([(0,f.j)("esri.widgets.Legend.support.ActiveLayerInfo")],qe),We=n(36257),Ge="state",Je="view",Qe="all-layer-views",Xe="legend-properties",Ke=h.Z.ofType(je),Ye=new Set(["esri.layers.BuildingSceneLayer","esri.layers.CatalogLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.OrientedImageryLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.catalog.CatalogFootprintLayer","esri.layers.catalog.CatalogDynamicGroupLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer"]),$e="view.basemapView.baseLayerViews",et="view.groundView.layerViews",tt="view.basemapView.referenceLayerViews",nt=[$e,et,"view.layerViews",tt],rt=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e))._layerViewByLayerId={},r._layerInfosByLayerViewId={},r._activeLayerInfosByLayerViewId={},r._activeLayerInfosWithNoParent=new h.Z,r.activeLayerInfos=new Ke,r.basemapLegendVisible=!1,r.groundLegendVisible=!1,r.hideLayersNotInCurrentView=!1,r.keepCacheOnDestroy=!1,r.respectLayerDefinitionExpression=!1,r.respectLayerVisibility=!0,r.layerInfos=[],r.view=null,r}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,u.watch)((function(){return e.view}),(function(){return e._viewHandles()}),u.initial),Je),this.addHandles((0,We.qe)((function(){return e._refresh()})))}},{key:"destroy",value:function(){this._destroyViewActiveLayerInfos(),this.view=null}},{key:"state",get:function(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready?"ready":"disabled"}},{key:"_viewHandles",value:function(){var e=this;this.removeHandles(Ge),this.view&&this.addHandles((0,u.watch)((function(){return e.state}),(function(){return e._stateHandles()}),u.initial),Ge)}},{key:"_stateHandles",value:function(){this._resetAll(),"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}},{key:"_resetAll",value:function(){this.removeHandles([Qe,Xe]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}},{key:"_destroyViewActiveLayerInfos",value:function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}},{key:"_destroyViewActiveLayerInfo",value:function(e){this.removeHandles(e);var t=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],(null===t||void 0===t?void 0:t.parent)&&t.parent.children.remove(t)}},{key:"_watchPropertiesAndAllLayerViews",value:function(){var e=this,t=this.view;if(t){var n=t.allLayerViews;n.length&&this._refresh(),this.addHandles(n.on("change",(function(t){return e._propertiesChangeHandle()})),Qe),this.addHandles((0,u.watch)((function(){return[e.layerInfos,e.basemapLegendVisible,e.groundLegendVisible]}),(function(){return e._propertiesChangeHandle()})),Xe)}}},{key:"_propertiesChangeHandle",value:function(){this._destroyViewActiveLayerInfos(),this._refresh()}},{key:"_refresh",value:function(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}},{key:"_sortActiveLayerInfos",value:function(e){var t=this,n=this.view;if(!(e.length<2)&&n){var r=[];e.forEach((function(n){if(!n.parent){var i=n.layer.parent,a=i&&"uid"in i&&t._layerViewByLayerId[i.uid],l=a&&t._activeLayerInfosByLayerViewId[a.uid];l&&e.includes(l)&&(r.push(n),n.parent=l,l.children.add(n),t._sortActiveLayerInfos(l.children))}})),e.removeMany(r);var i={};n.allLayerViews.forEach((function(e,t){return i[e.layer.uid]=t})),e.sort((function(e,t){var n=i[e.layer.uid]||0;return(i[t.layer.uid]||0)-n}))}}},{key:"_generateLayerViews",value:function(){var e=this,t=[];return nt.filter(this._filterLayerViews,this).map((function(t){return(0,m.U2)(e,t)})).filter((function(e){return null!=e})).forEach(this._collectLayerViews("layerViews",t)),t}},{key:"_filterLayerViews",value:function(e){var t=!this.basemapLegendVisible&&(e===$e||e===tt),n=!this.groundLegendVisible&&e===et;return!t&&!n}},{key:"_collectLayerViews",value:function(e,t){return function n(r){return r&&r.forEach((function(r){t.push(r),n(r[e])})),t}}},{key:"_filterLayerViewsByLayerInfos",value:function(e){var t=this,n=this.layerInfos;return!n||!n.length||n.some((function(n){return t._hasLayerInfo(n,e)}))}},{key:"_hasLayerInfo",value:function(e,t){var n=this._isLayerUIDMatching(e.layer,t.layer.uid);return n&&(this._layerInfosByLayerViewId[t.uid]=e),n}},{key:"_isLayerUIDMatching",value:function(e,t){return e&&(e.uid===t||this._hasLayerUID(e.layers,t))}},{key:"_hasLayerUID",value:function(e,t){var n=this;return e&&e.some((function(e){return n._isLayerUIDMatching(e,t)}))}},{key:"_isLayerViewSupported",value:function(e){return!!Ye.has(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}},{key:"_generateActiveLayerInfo",value:function(e){var t=this;this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles((0,u.watch)((function(){var t;return[e.legendEnabled,null===(t=e.layer)||void 0===t?void 0:t.legendEnabled]}),(function(){return t._layerActiveHandle(e)})),e.uid))}},{key:"_layerActiveHandle",value:function(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}},{key:"_isLayerActive",value:function(e){var t;return!this.respectLayerVisibility||e.legendEnabled&&(null===(t=e.layer)||void 0===t?void 0:t.legendEnabled)}},{key:"_buildActiveLayerInfo",value:function(e){var t,n=this,r=e.layer,i=e.uid,a=this._layerInfosByLayerViewId[i],l=this._activeLayerInfosByLayerViewId[i];if(!l){var s,o=void 0!==(null===a||void 0===a?void 0:a.title)&&a.layer.uid===r.uid;l=new je({layer:r,layerView:e,title:o?a.title:r.title,view:null!==(s=this.view)&&void 0!==s?s:void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:(null===a||void 0===a?void 0:a.sublayerIds)||[]}),this._activeLayerInfosByLayerViewId[i]=l}var c=r.parent&&"uid"in r.parent?this._layerViewByLayerId[null===(t=r.parent)||void 0===t?void 0:t.uid]:null;if(l.parent=this._activeLayerInfosByLayerViewId[null===c||void 0===c?void 0:c.uid],!this.hasHandles(i)){var d=[(0,u.watch)((function(){return r.title}),(function(e){return n._titleHandle(e,l)})),(0,u.watch)((function(){return[r.opacity,"renderer"in r&&r.renderer,"pointSymbol"in r&&r.pointSymbol,"lineSymbol"in r&&r.lineSymbol,"polygonSymbol"in r&&r.polygonSymbol]}),(function(){return n._constructLegendElements(l)})),(0,u.when)((function(){var e;return!0===(null===(e=n.view)||void 0===e?void 0:e.stationary)}),(function(){return n._scaleHandle(l)}),u.initial),(0,u.watch)((function(){return e.layer?(0,b.g)(e.layer,e.view):null}),(function(){return n._constructLegendElements(l)})),(0,u.watch)((function(){return e.updating}),(function(){null!=e.layer&&null!=(0,b.g)(e.layer,e.view)&&n._constructLegendElements(l)})),(0,u.watch)((function(){return"effect"in r&&r.effect}),(function(){return n._constructLegendElements(l)})),(0,u.when)((function(){var e;return null===(e=n.view)||void 0===e?void 0:e.timeZone}),(function(){return n._constructLegendElements(l)}),u.initial)];if(this.respectLayerVisibility){var f=(0,u.watch)((function(){return e.legendEnabled}),(function(e){return n._legendEnabledHandle(e,l)})),y=(0,u.watch)((function(){return r.legendEnabled}),(function(e){return n._legendEnabledHandle(e,l)}));d.push(f,y)}this.addHandles(d,i)}l.isScaleDriven||this._constructLegendElements(l),this._addActiveLayerInfo(l)}},{key:"_titleHandle",value:function(e,t){t.title=e,this._constructLegendElements(t)}},{key:"_legendEnabledHandle",value:function(e,t){e?this._addActiveLayerInfo(t):this._removeActiveLayerInfo(t)}},{key:"_scaleHandle",value:function(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}},{key:"_addActiveLayerInfo",value:function(e){var t=this,n=e.layerView,r=e.layer;if(this._isLayerActive(n)&&!this.activeLayerInfos.includes(e)){var i=e.parent;if(i)i.children.includes(e)||i.children.push(e),this._sortActiveLayerInfos(i.children);else{var a,l=null===(a=this.layerInfos)||void 0===a?void 0:a.some((function(e){return e.layer.uid===r.uid}));r.parent&&"uid"in r.parent&&!l?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){var s=[];this._activeLayerInfosWithNoParent.forEach((function(e){var n=e.layer.parent,r=n&&"uid"in n?t._layerViewByLayerId[null===n||void 0===n?void 0:n.uid]:null,i=t._activeLayerInfosByLayerViewId[null===r||void 0===r?void 0:r.uid];i&&(s.push(e),e.parent=i)})),s.length&&(this._activeLayerInfosWithNoParent.removeMany(s),s.forEach((function(e){return t._addActiveLayerInfo(e)})))}}}},{key:"_removeActiveLayerInfo",value:function(e){var t=e.parent;t?t.children.remove(e):this.activeLayerInfos.remove(e)}},{key:"_constructLegendElements",value:function(e){var t=this,n=e.layer;"featureCollections"in n&&n.featureCollections?e.buildLegendElementsForFeatureCollections(n.featureCollections):"featureReduction"in n&&n.featureReduction&&"renderer"in n.featureReduction&&("binning"===n.featureReduction.type||"cluster"===n.featureReduction.type)&&(!this.view||n.featureReduction.maxScale<=this.view.scale)?e.buildLegendElementsForFeatureReduction(n.featureReduction):"renderer"in n&&n.renderer&&!("sublayers"in n)?e.buildLegendElementsForRenderer(n.renderer):"url"in n&&n.url&&"catalog"!==n.type?e.buildLegendElementsForTools():e.children.forEach((function(e){return t._constructLegendElements(e)}))}}]),n}(v.default);(0,o._)([(0,c.Cb)({type:Ke})],rt.prototype,"activeLayerInfos",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"basemapLegendVisible",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"groundLegendVisible",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"hideLayersNotInCurrentView",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"keepCacheOnDestroy",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"respectLayerDefinitionExpression",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"respectLayerVisibility",void 0),(0,o._)([(0,c.Cb)()],rt.prototype,"layerInfos",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],rt.prototype,"state",null),(0,o._)([(0,c.Cb)()],rt.prototype,"view",void 0);var it=rt=(0,o._)([(0,f.j)("esri.widgets.Legend.LegendViewModel")],rt),at=n(99653),lt="esri-legend--card",st="esri-legend",ot={activated:"".concat(lt,"__carousel-indicator--activated"),base:lt,stacked:"".concat(st,"--stacked"),carouselTitle:"".concat(lt,"__carousel-title"),indicator:"".concat(lt,"__carousel-indicator"),intervalSeparator:"".concat(lt,"__interval-separator"),imageryLayerStretchedImage:"".concat(lt,"__imagery-layer-image--stretched"),imageLabel:"".concat(lt,"__image-label"),layerCaption:"".concat(lt,"__layer-caption"),labelElement:"".concat(lt,"__label-element"),layerRow:"".concat(lt,"__layer-row"),labelCell:"".concat(lt,"__label-cell"),message:"".concat(lt,"__message"),rampLabel:"".concat(lt,"__ramp-label"),section:"".concat(lt,"__section"),relationshipSection:"".concat(lt,"__relationship-section"),serviceCaptionText:"".concat(lt,"__service-caption-text"),serviceContent:"".concat(lt,"__service-content"),service:"".concat(lt,"__service"),groupLayer:"".concat(lt,"__group-layer"),groupLayerChild:"".concat(lt,"__group-layer-child"),symbol:"".concat(lt,"__symbol"),sizeRampRow:"".concat(lt,"__size-ramp-row"),symbolRow:"".concat(lt,"__symbol-row"),symbolCell:"".concat(lt,"__symbol-cell"),indicatorContainer:"".concat(lt,"__carousel-indicator-container"),intervalSeparatorsContainer:"".concat(lt,"__interval-separators-container"),relationshipLabelContainer:"".concat(lt,"__relationship-label-container"),labelContainer:"".concat(lt,"__label-container"),serviceCaptionContainer:"".concat(lt,"__service-caption-container"),symbolContainer:"".concat(lt,"__symbol-container"),sizeRampContainer:"".concat(lt,"__size-ramp-container"),sizeRampPreview:"".concat(lt,"__size-ramp-preview"),pieChartRampPreview:"".concat(lt,"__pie-chart-ramp-preview"),rampContainer:"".concat(st,"__ramps"),sizeRampHorizontal:"".concat(st,"__size-ramp--horizontal"),rampLabelsContainer:"".concat(st,"__ramp-labels"),layerInfo:"".concat(st,"__layer-cell ").concat(st,"__layer-cell--info"),univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"},ut=n(63528),ct=(n(42877),n(88367)),dt=n(80975),ft=n(67005),yt=(0,ct.E)(),vt=20,ht=10,pt=20,mt="esri-univariate-above-and-below-ramp__symbol",bt="esri-legend__color-ramp";function gt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vertical",t="stroke:rgb(200, 200, 200);stroke-width:1";return"vertical"===e?(0,ft.u)("svg",{height:"4",width:"10"},(0,ft.u)("line",{style:t,x1:"0",x2:"10",y1:"2",y2:"2"})):(0,ft.u)("svg",{height:"10",width:"10"},(0,ft.u)("line",{style:t,x1:"5",x2:"5",y1:"0",y2:"10"}))}function _t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vertical",n=document.createElement("div");return n.style.height="".concat(vt,"px"),n.className=mt,null!=e&&(n.style.opacity=e.toString()),yt.append(n,gt.bind(null,t)),n}function Lt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vertical",r=arguments.length>3?arguments[3]:void 0;e.infos.forEach((function(e,i){if(r&&2===i)e.preview=_t(t,n);else{var a=(0,V.F2)(e.size)+("horizontal"===n?pt:ht),l=e.preview,s="div"===(null===l||void 0===l?void 0:l.tagName.toLowerCase()),o=s?l:document.createElement("div");o.className=mt,"horizontal"===n?o.style.width="".concat(a,"px"):o.style.height="".concat(a,"px"),!s&&l&&o.appendChild(l),e.preview=o}}))}function wt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"classic",n=e.infos;return"classic"===t?((0,V.F2)(n[0].size)+ht)/2:((0,V.F2)(n[0].size)-(0,V.F2)(n[n.length-1].size))/2}function St(e,t){if(!e)return null;var n=e.infos.map((function(e){return e.color})),r=(0,J.jT)("full"===t.type?n:"above"===t.type?n.slice(0,3):n.slice(2,5),{width:t.width,height:t.height,align:t.rampAlignment,effectList:t.effectList,ariaLabel:t.ariaLabel});return r.className=bt,null!=t.opacity&&(r.style.opacity=t.opacity.toString()),r}function kt(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vertical",i=0,a=e.infos,l=Math.floor(a.length/2),s="full"===t||"above"===t?0:l,o="full"===t||"below"===t?a.length-1:l,u=s;u<=o;u++)i+=n&&u===l?"horizontal"===r?10:vt:(0,V.F2)(a[u].size)+("horizontal"===r?pt:ht);return Math.round(i)}function xt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vertical",i=kt(e,t,n,r),a=e.infos,l=Math.floor(a.length/2),s="full"===t||"above"===t?0:l,o="full"===t||"below"===t?a.length-1:l,u="full"===t?a[s].size+a[o].size:"above"===t?a[s].size:a[o].size,c=n?"vertical"===r?vt:10:0,d="vertical"===r?ht*("full"===t?2:1):pt*("full"===t?2:1);return Math.round(i-((0,V.F2)(u)/2+c/2+d/2))}function Ct(e,t){var n,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vertical",l=e.infos,s=l.find((function(e){return"size-ramp"===e.type})),o=l.find((function(e){return"color-ramp"===e.type}));return s&&((s=(0,r.Z)({},s)).infos=(0,L.Z)(s.infos),Lt(s,t,a,!0)),o&&((o=(0,r.Z)({},o)).infos=(0,L.Z)(o.infos)),"horizontal"===a&&(null!==(n=s)&&void 0!==n&&n.infos.reverse(),null!==(i=o)&&void 0!==i&&i.infos.reverse()),{sizeRampElement:s,colorRampElement:o}}function It(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vertical",a=e.infos,l=a.find((function(e){return"size-ramp"===e.type})),s=a.find((function(e){return"color-ramp"===e.type}));return l&&((l=(0,r.Z)({},l)).infos=(0,L.Z)(l.infos),Lt(l,null,i,!1)),s&&((s=(0,r.Z)({},s)).infos=(0,L.Z)(s.infos)),"horizontal"===i&&(null!==(t=l)&&void 0!==t&&t.infos.reverse(),null!==(n=s)&&void 0!==n&&n.infos.reverse()),{sizeRampElement:l,colorRampElement:s}}var Et=n(643),Rt=n(6291);function Zt(e){e.appendChild(this)}function Vt(e,t,n){if(t){if("number"==typeof t)return t;if("string"==typeof t)return(0,Et.Cb)(t);if("value"in t||"unit"in t)return(0,ae.n)(e.dotValue,t);if("colorName"in t&&"bandName"in t)return e[t.colorName]+": "+(e[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?e.clusterCountTitle:void 0;var r=null;return n?r=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:Ft(t,n)&&(r=t.normField?"showNormField":t.normByPct?"showNormPct":t.field?"showField":null),r?(0,ae.n)("showField"===r?"{field}":e[r],{field:t.field,normField:t.normField}):void 0}}function Ft(e,t){return!t}function zt(e,t){return!!(t&&"Stretched"===t&&e.version>=10.3&&"esri.layers.ImageryLayer"===e.declaredClass)}function At(e,t){var n,r;return e.label?t[e.label]+": "+("string"==typeof e.value?e.value:(0,Rt.uf)(null!==(n=e.value)&&void 0!==n?n:0,{style:"decimal",notation:null!==(r=e.value)&&void 0!==r&&r.toString().toLowerCase().includes("e")?"scientific":"standard"})):""}var Tt=n(96919),Mt=n(78088),Dt=n(80532),Nt=window.devicePixelRatio;var Ot=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r))._hasIndicators=!1,a._selectedSectionName=null,a._sectionNames=[],a._sectionMap=new Map,a.activeLayerInfos=null,a.headingLevel=3,a.layout="stack",a.messages=null,a.messagesCommon=null,a.type="card",a.view=null,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,u.watch)((function(){return e.activeLayerInfos}),(function(t){e.removeAllHandles(),e._watchForSectionChanges(t)})))}},{key:"render",value:function(){var e=this,t=this.view;this._hasIndicators="auto"===this.layout&&t&&t.container.clientWidth<=768||"stack"===this.layout;var n=this.activeLayerInfos,r=null===n||void 0===n?void 0:n.toArray().map((function(t){return e._renderLegendForLayer(t)})).filter((function(e){return!!e}));this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;var i=this._sectionNames.length,a=this._sectionNames.map((function(t,n){var r=(0,ae.n)(e.messagesCommon.pagination.pageText,{index:n+1,total:i});return(0,ft.u)("div",{"aria-controls":"".concat(t,"-panel"),"aria-label":r,"aria-selected":(e._selectedSectionName===t).toString(),bind:e,class:e.classes(ot.indicator,(0,g.Z)({},ot.activated,e._selectedSectionName===t)),"data-section-name":t,id:t,key:t,onclick:e._selectSection,onkeydown:e._focusSection,role:"tab",tabIndex:e._selectedSectionName===t?0:-1,title:r})})),l=this._hasIndicators&&i>1?(0,ft.u)("div",{class:ot.indicatorContainer,key:"carousel-navigation",role:"tablist"},a):null,s=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):null!==r&&void 0!==r&&r.length?r:null,o=(0,g.Z)({},ot.stacked,this._hasIndicators);return(0,ft.u)("div",{class:this.classes(ot.base,o)},s||(0,ft.u)("div",{class:ot.message},this.messages.noLegend),l)}},{key:"_selectSection",value:function(e){var t=e.target.getAttribute("data-section-name");t&&(this._selectedSectionName=t)}},{key:"_focusSection",value:function(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}},{key:"_switchSectionOnArrowPress",value:function(e){var t,n=e.key,r="ArrowLeft"===n?-1:1,i=e.target.getAttribute("data-section-name"),a=this._sectionNames.indexOf(i),l=this._sectionNames,s=null;-1!==a&&(l[a+r]?s=document.getElementById(l[a+r]):"ArrowLeft"===n?s=document.getElementById(l[l.length-1]):"ArrowRight"===n&&(s=document.getElementById(l[0])),null===(t=s)||void 0===t||t.focus())}},{key:"_watchForSectionChanges",value:function(e){var t=this;if(this._generateSectionNames(),e){e.forEach((function(e){var n="activeLayerInfo-".concat(e.layer.uid,"-version-change");t.removeHandles(n),t._watchForSectionChanges(e.children),t.addHandles((0,u.watch)((function(){return e.version}),(function(){return t._generateSectionNames()})),n)}));var n="activeLayerInfos-collection-change";this.removeHandles(n),this.addHandles(e.on("change",(function(){return t._watchForSectionChanges(e)})),n)}}},{key:"_generateSectionNames",value:function(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}},{key:"_getSectionName",value:function(e,t,n){return"".concat(this.id).concat(e.uid,"-type-").concat(t.type,"-").concat(n)}},{key:"_generateSectionNamesForActiveLayerInfo",value:function(e){var t=this;e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((function(n,r){t._sectionNames.push(t._getSectionName(e.layer,n,r))}))}},{key:"_renderLegendForLayer",value:function(e){var t=this;if(!e.ready)return null;if(e.children.length){var n=e.children.map((function(e){return t._renderLegendForLayer(e)})).toArray();return(0,ft.u)("div",{class:this.classes(ot.service,ot.groupLayer),key:e.layer.uid},(0,ft.u)("div",{class:ot.serviceCaptionContainer},e.title),n)}var r=e.legendElements;if(r&&!r.length)return null;var i=r.some((function(e){return"relationship-ramp"===e.type})),a=r.map((function(n,r){return t._renderLegendForElement(n,e,r,i)})).filter((function(e){return!!e}));if(!a.length)return null;var l=(0,g.Z)({},ot.groupLayerChild,!!e.parent);return(0,ft.u)("div",{class:this.classes(ot.service,l),key:e.layer.uid},(0,ft.u)("div",{class:ot.serviceCaptionContainer},(0,ft.u)("div",{class:ot.serviceCaptionText},e.title)),(0,ft.u)("div",{class:ot.serviceContent},a))}},{key:"_renderLegendForElement",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l="color-ramp"===e.type,s="opacity-ramp"===e.type,o=t.layer,u=null;if("string"==typeof e.title)u=e.title;else if(e.title){var c=e.title,d=Vt(this.messages,c,l||s);u=c.title?"".concat(c.title," (").concat(d,")"):d}var f=this._getSectionName(o,e,n),y=this._hasIndicators&&!a?(0,ft.u)("div",null,(0,ft.u)(Tt.X,{class:ot.carouselTitle,level:this.headingLevel},t.title),(0,ft.u)(Tt.X,{class:ot.layerCaption,level:(0,Tt.M)(this.headingLevel)},u)):u?(0,ft.u)(Tt.X,{class:ot.layerCaption,level:this.headingLevel},u):null,v=t.effectList,h=null;switch(e.type){case"symbol-table":var p=e.infos.map((function(n,i){return r._renderLegendForElementInfo(n,t,e.legendType,i)})).filter((function(e){return!!e}));if(p.length){var m,b,_=null===(m=p[0].properties.classes)||void 0===m?void 0:m[ot.symbolRow],L=(b={},(0,g.Z)(b,ot.labelContainer,!_&&!i),(0,g.Z)(b,ot.relationshipLabelContainer,i),b);h=(0,ft.u)("div",{class:this.classes(L)},p)}break;case"color-ramp":case"opacity-ramp":case"heatmap-ramp":case"stretch-ramp":h=this._renderLegendForRamp(e,o.opacity,v);break;case"size-ramp":h=this._renderSizeRamp(e,o.opacity);break;case"pie-chart-ramp":h=this._renderPieChartRamp(e);break;case"relationship-ramp":h=(0,ut.g)(e,this.id,{opacity:o.opacity,effectList:v,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case"univariate-above-and-below-ramp":h=this._renderUnivariateAboveAndBelowRamp(e,o.opacity,v);break;case"univariate-color-size-ramp":h=this._renderUnivariateColorSizeRamp(e,o.opacity,v)}if(!h)return null;var w=(0,ft.u)("div",{"aria-labelledby":f,class:ot.section,id:"".concat(f,"-panel"),key:f,role:"tabpanel",tabIndex:0},[y,h]);return a||this._sectionMap.set(f,w),w}},{key:"_renderPieChartRamp",value:function(e){return(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:ot.pieChartRampPreview})}},{key:"_renderUnivariateAboveAndBelowRamp",value:function(e,t,n){var r,i=Ct(e,t,"horizontal"),a=i.sizeRampElement,l=i.colorRampElement;if(!a)return null;var s=kt(a,"full",!0,"horizontal"),o=xt(a,"above",!0,"horizontal"),u=xt(a,"below",!0,"horizontal"),c=null===(r=this.messages)||void 0===r?void 0:r.previewColorRampAriaLabel,d=St(l,{width:o,height:12,rampAlignment:"horizontal",opacity:t,type:"above",effectList:n,ariaLabel:c}),f=St(l,{width:u,height:12,rampAlignment:"horizontal",opacity:t,type:"below",effectList:n,ariaLabel:c}),y=wt(a,"card"),v=a.infos.map((function(e){return e.label})),h=v.length-1,p=v.map((function(e,t){return 0===t||t===h?(0,ft.u)("div",{key:t},e):null})),m={marginTop:"3px",display:"flex"};(0,dt.dZ)(this.container)?m.marginRight="".concat(y,"px"):m.marginLeft="".concat(y,"px");var b={width:"".concat(s,"px"),display:"flex",flexDirection:"row",justifyContent:"space-between"};return(0,ft.u)("div",{class:ot.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},(0,ft.u)("div",{class:this.classes(ot.symbolContainer,ot.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},a.infos.map((function(e,t){return(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:ot.symbol,key:t})}))),d?(0,ft.u)("div",{class:ot.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:m},(0,ft.u)("div",{afterCreate:Zt,bind:d}),(0,ft.u)("div",{afterCreate:Zt,bind:f})):null,(0,ft.u)("div",{class:ot.layerInfo},(0,ft.u)("div",{class:ot.rampLabelsContainer,styles:b},p)))}},{key:"_renderUnivariateColorSizeRamp",value:function(e,t,n){var r,i=It(e,"horizontal"),a=i.sizeRampElement,l=i.colorRampElement;if(!a)return null;var s=kt(a,"full",!1,"horizontal"),o=St(l,{width:xt(a,"full",!1,"horizontal"),height:12,rampAlignment:"horizontal",opacity:t,type:"full",effectList:n,ariaLabel:null===(r=this.messages)||void 0===r?void 0:r.previewColorRampAriaLabel}),u=wt(a,"card"),c=a.infos.length-1,d=a.infos.map((function(e,t){return 0===t||t===c?(0,ft.u)("div",{key:t},e.label):null})),f={marginTop:"3px",display:"flex"};(0,dt.dZ)(this.container)?f.marginRight="".concat(u,"px"):f.marginLeft="".concat(u,"px");var y={width:"".concat(s,"px"),display:"flex",flexDirection:"row",justifyContent:"space-between"};return(0,ft.u)("div",{class:ot.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},(0,ft.u)("div",{class:this.classes(ot.symbolContainer,ot.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},a.infos.map((function(e,t){return(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:ot.symbol,key:t})}))),(0,ft.u)("div",{class:ot.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:f},(0,ft.u)("div",{afterCreate:Zt,bind:o})),(0,ft.u)("div",{class:ot.layerInfo},(0,ft.u)("div",{class:ot.rampLabelsContainer,styles:y},d)))}},{key:"_renderLegendForElementInfo",value:function(e,t,n,r){var i,a=t.layer;if(e.type)return this._renderLegendForElement(e,t,r,!1,!0);var l=zt(a,n),s=null!==(i=Vt(this.messages,e.label,!1))&&void 0!==i?i:"";if(e.preview){var o,u,c,d,f,y,v;if(null===(o=e.symbol)||void 0===o||!o.type.includes("simple-fill")){if(!e.label)return(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,key:r});var h=(0,g.Z)({},ot.symbolCell,this._hasIndicators);return(0,ft.u)("div",{class:this.classes(ot.layerRow,(0,g.Z)({},ot.symbolRow,this._hasIndicators)),key:r},(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:this.classes(h)}),(0,ft.u)("div",{class:this.classes(ot.imageLabel,(0,g.Z)({},ot.labelCell,this._hasIndicators))},s))}var p=255,m=255,b=255,_=0,L=255,w=255,S=255,k=0,x=null===(u=e.symbol.color)||void 0===u?void 0:u.a,C=null===(c=e.symbol.outline)||void 0===c||null===(d=c.color)||void 0===d?void 0:d.a;x&&(p=e.symbol.color.r,m=e.symbol.color.g,b=e.symbol.color.b,_=e.symbol.color.a*a.opacity),C&&(L=e.symbol.outline.color.r,w=e.symbol.outline.color.g,S=e.symbol.outline.color.b,k=e.symbol.outline.color.a*a.opacity);var I=null===(f=null===(y=e.symbol.color)||void 0===y?void 0:y.isBright)||void 0===f||f,E=I?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",R={background:x?"rgba(".concat(p,", ").concat(m,", ").concat(b,", ").concat(_,")"):"none",color:I?"black":"white",textShadow:"-1px -1px 0 ".concat(E,",\n                                              1px -1px 0 ").concat(E,",\n                                              -1px 1px 0 ").concat(E,",\n                                              1px 1px 0 ").concat(E),border:C?"1px solid rgba(".concat(L,", ").concat(w,", ").concat(S,", ").concat(k,")"):"none",filter:null!==(v=(0,Q.wJ)(t.effectList))&&void 0!==v?v:void 0};return(0,ft.u)("div",{class:ot.layerRow,key:r},(0,ft.u)("div",{class:ot.labelElement,styles:R},s))}if(e.src){var Z=this._renderImage(e,a,l);return(0,ft.u)("div",{class:ot.layerRow,key:r},Z,(0,ft.u)("div",{class:ot.imageLabel},s))}}},{key:"_renderImage",value:function(e,t,n){var r,i=e.label,a=e.src,l=e.opacity,s=(r={},(0,g.Z)(r,ot.imageryLayerStretchedImage,n),(0,g.Z)(r,ot.symbol,!n),r),o={opacity:"".concat(null!=l?l:t.opacity)};return(0,ft.u)("img",{alt:Vt(this.messages,i,!1),"aria-label":Vt(this.messages,i,!1),border:0,class:this.classes(s),height:e.height,src:a,styles:o,width:e.width})}},{key:"_renderSizeRampLines",value:function(e){var t=e.infos,n=t[0],r=t[t.length-1],i=n.symbol,a=this._hasIndicators,l=(0,V.F2)(n.size+n.outlineSize)*Nt,s=(0,V.F2)(r.size+r.outlineSize)*Nt,o=a?l:l+50*Nt,u=a?l/2+50*Nt:l,c=function(e){if(e){if(e.type.includes("3d")){var t,n=null===(t=e.symbolLayers)||void 0===t?void 0:t.length;if(!n)return;var r=e.symbolLayers.at(n-1).get("resource.primitive");return"triangle"===r||"cone"===r||"tetrahedron"===r}return"triangle"===e.style}}(i),d=function(e){if(e){if(e.type.includes("3d")){var t,n,r=null===(t=e.symbolLayers)||void 0===t?void 0:t.length;if(!r)return;var i=null===(n=e.symbolLayers.at(r-1).resource)||void 0===n?void 0:n.primitive;return"circle"===i||"cross"===i||"kite"===i||"sphere"===i||"cube"===i||"diamond"===i}var a=e.style;return"circle"===a||"diamond"===a||"cross"===a}}(i),f=document.createElement("canvas");f.width=o,f.height=u,f.style.width=f.width/Nt+"px",f.style.height=f.height/Nt+"px";var y=f.getContext("2d");if(a){y.beginPath();var v=o/2-s/2,h=u;y.moveTo(0,0),y.lineTo(v,h);var p=o,m=o/2+s/2,b=u;y.moveTo(p,0),y.lineTo(m,b)}else{y.beginPath();var g=u/2-s/2,_=o;y.moveTo(0,g),y.lineTo(_,0);var L=u/2+s/2,w=o,S=u;y.moveTo(0,L),y.lineTo(w,S)}return y.strokeStyle="#ddd",y.stroke(),(0,ft.u)("div",{afterCreate:Zt,bind:f,styles:a?{display:"flex",marginTop:"-".concat(c?0:d?l/2:0,"px"),marginBottom:"-".concat(c?s:d?s/2:0,"px")}:{display:"flex",marginRight:"-".concat(c?0:d?l/2:0,"px"),marginLeft:"-".concat(c?0:d?s/2:0,"px")}})}},{key:"_renderSizeRamp",value:function(e,t){var n=e.infos,r=n[0].label,i=n[n.length-1].label,a=n[0].preview,l=n[n.length-1].preview,s=this._hasIndicators,o={"flex-direction":s?"column":"row-reverse"};a&&((a=a.cloneNode(!0)).style.display="flex"),l&&((l=l.cloneNode(!0)).style.display="flex");var u={opacity:null!=t?"".concat(t):""};return(0,ft.u)("div",{class:this.classes(ot.layerRow,(0,g.Z)({},ot.sizeRampRow,s))},(0,ft.u)("div",{class:ot.rampLabel},s?r:i),(0,ft.u)("div",{class:ot.sizeRampContainer,styles:o},(0,ft.u)("div",{afterCreate:Zt,bind:a,class:ot.sizeRampPreview,styles:u}),this._renderSizeRampLines(e),(0,ft.u)("div",{afterCreate:Zt,bind:l,class:ot.sizeRampContainer,styles:u})),(0,ft.u)("div",{class:ot.rampLabel},s?i:r))}},{key:"_getRampStopLabel",value:function(e,t){switch(t){case"heatmap-ramp":return this.messages[e.label];case"stretch-ramp":return At(e,this.messages);default:return e.label}}},{key:"_renderLegendForRamp",value:function(e,t,n){var r,i=e.infos,a=e.type,l="heatmap-ramp"===a,s=i.length-1,o=25,u=s>2&&!l?25*s:100,c=u+20,d=10,f=i.slice(0).reverse(),y=f.length-1,v=f.length%2!=0?f[f.length/2|0]:null,h=v&&(0,ft.u)("div",{class:ot.intervalSeparatorsContainer},(0,ft.u)("div",{class:ot.intervalSeparator},"|"),(0,ft.u)("div",{class:ot.rampLabel},this._getRampStopLabel(v,a))),p=[[{shape:{type:"path",path:"M0 ".concat(o/2," L").concat(d," 0 L").concat(d," ").concat(o," Z")},fill:f[0].color,stroke:{width:0}},{shape:{type:"rect",x:d,y:0,width:u,height:o},fill:{type:"linear",x1:d,y1:0,x2:u+d,y2:0,colors:f.map((function(e,t){return{color:e.color,offset:l&&"ratio"in e?e.ratio:t/s}}))},stroke:{width:0}},{shape:{type:"path",path:"M".concat(u+d," 0 L").concat(c," ").concat(o/2," L").concat(u+d," ").concat(o," Z")},fill:f[y].color,stroke:{width:0}}]],m=(0,at.KB)(p,c,o),b={filter:null!==(r=(0,Q.wJ)(n))&&void 0!==r?r:void 0,opacity:null==t?void 0:"".concat(t)};return(0,ft.u)("div",{class:ot.layerRow,styles:{justifyContent:"center"}},(0,ft.u)("div",{class:ot.rampLabel},this._getRampStopLabel(f[0],a)),(0,ft.u)("div",{class:ot.symbolContainer},(0,ft.u)("div",{styles:b},m),h),(0,ft.u)("div",{class:ot.rampLabel},this._getRampStopLabel(f[y],a)))}}]),n}(y.Z);(0,o._)([(0,c.Cb)()],Ot.prototype,"activeLayerInfos",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"headingLevel",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"layout",void 0),(0,o._)([(0,c.Cb)(),(0,Dt.H)("esri/widgets/Legend/t9n/Legend")],Ot.prototype,"messages",void 0),(0,o._)([(0,c.Cb)(),(0,Dt.H)("esri/t9n/common")],Ot.prototype,"messagesCommon",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],Ot.prototype,"type",void 0),(0,o._)([(0,c.Cb)()],Ot.prototype,"view",void 0),(0,o._)([(0,Mt.h)()],Ot.prototype,"_selectSection",null);var Pt=Ot=(0,o._)([(0,f.j)("esri.widgets.Legend.styles.Card")],Ot),Bt="esri-legend",Ht={service:"".concat(Bt,"__service"),label:"".concat(Bt,"__service-label"),layer:"".concat(Bt,"__layer"),groupLayer:"".concat(Bt,"__group-layer"),groupLayerChild:"".concat(Bt,"__group-layer-child"),layerTable:"".concat(Bt,"__layer-table"),layerTableSizeRamp:"".concat(Bt,"__layer-table--size-ramp"),layerChildTable:"".concat(Bt,"__layer-child-table"),layerCaption:"".concat(Bt,"__layer-caption"),layerBody:"".concat(Bt,"__layer-body"),layerRow:"".concat(Bt,"__layer-row"),layerCell:"".concat(Bt,"__layer-cell"),layerInfo:"".concat(Bt,"__layer-cell ").concat(Bt,"__layer-cell--info"),imageryLayerStretchedImage:"".concat(Bt,"__imagery-layer-image--stretched"),imageryLayerCellStretched:"".concat(Bt,"__imagery-layer-cell--stretched"),imageryLayerInfoStretched:"".concat(Bt,"__imagery-layer-info--stretched"),symbolContainer:"".concat(Bt,"__layer-cell ").concat(Bt,"__layer-cell--symbols"),symbol:"".concat(Bt,"__symbol"),rampContainer:"".concat(Bt,"__ramps"),sizeRamp:"".concat(Bt,"__size-ramp"),colorRamp:"".concat(Bt,"__color-ramp"),opacityRamp:"".concat(Bt,"__opacity-ramp"),borderlessRamp:"".concat(Bt,"__borderless-ramp"),rampTick:"".concat(Bt,"__ramp-tick"),rampFirstTick:"".concat(Bt,"__ramp-tick-first"),rampLastTick:"".concat(Bt,"__ramp-tick-last"),rampLabelsContainer:"".concat(Bt,"__ramp-labels"),rampLabel:"".concat(Bt,"__ramp-label"),message:"".concat(Bt,"__message"),univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"},Ut=n(7021),qt="".concat(Bt,"__"),jt={display:"flex",alignItems:"flex-start"},Wt={marginLeft:"3px"},Gt={display:"table-cell",verticalAlign:"middle"},Jt=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r)).activeLayerInfos=null,a.headingLevel=3,a.messages=null,a.type="classic",a}return(0,a.Z)(n,[{key:"render",value:function(){var e=this,t=this.activeLayerInfos,n=null===t||void 0===t?void 0:t.toArray().map((function(t){return e._renderLegendForLayer(t)})).filter((function(e){return!!e}));return(0,ft.u)("div",null,null!==n&&void 0!==n&&n.length?n:(0,ft.u)("div",{class:Ht.message},this.messages.noLegend))}},{key:"_renderLegendForLayer",value:function(e){var t=this;if(!e.ready)return null;var n=!!e.children.length,r="".concat(qt).concat(e.layer.uid,"-version-").concat(e.version),i=e.title?(0,Tt.X)({level:this.headingLevel,class:this.classes(Ut.z.heading,Ht.label)},e.title):null;if(n){var a=e.children.map((function(e){return t._renderLegendForLayer(e)})).toArray();return(0,ft.u)("div",{class:this.classes(Ht.service,Ht.groupLayer),key:r},i,a)}var l=e.legendElements;if(l&&!l.length)return null;var s=l.map((function(n){return t._renderLegendForElement(n,e.layer,e.effectList)})).filter((function(e){return!!e}));if(!s.length)return null;var o=(0,g.Z)({},Ht.groupLayerChild,!!e.parent);return(0,ft.u)("div",{class:this.classes(Ht.service,o),key:r},i,(0,ft.u)("div",{class:Ht.layer},s))}},{key:"_renderLegendForElement",value:function(e,t,n,r){var i=this,a="color-ramp"===e.type,l="opacity-ramp"===e.type,s="size-ramp"===e.type,o=null;if("symbol-table"===e.type||s){var u=e.infos.map((function(r){return i._renderLegendForElementInfo(r,t,n,s,e.legendType)})).filter((function(e){return!!e}));u.length&&(o=(0,ft.u)("div",{class:Ht.layerBody},u))}else"color-ramp"===e.type||"opacity-ramp"===e.type||"heatmap-ramp"===e.type||"stretch-ramp"===e.type?o=this._renderLegendForRamp(e,t.opacity):"relationship-ramp"===e.type?o=(0,ut.g)(e,this.id,{opacity:t.opacity,effectList:n,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===e.type?o=this._renderPieChartRamp(e):"univariate-above-and-below-ramp"===e.type?o=this._renderUnivariateAboveAndBelowRamp(e,t.opacity,n):"univariate-color-size-ramp"===e.type&&(o=this._renderUnivariateColorSizeRamp(e,t.opacity,n));if(!o)return null;var c=e.title,d=null;if("string"==typeof c)d=c;else if(c){var f=Vt(this.messages,c,a||l);d=Ft(0,a||l)&&c.title?"".concat(c.title," (").concat(f,")"):f}var y=r?Ht.layerChildTable:Ht.layerTable,v=d?(0,ft.u)("div",{class:Ht.layerCaption},d):null,h=(0,g.Z)({},Ht.layerTableSizeRamp,s||!r);return(0,ft.u)("div",{class:this.classes(y,h)},v,o)}},{key:"_renderPieChartRamp",value:function(e){return(0,ft.u)("div",{afterCreate:Zt,bind:e.preview})}},{key:"_renderUnivariateAboveAndBelowRamp",value:function(e,t,n){var r,i=this,a=Ct(e,t),l=a.sizeRampElement,s=a.colorRampElement;if(!l)return null;var o=null===(r=this.messages)||void 0===r?void 0:r.previewColorRampAriaLabel,u=xt(l,"above",!0),c=xt(l,"below",!0),d=St(s,{width:12,height:u,rampAlignment:"vertical",opacity:t,type:"above",effectList:n,ariaLabel:o}),f=St(s,{width:12,height:c,rampAlignment:"vertical",opacity:t,type:"below",effectList:n,ariaLabel:o}),y=wt(l),v=l.infos.map((function(e){return e.label})),h=v.map((function(e,t){var n=2===t;return 0===t?(0,ft.u)("div",{class:e?d?Ht.univariateAboveAndBelowLabel:Ht.rampLabel:void 0,key:t},e):n?(0,ft.u)("div",null):null})),p=v.length-1,m=Math.floor(v.length/2),b=v.map((function(e,t){return t===m||t===p?(0,ft.u)("div",{class:e?d?Ht.univariateAboveAndBelowLabel:Ht.rampLabel:void 0,key:t},e):null})),g={display:"table-cell",verticalAlign:"middle"},_={marginTop:"".concat(y,"px")},L={height:"".concat(u,"px")},w={height:"".concat(c,"px")};return(0,ft.u)("div",{key:"univariate-above-and-below-ramp-preview",styles:jt},(0,ft.u)("div",{class:Ht.layerBody},l.infos.map((function(e,t){return(0,ft.u)("div",{class:i.classes(Ht.layerRow,Ht.sizeRamp)},(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:Ht.symbol,styles:g}),d||t%2!=0?null:(0,ft.u)("div",{class:Ht.layerInfo},v[t]))}))),d?(0,ft.u)("div",{key:"color-ramp-preview",styles:_},(0,ft.u)("div",{styles:Wt},(0,ft.u)("div",{styles:Gt},(0,ft.u)("div",{afterCreate:Zt,bind:d,class:Ht.rampContainer})),(0,ft.u)("div",{styles:Gt},(0,ft.u)("div",{class:Ht.rampLabelsContainer,styles:L},h))),(0,ft.u)("div",{styles:Wt},(0,ft.u)("div",{styles:Gt},(0,ft.u)("div",{afterCreate:Zt,bind:f,class:Ht.rampContainer})),(0,ft.u)("div",{styles:Gt},(0,ft.u)("div",{class:Ht.rampLabelsContainer,styles:w},b)))):null)}},{key:"_renderUnivariateColorSizeRamp",value:function(e,t,n){var r,i=this,a=It(e),l=a.sizeRampElement,s=a.colorRampElement;if(!l)return null;var o=wt(l),u=xt(l,"full",!1),c=St(s,{width:12,height:u,rampAlignment:"vertical",opacity:t,type:"full",effectList:n,ariaLabel:null===(r=this.messages)||void 0===r?void 0:r.previewColorRampAriaLabel}),d=l.infos.length-1,f=l.infos.map((function(e,t){return 0===t||t===d?(0,ft.u)("div",{class:e.label?s?Ht.univariateAboveAndBelowLabel:Ht.rampLabel:void 0,key:t},e.label):null})),y={display:"table-cell",verticalAlign:"middle"},v={marginTop:"".concat(o,"px")},h={height:"".concat(u,"px")};return(0,ft.u)("div",{key:"univariate-above-and-below-ramp-preview",styles:jt},(0,ft.u)("div",{class:Ht.layerBody},l.infos.map((function(e){return(0,ft.u)("div",{class:i.classes(Ht.layerRow,Ht.sizeRamp)},(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:Ht.symbol,styles:y}))}))),(0,ft.u)("div",{key:"color-ramp-preview",styles:v},(0,ft.u)("div",{styles:Wt},(0,ft.u)("div",{styles:Gt},(0,ft.u)("div",{afterCreate:Zt,bind:c,class:Ht.rampContainer})),(0,ft.u)("div",{styles:Gt},(0,ft.u)("div",{class:Ht.rampLabelsContainer,styles:h},f)))))}},{key:"_renderLegendForRamp",value:function(e,t){var n=this,r=e.infos,i="opacity-ramp"===e.type,a="heatmap-ramp"===e.type,l="stretch-ramp"===e.type,s=e.preview,o=i?Ht.opacityRamp:"";s.className="".concat(Ht.colorRamp," ").concat(o),null!=t&&(s.style.opacity=t.toString());var u=r.map((function(e){return(0,ft.u)("div",{class:e.label?Ht.rampLabel:void 0},a?n.messages[e.label]||e.label:l?At(e,n.messages):e.label)})),c={width:"".concat(24,"px")},d={height:s.style.height};return(0,ft.u)("div",{class:Ht.layerRow},(0,ft.u)("div",{class:Ht.symbolContainer,styles:c},(0,ft.u)("div",{afterCreate:Zt,bind:s,class:Ht.rampContainer})),(0,ft.u)("div",{class:Ht.layerInfo},(0,ft.u)("div",{class:Ht.rampLabelsContainer,styles:d},u)))}},{key:"_renderLegendForElementInfo",value:function(e,t,n,r,i){var a;if(e.type)return this._renderLegendForElement(e,t,n,!0);var l=null,s=zt(t,i);if(e.preview?l=(0,ft.u)("div",{afterCreate:Zt,bind:e.preview,class:Ht.symbol}):e.src&&(l=this._renderImage(e,t,s)),!l)return null;var o=(0,g.Z)({},Ht.imageryLayerInfoStretched,s),u=(a={},(0,g.Z)(a,Ht.imageryLayerInfoStretched,s),(0,g.Z)(a,Ht.sizeRamp,!s&&r),a);return(0,ft.u)("div",{class:Ht.layerRow},(0,ft.u)("div",{class:this.classes(Ht.symbolContainer,u)},l),(0,ft.u)("div",{class:this.classes(Ht.layerInfo,o)},Vt(this.messages,e.label,!1)||""))}},{key:"_renderImage",value:function(e,t,n){var r,i=e.label,a=e.src,l=e.opacity,s=(r={},(0,g.Z)(r,Ht.imageryLayerStretchedImage,n),(0,g.Z)(r,Ht.symbol,!n),r),o={opacity:"".concat(null!=l?l:t.opacity)};return(0,ft.u)("img",{alt:Vt(this.messages,i,!1),"aria-label":Vt(this.messages,i,!1),border:0,class:this.classes(s),height:e.height,src:a,styles:o,width:e.width})}}]),n}(y.Z);(0,o._)([(0,c.Cb)()],Jt.prototype,"activeLayerInfos",void 0),(0,o._)([(0,c.Cb)()],Jt.prototype,"headingLevel",void 0),(0,o._)([(0,c.Cb)(),(0,Dt.H)("esri/widgets/Legend/t9n/Legend")],Jt.prototype,"messages",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],Jt.prototype,"type",void 0);var Qt=Jt=(0,o._)([(0,f.j)("esri.widgets.Legend.styles.Classic")],Jt),Xt="esri-legend",Kt=function(e){(0,l.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var a;return(0,i.Z)(this,n),(a=t.call(this,e,r)).headingLevel=3,a.messages=null,a.style=new Qt,a.viewModel=new it,a}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,u.on)((function(){return e.view}),"resize",(function(){return e.scheduleRender()})),(0,u.on)((function(){return e.activeLayerInfos}),"change",(function(){return e._refreshActiveLayerInfos(e.activeLayerInfos)})),(0,u.watch)((function(){return e.headingLevel}),(function(t){var n=e.style;n&&(n.headingLevel=t)})),(0,u.watch)((function(){return e.style}),(function(t,n){n&&t!==n&&n.destroy(),t&&(t.activeLayerInfos=e.activeLayerInfos,"card"===t.type&&(t.view=e.view),t.headingLevel=e.headingLevel)}),u.initial)])}},{key:"activeLayerInfos",get:function(){return this.viewModel.activeLayerInfos},set:function(e){this.viewModel.activeLayerInfos=e}},{key:"basemapLegendVisible",get:function(){return this.viewModel.basemapLegendVisible},set:function(e){this.viewModel.basemapLegendVisible=e}},{key:"groundLegendVisible",get:function(){return this.viewModel.groundLegendVisible},set:function(e){this.viewModel.groundLegendVisible=e}},{key:"hideLayersNotInCurrentView",get:function(){return this.viewModel.hideLayersNotInCurrentView},set:function(e){this.viewModel.hideLayersNotInCurrentView=e}},{key:"keepCacheOnDestroy",get:function(){return this.viewModel.keepCacheOnDestroy},set:function(e){this.viewModel.keepCacheOnDestroy=e}},{key:"respectLayerDefinitionExpression",get:function(){return this.viewModel.respectLayerDefinitionExpression},set:function(e){this.viewModel.respectLayerDefinitionExpression=e}},{key:"respectLayerVisibility",get:function(){return this.viewModel.respectLayerVisibility},set:function(e){this.viewModel.respectLayerVisibility=e}},{key:"icon",get:function(){return"legend"},set:function(e){this._overrideIfSome("icon",e)}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(e){this.viewModel.layerInfos=e}},{key:"castStyle",value:function(e){if(e instanceof Pt||e instanceof Qt)return e;if("string"==typeof e)return"card"===e?new Pt:new Qt;if(e&&"string"==typeof e.type){var t=(0,r.Z)({},e);return delete t.type,new("card"===e.type?Pt:Qt)(t)}return new Qt}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"render",value:function(){return(0,ft.u)("div",{class:this.classes(Xt,Ut.z.widget,this.style instanceof Qt?Ut.z.panel:null)},this.style.render())}},{key:"_refreshActiveLayerInfos",value:function(e){var t=this;e.forEach((function(e){t.removeHandles("version_".concat(e.layer.uid)),t._renderOnActiveLayerInfoChange(e)})),this.scheduleRender()}},{key:"_renderOnActiveLayerInfoChange",value:function(e){var t=this,n=(0,u.watch)((function(){return e.version}),(function(){return t.scheduleRender()}));this.addHandles(n,"version_".concat(e.layer.uid));var r=(0,u.on)((function(){return e.children}),"change",(function(){return e.children.forEach((function(e){return t._renderOnActiveLayerInfoChange(e)}))}),u.initial);this.addHandles(r,"version_".concat(e.layer.uid)),e.children.forEach((function(e){return t._renderOnActiveLayerInfoChange(e)}))}}]),n}(y.Z);(0,o._)([(0,c.Cb)()],Kt.prototype,"activeLayerInfos",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"basemapLegendVisible",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"groundLegendVisible",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"headingLevel",void 0),(0,o._)([(0,c.Cb)()],Kt.prototype,"hideLayersNotInCurrentView",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"keepCacheOnDestroy",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"respectLayerDefinitionExpression",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"respectLayerVisibility",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"icon",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"label",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"layerInfos",null),(0,o._)([(0,c.Cb)(),(0,Dt.H)("esri/widgets/Legend/t9n/Legend")],Kt.prototype,"messages",void 0),(0,o._)([(0,c.Cb)()],Kt.prototype,"style",void 0),(0,o._)([(0,d.p)("style")],Kt.prototype,"castStyle",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"view",null),(0,o._)([(0,c.Cb)()],Kt.prototype,"viewModel",void 0);var Yt=Kt=(0,o._)([(0,f.j)("esri.widgets.Legend")],Kt)}}]);
//# sourceMappingURL=48671.1b8749c7.chunk.js.map