"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[24931],{22052:function(e,t,r){r.d(t,{l:function(){return n}});var n={upload:{createFromFiles:.8,loadMesh:.2},uploadAssetBlobs:{prepareAssetItems:.9,uploadAssetItems:.1},uploadConvertibleSource:{uploadEditSource:.5,serviceAssetsToGlb:.5},uploadLocalMesh:{meshToAssetBlob:.5,uploadAssetBlobs:.5}}},46939:function(e,t,r){r.d(t,{QH:function(){return d},T$:function(){return h},Xm:function(){return f},iE:function(){return v}});var n=r(29439),o=r(37762),i=r(15671),s=r(43144),a=r(42537),u=r(93169),l=r(77427),c=r(38499);function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},r=arguments.length>2?arguments[2]:void 0;return new p(e,t,r)}var p=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},n=arguments.length>2?arguments[2]:void 0;if((0,i.Z)(this,e),this.onProgress=r,this.taskName=n,this._progressMap=new Map,this._startTime=void 0,this._timingsMap=new Map,"number"==typeof t){this._weights={};for(var o=0;o<t;o++){var s=o,a=1/t;this._weights[s]=a,this._progressMap.set(s,0)}}else this._weights=t;this.emitProgress()}return(0,s.Z)(e,[{key:"emitProgress",value:function(){var e,t=0,r=(0,o.Z)(this._progressMap.entries());try{for(r.s();!(e=r.n()).done;){var i=(0,n.Z)(e.value,2),s=i[0];t+=i[1]*this._weights[s]}}catch(_){r.e(_)}finally{r.f()}if(1===t&&(0,u.Z)("enable-feature:esri-3dofl-upload-timings")){var a,l=Math.round(performance.now()-(null!==(a=this._startTime)&&void 0!==a?a:0))/1e3;console.log("".concat(this.taskName," done in ").concat(l," sec"));var c,f=(0,o.Z)(this._timingsMap);try{for(f.s();!(c=f.n()).done;){var p,d=(0,n.Z)(c.value,2),h=d[0],v=d[1],g=Math.round(v.end-v.start)/1e3,m=Math.round(g/l*100);console.log(null!==(p=this.taskName)&&void 0!==p?p:"Task",{stepKey:h,stepTime:g,relativeTime:m})}}catch(_){f.e(_)}finally{f.f()}}this.onProgress(t)}},{key:"setProgress",value:function(e,t){if(this._progressMap.set(e,t),(0,u.Z)("enable-feature:esri-3dofl-upload-timings")){var r,n=performance.now();null!==(r=this._startTime)&&void 0!==r||(this._startTime=n);var o=(0,l.s1)(this._timingsMap,e,(function(){return{start:n,end:0}}));1===t&&(o.end=n)}this.emitProgress()}},{key:"simulate",value:function(e,t){var r=this;return d((function(t){return r.setProgress(e,t)}),t)}},{key:"makeOnProgress",value:function(e){var t=this;return function(r){return t.setProgress(e,r)}}}]),e}();function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k,r=performance.now();e(0);var n=setInterval((function(){var n=performance.now()-r,o=1-Math.exp(-n/t);e(o)}),y);return(0,a.kB)((function(){clearInterval(n),e(1)}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;return(0,c.up)((0,c._H)(e*_/t))}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;return(0,c.up)((0,c._H)(e*_/t))}var g=10,m=10,_=8e-6,y=(0,c.HA)(50),k=(0,c.HA)(1e3)},85079:function(e,t,r){r.r(t),r.d(t,{Upload:function(){return T},clearPromptForFilesStub:function(){return x},stubFilePickerToSelect:function(){return P}});var n=r(93433),o=r(74165),i=r(15861),s=r(15671),a=r(43144),u=r(60136),l=r(29388),c=r(27366),f=r(7138),p=r(14921),d=r(10064),h=r(98928),v=r(66978),g=r(49861),m=(r(93169),r(32718),r(84936),r(69912)),_=r(848),y=r(22052),k=r(18277),b=r(46939),T=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,s.Z)(this,r),(e=t.call(this,{})).files=[],e.progress=0,e._uploadTask=null,e._layer=null,e}return(0,a.Z)(r,[{key:"destroy",value:function(){this.cancel(),this.files=[],this._layer=null,this._uploadTask=null}},{key:"state",get:function(){var e=this._uploadTask;return e&&0!==this.files.length?e.finished?e.error?"error":"success":"pending":"default"}},{key:"result",get:function(){var e,t;return null!==(e=null===(t=this._uploadTask)||void 0===t?void 0:t.value)&&void 0!==e?e:null}},{key:"error",get:function(){var e,t;return null!==(e=null===(t=this._uploadTask)||void 0===t?void 0:t.error)&&void 0!==e?e:null}},{key:"uploadTo",value:function(e){var t=this;this.cancel(),this.files=[],this._layer=e,this._uploadTask=(0,p.vr)(function(){var r=(0,i.Z)((0,o.Z)().mark((function r(n){var i,s,a,u,l,c,f;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Z(e);case 2:if(i=r.sent,(0,v.k_)(n),t.progress=0,t.files=i,s=(0,b.Xm)(y.l.upload,(function(e){t.progress=e}),"Upload.uploadTo"),0!==i.length){r.next=7;break}return r.abrupt("return",null);case 7:return(0,v.k_)(n),r.next=10,e.extractAndFilterFiles(i);case 10:return a=r.sent,(0,v.k_)(n),a.length>0&&(t.files=a),u=new _.Z({x:0,y:0,z:0,spatialReference:e.spatialReference}),r.next=15,e.convertMesh(a,{location:u,signal:n,onProgress:s.makeOnProgress("createFromFiles")});case 15:if(l=r.sent,(0,v.k_)(n),l){r.next=18;break}throw new d.Z("editor:upload","could not upload or convert model");case 18:return c=a.reduce((function(e,t){return e+t.size}),0),f=s.simulate("loadMesh",(0,b.T$)(c)),r.prev=19,r.next=22,l.load();case 22:return r.prev=22,f.remove(),r.finish(22);case 25:return r.abrupt("return",l);case 26:case"end":return r.stop()}}),r,null,[[19,,22,25]])})));return function(e){return r.apply(this,arguments)}}())}},{key:"retry",value:function(){this._layer&&this.uploadTo(this._layer)}},{key:"cancel",value:function(){var e;null===(e=this._uploadTask)||void 0===e||e.abort()}}]),r}(f.default);(0,c._)([(0,g.Cb)()],T.prototype,"files",void 0),(0,c._)([(0,g.Cb)()],T.prototype,"progress",void 0),(0,c._)([(0,g.Cb)()],T.prototype,"state",null),(0,c._)([(0,g.Cb)()],T.prototype,"result",null),(0,c._)([(0,g.Cb)()],T.prototype,"error",null),(0,c._)([(0,g.Cb)()],T.prototype,"_uploadTask",void 0),(0,c._)([(0,g.Cb)()],T.prototype,"_layer",void 0),T=(0,c._)([(0,m.j)("esri.widgets.Editor.Upload")],T);var w=null;function Z(e){return M.apply(this,arguments)}function M(){return(M=(0,i.Z)((0,o.Z)().mark((function e(t){var r,i,s,a,u;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,v.hh)(),i=r.resolve,s=r.promise,(a=document.createElement("input")).type="file",a.multiple=!1,a.accept=[].concat((0,n.Z)((0,k.ir)(t.infoFor3D)),[".zip"]).join(","),a.style.display="none",document.body.appendChild(a),u=(0,h.on)(a,"change",(function(){return i(a.files?Array.from(a.files):[])})),e.abrupt("return",(w?w(a):a.click(),s.finally((function(){u.remove(),a.remove()}))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){w=function(t){Promise.resolve().then((function(){return e})).then((function(e){if(w){var r=new DataTransfer;e.forEach((function(e){return r.items.add(e)})),t.files=r.files,t.dispatchEvent(new Event("change"))}}))}}function x(){w=null}}}]);
//# sourceMappingURL=24931.f0bdf508.chunk.js.map