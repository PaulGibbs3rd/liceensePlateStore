"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[16313],{97942:function(e,n,t){function r(e){var n,t,r=[],a=!1;return function(){for(var u=arguments.length,s=new Array(u),o=0;o<u;o++)s[o]=arguments[o];return a&&n===this&&i(s,r)||(t=e.apply(this,s),n=this,r=s,a=!0),t}}function i(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;++t)if(e[t]!==n[t])return!1;return!0}t.d(n,{H:function(){return r}})},47991:function(e,n,t){t.d(n,{SR:function(){return v},Ui:function(){return h}});var r=t(43144),i=t(15671),a=t(37762),u=t(29439),s=t(46784),o=t(65156),l=t(376),c=t(69662),f=t(77981),d=t(76335),p=t(92975);function h(e){return y(e,!0)}function v(e){return y(e,!1)}function y(e,n){if(null==e)return null;var t=e.spatialReference,r=(0,p.C5)(t),i=(0,s.AK)(e)?e.toJSON():e;if(!r)return i;var a=(0,p.sS)(t)?102100:4326,u=d.UZ[a].maxX,o=d.UZ[a].minX;if((0,f.wp)(i))return _(i,u,o);if((0,f.aW)(i))return i.points=i.points.map((function(e){return _(e,u,o)})),i;if((0,f.YX)(i))return m(i,r);if((0,f.oU)(i)||(0,f.l9)(i)){var c=(0,l.$P)(Z,i),h={xmin:c[0],ymin:c[1],xmax:c[2],ymax:c[3]},v=(0,d.XZ)(h.xmin,o)*(2*u),y=0===v?i:(0,d.Sy)(i,v);return h.xmin+=v,h.xmax+=v,h.xmax>u?S(y,u,n):h.xmin<o?S(y,o,n):y}return i}function m(e,n){if(!n)return e;var t=function(e,n){var t=[],r=e.ymin,i=e.ymax,a=e.xmin,s=e.xmax,o=e.xmax-e.xmin,l=(0,u.Z)(n.valid,2),c=l[0],f=l[1],d=g(e.xmin,n),p=d.x,h=d.frameId,v=g(e.xmax,n),y=v.x,m=v.frameId,_=p===y&&o>0;if(o>2*f){var b={xmin:a<s?p:y,ymin:r,xmax:f,ymax:i},S={xmin:c,ymin:r,xmax:a<s?y:p,ymax:i},Z={xmin:0,ymin:r,xmax:f,ymax:i},w={xmin:c,ymin:r,xmax:0,ymax:i},I=[],L=[];x(b,Z)&&I.push(h),x(b,w)&&L.push(h),x(S,Z)&&I.push(m),x(S,w)&&L.push(m);for(var C=h+1;C<m;C++)I.push(C),L.push(C);t.push(new k(b,[h]),new k(S,[m]),new k(Z,I),new k(w,L))}else p>y||_?t.push(new k({xmin:p,ymin:r,xmax:f,ymax:i},[h]),new k({xmin:c,ymin:r,xmax:y,ymax:i},[m])):t.push(new k({xmin:p,ymin:r,xmax:y,ymax:i},[h]));return t}(e,n).map((function(e){return e.extent}));return t.length<2?t[0]||e:t.length>2?(e.xmin=n.valid[0],e.xmax=n.valid[1],e):{rings:t.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}function _(e,n,t){if(Array.isArray(e)){var r=e[0];if(r>n){var i=(0,d.XZ)(r,n);e[0]=r+i*(-2*n)}else if(r<t){var a=(0,d.XZ)(r,t);e[0]=r+a*(-2*t)}}else{var u=e.x;if(u>n){var s=(0,d.XZ)(u,n);e.x+=s*(-2*n)}else if(u<t){var o=(0,d.XZ)(u,t);e.x+=o*(-2*t)}}return e}function g(e,n){var t,r=(0,u.Z)(n.valid,2),i=r[0],a=r[1],s=2*a,o=0;return e>a?(e-=(t=Math.ceil(Math.abs(e-a)/s))*s,o=t):e<i&&(e+=(t=Math.ceil(Math.abs(e-i)/s))*s,o=-t),{x:e,frameId:o}}function x(e,n){var t=n.xmin,r=n.ymin,i=n.xmax,a=n.ymax;return b(e,t,r)&&b(e,t,a)&&b(e,i,a)&&b(e,i,r)}function b(e,n,t){return n>=e.xmin&&n<=e.xmax&&t>=e.ymin&&t<=e.ymax}function S(e,n){var t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(0,f.l9)(e);if(r&&(0,c.Zy)(e),t)return(new w).cut(e,n);for(var i=r?e.rings:e.paths,u=r?4:2,s=i.length,o=-2*n,l=0;l<s;l++){var d=i[l];if(d&&d.length>=u){var p,h=[],v=(0,a.Z)(d);try{for(v.s();!(p=v.n()).done;){var y=p.value;h.push([y[0]+o,y[1]])}}catch(m){v.e(m)}finally{v.f()}i.push(h)}}return r?e.rings=i:e.paths=i,e}var k=(0,r.Z)((function e(n,t){(0,i.Z)(this,e),this.extent=n,this.frameIds=t})),Z=(0,o.Ue)(),w=function(){function e(){(0,i.Z)(this,e),this._linesIn=[],this._linesOut=[]}return(0,r.Z)(e,[{key:"cut",value:function(e,n){var t;if(this._xCut=n,e.rings)this._closed=!0,t=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,t=e.paths,this._minPts=2}var r,i=(0,a.Z)(t);try{for(i.s();!(r=i.n()).done;){var u=r.value;if(u&&!(u.length<this._minPts)){var s,o=!0,l=(0,a.Z)(u);try{for(l.s();!(s=l.n()).done;){var c=s.value;o?(this.moveTo(c),o=!1):this.lineTo(c)}}catch(x){l.e(x)}finally{l.f()}this._closed&&this.close()}}}catch(x){i.e(x)}finally{i.f()}this._pushLineIn(),this._pushLineOut(),t=[];var f,d=(0,a.Z)(this._linesIn);try{for(d.s();!(f=d.n()).done;){var p=f.value;p&&p.length>=this._minPts&&t.push(p)}}catch(x){d.e(x)}finally{d.f()}var h,v=-2*this._xCut,y=(0,a.Z)(this._linesOut);try{for(y.s();!(h=y.n()).done;){var m=h.value;if(m&&m.length>=this._minPts){var _,g=(0,a.Z)(m);try{for(g.s();!(_=g.n()).done;){_.value[0]+=v}}catch(x){g.e(x)}finally{g.f()}t.push(m)}}}catch(x){y.e(x)}finally{y.f()}return this._closed?e.rings=t:e.paths=t,e}},{key:"moveTo",value:function(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}},{key:"lineTo",value:function(e){var n=this._side(e[0]);if(n*this._prevSide==-1){var t=this._intersect(this._prevPt,e);this._lineTo(this._xCut,t,0),this._prevSide=0,this._lineTo(e[0],e[1],n)}else this._lineTo(e[0],e[1],n);this._prevSide=n,this._prevPt=e}},{key:"close",value:function(){var e=this._firstPt,n=this._prevPt;e[0]===n[0]&&e[1]===n[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}},{key:"_moveTo",value:function(e,n,t){this._closed?(this._lineIn.push([t<=0?e:this._xCut,n]),this._lineOut.push([t>=0?e:this._xCut,n])):(t<=0&&this._lineIn.push([e,n]),t>=0&&this._lineOut.push([e,n]))}},{key:"_lineTo",value:function(e,n,t){this._closed?(I(this._lineIn,t<=0?e:this._xCut,n),I(this._lineOut,t>=0?e:this._xCut,n)):t<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([e,n])):t>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([e,n])):this._prevSide<0?(this._lineIn.push([e,n]),this._lineOut.push([e,n])):this._prevSide>0&&(this._lineOut.push([e,n]),this._lineIn.push([e,n]))}},{key:"_checkClosingPt",value:function(e){var n=e.length;n>3&&e[0][0]===this._xCut&&e[n-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[n-2][1],e.pop())}},{key:"_side",value:function(e){return e<this._xCut?-1:e>this._xCut?1:0}},{key:"_intersect",value:function(e,n){var t=(this._xCut-e[0])/(n[0]-e[0]);return e[1]+t*(n[1]-e[1])}},{key:"_pushLineIn",value:function(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}},{key:"_pushLineOut",value:function(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}]),e}();function I(e,n,t){var r=e.length;r>1&&e[r-1][0]===n&&e[r-2][0]===n?e[r-1][1]=t:e.push([n,t])}},34311:function(e,n,t){function r(e,n,t){return{objectId:e,target:n,distance:t,type:"vertex"}}function i(e,n,t,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{objectId:e,target:n,distance:t,type:"edge",start:r,end:i,draped:a}}t.d(n,{p:function(){return i},u:function(){return r}})},35594:function(e,n,t){t.d(n,{F:function(){return i},o:function(){return a}});var r=t(77981);function i(e){return{geometryType:(0,r.Ji)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function a(e,n,t){var i=(0,r.q9)(n);return e.map((function(e){var n=i.fromJSON(e);return n.spatialReference=t,n}))}},23084:function(e,n,t){t.d(n,{LP:function(){return d},cv:function(){return f},en:function(){return c},lA:function(){return l}});var r=t(1413),i=t(42265),a=t(19545),u=t(84652),s=t(35995),o=t(66660);function l(e,n){return n?(0,r.Z)((0,r.Z)({},n),{},{query:(0,r.Z)((0,r.Z)({},null!==e&&void 0!==e?e:{}),n.query)}):{query:e}}function c(e){return"string"==typeof e?(0,s.mN)(e):(0,u.d9)(e)}function f(e,n,t){var r={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a))r[i]=a.map((function(e){return f(e)}));else if("object"==typeof a)if(a.toJSON){var u=a.toJSON(null===t||void 0===t?void 0:t[i]);r[i]=n?u:JSON.stringify(u)}else r[i]=n?a:JSON.stringify(a);else r[i]=a}return r}function d(e,n){var t;return e?(0,o.r)(e)&&(n||i.Z.apiKey)?n||i.Z.apiKey:null===a.id||void 0===a.id||null===(t=a.id.findCredential(e))||void 0===t?void 0:t.token:null}},23037:function(e,n,t){t.d(n,{Bf:function(){return y},Bj:function(){return S},Df:function(){return v},Py:function(){return b},Qs:function(){return j},Us:function(){return I},aL:function(){return w},iG:function(){return _},ql:function(){return x},se:function(){return m},vZ:function(){return g},zb:function(){return Z}});var r,i=t(29439),a=t(54557),u=t(42265),s=t(80987),o=t(32718),l=t(92026),c=t(35995),f=t(25243),d=t(32551),p=t(68954),h=function(){return o.Z.getLogger("esri.support.basemapUtils")};function v(){return{}}function y(e){for(var n in e){var t=e[n];(0,l.SC)(t),delete e[n]}}function m(e,n){var t,r;if("string"==typeof e){var s=e in p.s,o=!s&&e.includes("/");if(!s&&!o){var l=Object.entries(p.s).filter((function(e){var n=(0,i.Z)(e,2),t=(n[0],n[1]);return u.Z.apiKey&&!t.classic||!u.Z.apiKey&&(t.classic||t.is3d)})).map((function(e){var n=(0,i.Z)(e,1)[0];return'"'.concat(n,'"')})).sort().join(", ");return h().warn("Unable to find basemap definition for: ".concat(e,". Try one of these: ").concat(l)),null}n&&(r=n[e]),r||(r=s?a.default.fromId(e):new a.default({style:{id:e}}),n&&(n[e]=r))}else r=(0,f.se)(a.default,e);return null!==(t=r)&&void 0!==t&&t.destroyed&&(h().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function _(e){var n;return"Web Scene"===(null===(n=e.portalItem)||void 0===n?void 0:n.type)||e.referenceLayers.some((function(e){return"scene"===e.type}))}function g(e){var n,t;return!(null===e||void 0===e||null===(n=e.portalItem)||void 0===n||null===(t=n.tags)||void 0===t||!t.some((function(e){return"beta"===e.toLowerCase()})))}function x(e,n){var t,r,i,a;return(null===(t=e.basemap)||void 0===t||null===(r=t.referenceLayers)||void 0===r?void 0:r.some((function(e){return e.uid===n})))||(null===(i=e.basemap)||void 0===i||null===(a=i.baseLayers)||void 0===a?void 0:a.some((function(e){return e.uid===n})))}function b(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=m(e);if(!t)return null;var r=t.clone();return n&&(r.baseLayers=k(r.baseLayers,n.baseLayers),r.referenceLayers=k(r.referenceLayers,n.referenceLayers)),r}function S(e,n){var t,r;return e===n||(null!=(null===e||void 0===e||null===(t=e.portalItem)||void 0===t?void 0:t.id)&&e.portalItem.id===(null===n||void 0===n||null===(r=n.portalItem)||void 0===r?void 0:r.id)||"equal"===F(P(e),P(n),{mustMatchReferences:!0}))}function k(e,n){var t=new s.Z;return e.forEach((function(e){var r=n.find((function(n){return"scene"!==n.type&&q(R(e),R(n))}))||e;t.includes(r)?t.push(e):t.push(r)})),t}function Z(e){return!(null===e||void 0===e||!e.baseLayers.concat(e.referenceLayers).some(w))}function w(e){if(C(e.url))return!0;if("vector-tile"===e.type)for(var n in e.sourceNameToSource){var t=e.sourceNameToSource[n];if(C(null===t||void 0===t?void 0:t.sourceUrl))return!0}return!1}function I(e,n){var t,r,i;if(null==n||null==e)return{spatialReference:null,updating:!1};if("not-loaded"===n.loadStatus)return n.load(),{spatialReference:null,updating:!0};if(n.spatialReference)return{spatialReference:n.spatialReference,updating:!1};if(0===n.baseLayers.length)return{spatialReference:null,updating:!1};var a=n.baseLayers.at(0);switch(a.loadStatus){case"not-loaded":a.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}var u=(("supportedSpatialReferences"in a?a.supportedSpatialReferences:null)||["tileInfo"in a?null===(t=a.tileInfo)||void 0===t?void 0:t.spatialReference:a.spatialReference]).filter(Boolean),s=e.spatialReference;return s?{spatialReference:null!==(r=null!==(i=u.find((function(e){return s.equals(e)})))&&void 0!==i?i:u[0])&&void 0!==r?r:null,updating:!1}:{spatialReference:u[0],updating:!1}}var L=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function C(e){if(!e)return!1;var n=new c.R9((0,c.hF)(e));return!!n.authority&&L.test(n.authority)}function P(e){return e?!e.loaded&&e.resourceInfo?E(e.resourceInfo.data):{baseLayers:O(e.baseLayers),referenceLayers:O(e.referenceLayers)}:null}function O(e){return(s.Z.isCollection(e)?e.toArray():e).map(R)}function R(e){var n,t;return{type:e.type,effect:"effect"in e?e.effect:void 0,url:M("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl||""),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible,sublayers:"map-image"!==e.type&&"wms"!==e.type||null==e.sublayers||null===(n=e.sublayers)||void 0===n?void 0:n.map((function(e){return{id:e.id,visible:e.visible}})),activeLayerId:"wmts"===e.type?null===(t=e.activeLayer)||void 0===t?void 0:t.id:void 0}}function T(e){return e.isReference||"ArcGISSceneServiceLayer"===e.layerType}function E(e){var n,t;return e?{baseLayers:A((null!==(n=e.baseMapLayers)&&void 0!==n?n:[]).filter((function(e){return!T(e)}))),referenceLayers:A((null!==(t=e.baseMapLayers)&&void 0!==t?t:[]).filter((function(e){return T(e)})))}:null}function A(e){return e.map((function(e){return function(e){var n,t,r,i;switch(e.layerType){case"VectorTileLayer":i="vector-tile";break;case"ArcGISTiledMapServiceLayer":i="tile";break;case"ArcGISSceneServiceLayer":i="scene";break;default:i="unknown"}return{type:i,effect:e.effect,url:M(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!==(n=e.minScale)&&void 0!==n?n:0,maxScale:null!==(t=e.maxScale)&&void 0!==t?t:0,opacity:null!==(r=e.opacity)&&void 0!==r?r:1,visible:null==e.visibility||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}(e)}))}function F(e,n,t){return null!=e!=(null!=n)?"not-equal":e&&n?G(e.baseLayers,n.baseLayers)?G(e.referenceLayers,n.referenceLayers)?"equal":t.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function G(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!q(e[t],n[t]))return!1;return!0}function q(e,n){if(e.type!==n.type||e.url!==n.url||e.minScale!==n.minScale||e.maxScale!==n.maxScale||e.visible!==n.visible||e.opacity!==n.opacity)return!1;if(!(0,d.yQ)(e.effect,n.effect))return!1;if(null!=e.activeLayerId||null!=n.activeLayerId)return e.activeLayerId===n.activeLayerId;if(null!=e.sublayers||null!=n.sublayers){if(null==e.sublayers||null==n.sublayers||e.sublayers.length!==n.sublayers.length)return!1;for(var t=0;t<e.sublayers.length;t++){var r=e.sublayers.at(t),i=n.sublayers.at(t);if((null===r||void 0===r?void 0:r.id)!==(null===i||void 0===i?void 0:i.id)||(null===r||void 0===r?void 0:r.visible)!==(null===i||void 0===i?void 0:i.visible))return!1}}return!0}function M(e){return e?(0,c.Fv)(e).replace(/^\s*https?:/i,"").toLowerCase():""}function j(e){if(!e)return null;var n=e.thumbnailUrl;if(n)return n;var t=function(e){if(r)return r(e);var n=null,t=P(e),i=!(null!==t&&void 0!==t&&t.baseLayers.length);for(var a in p.s){var u=F(t,E(p.s[a]),{mustMatchReferences:i});if("equal"===u){n=a;break}"base-layers-equal"===u&&(n=a)}return n}(e);return t?p.s[t].thumbnailUrl:(0,l.ei)(e.baseLayers,H)}function H(e){var n;return"portalItem"in e?null===(n=e.portalItem)||void 0===n?void 0:n.thumbnailUrl:void 0}},36700:function(e,n,t){t.d(n,{x:function(){return f}});var r=t(1413),i=t(15671),a=t(43144),u=t(60136),s=t(29388),o=t(44179),l=t(75691),c=t(61309),f=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){return(0,i.Z)(this,t),n.call(this,(0,r.Z)((0,r.Z)({},e),{},{constraint:new o.Hk(e.targetPoint)}))}return(0,a.Z)(t,[{key:"hints",get:function(){return[new c.n(this.targetPoint,this.isDraped,this.domain)]}}]),t}(l.a)},33518:function(e,n,t){t.r(n),t.d(n,{GraphicsSnappingSource:function(){return U}});var r=t(4942),i=t(29439),a=t(93433),u=t(37762),s=t(74165),o=t(15861),l=t(15671),c=t(43144),f=t(60136),d=t(29388),p=t(27366),h=t(7138),v=t(63780),y=t(14921),m=t(97942),_=t(66978),g=t(94172),x=t(49861),b=(t(93169),t(32718),t(69912)),S=t(46634),k=t(80885),Z=t(79803),w=t(47991),I=t(27823),L=t(83406),C=t(3182),P=t(68928),O=t(75878),R=t(52410),T=t(74509),E=t(74579),A=t(64674),F=t(52824),G=t(59877),q=t(53580),M=t(48817),j=t(93463),H="graphics-collections",U=function(e){(0,f.Z)(t,e);var n=(0,d.Z)(t);function t(e){var r;return(0,l.Z)(this,t),(r=n.call(this,e)).availability=1,r._sources={multipoint:null,point:null,polygon:null,polyline:null},r._loadedWkids=new Set,r._loadedWkts=new Set,r._pendingAdds=[],r._extrudedPolygonSymbolsCount=0,r._updatingHandles=new S.R,r._memoizedMakeGetGroundElevation=(0,m.H)(F.g),r}return(0,c.Z)(t,[{key:"updating",get:function(){return this._updatingHandles.updating}},{key:"_hasZ",get:function(){var e=this.view;return null!=e&&"3d"===e.type&&"map-notes"!==this.layerSource.layer.type}},{key:"_snappingElevationAligner",get:function(){var e=this.view,n=this.layerSource.layer,t=null!=e&&"3d"===e.type;if(!t||"map-notes"===n.type)return(0,G.p)();var r=function(){var t=(0,o.Z)((0,s.Z)().mark((function t(r,i){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,_.Hl)(e.whenLayerView(n),i);case 2:return t.abrupt("return",t.sent.elevationAlignPointsInFeatures(r,i));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return(0,G.p)(t,{elevationInfo:n.elevationInfo,alignPointsInFeatures:r})}},{key:"_snappingElevationFilter",get:function(){var e=this.view,n=null!=e&&"3d"===e.type&&"map-notes"!==this.layerSource.layer.type;return(0,q.c)(n)}},{key:"_symbologySnappingFetcher",get:function(){var e=this.view,n=this.layerSource.layer,t=null!=e&&"3d"===e.type,r=this._extrudedPolygonSymbolsCount>0;return t&&"map-notes"!==n.type&&r?(0,M.k)(r,function(){var t=(0,o.Z)((0,s.Z)().mark((function t(r,i){var a;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.whenLayerView(n);case 2:return a=t.sent,t.abrupt("return",((0,_.k_)(i),a.queryForSymbologySnapping({candidates:r,spatialReference:e.spatialReference},i)));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()):(0,M.k)()}},{key:"destroy",value:function(){var e,n=this,t=(0,u.Z)(this._pendingAdds);try{for(t.s();!(e=t.n()).done;){e.value.task.abort()}}catch(r){t.e(r)}finally{t.f()}this._pendingAdds.length=0,this._mapSources((function(e){return n._destroySource(e)})),this._updatingHandles.destroy()}},{key:"initialize",value:function(){var e=this;this._updatingHandles.add((function(){return e.getGraphicsLayers()}),(function(n){e._updatingHandles.removeHandles(H);var t,r=(0,u.Z)(n);try{var i=function(){var n=t.value;e._addMany(n.graphics.toArray()),e.addHandles([n.on("graphic-update",(function(n){return e._onGraphicUpdate(n)})),e._updatingHandles.addOnCollectionChange((function(){return n.graphics}),(function(n){return e._onGraphicsChanged(n)}))],H)};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}}),g.initial);var n=this.view,t=this.layerSource.layer;null!=n&&"3d"===n.type&&"map-notes"!==t.type&&n.elevationProvider&&this.addHandles([n.elevationProvider.on("elevation-change",(function(n){var r=n.context;(0,T.W_)(r,t.elevationInfo)&&e._snappingElevationAligner.notifyElevationSourceChange()})),(0,g.watch)((function(){return t.elevationInfo}),(function(){return e._snappingElevationAligner.notifyElevationSourceChange()}),g.initial),(0,g.on)((function(){return t}),["edits","apply-edits","graphic-update"],(function(){return e._symbologySnappingFetcher.notifySymbologyChange()}))])}},{key:"fetchCandidates",value:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n,t){var r,i,a,u,o,l=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.point,i=n.coordinateHelper.spatialReference,e.next=4,(0,_.OT)(this._mapSources((function(e){return l._fetchCandidatesForSource(e,n,t)})));case 4:return a=e.sent,(0,_.k_)(t),u=this._memoizedMakeGetGroundElevation(this.view,i),o=a.flat().map((function(e){return(0,F.X)(e,u)})),e.abrupt("return",((0,A.lQ)(r,o),o));case 8:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"_fetchCandidatesForSource",value:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(n,t,r){var i,u,o,l,c,f,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,A.rh)(t,null!==(i=null===(u=this.view)||void 0===u?void 0:u.type)&&void 0!==i?i:"2d"),e.next=3,n.queryEngine.executeQueryForSnapping(o,r);case 3:return l=e.sent,(0,_.k_)(r),e.next=7,this._snappingElevationAligner.alignCandidates(l.candidates,t.coordinateHelper.spatialReference,r);case 7:return c=e.sent,(0,_.k_)(r),e.next=11,this._symbologySnappingFetcher.fetch(c,r);case 11:return f=e.sent,(0,_.k_)(r),d=0===f.length?c:[].concat((0,a.Z)(c),(0,a.Z)(f)),e.abrupt("return",this._snappingElevationFilter.filter(o,d));case 15:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){}},{key:"_onGraphicUpdate",value:function(e){if(this.getGraphicsLayers().some((function(n){return n.graphics.includes(e.graphic)})))switch(e.property){case"geometry":case"visible":this._remove(e.graphic),this._addMany([e.graphic])}}},{key:"_onGraphicsChanged",value:function(e){var n,t=(0,u.Z)(e.removed);try{for(t.s();!(n=t.n()).done;){var r=n.value;this._remove(r)}}catch(i){t.e(i)}finally{t.f()}this._addMany(e.added)}},{key:"_addMany",value:function(e){var n,t=[],r=new Map,i=(0,u.Z)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;null!=a.geometry&&(this._needsInitializeProjection(a.geometry.spatialReference)?(t.push(a.geometry.spatialReference),r.set(a.uid,a)):this._add(a))}}catch(s){i.e(s)}finally{i.f()}this._createPendingAdd(t,r)}},{key:"_createPendingAdd",value:function(e,n){var t=this;if(e.length){var r=(0,y.vr)(function(){var r=(0,o.Z)((0,s.Z)().mark((function r(a){var o,l,c,f;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,Z.initializeProjection)(e.map((function(e){return{source:e,dest:t.spatialReference}})),{signal:a});case 2:t._markLoadedSpatialReferences(e),o=(0,u.Z)(n);try{for(o.s();!(l=o.n()).done;)c=(0,i.Z)(l.value,2),f=c[1],t._add(f)}catch(s){o.e(s)}finally{o.f()}case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());this._updatingHandles.addPromise(r.promise);var a={task:r,graphics:n},l=function(){return(0,v.e$)(t._pendingAdds,a)};r.promise.then(l,l),this._pendingAdds.push(a)}}},{key:"_markLoadedSpatialReferences",value:function(e){var n,t=(0,u.Z)(e);try{for(t.s();!(n=t.n()).done;){var r=n.value;null!=r.wkid&&this._loadedWkids.add(r.wkid);var i=r.wkt2||r.wkt;i&&this._loadedWkts.add(i)}}catch(a){t.e(a)}finally{t.f()}}},{key:"_add",value:function(e){if(null!=e.geometry&&e.visible){var n=e.geometry;if("mesh"!==n.type){"extent"===n.type&&(n=k.Z.fromExtent(n));var t=this._ensureSource(n.type);if(null!=t){var r=this._createOptimizedFeature(e.uid,n);null!=r&&(t.featureStore.add(r),(0,E.QL)(e.symbol)&&this._extrudedPolygonSymbolsCount++)}}}}},{key:"_needsInitializeProjection",value:function(e){if(null!=e.wkid&&this._loadedWkids.has(e.wkid))return!1;var n=e.wkt2||e.wkt;return(!n||!this._loadedWkts.has(n))&&!(0,Z.canProjectWithoutEngine)(e,this.spatialReference)}},{key:"_createOptimizedFeature",value:function(e,n){var t=(0,Z.project)((0,w.SR)(n),this.spatialReference);if(!t)return null;var i=this._ensureGeometryHasZ(t),a=(0,L.GH)(i,this._hasZ,!1);return new C.u_(a,(0,r.Z)({},N,e),null,e)}},{key:"_ensureGeometryHasZ",value:function(e){var n;if(!this._hasZ)return e;var t=function(e){for(;e.length<3;)e.push(0)},r=e.clone();switch(r.hasZ=!0,r.type){case"point":r.z=null!==(n=r.z)&&void 0!==n?n:0;break;case"multipoint":r.points.forEach(t);break;case"polyline":r.paths.forEach((function(e){return e.forEach(t)}));break;case"polygon":r.rings.forEach((function(e){return e.forEach(t)}))}return r}},{key:"_ensureSource",value:function(e){var n=this._sources[e];if(null!=n)return n;var t=this._createSource(e);return this._sources[e]=t,t}},{key:"_createSource",value:function(e){var n=I.M.toJSON(e),t=this._hasZ,r=new P.Z({geometryType:n,hasZ:t,hasM:!1});return{featureStore:r,queryEngine:new O.q({featureStore:r,fieldsIndex:R.Z.fromLayerJSON({fields:[{name:N,type:"esriFieldTypeOID",alias:N}]}),geometryType:n,hasM:!1,hasZ:t,objectIdField:N,spatialReference:this.spatialReference,priority:j.T8.SNAPPING,scheduler:null!=this.view&&"3d"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}},{key:"_remove",value:function(e){var n=this;this._mapSources((function(t){return n._removeFromSource(t,e)}));var t,r=(0,u.Z)(this._pendingAdds);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.graphics.delete(e.uid),0===i.graphics.size&&i.task.abort()}}catch(a){r.e(a)}finally{r.f()}}},{key:"_removeFromSource",value:function(e,n){var t=n.uid;e.featureStore.has(t)&&(e.featureStore.removeById(n.uid),(0,E.QL)(n.symbol)&&this._extrudedPolygonSymbolsCount--)}},{key:"_destroySource",value:function(e){e.queryEngine.destroy(),this._sources[e.type]=null}},{key:"_mapSources",value:function(e){var n=this._sources,t=n.point,r=n.polygon,i=n.polyline,a=n.multipoint,u=[];return null!=t&&u.push(e(t)),null!=r&&u.push(e(r)),null!=i&&u.push(e(i)),null!=a&&u.push(e(a)),u}}]),t}(h.default);(0,p._)([(0,x.Cb)()],U.prototype,"getGraphicsLayers",void 0),(0,p._)([(0,x.Cb)({constructOnly:!0})],U.prototype,"layerSource",void 0),(0,p._)([(0,x.Cb)({constructOnly:!0})],U.prototype,"spatialReference",void 0),(0,p._)([(0,x.Cb)({constructOnly:!0})],U.prototype,"view",void 0),(0,p._)([(0,x.Cb)({readOnly:!0})],U.prototype,"updating",null),(0,p._)([(0,x.Cb)({readOnly:!0})],U.prototype,"availability",void 0),(0,p._)([(0,x.Cb)()],U.prototype,"_hasZ",null),(0,p._)([(0,x.Cb)()],U.prototype,"_snappingElevationAligner",null),(0,p._)([(0,x.Cb)()],U.prototype,"_snappingElevationFilter",null),(0,p._)([(0,x.Cb)()],U.prototype,"_symbologySnappingFetcher",null),(0,p._)([(0,x.Cb)()],U.prototype,"_extrudedPolygonSymbolsCount",void 0),U=(0,p._)([(0,b.j)("esri.views.interactive.snapping.featureSources.GraphicsSnappingSource")],U);var N="OBJECTID"},52824:function(e,n,t){t.d(n,{X:function(){return o},g:function(){return l}});var r=t(38054),i=t(97760),a=t(95905),u=t(36700);function s(e){var n=e.x,t=e.y,i=e.z;return(0,r.al)(n,t,null!==i&&void 0!==i?i:0)}function o(e,n){switch(e.type){case"edge":return e.draped?new i.k({edgeStart:s(e.start),edgeEnd:s(e.end),targetPoint:(0,r.s)(s(e.target)),objectId:e.objectId,getGroundElevation:n}):new a.L({edgeStart:s(e.start),edgeEnd:s(e.end),targetPoint:(0,r.s)(s(e.target)),objectId:e.objectId,isDraped:!1});case"vertex":return new u.x({targetPoint:(0,r.s)(s(e.target)),objectId:e.objectId,isDraped:!1})}}function l(e,n){return null!=e&&"3d"===e.type?function(t,r){return e.elevationProvider.getElevation(t,r,0,n,"ground")}:function(){return null}}},61309:function(e,n,t){t.d(n,{n:function(){return o}});var r=t(15671),i=t(43144),a=t(60136),u=t(29388),s=t(32035),o=function(e){(0,a.Z)(t,e);var n=(0,u.Z)(t);function t(e,i,a){var u;return(0,r.Z)(this,t),(u=n.call(this,i,a)).point=e,u}return(0,i.Z)(t,[{key:"equals",value:function(e){return e instanceof t&&(0,s.e)(this.point,e.point)}}]),t}(t(55054).r)}}]);
//# sourceMappingURL=16313.715e44f4.chunk.js.map