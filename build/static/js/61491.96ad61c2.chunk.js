"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[61491],{35582:function(e,t,i){i.d(t,{M:function(){return v},b:function(){return h}});var r,n,s=i(30168),a=i(41012),o=i(95276),l=i(58406),u=i(98634),c=i(64201),d=i(4760);function h(e){var t=new c.kG,i=t.vertex,h=t.fragment;(0,a.Sv)(i,e),i.uniforms.add(new l.p("width",(function(e){return e.width}))),t.attributes.add(d.T.POSITION,"vec3"),t.attributes.add(d.T.NORMAL,"vec3"),t.attributes.add(d.T.UV0,"vec2"),t.attributes.add(d.T.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.code.add((0,u.H)(r||(r=(0,s.Z)(["void main(void) {\nvec3 bitangent = normal;\nvtc = uv0;\nvlength = length;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;\n}"])))),h.uniforms.add(new l.p("outlineSize",(function(e){return e.outlineSize})),new o.N("outlineColor",(function(e){return e.outlineColor})),new l.p("stripeLength",(function(e){return e.stripeLength})),new o.N("stripeEvenColor",(function(e){return e.stripeEvenColor})),new o.N("stripeOddColor",(function(e){return e.stripeOddColor})));var v=1/Math.sqrt(2);return h.code.add((0,u.H)(n||(n=(0,s.Z)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      } else if (d < outlineSize) {\n        return outlineColor;\n      } else {\n        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n      }\n    }\n\n    void main(void) {\n      vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n      vec4 color = arrowColor(ntc, vlength / vradius);\n      if (color.a == 0.0) {\n        discard;\n      }\n      fragColor = color;\n    }\n  "])),u.H.float(v))),t}var v=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}))},77671:function(e,t,i){i.d(t,{Y:function(){return n}});var r=i(74177),n={readOnly:!0,get:function(){return(0,r.R)(this.view)}}},61491:function(e,t,i){i.r(t),i.d(t,{default:function(){return xe}});var r=i(15671),n=i(43144),s=i(60136),a=i(29388),o=i(27366),l=i(7138),u=(i(93169),i(92026)),c=i(49861),d=i(32718),h=(i(84936),i(69912)),v=i(77671),_=i(98074),y=i(51817),p=i(94172),f=i(33906),g=i(4914),m=i(13615),b=i(47072),w=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){return(0,r.Z)(this,i),t.call(this,e)}return(0,n.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,p.watch)((function(){return{viewData:e.viewData,startPoint:e.analysis.startPoint}}),(function(t){var i=t.viewData,r=t.startPoint;i.elevationAlignedStartPoint=e._applyProjectionAndElevationAlignment(r)}),p.syncAndInitial),(0,p.watch)((function(){return{viewData:e.viewData,endPoint:e.analysis.endPoint}}),(function(t){var i=t.viewData,r=t.endPoint;i.elevationAlignedEndPoint=e._applyProjectionAndElevationAlignment(r)}),p.syncAndInitial),(0,p.watch)((function(){return{result:e._computedResult,viewData:e.viewData}}),(function(e){var t=e.result;e.viewData.result=t}),p.syncAndInitial)])}},{key:"_applyProjectionAndElevationAlignment",value:function(e){if(null==e)return e;var t=this.view,i=t.spatialReference,r=t.elevationProvider,n=(0,f.G)(e,i,r);return null!==n&&void 0!==n?n:((0,f.e)(this.analysis,e.spatialReference,d.Z.getLogger(this)),null)}},{key:"_computedResult",get:function(){var e=this.viewData,t=e.elevationAlignedStartPoint,i=e.elevationAlignedEndPoint,r=e.measurementMode;if(null==t||null==i)return null;var n,s,a=(0,g.Uy)(t,i),o=(0,m.RT)(t,i);if(null==a)return null;switch(r){case y.e.Auto:s=null!=o?"geodesic":"euclidean",n=null!==o&&void 0!==o?o:a.horizontal;break;case y.e.Geodesic:if(null==o)return null;s="geodesic",n=o;break;case y.e.Euclidean:s="euclidean",n=a.horizontal}return{mode:s,directDistance:a.direct,horizontalDistance:n,verticalDistance:a.vertical,distance:r===y.e.Euclidean||a.horizontal.value<=b.Yo?a.direct:null!==o&&void 0!==o?o:a.horizontal}}}]),i}(l.default);(0,o._)([(0,c.Cb)()],w.prototype,"view",void 0),(0,o._)([(0,c.Cb)()],w.prototype,"analysis",void 0),(0,o._)([(0,c.Cb)()],w.prototype,"viewData",void 0),(0,o._)([(0,c.Cb)()],w.prototype,"_computedResult",null),w=(0,o._)([(0,h.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],w);var C=i(74165),k=i(15861),R=i(1413),S=(i(59166),i(86950)),O=i(16889),A=i(58935),M=i(47898),L=i(17842),P=i(68860),E=i(13611),z=i(32035),D=i(12400),T=i(55203),G=i(27210),V=i(33837),Z=i(100),x=i(7025),j=i(19093),U=i(86361),H=i(51378),N=i(52168),F=i(60084),I=i(71917),W=i(70619),q=i(56529),Q=i(55158),B=i(37081),K=i(23620),Y=i(93822),J=i(4760),X=i(82144),$=i(31132),ee=i(33559),te=i(78041),ie=i(27627),re=i(25920),ne=i(8883),se=i(35582),ae=i(8548),oe=i(36207),le=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e,n,s){return(0,r.Z)(this,i),t.call(this,e,n,s)}return(0,n.Z)(i,[{key:"initializeProgram",value:function(e){return new ie.$(e.rctx,i.shader.get().build(this.configuration),ce)}},{key:"_setPipelineState",value:function(e){var t=e===re.A.NONE,i=this.configuration;return(0,oe.sm)({blending:i.transparent?t?te.wu:(0,te.j7)(e):null,polygonOffset:this.configuration.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:ae.wb.LESS},depthWrite:oe.LZ,colorWrite:oe.BK})}},{key:"initializePipeline",value:function(){return this._setPipelineState(this.configuration.transparencyPassType)}},{key:"primitiveType",get:function(){return ae.MX.TRIANGLE_STRIP}}]),i}($.A);le.shader=new X.J(se.M,(function(){return i.e(14142).then(i.bind(i,14142))}));var ue=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments)).polygonOffsetEnabled=!1,e.transparent=!1,e.transparencyPassType=re.A.NONE,e}return(0,n.Z)(i)}(ne.W);(0,o._)([(0,ee.o)()],ue.prototype,"polygonOffsetEnabled",void 0),(0,o._)([(0,ee.o)()],ue.prototype,"transparent",void 0),(0,o._)([(0,ee.o)({count:re.A.COUNT})],ue.prototype,"transparencyPassType",void 0);var ce=new Map([[J.T.POSITION,0],[J.T.NORMAL,1],[J.T.UV0,2],[J.T.LENGTH,3]]),de=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e,new ve))._vertexAttributeLocations=ce,n.produces=new Map([[Y.r.OPAQUE_MATERIAL,function(e){return!n._transparent&&e===B.H_.Color}],[Y.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,function(e){return n._transparent&&e===B.H_.Color}]]),n._configuration=new ue,n}return(0,n.Z)(i,[{key:"getConfiguration",value:function(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration}},{key:"intersect",value:function(){}},{key:"createGLMaterial",value:function(e){return new he(e)}},{key:"createBufferWriter",value:function(){return new be}},{key:"_transparent",get:function(){var e=this.parameters;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}]),i}(q.F5),he=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(){return(0,r.Z)(this,i),t.apply(this,arguments)}return(0,n.Z)(i,[{key:"beginSlot",value:function(e){return this.ensureTechnique(le,e)}}]),i}(K.Z),ve=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(){var e;return(0,r.Z)(this,i),(e=t.apply(this,arguments)).width=32,e.outlineSize=.2,e.outlineColor=(0,U.al)(1,.5,0,1),e.stripeEvenColor=(0,U.al)(1,1,1,1),e.stripeOddColor=(0,U.al)(1,.5,0,1),e.stripeLength=1,e.polygonOffset=!1,e}return(0,n.Z)(i)}(q.Mt),_e=(0,Q.U$)().vec3f(J.T.POSITION).vec3f(J.T.NORMAL).vec2f(J.T.UV0).f32(J.T.LENGTH),ye=(0,D.Ue)(),pe=(0,D.Ue)(),fe=(0,D.Ue)(),ge=(0,D.Ue)(),me=(0,D.Ue)(),be=function(){function e(){(0,r.Z)(this,e),this.vertexBufferLayout=_e}return(0,n.Z)(e,[{key:"elementCount",value:function(e){return 2*(e.attributes.get(J.T.POSITION).indices.length/2+1)}},{key:"write",value:function(e,t,i,r,n){var s=i.attributes.get(J.T.POSITION),a=s.data,o=s.indices,l=i.attributes.get(J.T.NORMAL).data,u=a.length/3;o&&o.length!==2*(u-1)&&console.warn("MeasurementArrowMaterial does not support indices");for(var c=ye,d=pe,h=fe,v=ge,_=me,y=r.position,p=r.normal,f=r.uv0,g=0,m=0;m<u;++m){var b=3*m;if((0,z.s)(c,a[b],a[b+1],a[b+2]),m<u-1){var w=3*(m+1);(0,z.s)(d,a[w],a[w+1],a[w+2]),(0,z.s)(_,l[w],l[w+1],l[w+2]),(0,z.n)(_,_),(0,z.f)(h,d,c),(0,z.n)(h,h),(0,z.b)(v,_,h),(0,z.n)(v,v)}var C=(0,z.p)(c,d);e&&t&&((0,z.h)(c,c,e),(0,z.h)(d,d,e),(0,z.h)(v,v,t));var k=n+2*m,R=k+1;y.setVec(k,c),y.setVec(R,c),p.setVec(k,v),p.setVec(R,v),f.set(k,0,g),f.set(k,1,-1),f.set(R,0,g),f.set(R,1,1),m<u-1&&(g+=C)}for(var S=r.length,O=0;O<2*u;++O)S.set(n+O,g)}}]),e}(),we=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e))._arrowWidth=16,n._arrowSubdivisions=128,n._origin=(0,D.Ue)(),n._originTransform=(0,x.Ue)(),n._arrowCenter=(0,D.Ue)(),n._renderOccluded=q.yD.OccludeAndTransparent,n._geometry=null,n._stripeLength=1,n._stripesEnabled=!0,n._color=(0,U.Ue)(),n._contrastColor=(0,U.Ue)(),n.applyProperties(e),n}return(0,n.Z)(i,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameters({renderOccluded:e}))}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this._geometryChanged()}},{key:"stripeLength",get:function(){return this._stripeLength},set:function(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}},{key:"stripesEnabled",get:function(){return this._stripesEnabled},set:function(e){if(this._stripesEnabled=e,this.attached){var t=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:t})}}},{key:"color",get:function(){return this._color},set:function(e){(0,S.Ht)(e,this._color)||((0,j.c)(this._color,e),this._updateArrowColor())}},{key:"contrastColor",get:function(){return this._contrastColor},set:function(e){(0,S.Ht)(e,this._color)||((0,j.c)(this._contrastColor,e),this._updateArrowColor())}},{key:"createExternalResources",value:function(){var e=this,t=this._color,i=this._contrastColor,r=this._stripesEnabled?i:t;this._arrowMaterial=new de({outlineColor:t,stripeEvenColor:r,stripeOddColor:t,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new Z.Z,this._handles.add((0,p.watch)((function(){return e.view.state.camera}),(function(){e._viewChanged()})))}},{key:"destroyExternalResources",value:function(){this._arrowMaterial=null,this._handles=(0,u.SC)(this._handles)}},{key:"forEachExternalMaterial",value:function(e){e(this._arrowMaterial)}},{key:"createGeometries",value:function(e){var t;if(null!=(null===(t=this._geometry)||void 0===t?void 0:t.startRenderSpace)&&null!=this._geometry.endRenderSpace){var i=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);i.transformation=this._originTransform,e.addGeometry(i),this._viewChanged()}}},{key:"_createArrowGeometry",value:function(e,t,i,r){var n=this.view,s=n.renderCoordsHelper,a=[],o=[],l=function(e,t){var r=H.WM.get();(0,z.f)(r,e,i),a.push(r),o.push(t)};if("euclidean"===r.type){r.eval(.5,this._arrowCenter);var u=H.WM.get();if(s.worldUpAtPosition(this._arrowCenter,u),function(e,t,i){var r=(0,z.z)(Ce,t,e),n=(0,z.b)(Ce,r,i);return 0===(0,z.H)(n)}(e,t,u)){var c=n.camera,d=c.heading,h=c.tilt,v=(0,F.kE)(n,e,d,h,ke).direction;(0,z.c)(u,v)}l(e,u),l(t,u)}else{r.eval(.5,this._arrowCenter);for(var _=this._arrowSubdivisions+1&-2,y=0;y<_;++y){var p=y/(_-1),f=H.WM.get(),g=H.WM.get();r.eval(p,f),s.worldUpAtPosition(f,g),l(f,g)}}return(0,W.rh)(this._arrowMaterial,a,o)}},{key:"_geometryChanged",value:function(){this.recreateGeometry()}},{key:"_viewChanged",value:function(){if(this.view.ready&&this.attached&&null!=this._geometry){var e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}},{key:"_updateArrowColor",value:function(){if(this.attached){var e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,r=e,n=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:r,stripeOddColor:n})}}}]),i}(N._);var Ce=(0,D.Ue)(),ke=(0,I.d)(),Re=i(98917),Se=i(9052),Oe=i(86700),Ae=i(11208),Me=i(36257),Le=i(41201),Pe=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e))._segmentVisualElement=null,n._triangleVisualElement=null,n._rightAngleQuad=null,n._projectedGeodesicLine=null,n._geodesicStartHint=null,n._geodesicEndHint=null,n._segmentLabel=null,n._verticalLabel=null,n._horizontalLabel=null,n._startPosition=(0,D.Ue)(),n._endPosition=(0,D.Ue)(),n._cornerPosition=(0,D.Ue)(),n._startPositionAtSeaLevel=(0,D.Ue)(),n._endPositionAtSeaLevel=(0,D.Ue)(),n._triangleOrientationOverride=null,n.messages=null,n.loadingMessages=!0,n.visualElementOrientation=T.x.Auto,n.triangleCollapseRatioThreshold=.03,n}return(0,n.Z)(i,[{key:"_parameters",get:function(){var e=this.view.effectiveTheme,t=e.accentColor,i=e.textColor,r=(0,S.O)(t),n=(0,S.Ch)(t,.75),s=(0,S.O)((0,S.mj)(t)),a=(0,S.mj)(i,S.K6.Low);return{accentColor:r,contrastColor:s,translucentAccentColor:n,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,S.G)(a,.6),textCalloutColor:(0,S.G)(a,.5)}}},{key:"visible",get:function(){return this.analysisView.visible}},{key:"viewMode",get:function(){var e=this.analysisView,t=e.elevationAlignedStartPoint,i=e.elevationAlignedEndPoint;if(null==t||null==i||t.equals(i))return T.w.None;var r=this.analysisView.result;if(null==r)return T.w.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?T.w.ProjectedGeodesic:T.w.Direct;var n=r.verticalDistance,s=r.horizontalDistance,a=n.value,o=s.value;return Math.min(a/o,o/a)<this.triangleCollapseRatioThreshold?T.w.Direct:T.w.Triangle}},{key:"actualVisualizedMeasurement",get:function(){var e=this.analysisView,t=e.measurementMode,i=e.result;switch(t){case y.e.Auto:return null!=i&&i.horizontalDistance.value>b.Yo?"geodesic":"euclidean";case y.e.Euclidean:return"euclidean";case y.e.Geodesic:return"geodesic"}}},{key:"allowVisualElementsOrientationChange",get:function(){return null==this._triangleOrientationOverride},set:function(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}},{key:"labels",get:function(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}},{key:"initialize",value:function(){var e=this,t=this._parameters,i={attached:!0,view:this.view,isDecoration:!0},r=t.guideLineWidth,n=t.guideStippleLengthPixels,s=t.triangleLineWidth,a=t.geodesicProjectionLineWidth,o=t.directLabelFontSize,l=t.verticalLabelFontSize,u=t.horizontalLabelFontSize;this._segmentVisualElement=new we((0,R.Z)((0,R.Z)({},i),{},{geometry:null,renderOccluded:q.yD.OccludeAndTransparent})),this._triangleVisualElement=new V.r((0,R.Z)((0,R.Z)({},i),{},{width:s,renderOccluded:q.yD.OccludeAndTransparent})),this._rightAngleQuad=new Re.R((0,R.Z)((0,R.Z)({},i),{},{renderOccluded:q.yD.OccludeAndTransparent}));var c=(0,R.Z)((0,R.Z)({},i),{},{polygonOffset:!0,renderOccluded:q.yD.OccludeAndTransparent});this._projectedGeodesicLine=new V.r((0,R.Z)((0,R.Z)({},c),{},{width:a,stipplePattern:(0,Oe.z5)(n)})),this._geodesicStartHint=new V.r((0,R.Z)((0,R.Z)({},c),{},{width:r,stipplePattern:(0,Oe.z5)(n)})),this._geodesicEndHint=new V.r((0,R.Z)((0,R.Z)({},c),{},{width:r,stipplePattern:(0,Oe.z5)(n)})),this._segmentLabel=new G.K((0,R.Z)((0,R.Z)({},i),{},{fontSize:o})),this._verticalLabel=new G.K((0,R.Z)((0,R.Z)({},i),{},{fontSize:l})),this._horizontalLabel=new G.K((0,R.Z)((0,R.Z)({},i),{},{fontSize:u})),this.addHandles([(0,p.watch)((function(){var t=e.analysisView,i=t.elevationAlignedStartPoint,r=t.elevationAlignedEndPoint,n=e.view;return{view:n,camera:n.state.camera,viewMode:e.viewMode,elevationAlignedStartPoint:i,elevationAlignedEndPoint:r,orientation:e._actualVisualElementsOrientation,visualizedMeasurement:e.actualVisualizedMeasurement,stripeLength:e._measurementArrowStripeLength}}),(function(t){return e._updateGeometryAndViewMode(t)}),p.syncAndInitial),(0,p.watch)((function(){return{visible:e.visible,viewMode:e.viewMode}}),(function(t){return e._updateVisualElementVisibility(t)}),p.syncAndInitial),(0,p.watch)((function(){return{text:e._labelsText,visualizedMeasurement:e.actualVisualizedMeasurement}}),(function(t){return e._updateLabelText(t)}),p.syncAndInitial),(0,p.watch)((function(){return{visible:e.visible,viewMode:e.viewMode}}),(function(t){return e._updateLabelVisibility(t)}),p.syncAndInitial),(0,p.watch)((function(){return e._measurementArrowStripeLength}),(function(t){return e._updateSegmentStripeLength(t)}),p.syncAndInitial),(0,Me.qe)((0,k.Z)((0,C.Z)().mark((function t(){return(0,C.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._updateMessageBundle());case 1:case"end":return t.stop()}}),t)})))),(0,p.watch)((function(){return e._parameters}),(function(t){var i=t.textBackgroundColor,r=t.textCalloutColor,n=t.textColor,s=t.translucentAccentColor,a=t.accentColor,o=t.contrastColor,l=e._segmentLabel,u=e._verticalLabel,c=e._horizontalLabel,d=e._triangleVisualElement,h=e._rightAngleQuad,v=e._projectedGeodesicLine,_=e._geodesicStartHint,y=e._geodesicEndHint,p=e._segmentVisualElement;l.backgroundColor=i,l.calloutColor=r,l.textColor=n,u.backgroundColor=i,u.calloutColor=r,u.textColor=n,c.backgroundColor=i,c.calloutColor=r,c.textColor=n,d.color=s,h.color=s,v.color=s,_.color=s,y.color=s,p.color=a,p.contrastColor=o}),p.initial)]),this._updateMessageBundle()}},{key:"destroy",value:function(){this._segmentVisualElement=(0,u.SC)(this._segmentVisualElement),this._triangleVisualElement=(0,u.SC)(this._triangleVisualElement),this._rightAngleQuad=(0,u.SC)(this._rightAngleQuad),this._projectedGeodesicLine=(0,u.SC)(this._projectedGeodesicLine),this._geodesicStartHint=(0,u.SC)(this._geodesicStartHint),this._geodesicEndHint=(0,u.SC)(this._geodesicEndHint),this._segmentLabel=(0,u.SC)(this._segmentLabel),this._verticalLabel=(0,u.SC)(this._verticalLabel),this._horizontalLabel=(0,u.SC)(this._horizontalLabel),this.set("view",null)}},{key:"_updateVisualElementVisibility",value:function(e){var t=e.visible,i=e.viewMode;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case T.w.None:break;case T.w.Direct:this._segmentVisualElement.visible=!0;break;case T.w.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case T.w.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}},{key:"_updateGeometryAndViewMode",value:function(e){var t=e.view,i=e.camera,r=e.viewMode,n=e.elevationAlignedStartPoint,s=e.elevationAlignedEndPoint,a=e.orientation,o=e.visualizedMeasurement,l=e.stripeLength,u=t.renderCoordsHelper;if(null!=u&&null!=n&&null!=s&&!n.equals(s)){var c=this._startPosition,d=this._endPosition;u.toRenderCoords(n,c),u.toRenderCoords(s,d);var h=a===T.x.AboveSegment?1:-1,v=h*(u.getAltitude(d)-u.getAltitude(c));v<0&&(c=this._endPosition,d=this._startPosition);var _="geodesic"===o?new Se.u(this._startPosition,this._endPosition,u.spatialReference):new Se.y(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=_,this._updateSegmentStripeLength(l),r){case T.w.Direct:this._updateSegment(_,a);break;case T.w.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:_,orientation:a,startPosition:c,endPosition:d,deltaSign:h,altitudeDelta:v});break;case T.w.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:a,startPosition:c,endPosition:d})}}}},{key:"_updateSegment",value:function(e,t){this._segmentLabel.anchor=t===T.x.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}},{key:"_updateSegmentAndTriangle",value:function(e){var t=e.view.renderCoordsHelper,i=e.camera,r=e.segment,n=e.orientation,s=e.startPosition,a=e.endPosition,o=e.deltaSign,l=e.altitudeDelta,u=this._cornerPosition;t.worldUpAtPosition(s,u),(0,z.j)(u,u,o*Math.abs(l)),(0,z.g)(u,u,s),this._triangleVisualElement.geometry=[[[s[0],s[1],s[2]],[u[0],u[1],u[2]],[a[0],a[1],a[2]]]],this._rightAngleQuad.geometry={previous:s,center:u,next:a};var c=new Se.y(s,u),d=new Se.y(u,a),h=function(e,t,i,r,n){var s=ze,a=De;n.projectToRenderScreen(i,s),n.projectToRenderScreen(t,a);var o={segment:"bottom",horizontal:"top",vertical:s[0]<a[0]?"left":"right"},l=Te,u=Ge;if((0,Ae.CM)(e,i,n,l),(0,Ae.CM)(e,t,n,u),(0,E.AK)(l,u)>=Ee){var c=Math.sign(l[1])===Math.sign(u[1]);o.segment=c?(0,G.j)(o.vertical):o.vertical}else{var d=Ve;(0,Ae.CM)(i,t,n,d),(0,E.AK)(d,u)>=Ee&&(o.segment=Math.sign(d[0])===Math.sign(u[0])?(0,G.j)(o.horizontal):o.horizontal)}if(r===T.x.BelowSegment){var h=function(e){return"top"===e?"bottom":"top"};o.segment=h(o.segment),o.horizontal=h(o.horizontal),o.vertical=h(o.vertical)}return o}(s,a,u,n,i);this._segmentLabel.anchor=h.segment,this._segmentLabel.geometry={type:"segment",segment:r,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:c,sampleLocation:"center"},this._verticalLabel.anchor=h.vertical,this._horizontalLabel.geometry={type:"segment",segment:d,sampleLocation:"center"},this._horizontalLabel.anchor=h.horizontal}},{key:"_updateSegmentAndProjection",value:function(e){var t=e.view.renderCoordsHelper,i=e.orientation,r=e.startPosition,n=e.endPosition;t.setAltitude(this._startPositionAtSeaLevel,0,r),t.setAltitude(this._endPositionAtSeaLevel,0,n);var s=new Se.u(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(s),this._geodesicStartHint.setGeometryFromSegment(new Se.y(this._startPositionAtSeaLevel,r)),this._geodesicEndHint.setGeometryFromSegment(new Se.y(this._endPositionAtSeaLevel,n)),this._segmentLabel.geometry={type:"segment",segment:s,sampleLocation:"center"},this._segmentLabel.anchor=i===T.x.AboveSegment?"top":"bottom"}},{key:"_updateLabelText",value:function(e){var t=e.text,i=e.visualizedMeasurement;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}},{key:"_updateLabelVisibility",value:function(e){var t=e.visible,i=e.viewMode,r=this._segmentLabel,n=this._horizontalLabel,s=this._verticalLabel;if(r.visible=!1,n.visible=!1,s.visible=!1,t)switch(i){case T.w.Direct:r.visible=!0;break;case T.w.Triangle:r.visible=!0,n.visible=!0,s.visible=!0;break;case T.w.ProjectedGeodesic:r.visible=!0;case T.w.None:}}},{key:"_labelsText",get:function(){if(this.destroyed)return null;var e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;var i=t.directDistance,r=t.horizontalDistance,n=t.verticalDistance,s=this.analysisView.unit,a=function(e){return(0,R.Z)({directDistance:"",horizontalDistance:"",verticalDistance:""},e)};switch(s){case"metric":return a({directDistance:i&&(0,A.Rd)(e,i),horizontalDistance:r&&(0,A.Rd)(e,r),verticalDistance:n&&(0,A.Wv)(e,n)});case"imperial":return a({directDistance:i&&(0,A.Ud)(e,i),horizontalDistance:r&&(0,A.Ud)(e,r),verticalDistance:n&&(0,A.Zv)(e,n)});default:return a({directDistance:i&&(0,A.VG)(e,i,s),horizontalDistance:r&&(0,A.VG)(e,r,s),verticalDistance:n&&(0,A.VG)(e,n,s)})}}},{key:"_updateSegmentStripeLength",value:function(e){var t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}},{key:"_actualVisualElementsOrientation",get:function(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;var e=this.visualElementOrientation;return e===T.x.Auto?this.view.state.camera.aboveGround?T.x.AboveSegment:T.x.BelowSegment:e}},{key:"_requiresGeodesicGuideAt",value:function(e){var t=this.view;if(null===t||void 0===t||!t.state)return!1;var i=t.state.camera,r=t.renderCoordsHelper;if(!r)return!1;var n=i.computeScreenPixelSizeAt(e);return r.getAltitude(e)/n>=10}},{key:"_measurementArrowStripeLength",get:function(){var e=this.analysisView,t=e.result,i=e.unit;if(null==t)return null;var r=null,n=t.directDistance;switch(i){case"metric":r=n&&(0,M.nn)(n,"meters");break;case"imperial":r=n&&(0,M.nn)(n,(0,P.Q7)(n.value,n.unit));break;default:r=n&&(0,M.nn)(n,i)}return null==r?null:(0,O.sk)(r.value/30)*(0,P.En)(1,r.unit,"meters")}},{key:"_updateMessageBundle",value:function(){var e=this;this.loadingMessages=!0,(0,Le.ME)("esri/core/t9n/Units").then((function(t){e.messages=t})).finally((function(){e.loadingMessages=!1}))}},{key:"testData",get:function(){}}]),i}(l.default);(0,o._)([(0,c.Cb)()],Pe.prototype,"_parameters",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"_triangleOrientationOverride",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"messages",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"view",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"analysis",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"analysisView",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"loadingMessages",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"visible",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"viewMode",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"actualVisualizedMeasurement",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"visualElementOrientation",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"triangleCollapseRatioThreshold",void 0),(0,o._)([(0,c.Cb)()],Pe.prototype,"allowVisualElementsOrientationChange",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"labels",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"_labelsText",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"_actualVisualElementsOrientation",null),(0,o._)([(0,c.Cb)()],Pe.prototype,"_measurementArrowStripeLength",null),Pe=(0,o._)([(0,h.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Pe);var Ee=Math.cos((0,O.Vl)(12)),ze=(0,L.J$)(),De=(0,L.J$)(),Te=(0,L.gX)(),Ge=(0,L.gX)(),Ve=(0,L.gX)(),Ze=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).type="direct-line-measurement-view-3d",n.analysis=null,n.result=null,n.measurementMode=y.e.Auto,n.elevationAlignedStartPoint=null,n.elevationAlignedEndPoint=null,n}return(0,n.Z)(i,[{key:"initialize",value:function(){var e=this.view,t=this.analysis;this._analysisVisualization=new Pe({view:e,analysis:t,analysisView:this}),this._analysisController=new w({view:e,analysis:t,viewData:this})}},{key:"destroy",value:function(){this._analysisController=(0,u.SC)(this._analysisController),this._analysisVisualization=(0,u.SC)(this._analysisVisualization)}},{key:"updating",get:function(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}},{key:"viewMode",get:function(){return this._analysisVisualization.viewMode}},{key:"actualVisualizedMeasurement",get:function(){return this._analysisVisualization.actualVisualizedMeasurement}},{key:"visualElementOrientation",get:function(){return this._analysisVisualization.visualElementOrientation},set:function(e){this._analysisVisualization.visualElementOrientation=e}},{key:"allowVisualElementsOrientationChange",get:function(){return this._analysisVisualization.allowVisualElementsOrientationChange},set:function(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}},{key:"triangleCollapseRatioThreshold",get:function(){return this._analysisVisualization.triangleCollapseRatioThreshold},set:function(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}},{key:"directLabelText",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.direct)||void 0===t?void 0:t.text)&&void 0!==e?e:""}},{key:"horizontalLabelText",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.horizontal)||void 0===t?void 0:t.text)&&void 0!==e?e:""}},{key:"verticalLabelText",get:function(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.vertical)||void 0===t?void 0:t.text)&&void 0!==e?e:""}},{key:"unit",get:function(){var e;return null!==(e=this.analysis.unit)&&void 0!==e?e:this._defaultUnit}},{key:"testData",get:function(){}}]),i}((0,_.p)(l.default));(0,o._)([(0,c.Cb)()],Ze.prototype,"updating",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ze.prototype,"type",void 0),(0,o._)([(0,c.Cb)({constructOnly:!0,nonNullable:!0})],Ze.prototype,"analysis",void 0),(0,o._)([(0,c.Cb)()],Ze.prototype,"result",void 0),(0,o._)([(0,c.Cb)()],Ze.prototype,"measurementMode",void 0),(0,o._)([(0,c.Cb)()],Ze.prototype,"elevationAlignedStartPoint",void 0),(0,o._)([(0,c.Cb)()],Ze.prototype,"elevationAlignedEndPoint",void 0),(0,o._)([(0,c.Cb)({readOnly:!0})],Ze.prototype,"viewMode",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ze.prototype,"actualVisualizedMeasurement",null),(0,o._)([(0,c.Cb)()],Ze.prototype,"visualElementOrientation",null),(0,o._)([(0,c.Cb)()],Ze.prototype,"allowVisualElementsOrientationChange",null),(0,o._)([(0,c.Cb)()],Ze.prototype,"triangleCollapseRatioThreshold",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ze.prototype,"directLabelText",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ze.prototype,"horizontalLabelText",null),(0,o._)([(0,c.Cb)({readOnly:!0})],Ze.prototype,"verticalLabelText",null),(0,o._)([(0,c.Cb)()],Ze.prototype,"_analysisVisualization",void 0),(0,o._)([(0,c.Cb)()],Ze.prototype,"_analysisController",void 0),(0,o._)([(0,c.Cb)()],Ze.prototype,"unit",null),(0,o._)([(0,c.Cb)(v.Y)],Ze.prototype,"_defaultUnit",void 0);var xe=Ze=(0,o._)([(0,h.j)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],Ze)},55203:function(e,t,i){var r,n;i.d(t,{w:function(){return r},x:function(){return n}}),function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(r||(r={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(n||(n={}))},51817:function(e,t,i){var r;i.d(t,{e:function(){return r}}),function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(r||(r={}))},19182:function(e,t,i){i.d(t,{i:function(){return S}});var r=i(15671),n=i(43144),s=i(88301),a=i(61120),o=i(60136),l=i(29388),u=i(27366),c=i(7138),d=i(79056),h=i(49861),v=(i(93169),i(32718),i(84936),i(69912)),_=i(26279),y=i(78289),p=i(78485),f=function(){function e(t){(0,r.Z)(this,e),this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=_.eZ.Outline}return(0,n.Z)(e,[{key:"destroy",value:function(){this._destroyResources()}},{key:"resources",get:function(){return null!=this._resources?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}},{key:"renderGroup",get:function(){return this._renderGroup},set:function(e){var t;this._renderGroup=e;var i=null===(t=this._resources)||void 0===t?void 0:t.layerView;i&&(i.renderGroup=e)}},{key:"recreate",value:function(){this.attached&&this._createResources()}},{key:"recreateGeometry",value:function(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}},{key:"_createOrDestroyResources",value:function(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}},{key:"_createResources",value:function(){var e;this._destroyResources();var t=this._resourceFactory.createResources(),i=new g({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;this._resources={layerView:new g({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:t,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(i)),this._syncGeometriesToRenderer()}},{key:"_destroyResources",value:function(){var e;if(null!=this._resources){this._ensureRenderGeometriesRemoved();var t=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;t&&t.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}}},{key:"_syncGeometriesToRenderer",value:function(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}},{key:"_ensureRenderGeometriesRemoved",value:function(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,y.T.UPDATE),this._resources.geometriesAdded=!1)}},{key:"_ensureRenderGeometriesAdded",value:function(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,y.T.UPDATE),this._resources.geometriesAdded=!0))}}]),e}(),g=function(e){(0,o.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e)).drapeSourceType=_.Lw.Features,n.updatePolicy=p.j.SYNC,n.renderGroup=_.eZ.Outline,n}return(0,n.Z)(i)}((0,d.IG)(c.default));(0,u._)([(0,h.Cb)({constructOnly:!0})],g.prototype,"view",void 0),(0,u._)([(0,h.Cb)({readOnly:!0})],g.prototype,"drapeSourceType",void 0),(0,u._)([(0,h.Cb)()],g.prototype,"renderGroup",void 0),g=(0,u._)([(0,v.j)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],g);var m=i(86244),b=i(94172),w=i(79100),C=i(66327),k=i(97882),R=function(){function e(t){(0,r.Z)(this,e),this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1}return(0,n.Z)(e,[{key:"destroy",value:function(){this._destroyResources()}},{key:"object",get:function(){return null!=this._resources?this._resources.object:null}},{key:"resources",get:function(){return null!=this._resources?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}},{key:"recreate",value:function(){this.attached&&this._createResources()}},{key:"recreateGeometry",value:function(){if(this._resourceFactory.recreateGeometry){var e=this._resourceFactory.view._stage;if(null!=this._resources&&e){var t=this._resources.object;this._resources.external.forEach((function(t){t.type!==w.U.Mesh&&t.type!==w.U.Line&&t.type!==w.U.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((function(t){t.type!==w.U.Mesh&&t.type!==w.U.Line&&t.type!==w.U.Point||e.add(t)}))}}else this.recreate()}},{key:"_createOrDestroyResources",value:function(){this._attached?this._resources||this._createResources():this._destroyResources()}},{key:"_createResources",value:function(){this._destroyResources();var e=this._resourceFactory,t=e.view,i=t._stage;if(i){var r=new k.F(i,{pickable:!1,updatePolicy:p.j.SYNC}),n=new C.T({castShadow:!1}),s=e.createResources(n,r);s.forEach((function(e){i.add(e),e.type===w.U.Texture&&e.load(i.renderView.renderingContext)})),i.add(n),r.add(n);var a=e.cameraChanged,o=a?(0,b.watch)((function(){return t.state.camera}),(function(e){return a(e)}),b.initial):null;this._resources={layer:r,object:n,external:s,cameraHandle:o},this._syncVisible()}}},{key:"_destroyResources",value:function(){var e;if(null!=this._resources){var t=this._resourceFactory.view._stage;t&&(t.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((function(e){t.remove(e),e.type===w.U.Texture&&e.unload()}))),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}}},{key:"_syncVisible",value:function(){null!=this._resources&&(this._resources.object.visible=this._visible)}}]),e}(),S=function(e){(0,o.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n,s;return(0,r.Z)(this,i),(s=t.call(this,e))._isDraped=!1,s.object3dResources=new R(s.createObject3DResourceFactory(e.view)),s.drapedResources=new f(s.createDrapedResourceFactory(e.view)),s.isDraped=null!==(n=e.isDraped)&&void 0!==n&&n,s}return(0,n.Z)(i,[{key:"isDraped",get:function(){return this._isDraped},set:function(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}},{key:"renderGroup",get:function(){return this.drapedResources.renderGroup},set:function(e){this.drapedResources.renderGroup=e}},{key:"createResources",value:function(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}},{key:"destroyResources",value:function(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}},{key:"recreate",value:function(){this.object3dResources.recreate(),this.drapedResources.recreate()}},{key:"recreateGeometry",value:function(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}},{key:"destroy",value:function(){this.object3dResources.destroy(),this.drapedResources.destroy(),(0,s.Z)((0,a.Z)(i.prototype),"destroy",this).call(this)}},{key:"updateVisibility",value:function(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}]),i}(m.l)},52168:function(e,t,i){i.d(t,{_:function(){return v}});var r=i(15671),n=i(43144),s=i(60136),a=i(29388),o=i(29134),l=i(7025),u=i(86244),c=i(66327),d=i(78485),h=i(97882),v=function(e){(0,s.Z)(i,e);var t=(0,a.Z)(i);function i(e){var n;return(0,r.Z)(this,i),(n=t.call(this,e))._resources=null,n._transform=(0,l.Ue)(),n}return(0,n.Z)(i,[{key:"object",get:function(){return null!=this._resources?this._resources.object:null}},{key:"transform",get:function(){return this._transform},set:function(e){(0,o.JG)(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}},{key:"recreate",value:function(){this.attached&&this.createResources()}},{key:"recreateGeometry",value:function(){if(null!=this._resources){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}}},{key:"createResources",value:function(){this.destroyResources();var e=this.view._stage;if(e){var t=new h.F(e,{pickable:!1,updatePolicy:d.j.SYNC}),i=new c.T({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((function(t){return e.add(t)})),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}}},{key:"destroyResources",value:function(){var e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((function(t){e.remove(t)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}},{key:"updateVisibility",value:function(e){null!=this._resources&&(this._resources.object.visible=e)}}]),i}(u.l)},98917:function(e,t,i){i.d(t,{R:function(){return M}});var r=i(93433),n=i(37762),s=i(15671),a=i(43144),o=i(60136),l=i(29388),u=i(94172),c=i(29134),d=i(7025),h=i(32035),v=i(12400),_=i(19093),y=i(86361),p=i(51378),f=i(55946),g=i(19182),m=i(19265),b=i(91526),w=i(40779),C=i(70619),k=i(56529),R=i(39077),S=i(4760),O=i(66832),A=i(58901),M=function(e){(0,o.Z)(i,e);var t=(0,l.Z)(i);function i(e){var r;return(0,s.Z)(this,i),(r=t.call(this,e))._maxSize=0,r._position=(0,v.Ue)(),r._up=(0,v.Ue)(),r._right=(0,v.Ue)(),r._renderOccluded=k.yD.OccludeAndTransparent,r._color=(0,y.al)(1,0,0,1),r._outlineColor=(0,y.al)(0,0,0,1),r._outlineSize=0,r._size=32,r._outlineRenderOccluded=k.yD.Opaque,r.applyProperties(e),r}return(0,a.Z)(i,[{key:"createObject3DResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(e){return t._createObject3DResources(e)},destroyResources:function(){},cameraChanged:function(){return t._updateTransformObject3D()}}}},{key:"createDrapedResourceFactory",value:function(e){var t=this;return{view:e,createResources:function(){return t._createDrapedResources()},destroyResources:L}}},{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}},{key:"color",get:function(){return this._color},set:function(e){(0,_.c)(this._color,e),this._updateQuadMaterial()}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(e){(0,_.c)(this._outlineColor,e),this._updateOutlineMaterial()}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(e){var t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}},{key:"size",get:function(){return this._size},set:function(e){e!==this._size&&(this._size=e,this._updateTransform())}},{key:"outlineRenderOccluded",get:function(){return this._outlineRenderOccluded},set:function(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}},{key:"geometry",set:function(e){var t=e.previous,i=e.center,r=e.next;this._maxSize=Math.min((0,h.p)(i,t),(0,h.p)(i,r))/3,(0,h.n)(this._up,(0,h.f)(this._up,t,i)),(0,h.n)(this._right,(0,h.f)(this._right,r,i)),(0,h.c)(this._position,i),this.recreateGeometry()}},{key:"_createObject3DResources",value:function(e){var t=new O.E(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new A.U(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,i),{quadMaterial:t,outlineMaterial:i,forEach:function(e){e(t),i&&e(i)}}}},{key:"_createObject3DGeometries",value:function(e,t,i){if(!(0,h.e)(this._up,v.AG)||!(0,h.e)(this._right,v.AG)){var r,s=this._createGeometries(t,i),a=(0,n.Z)(s);try{for(a.s();!(r=a.n()).done;){var o=r.value;e.addGeometry(o)}}catch(l){a.e(l)}finally{a.f()}this._updateTransformObject3D(e)}}},{key:"_createDrapedResources",value:function(){var e=this,t=new O.E(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new A.U(this._outlineMaterialParameters),r=this._createGeometries(t,i).map((function(e){return new R.z(e)}));return this._setTransformDraped(r),{quadMaterial:t,outlineMaterial:i,geometries:r,pixelRatioHandle:(0,u.watch)((function(){return e.view.state.contentPixelRatio}),(function(){e.drapedResources.recreateGeometry()}))}}},{key:"_createGeometries",value:function(e,t){var i=this._getVertices(),n=i.up,s=i.right,a=i.corner,o=function(e,t,i,n){return new w.Z(n,[[S.T.POSITION,new b.a([0,0,0].concat((0,r.Z)(t),(0,r.Z)(e),(0,r.Z)(i)),[0,1,2,1,2,3],3,!0)]])}(n,s,a,e);return t?[o,(0,C.rh)(t,[n,a,s])]:[o]}},{key:"_getVertices",value:function(){var e=this._up,t=this._right,i=(0,h.g)(p.WM.get(),e,t);return this.isDraped&&(e=(0,h.c)(p.WM.get(),e),t=(0,h.c)(p.WM.get(),t),e[2]=0,t[2]=0,i[2]=0),{up:e,right:t,corner:i}}},{key:"_updateTransform",value:function(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}},{key:"_updateTransformObject3D",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.object3dResources.object;if(e){var t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),r=Math.min(this._maxSize,i);(0,c.vc)(P,this._position),(0,c.bA)(P,P,[r,r,r]),e.transformation=P}}},{key:"_setTransformDraped",value:function(e){if(0!==e.length){var t=this.view,i=t.basemapTerrain.overlayManager,r=t.state.contentPixelRatio,s=this._position,a=this._size,o=(0,h.c)(p.WM.get(),s);o[2]=m.gi;var l=E;l.spatialReference=i.renderer.spatialReference,l.x=o[0],l.y=o[1];var u=a*(this.view.overlayPixelSizeInMapUnits(l)*r),d=Math.min(this._maxSize,u);(0,c.vc)(P,o),(0,c.bA)(P,P,[d,d,1]);var v,_=(0,n.Z)(e);try{for(_.s();!(v=_.n()).done;){v.value.transformation=P}}catch(y){_.e(y)}finally{_.f()}}}},{key:"_quadMaterialParameters",get:function(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}},{key:"_updateQuadMaterial",value:function(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&e.quadMaterial.setParameters(this._quadMaterialParameters),null===(t=this.drapedResources.resources)||void 0===t||t.quadMaterial.setParameters(this._quadMaterialParameters)}},{key:"_outlineMaterialParameters",get:function(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}},{key:"_updateOutlineMaterial",value:function(){var e,t,i,r;null!==(e=this.object3dResources.resources)&&void 0!==e&&null!==(t=e.outlineMaterial)&&void 0!==t&&t.setParameters(this._outlineMaterialParameters),null===(i=this.drapedResources.resources)||void 0===i||null===(r=i.outlineMaterial)||void 0===r||r.setParameters(this._outlineMaterialParameters)}}]),i}(g.i);function L(e){e.pixelRatioHandle.remove(),e.geometries=[]}var P=(0,d.Ue)(),E=(0,f.T)(0,0,void 0,null)},86244:function(e,t,i){i.d(t,{l:function(){return a}});var r=i(15671),n=i(43144),s=(i(93169),i(94172)),a=function(){function e(t){var i=this;(0,r.Z)(this,e),this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t.view,this._handle=(0,s.watch)((function(){return t.view.ready}),(function(e){i._resourcesCreated&&(e?i._createResources():i._destroyResources())}))}return(0,n.Z)(e,[{key:"isDecoration",get:function(){return this._isDecoration},set:function(e){this._isDecoration=e}},{key:"applyProperties",value:function(e){var t=!1;for(var i in e)i in this&&("attached"===i?t=e[i]:this[i]=e[i]);this.attached=t}},{key:"destroy",value:function(){this.attached=!1,this._handle.remove()}},{key:"attached",get:function(){return this._attached},set:function(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}},{key:"onAttachedChange",value:function(e){}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}},{key:"_createResources",value:function(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}},{key:"_destroyResources",value:function(){this.destroyResources(),this._resourcesCreated=!1}}]),e}()}}]);
//# sourceMappingURL=61491.96ad61c2.chunk.js.map