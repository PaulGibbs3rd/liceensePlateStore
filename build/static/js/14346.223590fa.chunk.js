"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[14346],{70804:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(71002),i=r(89611),a=r(60136);function s(){s=function(e,t){return new r(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function r(e,n,a){var s=new RegExp(e,n);return t.set(s,a||t.get(e)),(0,i.Z)(s,r.prototype)}function u(e,r){var n=t.get(r);return Object.keys(n).reduce((function(t,r){var i=n[r];if("number"==typeof i)t[r]=e[i];else{for(var a=0;void 0===e[i[a]]&&a+1<i.length;)a++;t[r]=e[i[a]]}return t}),Object.create(null))}return(0,a.Z)(r,RegExp),r.prototype.exec=function(t){var r=e.exec.call(this,t);return r&&(r.groups=u(r,this)),r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var a=t.get(this);return e[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+a[t]})))}if("function"==typeof i){var s=this;return e[Symbol.replace].call(this,r,(function(){var e=arguments;return"object"!=(0,n.Z)(e[e.length-1])&&(e=[].slice.call(e)).push(u(e,s)),i.apply(this,e)}))}return e[Symbol.replace].call(this,r,i)},s.apply(this,arguments)}},36231:function(e,t,r){r.d(t,{q:function(){return o}});var n,i,a,s=r(84397),u={exports:{}};n=u,i=function(){function e(r,n,i,a,s){for(;a>i;){if(a-i>600){var u=a-i+1,o=n-i+1,l=Math.log(u),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(u-c)/u)*(o-u/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-o*c/u+f)),Math.min(a,Math.floor(n+(u-o)*c/u+f)),s)}var h=r[n],p=i,d=a;for(t(r,i,n),s(r[a],h)>0&&t(r,i,a);p<d;){for(t(r,p,d),p++,d--;s(r[p],h)<0;)p++;for(;s(r[d],h)>0;)d--}0===s(r[i],h)?t(r,i,d):t(r,++d,a),d<=n&&(i=d+1),n<=d&&(a=d-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,i,a,s){e(t,n,i||0,a||t.length-1,s||r)}},void 0!==(a=i())&&(n.exports=a);var o=(0,s.g)(u.exports)},91340:function(e,t,r){r.d(t,{it:function(){return N},wK:function(){return E},aX:function(){return M},or:function(){return Q},hR:function(){return I}});var n=r(74165),i=r(29439),a=r(15861),s=r(37762),u=r(42265),o=r(10064),l=r(32718),c=r(80885),f=r(29909),h=r(76335),p=r(92975),d=r(81753),y=r(1413),v=(r(59486),r(76200)),m=r(77981),x=r(23084);function g(e,t,r,n){return Z.apply(this,arguments)}function Z(){return Z=(0,a.Z)((0,n.Z)().mark((function e(t,r,i,a){var s,u,o,l,c,f,h,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,x.en)(t),u=r[0].spatialReference,o=(0,y.Z)((0,y.Z)({},a),{},{responseType:"json",query:(0,y.Z)((0,y.Z)({},s.query),{},{f:"json",sr:(0,p.B9)(u),target:JSON.stringify({geometryType:(0,m.Ji)(r[0]),geometries:r}),cutter:JSON.stringify(i)})}),e.next=5,(0,v.Z)(s.path+"/cut",o);case 5:return l=e.sent,c=l.data,f=c.cutIndexes,h=c.geometries,d=void 0===h?[]:h,e.abrupt("return",{cutIndexes:f,geometries:d.map((function(e){var t=(0,m.im)(e);return t.spatialReference=u,t}))});case 11:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}var b=r(35995),w=r(35594);function F(e,t,r){return _.apply(this,arguments)}function _(){return _=(0,a.Z)((0,n.Z)().mark((function e(t,r,i){var a,s,u,o,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?(0,b.mN)(t):t,s=r[0].spatialReference,u=(0,m.Ji)(r[0]),o=(0,y.Z)((0,y.Z)({},i),{},{query:(0,y.Z)((0,y.Z)({},a.query),{},{f:"json",sr:(0,p.B9)(s),geometries:JSON.stringify((0,w.F)(r))})}),e.next=6,(0,v.Z)(a.path+"/simplify",o);case 6:return l=e.sent,c=l.data,e.abrupt("return",(0,w.o)(c.geometries,u,s));case 9:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}var k=function(){return l.Z.getLogger("esri.geometry.support.normalizeUtils")};function S(e){for(var t=[],r=0,n=0,i=0;i<e.length;i++){for(var a=e[i],s=null,u=0;u<a.length;u++)s=a[u],t.push(s),0===u?n=r=s[0]:(r=Math.min(r,s[0]),n=Math.max(n,s[0]));s&&t.push([(r+n)/2,0])}return t}function I(e,t){if(!(e instanceof f.Z||e instanceof c.Z)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw k().error(r),new o.Z(r)}var n,i=(0,h.x3)(e),a=[],u=(0,s.Z)(i);try{for(u.s();!(n=u.n()).done;){var l=n.value,p=[];a.push(p),p.push([l[0][0],l[0][1]]);for(var d=0;d<l.length-1;d++){var y=l[d][0],v=l[d][1],m=l[d+1][0],x=l[d+1][1],g=Math.sqrt((m-y)*(m-y)+(x-v)*(x-v)),Z=(x-v)/g,b=(m-y)/g,w=g/t;if(w>1){for(var F=1;F<=w-1;F++){var _=F*t,S=b*_+y,I=Z*_+v;p.push([S,I])}var R=(g+Math.floor(w-1)*t)/2,T=b*R+y,A=Z*R+v;p.push([T,A])}p.push([m,x])}}}catch(M){u.e(M)}finally{u.f()}return function(e){return"polygon"===e.type}(e)?new c.Z({rings:a,spatialReference:e.spatialReference}):new f.Z({paths:a,spatialReference:e.spatialReference})}function R(e,t,r){if(t){var n=I(e,1e6);e=(0,d.Sx)(n,!0)}return r&&(e=(0,h.Sy)(e,r)),e}function T(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var i=(0,h.XZ)(n,t);e[0]=n+i*(-2*t)}else if(n<r){var a=(0,h.XZ)(n,r);e[0]=n+a*(-2*r)}}else{var s=e.x;if(s>t){var u=(0,h.XZ)(s,t);e=e.clone().offset(u*(-2*t),0)}else if(s<r){var o=(0,h.XZ)(s,r);e=e.clone().offset(o*(-2*r),0)}}return e}function A(e,t){for(var r=-1,n=function(n){for(var i=t.cutIndexes[n],a=t.geometries[n],u=(0,h.x3)(a),o=function(e){var t=u[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var s=t[i][0];n=s>n?s:n}n=Number(n.toFixed(9));for(var u=-360*(0,h.XZ)(n,180),o=0;o<t.length;o++){var l=a.getPoint(e,o);a.setPoint(e,o,l.clone().offset(u,0))}return!0}))},l=0;l<u.length;l++)o(l);if(i===r){if(function(e){return"polygon"===e[0].type}(e)){var c,f=(0,s.Z)((0,h.x3)(a));try{for(f.s();!(c=f.n()).done;){var p=c.value;e[i]=e[i].addRing(p)}}catch(m){f.e(m)}finally{f.f()}}else if(function(e){return"polyline"===e[0].type}(e)){var d,y=(0,s.Z)((0,h.x3)(a));try{for(y.s();!(d=y.n()).done;){var v=d.value;e[i]=e[i].addPath(v)}}catch(m){y.e(m)}finally{y.f()}}}else r=i,e[i]=a},i=0;i<t.cutIndexes.length;i++)n(i);return e}function M(e,t,r){return C.apply(this,arguments)}function C(){return C=(0,a.Z)((0,n.Z)().mark((function e(t,r,i){var a,o,l,y,v,m,x,Z,b,w,_,S,I,C,E,N,Q,V,q,z,D,P,G,O,j,B,L,U,X,$,W,H,J,Y,K,ee,te,re,ne,ie,ae,se,ue;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",M([t],r));case 2:r&&"string"!=typeof r&&k().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead"),o="string"==typeof r?r:null!==(a=null===r||void 0===r?void 0:r.url)&&void 0!==a?a:u.Z.geometryServiceUrl,_=0,S=[],I=[],C=(0,s.Z)(t);try{for(C.s();!(E=C.n()).done;)null!=(N=E.value)?(l||(l=N.spatialReference,y=(0,p.C5)(l),v=l.isWebMercator,Z=v?102100:4326,m=h.UZ[Z].maxX,x=h.UZ[Z].minX,b=h.UZ[Z].plus180Line,w=h.UZ[Z].minus180Line),y?"mesh"===N.type?I.push(N):"point"===N.type?I.push(T(N.clone(),m,x)):"multipoint"===N.type?((Q=N.clone()).points=Q.points.map((function(e){return T(e,m,x)})),I.push(Q)):"extent"===N.type?(V=N.clone()._normalize(!1,!1,y),I.push(V.rings?new c.Z(V):V)):N.extent?(q=N.extent,z=(0,h.XZ)(q.xmin,x)*(2*m),D=0===z?N.clone():(0,h.Sy)(N.clone(),z),q.offset(z,0),P=q.xmin,G=q.xmax,P=Number(P.toFixed(9)),G=Number(G.toFixed(9)),q.intersects(b)&&G!==m?(_=G>_?G:_,D=R(D,v),S.push(D),I.push("cut")):q.intersects(w)&&P!==x?(_=G*(2*m)>_?G*(2*m):_,D=R(D,v,360),S.push(D),I.push("cut")):I.push(D)):I.push(N.clone()):I.push(N)):I.push(N)}catch(n){C.e(n)}finally{C.f()}for(O=(0,h.XZ)(_,m),j=-90,B=O,L=new f.Z;O>0;)U=360*O-180,L.addPath([[U,j],[U,-1*j]]),j*=-1,O--;if(!(S.length>0&&B>0)){e.next=29;break}return e.t0=A,e.t1=S,e.next=16,g(o,S,L,i);case 16:for(e.t2=e.sent,X=(0,e.t0)(e.t1,e.t2),$=[],W=[],H=0;H<I.length;H++)"cut"!==(J=I[H])?W.push(J):(Y=X.shift(),null!=(K=t[H])&&"polygon"===K.type&&K.rings&&K.rings.length>1&&Y.rings.length>=K.rings.length?($.push(Y),W.push("simplify")):W.push(v?(0,d.$)(Y):Y));if($.length){e.next=23;break}return e.abrupt("return",W);case 23:return e.next=25,F(o,$,i);case 25:for(ee=e.sent,te=[],re=0;re<W.length;re++)"simplify"!==(ne=W[re])?te.push(ne):te.push(v?(0,d.$)(ee.shift()):ee.shift());return e.abrupt("return",te);case 29:for(ie=[],ae=0;ae<I.length;ae++)"cut"!==(se=I[ae])?ie.push(se):(ue=S.shift(),ie.push(!0===v?(0,d.$)(ue):ue));return e.abrupt("return",ie);case 32:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function E(e){var t;if(!e)return null;var r=e.extent;if(!r)return null;var n=e.spatialReference&&(0,p.C5)(e.spatialReference);if(!n)return r;var a,s=(0,i.Z)(n.valid,2),u=s[0],o=s[1],l=2*o,c=r.width,f=r.xmin,h=r.xmax;if(f=(t=[h,f])[0],h=t[1],"extent"===e.type||0===c||c<=o||c>l||f<u||h>o)return r;switch(e.type){case"polygon":if(!(e.rings.length>1))return r;a=S(e.rings);break;case"polyline":if(!(e.paths.length>1))return r;a=S(e.paths);break;case"multipoint":a=e.points}for(var d=r.clone(),y=0;y<a.length;y++){var v=a[y][0];v<0?(v+=o,h=Math.max(v,h)):(v-=o,f=Math.min(v,f))}return d.xmin=f,d.xmax=h,d.width<c?(d.xmin-=o,d.xmax-=o,d):r}function N(e,t,r){var n=(0,p.C5)(r);if(null==n)return e;var a=(0,i.Z)(n.valid,2),s=a[0],u=a[1],o=2*u,l=0,c=0;t>u?l=Math.ceil(Math.abs(t-u)/o):t<s&&(l=-Math.ceil(Math.abs(t-s)/o)),e>u?c=Math.ceil(Math.abs(e-u)/o):e<s&&(c=-Math.ceil(Math.abs(e-s)/o));var f=e+(l-c)*o,h=f-t;return h>u?f-=o:h<s&&(f+=o),f}function Q(e,t){var r=(0,p.C5)(t);if(r){var n=(0,i.Z)(r.valid,2),a=n[0],s=n[1],u=s-a;if(e<a)for(;e<a;)e+=u;if(e>s)for(;e>s;)e-=u}return e}},76335:function(e,t,r){r.d(t,{Sy:function(){return l},UZ:function(){return u},XZ:function(){return o},x3:function(){return c}});var n=r(37762),i=r(29909),a=r(78952),s=r(77981),u={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new i.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:a.Z.WebMercator}),minus180Line:new i.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:a.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new i.Z({paths:[[[180,-180],[180,180]]],spatialReference:a.Z.WGS84}),minus180Line:new i.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:a.Z.WGS84})}};function o(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){var r,i=c(e),a=(0,n.Z)(i);try{for(a.s();!(r=a.n()).done;){var s,u=r.value,o=(0,n.Z)(u);try{for(o.s();!(s=o.n()).done;){s.value[0]+=t}}catch(l){o.e(l)}finally{o.f()}}}catch(l){a.e(l)}finally{a.f()}return e}function c(e){return(0,s.oU)(e)?e.rings:e.paths}},75878:function(e,t,r){r.d(t,{q:function(){return _e}});var n=r(29439),i=r(1413),a=r(37762),s=r(74165),u=r(15861),o=r(43144),l=r(15671),c=r(63780),f=r(10064),h=r(46784),p=r(84652),d=r(92026),y=r(18759),v=r(66978),m=r(68860),x=r(79803),g=r(41414),Z=r(65156),b=r(376),w=r(77981),F=r(91340),_=r(92975),k=r(83406),S=r(93433),I=r(16054),R=r(54054),T=function(){function e(t,r){(0,l.Z)(this,e),this._cache=new I.z(t),this._invalidCache=new I.z(r)}return(0,o.Z)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(null!=this._invalidCache.get(r))return null;try{var i=R.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(E){return this._invalidCache.put(r,E),null}}},{key:"getError",value:function(e,t){var r,n="".concat(t.uid,":").concat(e);return null!==(r=this._invalidCache.get(n))&&void 0!==r?r:null}}]),e}(),A=r(85249),M=new T(50,500),C="unsupported-query",E=" as ",N=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeBigInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"]),Q=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),V=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID"].concat((0,S.Z)(N),(0,S.Z)(Q)));function q(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=D(t,e);if(!n){var i=M.getError(t,e);throw new f.Z(C,"invalid SQL expression",{expression:t,error:i})}var a=r.expressionName||"expression";if(r.validateStandardized&&!n.isStandardized)throw new f.Z(C,"".concat(a," is not standard"),{expression:t});if(r.validateAggregate&&!n.isAggregate)throw new f.Z(C,"".concat(a," does not contain a valid aggregate function"),{expression:t});return n.fieldNames}function z(e,t,r,n,i){if(!r)return!0;var a="having clause",s=q(e,r,{validateAggregate:!0,expressionName:a});O(e,t,s,{expressionName:a,query:i});var u=D(r,e),o=null===u||void 0===u?void 0:u.getExpressions().every((function(t){var r,i=t.aggregateType,a=t.field,s=null===(r=e.get(a))||void 0===r?void 0:r.name;return n.some((function(t){var r,n=t.onStatisticField,a=t.statisticType;return(null===(r=e.get(n))||void 0===r?void 0:r.name)===s&&a.toLowerCase().trim()===i}))}));if(!o)throw new f.Z(C,"expressions in having clause should also exist in outStatistics",{having:r});return!0}function D(e,t){return e?M.get(e,t):null}function P(e){return/\((.*?)\)/.test(e)?e:e.split(E)[0]}function G(e){return e.split(E)[1]}function O(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=new Map;if(j(a,e,t,null!==(n=i.allowedFieldTypes)&&void 0!==n?n:V,r),a.size){var s,u=null!==(s=i.expressionName)&&void 0!==s?s:"expression";throw new f.Z(C,"".concat(u," contains invalid or missing fields"),{errors:Array.from(a.values()),query:i.query})}}function j(e,t,r,n,i){var s,u=i.includes("*")?[].concat((0,S.Z)(r),(0,S.Z)(i.filter((function(e){return"*"!==e})))):i,o=(0,a.Z)(u);try{for(o.s();!(s=o.n()).done;){var l=s.value;if(t.get(l))B(e,t,r,n,l);else try{var c,f=q(t,P(l),{validateStandardized:!0}),h=(0,a.Z)(f);try{for(h.s();!(c=h.n()).done;){B(e,t,r,n,c.value)}}catch(p){h.e(p)}finally{h.f()}}catch(N){e.set(l,{type:"expression-error",expression:l,error:N})}}}catch(p){o.e(p)}finally{o.f()}}function B(e,t,r,n,i){var a=t.get(i);a?r.has(a.name)?"all"!==n&&!1===(null===n||void 0===n?void 0:n.has(a.type))&&e.set(i,{type:"invalid-type",fieldName:a.name,fieldType:A.v.fromJSON(a.type),allowedFieldTypes:Array.from(n,(function(e){return A.v.fromJSON(e)}))}):e.set(i,{type:"missing-field",fieldName:a.name}):e.set(i,{type:"invalid-field",fieldName:i})}var L=r(3306),U=r(19995),X=r(60480),$=r(4954),W=r(94446),H=r(58971),J=r(37270),Y=r(95281),K=r(71486),ee=r(819),te=function(){function e(t,r,n){var i;(0,l.Z)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=null!==(i=t.returnDistinctValues)&&void 0!==i&&i,this.fieldsIndex=n,this.featureAdapter=r;var s=t.outFields;if(s&&!s.includes("*")){this.outFields=s;var u,o=0,c=(0,a.Z)(s);try{for(c.s();!(u=c.n()).done;){var f=u.value,h=P(f),p=this.fieldsIndex.get(h),d=p?null:D(h,n),y=p?p.name:G(f)||"FIELD_EXP_"+o++;this._fieldDataCache.set(f,{alias:y,clause:d})}}catch(v){c.e(v)}finally{c.f()}}}return(0,o.Z)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n,i,a=r?r.name:t,s=null;return this._fieldDataCache.has(a)?s=null===(n=this._fieldDataCache.get(a))||void 0===n?void 0:n.clause:r||(s=D(t,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:s})),r?this.featureAdapter.getAttribute(e,a):null===(i=s)||void 0===i?void 0:i.calculateValue(e,this.featureAdapter)}},{key:"getDataValues",value:function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.normalizationType,a=t.normalizationTotal,s=this.fieldsIndex.get(t.field),u=(0,J.UQ)(s)||(0,J.ig)(s),o=(0,J.sX)(s);return e.map((function(e){var s=t.field&&r.getFieldValue(e,t.field,r.fieldsIndex.get(t.field));if(t.field2?(s="".concat((0,K.wk)(s)).concat(t.fieldDelimiter).concat((0,K.wk)(r.getFieldValue(e,t.field2,r.fieldsIndex.get(t.field2)))),t.field3&&(s="".concat(s).concat(t.fieldDelimiter).concat((0,K.wk)(r.getFieldValue(e,t.field3,r.fieldsIndex.get(t.field3)))))):"string"==typeof s&&n&&(u?s=s?new Date(s).getTime():null:o&&(s=s?(0,Y.yO)(s):null)),i&&Number.isFinite(s)){var l="field"===i&&t.normalizationField?r.getFieldValue(e,t.normalizationField,r.fieldsIndex.get(t.normalizationField)):null;s=(0,K.fk)(s,i,l,a)}return s}))}},{key:"getExpressionValues",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r,n,a,u){var o,l,c,f,h,p,d=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ee.LC)();case 2:if(o=e.sent,l=o.arcadeUtils,c=l.hasGeometryOperations(r),e.t0=c,!e.t0){e.next=9;break}return e.next=9,l.enableGeometryOperations();case 9:return f=l.createFunction(r),h=l.getViewInfo(n),p={fields:this.fieldsIndex.fields},e.abrupt("return",t.map((function(e){var t={attributes:d.featureAdapter.getAttributes(e),layer:p,geometry:c?(0,i.Z)((0,i.Z)({},(0,L.Op)(a.geometryType,a.hasZ,a.hasM,d.featureAdapter.getGeometry(e))),{},{spatialReference:null===n||void 0===n?void 0:n.spatialReference}):null},r=l.createExecContext(t,h,u);return l.executeFunction(f,r)})));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"validateItem",value:function(e,t){var r,n,i;return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:D(t,this.fieldsIndex)}),null!==(r=null===(n=this._fieldDataCache.get(t))||void 0===n||null===(i=n.clause)||void 0===i?void 0:i.testFeature(e,this.featureAdapter))&&void 0!==r&&r}},{key:"validateItems",value:function(e,t){var r,n,i;return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:D(t,this.fieldsIndex)}),null!==(r=null===(n=this._fieldDataCache.get(t))||void 0===n||null===(i=n.clause)||void 0===i?void 0:i.testSet(e,this.featureAdapter))&&void 0!==r&&r}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(null===t||void 0===t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},i=(0,a.Z)(t);try{for(i.s();!(r=i.n()).done;){var s=r.value,u=this._fieldDataCache.get(s),o=u.alias,l=u.clause;n[o]=l?l.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,o)}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if(null==e||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,i=(0,a.Z)(t);try{for(i.s();!(n=i.n()).done;){var s=n.value,u=this._fieldDataCache.get(s).alias;r.push(e[u])}}catch(f){i.e(f)}finally{i.f()}}else for(var o in e)r.push(e[o]);var l="".concat((t||["*"]).join(","),"=").concat(r.join(",")),c=this._returnDistinctMap.get(l)||0;return this._returnDistinctMap.set(l,++c),c>1?null:e}}]),e}(),re=r(34311),ne=function(){function e(t,r,n){(0,l.Z)(this,e),this.items=t,this.query=r,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.fieldsIndex=n.fieldsIndex,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.featureAdapter=n.featureAdapter}return(0,o.Z)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(){var e=new te(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);var t=this.query,r=t.groupByFieldsForStatistics,n=t.having,i=t.outStatistics;if(!(null===r||void 0===r?void 0:r.length))return 1;var s,u=new Map,o=new Map,l=new Set,c=(0,a.Z)(i);try{for(c.s();!(s=c.n()).done;){var f=s.value,h="exceedslimit"!==f.statisticType?f.onStatisticField:void 0;if(!o.has(h)){var p,d=[],y=(0,a.Z)(r);try{for(y.s();!(p=y.n()).done;){var v=p.value,m=this._getAttributeValues(e,v,u);d.push(m)}}catch(_){y.e(_)}finally{y.f()}o.set(h,this._calculateUniqueValues(d,e.returnDistinctValues))}var x=o.get(h);for(var g in x){var Z=x[g],b=Z.data,w=Z.items,F=b.join(",");n&&!e.validateItems(w,n)||l.add(F)}}}catch(_){c.e(_)}finally{c.f()}return l.size}},{key:"createQueryResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.query.outStatistics){e.next=11;break}if(!this.query.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))){e.next=5;break}e.t0=this._createExceedsLimitQueryResponse(this.query),e.next=8;break;case 5:return e.next=7,this._createStatisticsQueryResponse(this.query);case 7:e.t0=e.sent;case 8:t=e.t0,e.next=12;break;case 11:t=this._createFeatureQueryResponse(this.query);case 12:return this.query.returnQueryGeometry&&(r=this.query.geometry,(0,_.JY)(this.query.outSR)&&!(0,_.fS)(r.spatialReference,this.query.outSR)?t.queryGeometry=(0,L.S2)((0,i.Z)({spatialReference:this.query.outSR},(0,U.iV)(r,r.spatialReference,this.query.outSR))):t.queryGeometry=(0,L.S2)((0,i.Z)({spatialReference:this.query.outSR},r))),e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,i=ae(this.hasZ,this.hasM),s=e.point,u=e.mode,o="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,c={candidates:[]},f="esriGeometryPolygon"===this.geometryType,h=this._getPointCreator(u,this.spatialReference,t),p=new se(null,0),d=new se(null,0),y={x:0,y:0,z:0},v=(0,a.Z)(this.items);try{for(v.s();!(r=v.n()).done;){var m=r.value,x=n.getGeometry(m);if(null!=x){var g=x.coords,Z=x.lengths;if(p.coords=g,d.coords=g,e.returnEdge)for(var b=0,w=0;w<Z.length;w++)for(var F=Z[w],_=0;_<F;_++,b+=i){var k=p;if(k.coordsIndex=b,_!==F-1){var S=d;S.coordsIndex=b+i;var I=y;ie(y,s,k,S);var R=(s.x-I.x)/o,T=(s.y-I.y)/l,A=R*R+T*T;A<=1&&c.candidates.push((0,re.p)(n.getObjectId(m),h(I),Math.sqrt(A),h(k),h(S)))}}if("none"!==e.vertexMode){var M=f?g.length-i:g.length;if("all"===e.vertexMode)for(var C=0;C<M;C+=i){var E=p;E.coordsIndex=C;var N=(s.x-E.x)/o,Q=(s.y-E.y)/l,V=N*N+Q*Q;V<=1&&c.candidates.push((0,re.u)(n.getObjectId(m),h(E),Math.sqrt(V)))}else if("ends"===e.vertexMode){var q=[0];f||q.push(g.length-i);for(var z=0,D=q;z<D.length;z++){var P=D[z],G=p;G.coordsIndex=P;var O=(s.x-G.x)/o,j=(s.y-G.y)/l,B=O*O+j*j;B<=1&&c.candidates.push((0,re.u)(n.getObjectId(m),h(G),Math.sqrt(B)))}}}}}}catch(L){v.e(L)}finally{v.f()}return c.candidates.sort((function(e,t){return e.distance-t.distance})),c}},{key:"_getPointCreator",value:function(e,t,r){var n=null==r||(0,_.fS)(t,r)?function(e){return e}:function(e){return(0,U.iV)(e,t,r)},i=this.hasZ;return"3d"===e?i?function(e){var t=e.x,r=e.y,i=e.z;return n({x:t,y:r,z:i})}:function(e){var t=e.x,r=e.y;return n({x:t,y:r,z:0})}:function(e){var t=e.x,r=e.y;return n({x:t,y:r})}}},{key:"createSummaryStatisticsResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i,a,u,o,l,c,f,h,p,d,y,v,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.field,n=t.valueExpression,i=t.normalizationField,a=t.normalizationType,u=t.normalizationTotal,o=t.minValue,l=t.maxValue,c=t.scale,f=t.timeZone,h=this.fieldsIndex.get(r),p=(0,J.y2)(h)||(0,J.UQ)(h)||(0,J.ig)(h),e.next=13,this._getDataValues({field:r,valueExpression:n,normalizationField:i,normalizationType:a,normalizationTotal:u,scale:c,timeZone:f});case 13:return d=e.sent,y=(0,K.S5)({normalizationType:a,normalizationField:i,minValue:o,maxValue:l}),v={value:.5,fieldType:null===h||void 0===h?void 0:h.type},m=(0,J.qN)(h)?(0,K.H0)({values:d,supportsNullCount:y,percentileParams:v}):(0,K.i5)({values:d,minValue:o,maxValue:l,useSampleStdDev:!a,supportsNullCount:y,percentileParams:v}),e.abrupt("return",(0,K.F_)(m,p));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createUniqueValuesResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i,a,u,o,l,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.field,n=t.valueExpression,i=t.domains,a=t.returnAllCodedValues,u=t.scale,o=t.timeZone,e.next=8,this._getDataValues({field:r,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,valueExpression:n,scale:u,timeZone:o},!1);case 8:return l=e.sent,c=(0,K.eT)(l),e.abrupt("return",(0,K.Qm)(c,i,a,t.fieldDelimiter));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createClassBreaksResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i,a,u,o,l,c,f,h,p,d,y,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.field,n=t.valueExpression,i=t.normalizationField,a=t.normalizationType,u=t.normalizationTotal,o=t.classificationMethod,l=t.standardDeviationInterval,c=t.minValue,f=t.maxValue,h=t.numClasses,p=t.scale,d=t.timeZone,e.next=14,this._getDataValues({field:r,valueExpression:n,normalizationField:i,normalizationType:a,normalizationTotal:u,scale:p,timeZone:d});case 14:return y=e.sent,v=(0,K.G2)(y,{field:r,normalizationField:i,normalizationType:a,normalizationTotal:u,classificationMethod:o,standardDeviationInterval:l,minValue:c,maxValue:f,numClasses:h}),e.abrupt("return",(0,K.DL)(v,o));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createHistogramResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i,a,u,o,l,c,f,h,p,d,y;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.field,n=t.valueExpression,i=t.normalizationField,a=t.normalizationType,u=t.normalizationTotal,o=t.classificationMethod,l=t.standardDeviationInterval,c=t.minValue,f=t.maxValue,h=t.numBins,p=t.scale,d=t.timeZone,e.next=14,this._getDataValues({field:r,valueExpression:n,normalizationField:i,normalizationType:a,normalizationTotal:u,scale:p,timeZone:d});case 14:return y=e.sent,e.abrupt("return",(0,K.oF)(y,{field:r,normalizationField:i,normalizationType:a,normalizationTotal:u,classificationMethod:o,standardDeviationInterval:l,minValue:c,maxValue:f,numBins:h}));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&null!==t&&void 0!==t&&t.length){var i,s=(0,a.Z)(t.reverse());try{var u=function(){var t=i.value.split(" "),a=t[0],s=n.fieldsIndex.get(a),u=!!t[1]&&"desc"===t[1].toLowerCase(),o=(0,K.Lq)(null===s||void 0===s?void 0:s.type,u);e.sort((function(e,t){var n=r(e,a,s),i=r(t,a,s);return o(n,i)}))};for(s.s();!(i=s.n()).done;)u()}catch(o){s.e(o)}finally{s.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,o=e.outFields,l=e.outSR,c=e.quantizationParameters,f=e.resultRecordCount,h=e.resultOffset,p=e.returnZ,d=e.returnM,y=null!=f&&r.length>(h||0)+f,v=o&&(o.includes("*")?(0,S.Z)(this.fieldsIndex.fields):o.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:y,features:this._createFeatures(e,r),fields:v,geometryType:n,hasM:i&&d,hasZ:a&&p,objectIdFieldName:s,spatialReference:(0,L.S2)(l||u),transform:c&&(0,H.vY)(c)||null}}},{key:"_createFeatures",value:function(e,t){var r=new te(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,i=this.hasZ,s=e.orderByFields,u=e.quantizationParameters,o=e.returnGeometry,l=e.returnCentroid,c=e.maxAllowableOffset,f=e.resultOffset,h=e.resultRecordCount,p=e.returnZ,d=void 0!==p&&p,y=e.returnM,v=i&&d,m=n&&(void 0!==y&&y),x=[],g=0,Z=(0,S.Z)(t);if(this._sortFeatures(Z,s,(function(e,t,n){return r.getFieldValue(e,t,n)})),this.geometryType&&(o||l)){var b,w=null!==(b=(0,H.vY)(u))&&void 0!==b?b:void 0,F="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(o&&!l){var _,k=(0,a.Z)(Z);try{for(k.s();!(_=k.n()).done;){var I=_.value,R=this.featureAdapter.getGeometry(I),T={attributes:r.getAttributes(I),geometry:(0,L.Op)(this.geometryType,this.hasZ,this.hasM,R,c,w,v,m)};F&&R&&!T.geometry&&(T.centroid=(0,L.EG)(this,this.featureAdapter.getCentroid(I,this),w)),x[g++]=T}}catch(O){k.e(O)}finally{k.f()}}else if(!o&&l){var A,M=(0,a.Z)(Z);try{for(M.s();!(A=M.n()).done;){var C=A.value;x[g++]={attributes:r.getAttributes(C),centroid:(0,L.EG)(this,this.featureAdapter.getCentroid(C,this),w)}}}catch(O){M.e(O)}finally{M.f()}}else{var E,N=(0,a.Z)(Z);try{for(N.s();!(E=N.n()).done;){var Q=E.value;x[g++]={attributes:r.getAttributes(Q),centroid:(0,L.EG)(this,this.featureAdapter.getCentroid(Q,this),w),geometry:(0,L.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Q),c,w,v,m)}}}catch(O){N.e(O)}finally{N.f()}}}else{var V,q=(0,a.Z)(Z);try{for(q.s();!(V=q.n()).done;){var z=V.value,D=r.getAttributes(z);D&&(x[g++]={attributes:D})}}catch(O){q.e(O)}finally{q.f()}}var P=f||0;if(null!=h){var G=P+h;x=x.slice(P,Math.min(x.length,G))}return x}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r,n=!1,i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,o=(0,a.Z)(null!==(t=e.outStatistics)&&void 0!==t?t:[]);try{for(o.s();!(r=o.n()).done;){var l=r.value;if("exceedslimit"===l.statisticType){i=null!=l.maxPointCount?l.maxPointCount:Number.POSITIVE_INFINITY,s=null!=l.maxRecordCount?l.maxRecordCount:Number.POSITIVE_INFINITY,u=null!=l.maxVertexCount?l.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(h){o.e(h)}finally{o.f()}if("esriGeometryPoint"===this.geometryType)n=this.items.length>i;else if(this.items.length>s)n=!0;else{var c=ae(this.hasZ,this.hasM),f=this.featureAdapter;n=this.items.reduce((function(e,t){var r=f.getGeometry(t);return e+(null!=r&&r.coords.length||0)}),0)/c>u}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(n)}}]}}},{key:"_createStatisticsQueryResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i,u,o,l,c,f,h,p,d,y,v,m,x,g,Z,b,w,F,_,k,S,I,R,T,A,M,C,E,N,Q,V,q,z,D,P,G,O,j,B,L,U,X=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={attributes:{}},n=[],i=new Map,u=new Map,o=new Map,l=new Map,c=new te(t,this.featureAdapter,this.fieldsIndex),f=t.outStatistics,h=t.groupByFieldsForStatistics,p=t.having,d=t.orderByFields,y=t.resultRecordCount,v=null===h||void 0===h?void 0:h.length,x=(m=!!v)?h[0]:null,g=m&&!this.fieldsIndex.get(x),Z=(0,a.Z)(null!==f&&void 0!==f?f:[]),e.prev=2,Z.s();case 4:if((b=Z.n()).done){e.next=38;break}if(F=b.value,_=F.outStatisticFieldName,k=F.statisticType,S=F,I="exceedslimit"!==k?F.onStatisticField:void 0,R="percentile_disc"===k||"percentile_cont"===k,T="EnvelopeAggregate"===k||"CentroidAggregate"===k||"ConvexHullAggregate"===k,A=m&&1===v&&(I===x||g)&&"count"===k,!m){e.next=22;break}if(!o.has(I)){M=[],C=(0,a.Z)(h);try{for(C.s();!(E=C.n()).done;)N=E.value,Q=this._getAttributeValues(c,N,i),M.push(Q)}catch($){C.e($)}finally{C.f()}o.set(I,this._calculateUniqueValues(M,!T&&c.returnDistinctValues))}if(V=o.get(I)){e.next=12;break}return e.abrupt("continue",36);case 12:q=Object.keys(V),z=(0,s.Z)().mark((function e(){var t,r,n,a,u,o,f,d,y,v,m,x,g,Z,b;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=P[D],r=V[t],n=r.count,a=r.data,u=r.items,o=r.itemPositions,f=a.join(","),p&&!c.validateItems(u,p)){e.next=19;break}if(d=l.get(f)||{attributes:{}},!T){e.next=14;break}return d.aggregateGeometries||(d.aggregateGeometries={}),e.next=8,X._getAggregateGeometry(S,u);case 8:y=e.sent,v=y.aggregateGeometries,m=y.outStatisticFieldName,d.aggregateGeometries[m]=v,e.next=17;break;case 14:x=null,A?x=n:(g=X._getAttributeValues(c,I,i),Z=o.map((function(e){return g[e]})),x=R&&"statisticParameters"in S?X._getPercentileValue(S,Z):X._getStatisticValue(S,Z,null,c.returnDistinctValues)),d.attributes[_]=x;case 17:b=0,h.forEach((function(e,t){return d.attributes[X.fieldsIndex.get(e)?e:"EXPR_"+ ++b]=a[t]})),l.set(f,d);case 19:case"end":return e.stop()}}),e)})),D=0,P=q;case 15:if(!(D<P.length)){e.next=20;break}return e.delegateYield(z(),"t0",17);case 17:D++,e.next=15;break;case 20:e.next=34;break;case 22:if(!T){e.next=32;break}return r.aggregateGeometries||(r.aggregateGeometries={}),e.next=26,this._getAggregateGeometry(S,this.items);case 26:G=e.sent,O=G.aggregateGeometries,j=G.outStatisticFieldName,r.aggregateGeometries[j]=O,e.next=34;break;case 32:B=this._getAttributeValues(c,I,i),r.attributes[_]=R&&"statisticParameters"in S?this._getPercentileValue(S,B):this._getStatisticValue(S,B,u,c.returnDistinctValues);case 34:L="min"!==k&&"max"!==k||!(0,J.qN)(this.fieldsIndex.get(I))&&!this._isAnyDateField(I)?null:null===(w=this.fieldsIndex.get(I))||void 0===w?void 0:w.type,n.push({name:_,alias:_,type:L||"esriFieldTypeDouble"});case 36:e.next=4;break;case 38:e.next=43;break;case 40:e.prev=40,e.t1=e.catch(2),Z.e(e.t1);case 43:return e.prev=43,Z.f(),e.finish(43);case 46:return U=m?Array.from(l.values()):[r],e.abrupt("return",(this._sortFeatures(U,d,(function(e,t){return e.attributes[t]})),y&&(U.length=Math.min(y,U.length)),{fields:n,features:U}));case 48:case"end":return e.stop()}}),e,this,[[2,40,43,46]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAnyDateField",value:function(e){var t=this.fieldsIndex.get(e);return(0,J.y2)(t)||(0,J.UQ)(t)||(0,J.ig)(t)||(0,J.sX)(t)}},{key:"_getAggregateGeometry",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var a,u,o,l,c,f,h,p,d,y,v,m,x,g,Z;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(99058),r.e(18241)]).then(r.bind(r,50309));case 2:return a=e.sent,u=a.convexHull,o=a.union,l=t.statisticType,c=t.outStatisticFieldName,f=this.featureAdapter,h=this.spatialReference,p=this.geometryType,d=this.hasZ,y=this.hasM,v=n.map((function(e){return(0,L.Op)(p,d,y,f.getGeometry(e))})),m=u(h,v,!0)[0],x={aggregateGeometries:null,outStatisticFieldName:null},"EnvelopeAggregate"===l?(g=m?(0,W._w)(m):(0,W.aO)(o(h,v)),x.aggregateGeometries=(0,i.Z)((0,i.Z)({},g),{},{spatialReference:h}),x.outStatisticFieldName=c||"extent"):"CentroidAggregate"===l?(Z=m?(0,$.tO)(m):(0,$.$G)((0,W.aO)(o(h,v))),x.aggregateGeometries={x:Z[0],y:Z[1],spatialReference:h},x.outStatisticFieldName=c||"centroid"):"ConvexHullAggregate"===l&&(x.aggregateGeometries=m,x.outStatisticFieldName=c||"convexHull"),e.abrupt("return",x);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getStatisticValue",value:function(e,t,r,n){var i,a=e.onStatisticField,s=e.statisticType;return i=null!==r&&void 0!==r&&r.has(a)?r.get(a):(0,J.qN)(this.fieldsIndex.get(a))||this._isAnyDateField(a)?(0,K.H0)({values:t,returnDistinct:n}):(0,K.i5)({values:n?(0,S.Z)(new Set(t)):t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(a,i),i["var"===s?"variance":s]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s=n.orderBy,u=this.fieldsIndex.get(r);return(0,K.XL)(t,{value:a,orderBy:s,fieldType:null===u||void 0===u?void 0:u.type,isDiscrete:"percentile_disc"===i})}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,i=n.length,s=0;s<i;s++){var u,o=n[s],l=[],c=(0,a.Z)(e);try{for(c.s();!(u=c.n()).done;){var f=u.value;l.push(f[s])}}catch(p){c.e(p)}finally{c.f()}var h=l.join(",");null==r[h]?r[h]={count:1,data:l,items:[o],itemPositions:[s]}:(t||r[h].count++,r[h].items.push(o),r[h].itemPositions.push(s))}return r}},{key:"_getDataValues",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i,a,u,o=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(o.length>1&&void 0!==o[1])||o[1],n=new te(this.query,this.featureAdapter,this.fieldsIndex),i=t.valueExpression,a=t.scale,u=t.timeZone,e.abrupt("return",i?n.getExpressionValues(this.items,i,{viewingMode:"map",scale:a,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},u):n.getDataValues(this.items,(0,p.d9)(t),r));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function ie(e,t,r,n){var i=n.x-r.x,a=n.y-r.y,s=i*i+a*a,u=(t.x-r.x)*i+(t.y-r.y)*a,o=Math.min(1,Math.max(0,u/s));e.x=r.x+i*o,e.y=r.y+a*o}function ae(e,t){return e?t?4:3:t?3:2}var se=function(){function e(t,r){(0,l.Z)(this,e),this.coords=t,this.coordsIndex=r}return(0,o.Z)(e,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]),e}(),ue=r(20994),oe=r(77095),le="unsupported-query";function ce(e,t){return fe.apply(this,arguments)}function fe(){return fe=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,a,u,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.fieldsIndex,a=r.geometryType,u=r.spatialReference,o=r.availableFields,!((null!==(n=t.distance)&&void 0!==n?n:0)<0||null!=t.geometryPrecision||t.multipatchOption&&"xyFootprint"!==t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=3;break}throw new f.Z(le,"Unsupported query options",{query:t});case 3:return e.abrupt("return",(he(i,o,t),de(i,o,t),Promise.all([(0,oe.P0)(t,a,u),(0,U._W)(u,t.outSR)]).then((function(){return t}))));case 4:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}function he(e,t,r){var n=r.outFields,i=r.orderByFields,a=r.returnDistinctValues,s=r.outStatistics,u=s?s.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})).filter(Boolean):[];if(i&&i.length>0){var o=" asc",l=" desc",c=i.map((function(e){var t=e.toLowerCase();return t.includes(o)?t.split(o)[0]:t.includes(l)?t.split(l)[0]:e})).filter((function(e){return!u.includes(e)}));O(e,t,c,{expressionName:"orderByFields",query:r})}if(n&&n.length>0)O(e,t,n,{expressionName:"outFields",query:r,allowedFieldTypes:"all"});else if(a)throw new f.Z(le,"outFields should be specified for returnDistinctValues",{query:r});!function(e,t,r,n){if(!r)return!0;var i="where clause";O(e,t,q(e,r,{validateStandardized:!0,expressionName:i}),{expressionName:i,query:n})}(e,t,r.where,r)}var pe=new Set([].concat((0,S.Z)(N),(0,S.Z)(Q)));function de(e,t,r){var n=r.outStatistics,i=r.groupByFieldsForStatistics,s=r.having,u=null===i||void 0===i?void 0:i.length,o=null===n||void 0===n?void 0:n.length;if(s){if(!u||!o)throw new f.Z(le,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});z(e,t,s,n,r)}if(o){if(!function(e){return null!=e&&e.every((function(e){return"exceedslimit"!==e.statisticType}))}(n))return;O(e,t,n.map((function(e){return e.onStatisticField})).filter(Boolean),{expressionName:"onStatisticFields",query:r}),u&&O(e,t,i,{expressionName:"groupByFieldsForStatistics",query:r});var l,c=(0,a.Z)(n);try{for(c.s();!(l=c.n()).done;){var h=l.value,p=h.onStatisticField,d=h.statisticType;if("percentile_disc"!==d&&"percentile_cont"!==d||!("statisticParameters"in h))e.get(p)&&"count"!==d&&"min"!==d&&"max"!==d&&O(e,t,[p],{expressionName:"outStatistics with '".concat(d,"' statistic type"),allowedFieldTypes:pe,query:r});else if(!h.statisticParameters)throw new f.Z(le,"statisticParameters should be set for percentile type",{definition:h,query:r})}}catch(y){c.e(y)}finally{c.f()}}}function ye(e,t,r){return ve.apply(this,arguments)}function ve(){return ve=(0,u.Z)((0,s.Z)().mark((function e(t,r,n){var i,a,u,o,l;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.fieldsIndex,u=n.geometryType,o=n.spatialReference,l=n.availableFields,!((null!==(i=t.distance)&&void 0!==i?i:0)<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=3;break}throw new f.Z(le,"Unsupported query options",{query:t});case 3:return e.abrupt("return",(he(a,l,t),Promise.all([me(a,l,r,t),(0,oe.P0)(t,u,o),(0,U._W)(o,t.outSR)]).then((function(){return t}))));case 4:case"end":return e.stop()}}),e)}))),ve.apply(this,arguments)}function me(e,t,r,n){return xe.apply(this,arguments)}function xe(){return xe=(0,u.Z)((0,s.Z)().mark((function e(t,r,n,i){var a,u,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],!n.valueExpression){e.next=7;break}return e.next=4,(0,ee.LC)();case 4:u=e.sent,o=u.arcadeUtils,a=o.extractFieldNames(n.valueExpression);case 7:if(n.field&&a.push(n.field),n.field2&&a.push(n.field2),n.field3&&a.push(n.field3),n.normalizationField&&a.push(n.normalizationField),a.length||n.valueExpression){e.next=9;break}throw new f.Z(le,"field or valueExpression is required",{params:n});case 9:O(t,r,a,{expressionName:"statistics",query:i});case 10:case"end":return e.stop()}}),e)}))),xe.apply(this,arguments)}var ge=r(20311),Ze=r(52410),be=r(93463),we=new y.WJ(2e6),Fe=0,_e=function(){function e(t){var r=this;(0,l.Z)(this,e),this._geometryQueryCache=null,this._changeHandle=null,this.capabilities={query:X.g},this.geometryType=t.geometryType,this.hasM=!!t.hasM,this.hasZ=!!t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new y.Xq(Fe+++"$$",we)),this.fieldsIndex=(0,h.AK)(t.fieldsIndex)?t.fieldsIndex:Ze.Z.fromJSON(t.fieldsIndex),!t.availableFields||1===t.availableFields.length&&"*"===t.availableFields[0]?this.availableFields=new Set(this.fieldsIndex.fields.map((function(e){return e.name}))):this.availableFields=new Set(t.availableFields.map((function(e){var t;return null===(t=r.fieldsIndex.get(e))||void 0===t?void 0:t.name})).filter((function(e){return null!=e}))),t.scheduler&&t.priority&&(this._frameTask=t.scheduler.registerTask(t.priority))}return(0,o.Z)(e,[{key:"destroy",value:function(){this._frameTask=(0,d.hw)(this._frameTask),this.clearCache(),(0,d.SC)(this._geometryQueryCache),this._changeHandle=(0,d.hw)(this._changeHandle)}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"clearCache",value:function(){var e;null!==(e=this._geometryQueryCache)&&void 0!==e&&e.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null,this._fullExtentPromise=null}},{key:"executeQuery",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,v.$h)(r),e.prev=1,e.next=4,this._executeQuery(t,{},n);case 4:return e.abrupt("return",e.sent.createQueryResponse());case 7:if(e.prev=7,e.t0=e.catch(1),e.t0===ue.Ti){e.next=11;break}throw e.t0;case 11:return e.abrupt("return",new ne([],t,this).createQueryResponse());case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,n,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},r=i.length>1?i[1]:void 0,n=(0,v.$h)(r),e.prev=3,e.next=6,this._executeQuery(t,{returnGeometry:!1,returnCentroid:!1,outSR:null},n);case 6:return e.abrupt("return",e.sent.createQueryResponseForCount());case 9:if(e.prev=9,e.t0=e.catch(3),e.t0===ue.Ti){e.next=13;break}throw e.t0;case 13:return e.abrupt("return",0);case 14:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,v.$h)(r),i=t.outSR,e.prev=1,e.next=4,this._executeQuery(t,{returnGeometry:!0,returnCentroid:!1,outSR:null},n);case 4:if(a=e.sent,u=a.size){e.next=8;break}return e.abrupt("return",{count:0,extent:null});case 8:return e.t0=u,e.next=11,this._getBounds(a.items,a.spatialReference,i||this.spatialReference);case 11:return e.t1=e.sent,e.abrupt("return",{count:e.t0,extent:e.t1});case 15:if(e.prev=15,e.t2=e.catch(1),e.t2!==ue.Ti){e.next=19;break}return e.abrupt("return",{count:0,extent:null});case 19:throw e.t2;case 20:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForIdSet",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,u,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,v.$h)(r),e.prev=1,e.next=4,this._executeQuery(t,{returnGeometry:!0,returnCentroid:!1,outSR:null},n);case 4:return i=e.sent,u=i.items,o=new Set,e.next=9,this._reschedule((function(){var e,t=(0,a.Z)(u);try{for(t.s();!(e=t.n()).done;){var r=e.value;o.add(i.featureAdapter.getObjectId(r))}}catch(n){t.e(n)}finally{t.f()}}),n);case 9:return e.abrupt("return",o);case 12:if(e.prev=12,e.t0=e.catch(1),e.t0!==ue.Ti){e.next=16;break}return e.abrupt("return",new Set);case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForSnapping",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,a,u,o,l,c,f,h,d,y,m,x,g,Z,b,k,S,I=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,v.$h)(r),a=t.point,u=t.distance,o=t.returnEdge,l=t.vertexMode,o||"none"!==l){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return c=(0,p.d9)(t.query),e.next=6,this._schedule((function(){return(0,ue.j6)(c,I.definitionExpression,I.spatialReference)}),n);case 6:return c=e.sent,e.next=9,this._reschedule((function(){return ce(c,{availableFields:I.availableFields,fieldsIndex:I.fieldsIndex,geometryType:I.geometryType,spatialReference:I.spatialReference})}),n);case 9:if(c=e.sent,f=!(0,_.fS)(a.spatialReference,this.spatialReference),e.t0=f,!e.t0){e.next=15;break}return e.next=15,(0,U._W)(a.spatialReference,this.spatialReference);case 15:if(h="number"==typeof u?u:u.x,d="number"==typeof u?u:u.y,y={xmin:a.x-h,xmax:a.x+h,ymin:a.y-d,ymax:a.y+d,spatialReference:a.spatialReference},m=f?(0,U.iV)(y,this.spatialReference):y){e.next=18;break}return e.abrupt("return",{candidates:[]});case 18:return e.next=20,(0,F.aX)((0,w.im)(a),null,{signal:n});case 20:return x=e.sent[0],e.next=23,(0,F.aX)((0,w.im)(m),null,{signal:n});case 23:if(g=e.sent[0],null!=x&&null!=g){e.next=26;break}return e.abrupt("return",{candidates:[]});case 26:return e.t1=ne,e.next=29,this._reschedule((function(){return I._searchFeatures(ke(g.toJSON()))}),n);case 29:return e.t2=e.sent,e.t3=c,e.t4=this,Z=new e.t1(e.t2,e.t3,e.t4),e.next=35,this._reschedule((function(){return I._executeObjectIdsQuery(Z)}),n);case 35:return e.next=37,this._reschedule((function(){return I._executeTimeQuery(Z)}),n);case 37:return e.next=39,this._reschedule((function(){return I._executeAttributesQuery(Z)}),n);case 39:return e.next=41,this._reschedule((function(){return I._executeGeometryQueryForSnapping(Z,n)}),n);case 41:return b=x.toJSON(),k=f?(0,U.iV)(b,this.spatialReference):b,S=f?Math.max(m.xmax-m.xmin,m.ymax-m.ymin)/2:u,e.abrupt("return",Z.createSnappingResponse((0,i.Z)((0,i.Z)({},t),{},{point:k,distance:S}),a.spatialReference));case 43:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,a,u=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(0,v.$h)(r),null!==(n=this.timeInfo)&&void 0!==n&&n.trackIdField){e.next=3;break}throw new f.Z("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 3:return e.prev=3,e.next=6,this._executeQuery(t,{},i);case 6:return a=e.sent,e.next=9,this._reschedule((function(){return u._filterLatest(a)}),i);case 9:return e.abrupt("return",a.createQueryResponse());case 12:if(e.prev=12,e.t0=e.catch(3),e.t0===ue.Ti){e.next=16;break}throw e.t0;case 16:return e.abrupt("return",new ne([],t,this).createQueryResponse());case 17:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"executeQueryForSummaryStatistics",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,n,i,a,u,o,l=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1?l[1]:void 0,n=l.length>2?l[2]:void 0,i=(0,v.$h)(n),a=r.field,u=r.normalizationField,o=r.valueExpression,e.next=6,this._executeQueryForStatistics(t,{field:a,normalizationField:u,valueExpression:o},i);case 6:return e.abrupt("return",e.sent.createSummaryStatisticsResponse(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForUniqueValues",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,n,i,a,u,o,l,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=c.length>1?c[1]:void 0,n=c.length>2?c[2]:void 0,i=(0,v.$h)(n),a=r.field,u=r.field2,o=r.field3,l=r.valueExpression,e.next=6,this._executeQueryForStatistics(t,{field:a,field2:u,field3:o,valueExpression:l},i);case 6:return e.abrupt("return",e.sent.createUniqueValuesResponse(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForClassBreaks",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,n,i,a,u,o,l=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1?l[1]:void 0,n=l.length>2?l[2]:void 0,i=(0,v.$h)(n),a=r.field,u=r.normalizationField,o=r.valueExpression,e.next=6,this._executeQueryForStatistics(t,{field:a,normalizationField:u,valueExpression:o},i);case 6:return e.abrupt("return",e.sent.createClassBreaksResponse(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForHistogram",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,n,i,a,u,o,l=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},r=l.length>1?l[1]:void 0,n=l.length>2?l[2]:void 0,i=(0,v.$h)(n),a=r.field,u=r.normalizationField,o=r.valueExpression,e.next=6,this._executeQueryForStatistics(t,{field:a,normalizationField:u,valueExpression:o},i);case 6:return e.abrupt("return",e.sent.createHistogramResponse(r));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchRecomputedExtents",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,i,a,u,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,v.$h)(t),this._timeExtentPromise||(this._timeExtentPromise=(0,ge.R)(this.timeInfo,this.featureStore)),e.next=4,Promise.all([this._getFullExtent(),this._timeExtentPromise]);case 4:return i=e.sent,a=(0,n.Z)(i,2),u=a[0],o=a[1],e.abrupt("return",((0,v.k_)(r),{fullExtent:u,timeExtent:o}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getBounds",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r,n){var i,a,u,o,l,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,g.t8)((0,g.Ue)(),g.G_),e.next=3,this.featureStore.forEachBounds(t,(function(e){return(0,g.TC)(i,e)}));case 3:return a={xmin:i[0],ymin:i[1],xmax:i[3],ymax:i[4],spatialReference:(0,L.S2)(this.spatialReference)},this.hasZ&&isFinite(i[2])&&isFinite(i[5])&&(a.zmin=i[2],a.zmax=i[5],a.hasZ=!0),(u=(0,U.iV)(a,r,n)).spatialReference=(0,L.S2)(n),u.xmax-u.xmin==0&&(o=(0,m.c9)(u.spatialReference),u.xmin-=o,u.xmax+=o),u.ymax-u.ymin==0&&(l=(0,m.c9)(u.spatialReference),u.ymin-=l,u.ymax+=l),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(c=(0,m.c9)(u.spatialReference),u.zmin-=c,u.zmax+=c),e.abrupt("return",u);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getFullExtent",value:function(){var e=this;return this._fullExtentPromise||(this._fullExtentPromise="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then((function(t){return e._getBounds(t,e.spatialReference,e.spatialReference)}))),this._fullExtentPromise}},{key:"_schedule",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!=this._frameTask?this._frameTask.schedule(t,r):t(be.G5));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_reschedule",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!=this._frameTask?this._frameTask.reschedule(t,r):t(be.G5));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getAllFeaturesQueryEngineResult",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ne,e.next=3,this._getAllFeatures();case 3:return e.t1=e.sent,e.t2=t,e.t3=this,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getAllFeatures",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r,n,i=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this._allFeaturesPromise&&(t=[],this._allFeaturesPromise=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.featureStore.forEach((function(e){return t.push(e)}));case 2:case"end":return e.stop()}}),e)})))().then((function(){return t}))),r=this._allFeaturesPromise,e.next=4,r;case 4:return n=e.sent,e.abrupt("return",r===this._allFeaturesPromise?n.slice():this._getAllFeatures());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_executeQuery",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r,n){var a,u,o=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,p.d9)(t),e.next=3,this._schedule((function(){return(0,ue.Up)(t,o.definitionExpression,o.spatialReference)}),n);case 3:return t=e.sent,e.next=6,this._reschedule((function(){return ce(t,{availableFields:o.availableFields,fieldsIndex:o.fieldsIndex,geometryType:o.geometryType,spatialReference:o.spatialReference})}),n);case 6:return t=e.sent,t=(0,i.Z)((0,i.Z)({},t),r),e.next=10,this._reschedule((function(){return o._executeSceneFilterQuery(t,n)}),n);case 10:return a=e.sent,e.next=13,this._reschedule((function(){return o._executeGeometryQuery(t,a,n)}),n);case 13:return u=e.sent,e.next=16,this._reschedule((function(){return o._executeAggregateIdsQuery(u)}),n);case 16:return e.next=18,this._reschedule((function(){return o._executeObjectIdsQuery(u)}),n);case 18:return e.next=20,this._reschedule((function(){return o._executeTimeQuery(u)}),n);case 20:return e.next=22,this._reschedule((function(){return o._executeAttributesQuery(u)}),n);case 22:return e.abrupt("return",u);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_executeSceneFilterQuery",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,o,l,c,f,h,p,d,y,v,m,x,g,Z,b,w,F,k=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.sceneFilter){e.next=2;break}return e.abrupt("return",null);case 2:if(n=t.outSR,i=t.returnGeometry,o=t.returnCentroid,l=this.featureStore.featureSpatialReference,c=t.sceneFilter.geometry,f=null==l||(0,_.fS)(l,c.spatialReference)?c:(0,U.iV)(c,l)){e.next=5;break}return e.abrupt("return",null);case 5:return h=i||o,p=(0,_.JY)(n)&&!(0,_.fS)(this.spatialReference,n)&&h?function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",k._project(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():function(e){return e},d=this.featureAdapter,e.next=10,this._reschedule((function(){return k._searchFeatures(ke(f))}),r);case 10:if(y=e.sent,"disjoint"!==t.sceneFilter.spatialRelationship){e.next=24;break}if(y.length){e.next=14;break}return e.abrupt("return",null);case 14:v=new Set,m=(0,a.Z)(y);try{for(m.s();!(x=m.n()).done;)g=x.value,v.add(d.getObjectId(g))}catch(S){m.e(S)}finally{m.f()}return e.next=19,this._reschedule((function(){return k._getAllFeatures()}),r);case 19:return Z=e.sent,e.next=22,this._reschedule((0,u.Z)((0,s.Z)().mark((function e(){var n,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,oe.cW)("esriSpatialRelDisjoint",f,k.geometryType,k.hasZ,k.hasM);case 2:return n=e.sent,i=function(e){return!v.has(d.getObjectId(e))||n(d.getGeometry(e))},e.next=6,k._runSpatialFilter(Z,i,r);case 6:return a=e.sent,e.abrupt("return",new ne(a,t,k));case 8:case"end":return e.stop()}}),e)}))),r);case 22:return b=e.sent,e.abrupt("return",p(b));case 24:if(y.length){e.next=26;break}return e.abrupt("return",new ne([],t,this));case 26:if(!this._canExecuteSinglePass(f,t)){e.next=28;break}return e.abrupt("return",p(new ne(y,t,this)));case 28:return e.next=30,(0,oe.cW)("esriSpatialRelContains",f,this.geometryType,this.hasZ,this.hasM);case 30:return w=e.sent,e.next=33,this._runSpatialFilter(y,(function(e){return w(d.getGeometry(e))}),r);case 33:return F=e.sent,e.abrupt("return",p(new ne(F,t,this)));case 35:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_executeGeometryQuery",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r,n){var i,o,l,f,h,p,d,y,v,m,x,g,Z,b,w,F,k,S,I,R,T,A,M,C,E,N=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r||0!==r.items.length){e.next=2;break}return e.abrupt("return",r);case 2:if(t=null!=r?r.query:t,o=(i=t).geometry,l=i.outSR,f=i.spatialRel,h=i.returnGeometry,p=i.returnCentroid,d=this.featureStore.featureSpatialReference,y=!o||null==d||(0,_.fS)(d,o.spatialReference)?o:(0,U.iV)(o,d),v=h||p,m=(0,_.JY)(l)&&!(0,_.fS)(this.spatialReference,l),x=this._geometryQueryCache&&null==r?m&&v?JSON.stringify({originalFilterGeometry:o,spatialRelationship:f,outSpatialReference:l}):JSON.stringify({originalFilterGeometry:o,spatialRelationship:f}):null,null==(g=x?this._geometryQueryCache.get(x):null)){e.next=6;break}return e.abrupt("return",new ne(g,t,this));case 6:if(Z=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=m&&v,!e.t0){e.next=4;break}return e.next=4,N._project(t,l);case 4:return x&&N._geometryQueryCache.put(x,t.items,t.items.length+1),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y){e.next=18;break}if(e.t0=Z,null==r){e.next=13;break}e.t1=r,e.next=16;break;case 13:return e.next=15,this._getAllFeaturesQueryEngineResult(t);case 15:e.t1=e.sent;case 16:return e.t2=e.t1,e.abrupt("return",(0,e.t0)(e.t2));case 18:return b=this.featureAdapter,e.next=21,this._reschedule((function(){return N._searchFeatures(ke(o))}),n);case 21:if(w=e.sent,"esriSpatialRelDisjoint"!==f){e.next=49;break}if(w.length){e.next=34;break}if(e.t3=Z,null==r){e.next=29;break}e.t4=r,e.next=32;break;case 29:return e.next=31,this._getAllFeaturesQueryEngineResult(t);case 31:e.t4=e.sent;case 32:return e.t5=e.t4,e.abrupt("return",(0,e.t3)(e.t5));case 34:F=new Set,k=(0,a.Z)(w);try{for(k.s();!(S=k.n()).done;)I=S.value,F.add(b.getObjectId(I))}catch(Q){k.e(Q)}finally{k.f()}if(null==r){e.next=41;break}e.t6=r.items,e.next=44;break;case 41:return e.next=43,this._reschedule((function(){return N._getAllFeatures()}),n);case 43:e.t6=e.sent;case 44:return R=e.t6,e.next=47,this._reschedule((0,u.Z)((0,s.Z)().mark((function e(){var r,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,oe.cW)(f,y,N.geometryType,N.hasZ,N.hasM);case 2:return r=e.sent,i=function(e){return!F.has(b.getObjectId(e))||r(b.getGeometry(e))},e.next=6,N._runSpatialFilter(R,i,n);case 6:return a=e.sent,e.abrupt("return",new ne(a,t,N));case 8:case"end":return e.stop()}}),e)}))),n);case 47:return T=e.sent,e.abrupt("return",Z(T));case 49:if(null!=r&&(A=new c.SO,w=w.filter((function(e){return(0,c.cq)(r.items,e,r.items.length,A)>=0}))),w.length){e.next=53;break}return M=new ne([],t,this),e.abrupt("return",(x&&this._geometryQueryCache.put(x,M.items,1),M));case 53:if(!this._canExecuteSinglePass(y,t)){e.next=55;break}return e.abrupt("return",Z(new ne(w,t,this)));case 55:return e.next=57,(0,oe.cW)(f,y,this.geometryType,this.hasZ,this.hasM);case 57:return C=e.sent,e.next=60,this._runSpatialFilter(w,(function(e){return C(b.getGeometry(e))}),n);case 60:return E=e.sent,e.abrupt("return",Z(new ne(E,t,this)));case 62:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_executeGeometryQueryForSnapping",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,a,u,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.query,a=i.spatialRel,null!==t&&void 0!==t&&null!==(n=t.items)&&void 0!==n&&n.length&&i.geometry&&a){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,oe.cW)(a,i.geometry,this.geometryType,this.hasZ,this.hasM);case 5:return u=e.sent,e.next=8,this._runSpatialFilter(t.items,(function(e){return u(e.geometry)}),r);case 8:o=e.sent,t.items=o;case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_executeAggregateIdsQuery",value:function(e){var t;if(0!==e.items.length&&null!==(t=e.query.aggregateIds)&&void 0!==t&&t.length&&null!=this.aggregateAdapter){var r,n=new Set,i=(0,a.Z)(e.query.aggregateIds);try{for(i.s();!(r=i.n()).done;){var s=r.value;this.aggregateAdapter.getFeatureObjectIds(s).forEach((function(e){return n.add(e)}))}}catch(o){i.e(o)}finally{i.f()}var u=this.featureAdapter.getObjectId;e.items=e.items.filter((function(e){return n.has(u(e))}))}}},{key:"_executeObjectIdsQuery",value:function(e){var t;if(0!==e.items.length&&null!==(t=e.query.objectIds)&&void 0!==t&&t.length){var r=new Set(e.query.objectIds),n=this.featureAdapter.getObjectId;e.items=e.items.filter((function(e){return r.has(n(e))}))}}},{key:"_executeTimeQuery",value:function(e){if(0!==e.items.length){var t=(0,ge.y)(this.timeInfo,e.query.timeExtent,this.featureAdapter);null!=t&&(e.items=e.items.filter(t))}}},{key:"_executeAttributesQuery",value:function(e){var t=this;if(0!==e.items.length){var r=D(e.query.where,this.fieldsIndex);if(r){if(!r.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter((function(e){return r.testFeature(e,t.featureAdapter)}))}}}},{key:"_runSpatialFilter",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r,n){var i,a,o,l=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(null!=this._frameTask){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return i=0,a=new Array,o=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(u){var c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t.length)){e.next=9;break}if(c=t[i++],r(c)&&(a.push(c),u.madeProgress()),e.t0=u.done,!e.t0){e.next=7;break}return e.next=7,l._reschedule((function(e){return o(e)}),n);case 7:e.next=0;break;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(e){return o(e)}),n).then((function(){return a})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_filterLatest",value:function(e){var t,r=this.timeInfo,n=r.trackIdField,i=r.startTimeField,s=r.endTimeField||i,u=new Map,o=this.featureAdapter.getAttribute,l=(0,a.Z)(e.items);try{for(l.s();!(t=l.n()).done;){var c=t.value,f=o(c,n),h=o(c,s),p=u.get(f);(!p||h>o(p,s))&&u.set(f,c)}}catch(d){l.e(d)}finally{l.f()}e.items=Array.from(u.values())}},{key:"_canExecuteSinglePass",value:function(e,t){var r=t.spatialRel;return(0,oe.hN)(e)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r))}},{key:"_project",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){var n,i,a,u,o=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!(0,_.fS)(this.spatialReference,r)){e.next=2;break}return e.abrupt("return",t);case 2:return n=this.featureAdapter,e.prev=3,e.next=6,this._getFullExtent();case 6:a=e.sent,i=(0,x.getTransformation)(this.spatialReference,r,a),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:return e.next=14,(0,U.oj)(t.items.map((function(e){return(0,L.Op)(o.geometryType,o.hasZ,o.hasM,n.getGeometry(e))})),this.spatialReference,r,i);case 14:return u=e.sent,e.abrupt("return",(t.items=u.map((function(e,r){return n.cloneWithGeometry(t.items[r],(0,k.GH)(e,o.hasZ,o.hasM))})),t));case 16:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_searchFeatures",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,n,i=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set,e.next=3,Promise.all(t.map((function(e){return i.featureStore.forEachInBounds(e,(function(e){return r.add(e)}))})));case 3:return n=Array.from(r.values()),e.abrupt("return",(r.clear(),n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_executeQueryForStatistics",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r,n){var i,a,u=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,p.d9)(t),e.prev=1,e.next=4,this._schedule((function(){return(0,ue.Up)(t,u.definitionExpression,u.spatialReference)}),n);case 4:return t=e.sent,e.next=7,this._reschedule((function(){return ye(t,r,{availableFields:u.availableFields,fieldsIndex:u.fieldsIndex,geometryType:u.geometryType,spatialReference:u.spatialReference})}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return u._executeSceneFilterQuery(t,n)}),n);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return u._executeGeometryQuery(t,i,n)}),n);case 13:return a=e.sent,e.next=16,this._reschedule((function(){return u._executeAggregateIdsQuery(a)}),n);case 16:return e.next=18,this._reschedule((function(){return u._executeObjectIdsQuery(a)}),n);case 18:return e.next=20,this._reschedule((function(){return u._executeTimeQuery(a)}),n);case 20:return e.next=22,this._reschedule((function(){return u._executeAttributesQuery(a)}),n);case 22:return e.abrupt("return",a);case 25:if(e.prev=25,e.t0=e.catch(1),e.t0===ue.Ti){e.next=29;break}throw e.t0;case 29:return e.abrupt("return",new ne([],t,this));case 30:case"end":return e.stop()}}),e,this,[[1,25]])})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}();function ke(e){if((0,oe.hN)(e)){if((0,w.YX)(e))return[(0,Z.al)(Math.min(e.xmin,e.xmax),Math.min(e.ymin,e.ymax),Math.max(e.xmin,e.xmax),Math.max(e.ymin,e.ymax))];if((0,w.oU)(e))return e.rings.map((function(e){return(0,Z.al)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[(0,b.$P)((0,Z.Ue)(),e)]}},60480:function(e,t,r){r.d(t,{g:function(){return n}});var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},77835:function(e,t,r){r.d(t,{n:function(){return s}});var n=r(85403),i=r(3182),a=r(80457),s={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new i.u_(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return null==e.centroid&&(e.centroid=(0,n.Y)(new a.Z,e.geometry,t.hasZ,t.hasM)),e.centroid}}},95281:function(e,t,r){r.d(t,{do:function(){return _},gq:function(){return b},qQ:function(){return w},yO:function(){return F}});var n=r(74165),i=r(1413),a=r(15861),s=r(37762),u=r(70804),o=(r(59486),r(10064),r(17842)),l=r(86710),c=r(78952),f=r(58971),h=r(92975),p=r(37270),d=r(27811),y=r(62734),v=r(71486),m=r(819),x=r(848),g=null,Z=(0,u.Z)(/^(([0-1][0-9])|([2][0-3])):([0-5][0-9])(:([0-5][0-9]))?([.](\d+))?$/,{hh:1,mm:4,ss:6,ms:8});function b(e,t,r,n){var i=(0,h.MP)(r)?(0,h.C5)(r):null,a=i?Math.round((i.valid[1]-i.valid[0])/t.scale[0]):null;return e.map((function(e){var r=new x.Z(e.geometry);return(0,f.RF)(t,r,r),e.geometry=i?function(e,t,r){return e.x<0?e.x+=t:e.x>r&&(e.x-=t),e}(r,null!==a&&void 0!==a?a:0,n[0]):r,e}))}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=new Float64Array(n*i);t=Math.round((0,o.F2)(t));var u,l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,f=(0,d.wx)(r),h=(0,s.Z)(e);try{for(h.s();!(u=h.n()).done;)for(var p=u.value,y=p.geometry,v=p.attributes,m=y.x,x=y.y,g=Math.max(0,m-t),Z=Math.max(0,x-t),b=Math.min(i,x+t),w=Math.min(n,m+t),F=+f(v),_=Z;_<b;_++)for(var k=g;k<w;k++){var S=_*n+k,I=(0,d.If)(k-m,_-x,t)*F,R=a[S]+=I;l=Math.min(l,R),c=Math.max(c,R)}}catch(T){h.e(T)}finally{h.f()}return{min:l,max:c}}function F(e){var t=Z.exec(e);if(!t)return null;var r=t.groups,n=r.hh,i=r.mm,a=r.ss,s=r.ms;return Number(n)*l.fM.hours+Number(i)*l.fM.minutes+Number(a)*l.fM.seconds+Number(s||0)}function _(e,t){return k.apply(this,arguments)}function k(){return k=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,s,u,o,l,f,h,d,x,Z,b,w,_,k,S,I,R,T,A,M,C,E,N=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(N.length>2&&void 0!==N[2])||N[2],r){e.next=3;break}return e.abrupt("return",[]);case 3:if(s=t.field,u=t.field2,o=t.field3,l=t.fieldDelimiter,f=t.fieldInfos,h=t.timeZone,d=s&&(null===f||void 0===f?void 0:f.find((function(e){return e.name.toLowerCase()===s.toLowerCase()}))),x=!!d&&(0,p.sX)(d),Z=!!d&&(0,y.a8)(d),b=t.valueExpression,w=t.normalizationType,_=t.normalizationField,k=t.normalizationTotal,S=[],I=t.viewInfoParams,R=null,T=null,!b){e.next=18;break}if(g){e.next=12;break}return e.next=9,(0,m.LC)();case 9:A=e.sent,M=A.arcadeUtils,g=M;case 12:if(e.t0=g.hasGeometryOperations(b),!e.t0){e.next=16;break}return e.next=16,g.enableGeometryOperations();case 16:R=g.createFunction(b),T=I?g.getViewInfo({viewingMode:I.viewingMode,scale:I.scale,spatialReference:new c.Z(I.spatialReference)}):null;case 18:return C=t.fieldInfos,E=r[0]&&"declaredClass"in r[0]&&"esri.Graphic"===r[0].declaredClass||!C?null:{fields:C},e.abrupt("return",(r.forEach((function(e){var t,r=e.attributes;if(b){var n=E?(0,i.Z)((0,i.Z)({},e),{},{layer:E}):e,c=g.createExecContext(n,T,h);t=g.executeFunction(R,c)}else r&&(t=r[s],u?(t="".concat((0,v.wk)(t)).concat(l).concat((0,v.wk)(r[u])),o&&(t="".concat(t).concat(l).concat((0,v.wk)(r[o])))):"string"==typeof t&&a&&(Z?t=t?new Date(t).getTime():null:x&&(t=t?F(t):null)));if(w&&"number"==typeof t&&isFinite(t)){var f=r&&parseFloat(r[_]);t=(0,v.fk)(t,w,f,k)}S.push(t)})),S));case 20:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}},62734:function(e,t,r){r.d(t,{$8:function(){return o},a8:function(){return u}});var n=r(1413),i=r(76969),a=r(37270),s=(r(819),r(23037),r(6701));new Set(["integer","small-integer"]);function u(e){return(0,a.y2)(e)||(0,a.UQ)(e)||(0,a.ig)(e)}function o(e,t){var r,a,u,o=null!==t&&void 0!==t?t:{},l=o.format,c=o.timeZoneOptions,f=o.fieldType;if(c&&(a=(r=(0,s.Np)(c.layerTimeZone,c.datesInUnknownTimezone,c.viewTimeZone,(0,i.Ze)(l||"short-date-short-time"),f)).timeZone,u=r.timeZoneName),"string"==typeof e&&isNaN(Date.parse("time-only"===f?"1970-01-01T".concat(e,"Z"):e)))return e;switch(f){case"date-only":var h=(0,i.Ze)(l||"short-date");return"string"==typeof e?(0,i.o8)(e,(0,n.Z)({},h)):(0,i.p6)(e,(0,n.Z)((0,n.Z)({},h),{},{timeZone:s.pt}));case"time-only":var p=(0,i.Ze)(l||"short-time");return"string"==typeof e?(0,i.LJ)(e,p):(0,i.p6)(e,(0,n.Z)((0,n.Z)({},p),{},{timeZone:s.pt}));case"timestamp-offset":if(!a&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;var d=l||c?(0,i.Ze)(l||"short-date-short-time"):void 0,y=d?(0,n.Z)((0,n.Z)({},d),{},{timeZone:a,timeZoneName:u}):void 0;return"string"==typeof e?(0,i.i$)(e,y):(0,i.p6)(e,y);default:var v=l||c?(0,i.Ze)(l||"short-date-short-time"):void 0;return(0,i.p6)("string"==typeof e?new Date(e):e,v?(0,n.Z)((0,n.Z)({},v),{},{timeZone:a,timeZoneName:u}):void 0)}}}}]);
//# sourceMappingURL=14346.223590fa.chunk.js.map