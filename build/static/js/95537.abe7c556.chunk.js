"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[95537],{2622:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(15671),i=n(43144),o=n(39052),a=n(56885),s=function(e,t){function n(e){(0,r.Z)(this,n),this._observable=new a.s,this._set=new Set(e)}return(0,i.Z)(n,[{key:"size",get:function(){return(0,o.it)(this._observable),this._set.size}},{key:"add",value:function(e){var t=this._set.size;return this._set.add(e),this._set.size!==t&&this._observable.notify(),this}},{key:"clear",value:function(){this._set.size>0&&(this._set.clear(),this._observable.notify())}},{key:"delete",value:function(e){var t=this._set.delete(e);return t&&this._observable.notify(),t}},{key:"entries",value:function(){return(0,o.it)(this._observable),this._set.entries()}},{key:"forEach",value:function(e,t){var n=this;(0,o.it)(this._observable),this._set.forEach((function(r,i){return e.call(t,r,i,n)}),t)}},{key:"has",value:function(e){return(0,o.it)(this._observable),this._set.has(e)}},{key:"keys",value:function(){return(0,o.it)(this._observable),this._set.keys()}},{key:"values",value:function(){return(0,o.it)(this._observable),this._set.values()}},{key:e,value:function(){return(0,o.it)(this._observable),this._set[Symbol.iterator]()}},{key:t,get:function(){return this._set[Symbol.toStringTag]}}]),n}(Symbol.iterator,Symbol.toStringTag)},96669:function(e,t,n){function r(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function i(e,t){var n;return"number"==typeof e?e:null!==e&&void 0!==e&&null!==(n=e.stops)&&void 0!==n&&n.length?function(e){for(var t=0,n=0,r=0;r<e.length;r++){var i=e[r].size;"number"==typeof i&&(t+=i,n++)}return t/n}(e.stops):t}function o(e,t){if(!t)return e;var n=t.filter((function(e){return"size"===e.type})).map((function(t){var n=t.maxSize,r=t.minSize;return(i(n,e)+i(r,e))/2})),r=0,o=n.length;if(0===o)return e;for(var a=0;a<o;a++)r+=n[a];var s=Math.floor(r/o);return Math.max(s,e)}function a(e){var t=null===e||void 0===e?void 0:e.renderer,n="touch"===(null===e||void 0===e?void 0:e.pointerType)?9:6;if(!t)return n;var i="visualVariables"in t?o(n,t.visualVariables):n;if("simple"===t.type)return r(i,t.symbol);if("unique-value"===t.type){var a,s=i;return null!==(a=t.uniqueValueInfos)&&void 0!==a&&a.forEach((function(e){s=r(s,e.symbol)})),s}if("class-breaks"===t.type){var l=i;return t.classBreakInfos.forEach((function(e){l=r(l,e.symbol)})),l}return"dot-density"===t.type||t.type,i}n.d(t,{k:function(){return a}})},66038:function(e,t,n){n.d(t,{wW:function(){return U}});var r=n(93433),i=n(1413),o=n(15671),a=n(43144),s=n(60136),l=n(29388),u=n(27366),c=n(7138),p=n(91505),d=n(84652),v=n(92026),f=n(97942),h=n(66978),y=n(2622),g=n(94172),m=n(17842),_=n(49861),b=(n(93169),n(32718),n(69912)),x=n(48732),w=n(46634),C=n(70178),k=n(74509),S=n(50951),Z=n(78005),T=function(){function e(t){var n=t.consumesClicks,r=t.grabbableForEvent;(0,o.Z)(this,e),this.events=new p.Z,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.consumesClicks=n,this.grabbableForEvent=r}return(0,a.Z)(e,[{key:"destroy",value:function(){}},{key:"intersectionDistance",value:function(e,t){return 0}},{key:"attach",value:function(){}},{key:"detach",value:function(){}},{key:"onElevationChange",value:function(){}},{key:"onViewChange",value:function(){}}]),e}(),P=n(14813),M=n(74229),R=n(84954),I=n(17877),O=n(44179),V=n(55915),E=n(52349),H=n(34019),D=n(80151),z=n(71040),F=n(64674),G=Symbol(),W=Symbol(),U=function(e){(0,s.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,o.Z)(this,n),(r=t.call(this,e))._createOperationCompleted=!1,r._hideDefaultCursor=!1,r._pointerDownStates=new y.Z,r._stagedScreenPoint=null,r._stagedPointerType=null,r._updatingHandles=new w.R,r._stagedPointerId=null,r.constraintsEnabled=!1,r.constraints=void 0,r._getPointConstraint=(0,f.H)(V.rS),r._getPolylineOrPolygonConstraint=(0,f.H)(V.$U),r.constraintZ=null,r.defaultZ=null,r.isDraped=!0,r.labelOptions=new E.Z,r.cursor=null,r.loading=!1,r.snapToSceneEnabled=null,r.firstVertex=null,r.lastVertex=null,r.secondToLastVertex=null,null==e.elevationInfo&&(r.elevationInfo=(0,k.mF)(!!e.hasZ)),r}return(0,a.Z)(n,[{key:"initialize",value:function(){var e=this,t=this.geometryType,n=this.view,r=n.spatialReference,o="viewingMode"in n.state?n.state.viewingMode:S.JY.Local,a="segment"===t||"multipoint"===t?"polyline":t;this.coordinateHelper=(0,P.Y6)(this.hasZ,this.hasM,r),this._editGeometryOperations=new I.c(new R.XE(a,this.coordinateHelper),o),this._snappingOperation=new z.y({view:n}),this.addHandles([(0,g.watch)((function(){return{stagedPoint:e._snappingOperation.stagedPoint,constraint:e._constraint}}),(function(t,n){var r=t.stagedPoint,i=t.constraint,o=e.snappingOptions;if(o&&(o.forceDisabled=null!=i&&(0,O.wp)(i)),null!=n&&r===n.stagedPoint&&i!==n.constraint)return e._onKeyboardBasedChange();e._processCursor(null!==r&&void 0!==r?r:e._screenToMap(e._stagedScreenPoint))}),{equals:function(e,t){return e.stagedPoint===t.stagedPoint&&(0,v._W)(e.constraint,t.constraint)}}),(0,g.watch)((function(){return e.view.viewpoint}),(function(t,n){t&&n&&(0,x.Hg)(t,n)&&e._onKeyboardBasedChange()}))]),this._activeComponent=new R.wA(r,o),this._editGeometryOperations.data.components.push(this._activeComponent);var s=this.segmentLabels;null!=s&&(s.context={view:n,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles((0,g.watch)((function(){return e.labelOptions.enabled}),(function(e){s.visible=e}),g.syncAndInitial))),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(function(t){var n,r,o,a,s,l,u,c=t.vertices.map((function(t){return{componentIndex:0,vertexIndex:t.index,coordinates:e.coordinateHelper.vectorToArray(t.pos)}})),p=c.map((function(e){return e.coordinates})),d=null!==(n=e.coordinateHelper.vectorToDehydratedPoint(null===(r=e._activeComponent.getFirstVertex())||void 0===r?void 0:r.pos))&&void 0!==n?n:null;(0,C.kg)(d,e.firstVertex)||(e.firstVertex=d);var v=null!==(o=e.coordinateHelper.vectorToDehydratedPoint(null===(a=e._activeComponent.getLastVertex())||void 0===a?void 0:a.pos))&&void 0!==o?o:null;(0,C.kg)(v,e.lastVertex)||(e.lastVertex=v);var f=null!==(s=e.coordinateHelper.vectorToDehydratedPoint(null===(l=e._activeComponent.edges.at(-1))||void 0===l||null===(u=l.leftVertex)||void 0===u?void 0:u.pos))&&void 0!==s?s:null;switch((0,C.kg)(f,e.secondToLastVertex)||(e.secondToLastVertex=f),e._processCursor(e.cursorVertex),t.type){case"vertex-add":e.emit(t.type,(0,i.Z)((0,i.Z)({},t),{},{added:p,vertices:c}));break;case"vertex-update":e.emit(t.type,(0,i.Z)((0,i.Z)({},t),{},{updated:p,vertices:c}));break;case"vertex-remove":e.emit(t.type,(0,i.Z)((0,i.Z)({},t),{},{removed:p,vertices:c}))}})));var l=this._manipulator=new T({consumesClicks:!1,grabbableForEvent:function(t){return"click"!==e.drawingMode||"touch"===t.pointerType&&e._snappingEnabled&&1===e._pointerDownStates.size}});this.manipulators.add(l),l.grabbable="point"!==t,this.addHandles([l.events.on("immediate-click",(function(t){return e._onImmediateClick(t)})),l.events.on("immediate-double-click",(function(t){return e._onImmediateDoubleClick(t)})),(0,g.watch)((function(){return e.drawingMode}),(function(){e.removeHandles(G),e.addHandles(e._createManipulatorDragPipeline(l),G)}),g.syncAndInitial),(0,g.watch)((function(){return{effectiveCursor:e.effectiveCursor}}),(function(e){var t=e.effectiveCursor;l.cursor=t}),g.syncAndInitial)]),(0,F.Ob)(this,(function(){var t,n=null!==(t=e.view.inputManager.latestPointerType)&&void 0!==t?t:"mouse",r=e._getSnappingContext(n);if(null!=e.snappingManager){var i=e._snappingOperation.snapAgainNearPreviousMapPoint(e.snappingManager,r);e._updatingHandles.addPromise((0,h.R8)(i))}}))}},{key:"destroy",value:function(){(0,v.SC)(this.segmentLabels),(0,v.SC)(this._snappingOperation),this._editGeometryOperations=(0,v.SC)(this._editGeometryOperations),this._updatingHandles.destroy()}},{key:"_isDragging",get:function(){var e=this._stagedPointerId,t=this._manipulator;return null!=e&&this._pointerDownStates.has(e)||t.grabbing||!t.interactive}},{key:"_snappingEnabled",get:function(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}},{key:"_requiresScenePoint",get:function(){var e=this._updateAndGetEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==e}},{key:"canRedo",get:function(){return this._editGeometryOperations.canRedo}},{key:"canUndo",get:function(){return this._editGeometryOperations.canUndo}},{key:"committedVertices",get:function(){var e=this;return this._activeComponent.vertices.map((function(t){return e.coordinateHelper.vectorToArray(t.pos)}))}},{key:"_constraint",get:function(){var e=this.constraints,t=this.constraintsEnabled;if(e&&t)switch(this.geometryType){case"point":return this._getPointConstraint(e);case"polygon":case"polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,e)}}},{key:"drawingMode",set:function(e){this._set("drawingMode",null!==e&&void 0!==e?e:Z.n)}},{key:"effectiveCursor",get:function(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}},{key:"interactive",get:function(){return this._manipulator.interactive},set:function(e){this._manipulator.interactive=e}},{key:"isCompleted",get:function(){return this._createOperationCompleted}},{key:"numCommittedVertices",get:function(){return this._activeComponent.vertices.length}},{key:"snappingOptions",get:function(){return null!=this.snappingManager?this.snappingManager.options:null}},{key:"cursorVertex",get:function(){return this._get("cursorVertex")}},{key:"visualizationCursorVertex",get:function(){return"mouse"===this._stagedPointerType?this.cursorVertex:null}},{key:"committableVertex",get:function(){var e=this.cursorVertex,t=this.lastVertex,n=this.firstVertex;return"polygon"===this.geometryType&&(0,C.Fz)(e,n)||(0,C.Fz)(e,t)?null:e}},{key:"updating",get:function(){return this._updatingHandles.updating}},{key:"geometryIncludingUncommittedVertices",get:function(){var e=this.committedVertices,t=this.committableVertex,n=this.coordinateHelper,r=e.slice();return null!=t&&r.push(n.pointToArray(t)),r}},{key:"cancel",value:function(){this.complete({aborted:!0})}},{key:"commitStagedVertex",value:function(){this._snappingOperation.abort();var e=this.committableVertex;null!=e&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e))}},{key:"complete",value:function(e){var t,n=(null===e||void 0===e?void 0:e.aborted)||!1;this._snappingOperation.abort(),null===(t=this.snappingManager)||void 0===t||t.doneSnapping();var r=this.geometryType,i=this.numCommittedVertices,o="multipoint"===r&&0===i||"polyline"===r&&i<2||"polygon"===r&&i<3;"segment"!==r&&"point"!==r||this.commitStagedVertex(),this._createOperationCompleted=!o,(this.isCompleted||n)&&(this._stagedScreenPoint=null,this._stagedPointerId=null,this._stagedPointerType=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map((function(e,t){return{componentIndex:0,vertexIndex:t,coordinates:e}})),aborted:n,type:"complete"}))}},{key:"onInputEvent",value:function(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}},{key:"redo",value:function(){this._editGeometryOperations.redo()}},{key:"undo",value:function(){null!=this.snappingManager&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}},{key:"_processCursor",value:function(e){var t,n,r,i=(0,d.d9)(this.cursorVertex),o=(0,d.d9)(e),a=o&&(null!==(t=null===(n=this._updateAndGetEffectiveDrawSurface())||void 0===n?void 0:n.constrainZ(o))&&void 0!==t?t:o),s=this._snapToClosingVertex(a),l=this._applyConstraints(s);(0,C.Fz)(i,l)||(this._set("cursorVertex",l),null!==(r=this.segmentLabels)&&void 0!==r&&r.set("stagedVertex",null!=l?this.coordinateHelper.pointToVector(l):null),null==l||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(l)}],operation:"apply",type:"vertex-update"}))}},{key:"_snapToClosingVertex",value:function(e){if(null==e||this._isDragging||"polygon"!==this.geometryType||this.numCommittedVertices<=2)return e;var t=this._mapToScreen(e);if(!t)return e;var n=this._activeComponent;return this._vertexWithinPointerDistance(n.vertices[0].pos,t)?this.firstVertex:this._vertexWithinPointerDistance(n.vertices.at(-1).pos,t)?this.lastVertex:e}},{key:"_createManipulatorDragPipeline",value:function(e){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}},{key:"_createManipulatorDragPipelineClick",value:function(e){var t=this;return(0,M.Xd)(e,(function(e,n,i,o){var a,s="touch"===o&&t._snappingEnabled;if(!t.isCompleted&&s){var l=(0,D.W)({predicate:function(){return s},snappingManager:t.snappingManager,snappingContext:new H.N({editGeometryOperations:t._editGeometryOperations,elevationInfo:t.elevationInfo,feature:t.graphic,pointer:o,visualizer:t.snappingVisualizer,drawConstraints:t.constraints}),updatingHandles:t._updatingHandles,useZ:!t._requiresScenePoint}),u=l.snappingStep,c=l.cancelSnapping;i=i.next((function(e){return s&&null!=t.snappingManager&&t.snappingManager.doneSnapping(),e})).next(c),(a=n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(t._processCursor(e.mapStart),("segment"===t.geometryType||s&&!t.numCommittedVertices)&&t.commitStagedVertex()),e})).next((0,M.BS)(t.view,t.elevationInfo))).next.apply(a,(0,r.Z)(u)).next((function(e){return s&&(t._processCursor(e.mapEnd),"end"===e.action&&t.commitStagedVertex()),e})).next((function(e){return"end"===e.action&&("mouse"!==t._stagedPointerType&&t._snappingOperation.abort(),"segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()),e}))}}))}},{key:"_createManipulatorDragPipelineFreehand",value:function(e){var t=this;return(0,M.Xd)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(t._snappingOperation.abort(),null==t.committableVertex&&t._processCursor(e.mapStart),"segment"===t.geometryType&&t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t._processCursor(e.mapEnd),"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":t.complete()}return e}))}))}},{key:"_createManipulatorDragPipelineHybrid",value:function(e){var t=this;return(0,M.Xd)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(t._snappingOperation.abort(),t.addHandles(t._editGeometryOperations.createUndoGroup(),W),t._processCursor(e.mapStart),t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t._processCursor(e.mapEnd),"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":"mouse"!==t._stagedPointerType&&t._snappingOperation.abort(),t.removeHandles(W),"segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()}return e}))}))}},{key:"_drawAtFixedElevation",get:function(){var e=this.constraintsEnabled,t=this.constraintZ,n=this.geometryType,r=this.numCommittedVertices;return e?null!=t||"segment"===n&&r>0:("segment"===n||"polygon"===n)&&r>0}},{key:"_updateAndGetEffectiveDrawSurface",value:function(){var e,t=this.constraintsEnabled,n=this.coordinateHelper,r=this.drawSurface,i=this.elevationDrawSurface,o=this.snapToSceneEnabled;if(null==i)return r;if(!this.hasZ)return i.defaultZ=null,i;var a,s=null===(e=this.elevationInfo)||void 0===e?void 0:e.mode,l=this.defaultZ,u=t||"absolute-height"===s;(null!=o&&(u=o),"on-the-ground"===s&&(u=!1),this._drawAtFixedElevation)&&(l=null!==(a=t?this.constraintZ:null)&&void 0!==a?a:n.getZ(this._activeComponent.vertices[0].pos),u=!1);return u?r:(i.defaultZ=l,i)}},{key:"_mapToScreen",value:function(e){var t;return null===(t=this._updateAndGetEffectiveDrawSurface())||void 0===t?void 0:t.mapToScreen(e)}},{key:"_onHold",value:function(e){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===e.pointerType&&this._snappingEnabled&&this._processCursor(e.mapPoint),e.stopPropagation()}},{key:"_onImmediateClick",value:function(e){if(!("mouse"===e.pointerType&&2===e.button||this._manipulator.dragging))try{var t=this.drawingMode,n=this.geometryType;this._stagedPointerType=e.pointerType,this._stagedScreenPoint=e.screenPoint;var r=this._screenToMap(e.screenPoint);if(null==r)return;if(null==r||"freehand"===t&&"point"!==n)return;if(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(r),null==this.committableVertex)return void this.complete();this.commitStagedVertex(),"mouse"!==e.pointerType&&this._processCursor(null),("freehand"===t||"point"===n||"segment"===n&&2===this.numCommittedVertices||"segment"===n&&"hybrid"===t&&1===this.numCommittedVertices)&&this.complete()}finally{e.stopPropagation()}}},{key:"_onImmediateDoubleClick",value:function(e){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),e.stopPropagation())}},{key:"_onPointerMove",value:function(e){var t=(0,m.vW)(e.x,e.y);this._stagedScreenPoint=t,this._stagedPointerType=e.pointerType,this._stagedPointerId=e.pointerId,this._isDragging?this._snappingOperation.abort():(e.stopPropagation(),this._processCursorMovementRelativeToSurface(t,e.pointerType))}},{key:"_onKeyboardBasedChange",value:function(){"mouse"===this._stagedPointerType&&this._stagedScreenPoint&&null!=this._stagedPointerId&&!this._isDragging?this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType):this._snappingOperation.abort()}},{key:"_processCursorMovementRelativeToSurface",value:function(e,t){var n,r=this._snappingOperation,i=this._screenToMap(e),o=this._requiresScenePoint?null===(n=this.drawSurface)||void 0===n?void 0:n.screenToMap(e):null;if(null==i)return this._hideDefaultCursor=!0,this._processCursor(null),void r.abort();this._hideDefaultCursor=!1;var a=this.snappingManager;if(null==a)return this._processCursor(i),void r.abort();var s=this._getSnappingContext(t);this._updatingHandles.addPromise((0,h.R8)(r.snap({point:i,scenePoint:o},a,s)))}},{key:"_applyConstraints",value:function(e){var t=this._constraint,n=this.constraints;if(!e||!n||!t)return e;var r=n.context,i=(0,V.qX)(e,r),o=i?t.closestTo(i):void 0;if(!o)return e;var a=(0,V.Ly)(o,e,r),s="2d"===this.view.type||"absolute-height"!==r.elevationInfo.mode;return null!=a&&s&&null!=this.constraintZ&&this.hasZ&&(a.z=this.constraintZ),a}},{key:"_screenToMap",value:function(e){var t;return e?null===(t=this._updateAndGetEffectiveDrawSurface())||void 0===t?void 0:t.screenToMap(e):null}},{key:"_screenToMapDragEventStep",value:function(){var e=this,t=null;return function(n){if("start"===n.action&&(t=e._screenToMap(n.screenStart)),null==t)return null;var r=e._screenToMap(n.screenEnd);return null!=r?(0,i.Z)((0,i.Z)({},n),{},{mapStart:t,mapEnd:r}):null}}},{key:"_vertexWithinPointerDistance",value:function(e,t){var n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return null!=n&&function(e,t,n){var r=e.x-t.x,i=e.y-t.y;return r*r+i*i<=n}(n,t,25)}},{key:"_getSnappingContext",value:function(e){var t,n=this._drawAtFixedElevation?null===(t=this.elevationDrawSurface)||void 0===t?void 0:t.defaultZ:null;return new H.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=n?{value:n,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}}]),n}(p.Z.EventedMixin(c.default));(0,u._)([(0,_.Cb)()],U.prototype,"_hideDefaultCursor",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"_stagedPointerId",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"_isDragging",null),(0,u._)([(0,_.Cb)()],U.prototype,"_snappingOperation",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"_snappingEnabled",null),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"graphic",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"constraintsEnabled",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"constraints",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"_constraint",null),(0,u._)([(0,_.Cb)()],U.prototype,"constraintZ",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"defaultZ",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"isDraped",void 0),(0,u._)([(0,_.Cb)({value:Z.n})],U.prototype,"drawingMode",null),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"elevationDrawSurface",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"elevationInfo",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0,type:E.Z})],U.prototype,"labelOptions",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"geometryType",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"hasM",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"hasZ",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"cursor",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"effectiveCursor",null),(0,u._)([(0,_.Cb)()],U.prototype,"loading",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"manipulators",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"drawSurface",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"segmentLabels",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"snappingManager",void 0),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"snappingVisualizer",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"snapToSceneEnabled",void 0),(0,u._)([(0,_.Cb)({readOnly:!0})],U.prototype,"cursorVertex",null),(0,u._)([(0,_.Cb)({readOnly:!0})],U.prototype,"visualizationCursorVertex",null),(0,u._)([(0,_.Cb)()],U.prototype,"committableVertex",null),(0,u._)([(0,_.Cb)()],U.prototype,"firstVertex",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"lastVertex",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"secondToLastVertex",void 0),(0,u._)([(0,_.Cb)()],U.prototype,"updating",null),(0,u._)([(0,_.Cb)({constructOnly:!0})],U.prototype,"view",void 0),U=(0,u._)([(0,b.j)("esri.views.draw.DrawOperation")],U)},78005:function(e,t,n){n.d(t,{A:function(){return r},n:function(){return i}});var r=["freehand","hybrid","click"],i="click"},46640:function(e,t,n){n.d(t,{$c:function(){return f},aL:function(){return p},hP:function(){return v},iW:function(){return d}});var r=n(15671),i=n(43144),o=(n(59486),n(17842)),a=n(55946),s=n(37818),l=n(74509),u=n(78952),c=n(848),p=function(){function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,r.Z)(this,e),this._elevationInfo=t,this.defaultZ=n,this._view=i,this._excludeGraphics=o}return(0,i.Z)(e,[{key:"screenToMap",value:function(e){var t=this.defaultZ,n=this._view.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(e.x,e.y),this._elevationInfo,null!==t&&void 0!==t?t:0,this._excludeGraphics);return null==t&&null!=n&&(n.z=void 0),n}},{key:"mapToScreen",value:function(e){var t=(0,a.T)(e.x,e.y,(0,l.vQ)(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(t)}},{key:"constrainZ",value:function(e){var t=this.defaultZ;return null!=t&&e.z!==t&&((e=(0,s.WG)(e)).z=t),e}}]),e}(),d=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(0,r.Z)(this,e),this.view=t,this.elevationInfo=n,this.exclude=i}return(0,i.Z)(e,[{key:"screenToMap",value:function(e){var t=this.view.toMap(e,{exclude:this.exclude,excludeHud:!0});return null!=t&&(t.z=(0,l.Ou)(t,this.view,this.elevationInfo)),t}},{key:"mapToScreen",value:function(e){var t=e;return null!=this.elevationInfo&&(t=(0,a.T)(e.x,e.y,(0,l.vQ)(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}},{key:"constrainZ",value:function(e){return e}}]),e}(),v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,r.Z)(this,e),this.view=t,this.hasZ=n,this.defaultZ=i,this.mapToScreen=function(e){return t.toScreen(e)},this.screenToMap=n?function(e){var n=t.toMap(e);return n.z=i,n}:function(e){return t.toMap(e)}}return(0,i.Z)(e,[{key:"constrainZ",value:function(e){var t=this.defaultZ;return this.hasZ&&e.z!==t&&((e=(0,s.WG)(e)).z=t),e}}]),e}(),f=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"screenToMap",value:function(t){var n=t.x,r=t.y;return new c.Z({x:n,y:r,spatialReference:e.spatialReference})}},{key:"mapToScreen",value:function(e){return(0,o.vW)(e.x,e.y)}},{key:"constrainZ",value:function(e){return e}}]),e}();f.spatialReference=new u.Z},3826:function(e,t,n){n.d(t,{Gn:function(){return x},Q8:function(){return g},kq:function(){return _}});var r=n(60136),i=n(29388),o=n(15671),a=n(43144),s=(n(59486),n(63780)),l=n(50264),u=n(55364),c=n(68700),p=n(50894),d=n(32035),v=n(12400),f=n(14320),h=n(848);function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?[e,t,n]:[e,t]}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?{x:e,y:t,z:n}:{x:e,y:t}}var m=function(){function e(t){(0,o.Z)(this,e),this.spatialReference=t}return(0,a.Z)(e,[{key:"mapToLocalMultiple",value:function(e){var t=this;return e.map((function(e){return t.mapToLocal(e)})).filter(s.pC)}},{key:"doUnnormalization",get:function(){return!1}}]),e}(),_=function(e){(0,r.Z)(n,e);var t=(0,i.Z)(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,o.Z)(this,n),(i=t.call(this,r))._defaultZ=a,i.transform=(0,u.Ue)(),i.transformInv=(0,u.Ue)(),i.transform=(0,u.d9)(e),(0,l.U_)(i.transformInv,i.transform),i}return(0,a.Z)(n,[{key:"makeMapPoint",value:function(e,t){return y(e,t,this._defaultZ)}},{key:"mapToLocal",value:function(e){return g(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}},{key:"localToMap",value:function(e){return y(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}}]),n}(m),b=function(e){(0,r.Z)(n,e);var t=(0,i.Z)(n);function n(e,r){var i;(0,o.Z)(this,n),(i=t.call(this,e.spatialReference)).view=e,i.defaultZ=null,i.pWS=(0,v.Ue)(),i.tangentFrameUpWS=(0,v.Ue)(),i.tangentFrameRightWS=(0,v.Ue)(),i.tangentFrameForwardWS=(0,v.Ue)(),i.localFrameRightWS=(0,v.Ue)(),i.localFrameUpWS=(0,v.Ue)(),i.worldToLocalTransform=(0,p.Ue)(),i.localToWorldTransform=(0,p.Ue)(),i.scale=1,i.scale=e.resolution,i.referenceMapPoint=r,i.defaultZ=r.hasZ?r.z:null;var a=e.state.camera.viewRight;i.view.renderCoordsHelper.toRenderCoords(i.referenceMapPoint,i.pWS),i.view.renderCoordsHelper.worldBasisAtPosition(i.pWS,f.R.X,i.tangentFrameRightWS),i.view.renderCoordsHelper.worldBasisAtPosition(i.pWS,f.R.Y,i.tangentFrameUpWS),i.view.renderCoordsHelper.worldBasisAtPosition(i.pWS,f.R.Z,i.tangentFrameForwardWS);var s=(0,v.Ue)();return(0,d.j)(s,i.tangentFrameForwardWS,(0,d.m)(a,i.tangentFrameForwardWS)),(0,d.f)(i.localFrameRightWS,a,s),(0,d.n)(i.localFrameRightWS,i.localFrameRightWS),(0,d.b)(i.localFrameUpWS,i.tangentFrameForwardWS,i.localFrameRightWS),(0,c.b0)(i.worldToLocalTransform,i.localFrameRightWS,i.tangentFrameRightWS),(0,c.U_)(i.localToWorldTransform,i.worldToLocalTransform),i}return(0,a.Z)(n,[{key:"doUnnormalization",get:function(){return"global"===this.view.viewingMode}},{key:"makeMapPoint",value:function(e,t){return y(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){var t=(0,v.Ue)();this.view.renderCoordsHelper.toRenderCoords(new h.Z({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,d.u)(t,t,this.worldToLocalTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,new h.Z({spatialReference:this.view.spatialReference}));return null!=n?g(n.x/this.scale,n.y/this.scale):null}},{key:"localToMap",value:function(e){var t=(0,v.Ue)();this.view.renderCoordsHelper.toRenderCoords(new h.Z({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,d.u)(t,t,this.localToWorldTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,new h.Z({spatialReference:this.view.spatialReference}));return null!=n?y(n.x,n.y,this.defaultZ):null}}]),n}(m);function x(e,t){if("2d"===e.type)return new _(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){var n=t.length>2?new h.Z({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new h.Z({x:t[0],y:t[1],spatialReference:e.spatialReference});return new b(e,n)}return null}},55915:function(e,t,n){n.d(t,{$U:function(){return w},Ly:function(){return S},ND:function(){return y},qX:function(){return k},rS:function(){return x}});var r=n(37762),i=n(29439),o=(n(59486),n(47898)),a=n(68860),s=n(32035),l=n(5986),u=n(15559),c=n(55946),p=n(74509),d=n(44179),v=n(38054),f=n(73840),h=n(78952);function y(e,t,n,r,i,o){var a="geodesic",s=(0,u.Lc)(n),c=(0,v.by)();return(0,v.SN)(e,t,r,c),c[2]=0,s&&(0,l.S)(c,n,c,s)||(a="euclidean",s=n),{mode:a,view:t,elevationInfo:r,hasZ:i,directionMode:o,spatialReference:e.spatialReference,measurementSR:s,origin:c}}function g(e,t,n){if(null!=t&&null!=e){var r=(0,a.j5)(n.measurementSR);if(null!=r){var i=k(e,n);if(null!=i){var s=(0,o.mE)(t,r);return new d.kt(i,s)}}}}function m(e,t,n,r){if(null!=n&&null!=e){var i=k(e,r);if(null!=i){var a=(0,f.yd)(n),s=function(e){if(null!=e){var t=(0,v.by)(),n=(0,o.GJ)(e,"degrees","geographic");return(0,f.LH)(t,i,r.measurementSR,10,n,r.mode)?new d.aU(i,t):void 0}},l=function(){if(null!=t&&null!=e)return(0,f.yd)((0,f.Lm)(t,e))};switch(r.directionMode){case f.uE.Absolute:return s(a);case f.uE.Relative:var u=l();if(null==u)return;return s(u+a);case f.uE.RelativeBilateral:var c=l();if(null==c)return;return(0,d.f2)([s(c+a),s(c-a)])}}}}function _(e,t){var n=function(e,t){var n,r;return null!==(n=null===(r=T(e,t))||void 0===r?void 0:r.value)&&void 0!==n?n:void 0}(e,t);return null!=n?new d.SP(n):void 0}function b(e,t,n){var r=n.context,a=n.longitude,s=n.latitude,u=n.direction,c=n.distance,p=n.elevation;if(null!=a||null!=s||null!=c||null!=p||null!=u){if(null!=a||null!=s){var h=(0,f.yd)(a),y=(0,f.yd)(s),g=Z(p,r);return new d.lY(h,y,g)}return function(e,t,n){var r=n.context,a=n.direction,s=n.distance,u=n.elevation;if(null==t)return _(u,r);var c=r.view,p=r.elevationInfo,h=r.measurementSR,y=(0,v.SN)(t,c,p);if(!h||!(0,l.S)(y,t.spatialReference,P,h))return;var g=(0,i.Z)(P,2),m=g[0],b=g[1],x=null!=s?(0,o.mE)(s,"meters"):void 0,w=(0,f.yd)(a),C=Z(u,r),k=function(e){var t=new d.Vy([m,b],h,x,C,e);return null==x||null==e||null==C&&r.hasZ?t:new d.Hk(t.closestTo(y))};if(null==w)return k(void 0);var S=function(){if(null!=e&&null!=t)return(0,f.yd)((0,f.Lm)(e,t))};switch(r.directionMode){case f.uE.Absolute:return k(w);case f.uE.Relative:var T=S();if(null==T)return;return k(T+w);case f.uE.RelativeBilateral:var M=S();if(null==M)return;return(0,d.f2)([k(M+w),k(M-w)])}}(e,t,n)}}function x(e){return"geodesic"===e.context.mode?b(null,null,e):C(e)}function w(e,t,n){var i=n.context,o=n.x,a=n.y,s=n.distance,l=n.direction,u=n.elevation;return"geodesic"===i.mode?b(t,e,n):null!=o||null!=a?C(n):function(e){var t,n,i=(0,r.Z)(e);try{for(i.s();!(n=i.n()).done;){var o,a,s=n.value;s&&(t=null!==(o=null===(a=t)||void 0===a?void 0:a.intersect(s))&&void 0!==o?o:s)}}catch(l){i.e(l)}finally{i.f()}return t}([g(e,s,i),m(e,t,l,i),_(u,i)])}function C(e){var t,n,r=e.x,i=e.y,o=e.elevation,a=e.context;I.x=null!==(t=null===r||void 0===r?void 0:r.value)&&void 0!==t?t:0,I.y=null!==(n=null===i||void 0===i?void 0:i.value)&&void 0!==n?n:0,I.spatialReference=a.spatialReference;var s=k(I,a,M);return new d.lY(null!=r&&null!=s?s[0]:void 0,null!=i&&null!=s?s[1]:void 0,Z(o,a))}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,v.by)(),r=t.view,i=t.elevationInfo,o=t.measurementSR,a=t.origin,u=t.mode;if((0,v.SN)(e,r,i,n),(0,l.S)(n,e.spatialReference,n,o))return"geodesic"!==u&&(0,s.f)(n,n,a),n}function S(e,t,n,r){var i=n.view,o=n.measurementSR,a=n.spatialReference,u=n.origin;if("geodesic"===n.mode?(0,s.c)(R,e):(0,s.g)(R,e,u),(0,l.S)(R,o,R,a))return(0,v.aK)(R,i,t,n,r)}function Z(e,t){var n=T(e,t);return null!=n?(0,o.mE)(n,"meters"):void 0}function T(e,t){var n=t.view,r=t.origin,s=t.elevationInfo,l=t.hasZ,u=t.measurementSR;if(null!=e&&l){var c=(0,a.y)(u);if(null!=c){var d=(0,i.Z)(r,2),v=d[0],f=d[1],h=(0,o.mE)(e,c),y="3d"===(null===n||void 0===n?void 0:n.type)?(0,p.O3)(n,v,f,h,u,s):h;return null!=y?(0,o.yG)(y,c):void 0}}}var P=(0,v.by)(),M=(0,v.by)(),R=(0,v.by)(),I=(0,c.T)(0,0,0,h.Z.WGS84)},34019:function(e,t,n){n.d(t,{N:function(){return o}});var r=n(15671),i=n(43144),o=function(){function e(t){(0,r.Z)(this,e),this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.feature=t.feature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ,this.drawConstraints=t.drawConstraints}return(0,i.Z)(e,[{key:"coordinateHelper",get:function(){return this.editGeometryOperations.data.coordinateHelper}},{key:"spatialReference",get:function(){return this.coordinateHelper.spatialReference}}]),e}()},80151:function(e,t,n){n.d(t,{W:function(){return g}});var r=n(37762),i=n(29439),o=n(74165),a=n(15861),s=n(1413),l=n(92026),u=n(66978),c=n(94172),p=n(70178),d=n(37818),v=n(74509),f=n(74229),h=n(34019),y=n(93463);function g(e){var t=e.predicate,n=void 0===t?function(){return!0}:t,i=e.snappingManager,d=e.snappingContext,g=e.updatingHandles,w=e.useZ,C=void 0===w||w,k=new f.hM;if(null==i)return{snappingStep:[x,k],cancelSnapping:x};var S,Z,T,P,M=null,R=null,I=null,O=function(){var e;M=(0,l.IM)(M),i.doneSnapping(),null!==(e=R)&&void 0!==e&&e.frameTask.remove(),R=null,S=(0,l.hw)(S),I=null},V=(Z=i,T=C,P=k,(0,u.Ds)(function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t,n){var r,i,a,s,l,u,c,d,v,f;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.frameTask,i=t.point,a=t.scenePoint,s=t.context,l=t.event,u=t.delta,c=t.getLastState,e.next=3,r.schedule((function(){return Z.snap({point:i,scenePoint:a,context:s,signal:n})}),n);case 3:if(!(d=e.sent).valid){e.next=10;break}return e.next=7,r.schedule((function(){return d.apply()}),n);case 7:v=e.sent,null!=(f=c()).point&&i!==f.point&&(v=Z.update({point:f.point,scenePoint:f.scenePoint,context:s})),null!=f.updatePoint&&(0,p.kg)(v,f.updatePoint)||(b(l.mapEnd,v,u,T),P.execute(l));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())),E=null,H=null,D=null;return{snappingStep:[function(e){if(!n(e))return e;var t=e.action;if("start"===t){var o=e.info,a=function(e){return"3d"===e.type?e.resourceController.scheduler.registerTask(y.T8.SNAPPING):y.sq}(i.view);if(R=function(e,t,n){return{context:new h.N({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:null!=t.info?t.info.handle:null,excludeFeature:e.excludeFeature,feature:e.feature,visualizer:e.visualizer}),originalPos:null!=t.snapOrigin?e.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:null!=t.scenePoints?t.scenePoints.sceneStart:null,frameTask:n}}(d,e,a),R.context.selfSnappingZ=null,!C&&null!=o){var l,p=function(e,t){if(!e.hasZ())return null;var n,i=t.vertices,o=null,a=(0,r.Z)(i);try{for(a.s();!(n=a.n()).done;){var s=n.value,l=e.getZ(s.pos);if(null!=o&&null!=l&&Math.abs(l-o)>1e-6)return null;null==o&&(o=l)}}catch(u){a.e(u)}finally{a.f()}return o}(d.coordinateHelper,o.handle.component);null!=p&&(R.context.selfSnappingZ={value:p,elevationInfo:null!==(l=d.elevationInfo)&&void 0!==l?l:v.jG})}}if(null!=R){var f=R,x=f.context,w=f.originalScenePos,k=f.originalPos,Z=e.mapEnd,T=e.mapStart,P=e.scenePoints,z=m(k,_(Z,T)),F=_(T,k),G=(0,s.Z)((0,s.Z)({},e),{},{action:"update"}),W=R.context,U=function(e,t){return null==e||null==t?null:m(e,_(t.sceneEnd,t.sceneStart))}(w,P),A=i.update({point:z,scenePoint:U,context:x});if(D=A,b(Z,A,F,C),E=z,H=U,"end"!==t){var L=R.frameTask;null==M&&(M=new AbortController),I=function(e){g.addPromise((0,u.R8)(V({frameTask:L,event:G,context:W,point:z,scenePoint:U,delta:F,getLastState:function(){return{point:E,scenePoint:H,updatePoint:e.forceUpdate?null:D}}},M.signal)))},I({forceUpdate:!1}),null==S&&(S=(0,c.watch)((function(){return i.options.effectiveEnabled}),(function(){var e;return null===(e=I)||void 0===e?void 0:e({forceUpdate:!0})})))}}return"end"===t&&O(),e},k],cancelSnapping:function(e){return O(),e}}}function m(e,t){var n=(0,i.Z)(t,3),r=n[0],o=n[1],a=n[2],s=(0,d.WG)(e);return s.x+=r,s.y+=o,s.hasZ&&(s.z+=a),s}function _(e,t){var n=e.hasZ&&t.hasZ?e.z-t.z:0;return[e.x-t.x,e.y-t.y,n]}function b(e,t,n,r){var o=(0,i.Z)(n,3),a=o[0],s=o[1],l=o[2];e.x=t.x+a,e.y=t.y+s,r&&e.hasZ&&t.hasZ&&(e.z=t.z+l)}function x(e){return e}},71040:function(e,t,n){n.d(t,{y:function(){return g}});var r=n(74165),i=n(1413),o=n(15861),a=n(15671),s=n(43144),l=n(60136),u=n(29388),c=n(27366),p=n(7138),d=n(92026),v=n(66978),f=n(49861),h=(n(93169),n(32718),n(84936),n(69912)),y=n(93463),g=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(e){var s;return(0,a.Z)(this,n),(s=t.call(this,e)).constrainResult=function(e){return e},s._snapPoints=null,s._frameTask=null,s._abortController=null,s._stagedPoint=null,s._snap=(0,v.Ds)(function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n,o,a){var l,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(l=s._frameTask)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,l.schedule((function(){return n.snap((0,i.Z)((0,i.Z)({},t),{},{context:o,signal:a}))}),a);case 5:if(u=e.sent,e.t0=u.valid,!e.t0){e.next=10;break}return e.next=10,l.schedule((function(){s.stagedPoint=u.apply(),t!==s._snapPoints&&null!=s._snapPoints&&(s.stagedPoint=n.update((0,i.Z)((0,i.Z)({},s._snapPoints),{},{context:o})))}),a);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()),s}return(0,s.Z)(n,[{key:"stagedPoint",get:function(){return this._stagedPoint},set:function(e){this._stagedPoint=this.constrainResult(e)}},{key:"initialize",value:function(){var e,t,n="3d"===this.view.type?null===(e=this.view)||void 0===e||null===(t=e.resourceController)||void 0===t?void 0:t.scheduler:null;this._frameTask=null!=n?n.registerTask(y.T8.SNAPPING):y.sq}},{key:"destroy",value:function(){this._abortController=(0,d.IM)(this._abortController),this._frameTask=(0,d.hw)(this._frameTask)}},{key:"update",value:function(e,t,n){this._snapPoints=e;var r=e.point,i=e.scenePoint,o=t.update({point:r,scenePoint:i,context:n});return this.stagedPoint=o,o}},{key:"snap",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n,i){var o,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.point,a=t.scenePoint,e.abrupt("return",(this.stagedPoint=n.update({point:o,scenePoint:a,context:i}),this._snapPoints=t,null==this._abortController&&(this._abortController=new AbortController),this._snap(t,n,i,this._abortController.signal)));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"snapAgainNearPreviousMapPoint",value:function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this._snapPoints,!e.t0){e.next=4;break}return e.next=4,this.snap(this._snapPoints,t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"abort",value:function(){this._abortController=(0,d.IM)(this._abortController),this._snapPoints=null}}]),n}(p.default);(0,c._)([(0,f.Cb)({constructOnly:!0})],g.prototype,"view",void 0),(0,c._)([(0,f.Cb)()],g.prototype,"stagedPoint",null),(0,c._)([(0,f.Cb)()],g.prototype,"constrainResult",void 0),(0,c._)([(0,f.Cb)()],g.prototype,"_stagedPoint",void 0),g=(0,c._)([(0,h.j)("esri.views.interactive.snapping.SnappingOperation")],g)},45008:function(e,t,n){n.d(t,{D:function(){return s},K:function(){return a}});n(59486);var r=n(68860),i=n(96669),o=n(53866);function a(e,t,n){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new o.Z,s=0;if("2d"===n.type)s=t*(null!==(i=n.resolution)&&void 0!==i?i:0);else if("3d"===n.type){var l=n.overlayPixelSizeInMapUnits(e),u=n.basemapSpatialReference;s=null==u||u.equals(n.spatialReference)?t*l:(0,r.c9)(u)/(0,r.c9)(n.spatialReference)}var c=e.x-s,p=e.y-s,d=e.x+s,v=e.y+s,f=n.spatialReference;return a.xmin=Math.min(c,d),a.ymin=Math.min(p,v),a.xmax=Math.max(c,d),a.ymax=Math.max(p,v),a.spatialReference=f,a}function s(e,t,n){var r=n.toMap(e);return null!=r&&a(r,(0,i.k)(),n,l).intersects(t)}var l=new o.Z}}]);
//# sourceMappingURL=95537.abe7c556.chunk.js.map