"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[47745],{47745:function(e,t,i){i.r(t),i.d(t,{default:function(){return W}});var r=i(74165),n=i(15861),l=i(37762),s=i(15671),u=i(43144),a=i(88301),d=i(61120),o=i(60136),c=i(29388),h=i(27366),y=i(52639),v=i(32718),f=i(92026),p=i(2622),g=i(94172),_=i(49861),b=(i(93169),i(84936),i(69912)),F=i(54054),w=i(18661),I=i(87072),C=i(21149),E=i(28554),k=i(43629),O=i(42757),m=i(42069),S=i(831),x=i(31730),H=i(71039),j=i(95964),Q=i(75162),Z=i(43812),q=i(51246),R=i(73552),A=i(44011),V=i(1247),D=i(48252),G=i(23224),U=i(6777),L=i(77057),P=i(58890),T=i(17006),z=i(24405),M=i(69787),N=i(93463),Y=(0,D.v)(),B=function(e){(0,o.Z)(i,e);var t=(0,c.Z)(i);function i(){var e;return(0,s.Z)(this,i),(e=t.apply(this,arguments)).type="scene-layer-3d",e._setVisibilityHiddenObjectIds=new p.Z,e.progressiveLoadFactor=1,e._elevationContext="scene",e._isIntegratedMesh=!1,e._supportsLabeling=!0,e._pendingEditsQueue=Promise.resolve(),e._interactiveEditingSessions=new Map,e._queryEngine=null,e}return(0,u.Z)(i,[{key:"i3slayer",get:function(){return this.layer}},{key:"tryRecycleWith",value:function(e,t){var i=this;return e.url===this.layer.url&&this.i3sOverrides.isEmpty?e.load(t).then((function(){var t;(0,A.tq)(i.layer,e,i.i3sOverrides),i.layer=e,i.i3sOverrides.destroy();var r=null===(t=i.view.resourceController)||void 0===t?void 0:t.memoryController;i.i3sOverrides=new Q.v({view:i.view,layer:e,memoryController:r}),i.resetHighlights()})):null}},{key:"layerPopupEnabledAndHasTemplate",get:function(){var e;return this.layer.popupEnabled&&(0,z.zc)(this.layer,null===(e=this.view.popup)||void 0===e?void 0:e.defaultPopupTemplateEnabled)}},{key:"filter",get:function(){return this._get("filter")},set:function(e){this._set("filter",H.z.checkSupport(e)?e:null)}},{key:"viewFilter",get:function(){var e=this,t=this.mergedFilter,i=this.layerFilter;if(null==t&&null==i)return null;var r=this._get("viewFilter");return null==r?new H.z({layerFilter:i,viewFilter:t,layerFieldsIndex:this.layer.fieldsIndex,loadAsyncModule:function(t){return e._loadAsyncModule(t)},addSqlFilter:function(t,i){return e.addSqlFilter(t,i,e.logError)},addTimeFilter:function(t,i){return e.addTimeFilter(t,i)}}):(r.viewFilter=t,r.layerFilter=i,r)}},{key:"requiredFields",get:function(){var e,t;return null!==(e=null===(t=this._fieldsHelper)||void 0===t?void 0:t.requiredFields)&&void 0!==e?e:[]}},{key:"_floorFilterClause",get:function(){var e=(0,I.c)(this);return null!=e?F.WhereClause.create(e,this.layer.fieldsIndex):null}},{key:"_excludeObjectIdsSorted",get:function(){var e=this.layer.excludeObjectIds.toArray();return e.length?e.sort((function(e,t){return e-t})):null}},{key:"_setVisibilityHiddenObjectIdsSorted",get:function(){return this._setVisibilityHiddenObjectIds.size?Array.from(this._setVisibilityHiddenObjectIds).sort((function(e,t){return e-t})):null}},{key:"lodFactor",get:function(){var e,t,i,r,n;return null!==(e=null===(t=this.view)||void 0===t||null===(i=t.qualitySettings)||void 0===i||null===(r=i.sceneService)||void 0===r||null===(n=r.object)||void 0===n?void 0:n.lodFactor)&&void 0!==e?e:1}},{key:"lodCrossfadeUncoveredDuration",get:function(){var e,t,i;return null!==(e=null===(t=this.view)||void 0===t||null===(i=t.qualitySettings)||void 0===i?void 0:i.fadeDuration)&&void 0!==e?e:0}},{key:"updatingProgressValue",get:function(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.updatingProgress)&&void 0!==e?e:0}},{key:"visibleAtCurrentScale",get:function(){return(0,M.GB)(this.i3slayer.effectiveScaleRange,this.view.terrainScale)}},{key:"initialize",value:function(){var e=this;this._fieldsHelper=new U.K({layerView:this}),this._updatingHandles.add((function(){return e.layer.rangeInfos}),(function(t){return e._rangeInfosChanged(t)}),g.initial),this._updatingHandles.add((function(){return e.layer.renderer}),(function(t){return e._updatingHandles.addPromise(e._rendererChange(t))}),g.initial);var t=function(){return e._filterChange()};this._updatingHandles.add((function(){return e.parsedDefinitionExpression}),t),this._updatingHandles.add((function(){return e.mergedFilter}),t),this._updatingHandles.add((function(){return e._floorFilterClause}),t),this._updatingHandles.add((function(){return e._excludeObjectIdsSorted}),t),this._updatingHandles.add((function(){return e._setVisibilityHiddenObjectIdsSorted}),t),this._updatingHandles.add((function(){var t;return null===(t=e.viewFilter)||void 0===t?void 0:t.sortedObjectIds}),t),this._updatingHandles.add((function(){var t;return null===(t=e.viewFilter)||void 0===t?void 0:t.parsedWhereClause}),t),this._updatingHandles.add((function(){return e.getTimeFilterDependencies()}),t),this._updatingHandles.add((function(){var t,i,r;return[null===(t=e.viewFilter)||void 0===t?void 0:t.parsedGeometry,null===(i=e.mergedFilter)||void 0===i?void 0:i.spatialRelationship,null===(r=e.layer.filter)||void 0===r?void 0:r.spatialRelationship]}),(function(){return e._geometryFilterChange()})),(0,E.Rx)()&&this.i3sOverrides.is3DOFL&&this._updatingHandles.add((function(){return e.i3sOverrides.sortedGeometryChangedObjectIds}),t),this.addHandles(this.layer.on("apply-edits",(function(t){return e._updatingHandles.addPromise(t.result)}))),this.addHandles(this.layer.on("edits",(function(t){var i=e._pendingEditsQueue.then((function(){return e._handleEdits(t)})).then();e._pendingEditsQueue=i,e._updatingHandles.addPromise(i)})))}},{key:"destroy",value:function(){this._fieldsHelper=(0,f.SC)(this._fieldsHelper)}},{key:"_rangeInfosChanged",value:function(e){null!=e&&e.length>0&&v.Z.getLogger(this).warn("Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.")}},{key:"createQuery",value:function(){var e,t,i={outFields:["*"],returnGeometry:!1,outSpatialReference:this.view.spatialReference};return null!==(e=null===(t=this.mergedFilter)||void 0===t?void 0:t.createQuery(i))&&void 0!==e?e:new C.Z(i)}},{key:"queryExtent",value:function(e,t){return this._ensureQueryEngine().executeQueryForExtent(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal)}},{key:"queryFeatureCount",value:function(e,t){return this._ensureQueryEngine().executeQueryForCount(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal)}},{key:"queryFeatures",value:function(e,t){var i=this;return this._ensureQueryEngine().executeQuery(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal).then((function(e){if(null===e||void 0===e||!e.features)return e;var t,r=i.layer,n=(0,l.Z)(e.features);try{for(n.s();!(t=n.n()).done;){var s=t.value;s.layer=r,s.sourceLayer=r}}catch(u){n.e(u)}finally{n.f()}return e}))}},{key:"queryObjectIds",value:function(e,t){return this._ensureQueryEngine().executeQueryForIds(this._ensureQuery(e),null===t||void 0===t?void 0:t.signal)}},{key:"_ensureQueryEngine",value:function(){return this._queryEngine||(this._queryEngine=this._createQueryEngine()),this._queryEngine}},{key:"_createQueryEngine",value:function(){var e,t=this,i=(0,x.gz)(this.view.spatialReference,this.view.renderSpatialReference,this._collection);return new Z.u({layerView:this,priority:N.T8.FEATURE_QUERY_ENGINE,spatialIndex:new R.I({featureAdapter:new q.u({objectIdField:this.layer.objectIdField,attributeStorageInfo:null!==(e=this.layer.attributeStorageInfo)&&void 0!==e?e:[],getFeatureExtent:i}),forAllFeatures:function(e,i){return t._forAllFeatures((function(t,i,r){return e({id:t,index:i,meta:r})}),i,O.p1.QUERYABLE)},getFeatureExtent:i,sourceSpatialReference:(0,A.tp)(this.layer),viewSpatialReference:this.view.spatialReference})})}},{key:"highlight",value:function(e){var t=this._highlights;if(e instanceof C.Z){var r=t.acquireSet(),n=r.set,l=r.handle;return this.queryObjectIds(e).then((function(e){return t.setFeatureIds(n,e)})),l}return(0,a.Z)((0,d.Z)(i.prototype),"highlight",this).call(this,e)}},{key:"createInteractiveEditSession",value:function(e){return(0,S.sw)(this._attributeEditingContext,e)}},{key:"_createLayerGraphic",value:function(e){return new y.Z({attributes:e,layer:this.layer,sourceLayer:this.layer})}},{key:"getFilters",value:function(){var e=this,t=(0,a.Z)((0,d.Z)(i.prototype),"getFilters",this).call(this);(0,E.Rx)()&&this.i3sOverrides.is3DOFL&&this.i3sOverrides.sortedGeometryChangedObjectIds.length>0&&t.push((function(t,i){i.node.index>=0&&(0,A.Yb)(e.i3sOverrides.sortedGeometryChangedObjectIds,!1,t)}));var r=this._setVisibilityHiddenObjectIdsSorted;null!=r&&t.push((function(e){return(0,A.Yb)(r,!1,e)}));var n=this._excludeObjectIdsSorted;return null!=n&&t.push((function(e){return(0,A.Yb)(n,!1,e)})),this._floorFilterClause&&this.addSqlFilter(t,this._floorFilterClause,this.logError),this.addSqlFilter(t,this.parsedDefinitionExpression,this.logError),null!=this.viewFilter&&this.viewFilter.addFilters(t,this.view,this._controller.crsIndex,this._collection),t}},{key:"setVisibility",value:function(e,t){t?this._setVisibilityHiddenObjectIds.delete(e):this._setVisibilityHiddenObjectIds.add(e)}},{key:"isUpdating",value:function(){return(0,a.Z)((0,d.Z)(i.prototype),"isUpdating",this).call(this)||this.layerFilterUpdating||null!=this.viewFilter&&this.viewFilter.updating||null!=this.i3sOverrides&&this.i3sOverrides.updating}},{key:"_ensureQuery",value:function(e){return this._addDefinitionExpressionToQuery(null==e?this.createQuery():C.Z.from(e))}},{key:"_attributeEditingContext",get:function(){var e,t=this;return{sessions:this._interactiveEditingSessions,fieldsIndex:this.layer.fieldsIndex,objectIdField:this._getObjectIdField(),globalIdField:this._getGlobalIdField(),forEachNode:function(e){return t._forAllNodes((function(t){return null!=t?e(t.node,t.featureIds):null}))},attributeStorageInfo:null!==(e=this.i3slayer.attributeStorageInfo)&&void 0!==e?e:[],i3sOverrides:this.i3sOverrides,getAttributeData:function(e){return t.getAttributeData(e)},setAttributeData:function(e,i){return t.setAttributeData(e,i)},clearMemCache:function(){return t.clearMemCache()}}}},{key:"_handleEdits",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){var i,n,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,E.Rx)(),n=this._attributeEditingContext,e.next=4,(0,S.Qw)(n,t);case 4:l=e.sent,i&&(0,S.ZS)(n,l),(0,S.Z6)(n,l);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasGeometryFilter",get:function(){var e=this.viewFilter;return null!=(null===e||void 0===e?void 0:e.parsedGeometry)}},{key:"computeNodeFiltering",value:function(e){var t=this.viewFilter;return null==t||!this.view.spatialReference||t.isMBSGeometryVisible(e,this.view.spatialReference,this._controller.crsIndex)?j.U_.Unmodified:j.U_.Culled}}]),i}((0,k.N)((0,L.q)((0,V.l)((0,G.i)((0,m.A)(T.Z))))));(0,h._)([(0,_.Cb)()],B.prototype,"i3slayer",null),(0,h._)([(0,_.Cb)(P.q)],B.prototype,"updatingProgress",void 0),(0,h._)([(0,_.Cb)({type:w.Z})],B.prototype,"filter",null),(0,h._)([(0,_.Cb)({readOnly:!0})],B.prototype,"viewFilter",null),(0,h._)([(0,_.Cb)(Y.requiredFields)],B.prototype,"requiredFields",null),(0,h._)([(0,_.Cb)(Y.availableFields)],B.prototype,"availableFields",void 0),(0,h._)([(0,_.Cb)()],B.prototype,"_fieldsHelper",void 0),(0,h._)([(0,_.Cb)()],B.prototype,"_floorFilterClause",null),(0,h._)([(0,_.Cb)()],B.prototype,"_excludeObjectIdsSorted",null),(0,h._)([(0,_.Cb)()],B.prototype,"_setVisibilityHiddenObjectIds",void 0),(0,h._)([(0,_.Cb)()],B.prototype,"_setVisibilityHiddenObjectIdsSorted",null),(0,h._)([(0,_.Cb)()],B.prototype,"lodFactor",null),(0,h._)([(0,_.Cb)()],B.prototype,"updatingProgressValue",null),(0,h._)([(0,_.Cb)({readOnly:!0})],B.prototype,"visibleAtCurrentScale",null);var W=B=(0,h._)([(0,b.j)("esri.views.3d.layers.SceneLayerView3D")],B)}}]);
//# sourceMappingURL=47745.89f3da58.chunk.js.map