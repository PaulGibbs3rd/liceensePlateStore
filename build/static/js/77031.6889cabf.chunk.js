"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[77031],{77031:function(e,t,n){n.r(t),n.d(t,{arcgis_version_management:function(){return p}});var i=n(37762),r=n(29439),o=n(74165),s=n(1413),a=n(15861),c=n(15671),l=n(43144),u=n(62042),v=n(53466),d=n(34872),f=n(62153),h=n(64880),m=(n(14285),(0,h.m)(f.ag)),p=function(){function e(t){(0,c.Z)(this,e),(0,u.r)(this,t),this.arcgisReady=(0,u.c)(this,"arcgisReady",7),this.arcgisVersioningStateChanged=(0,u.c)(this,"arcgisVersioningStateChanged",7),this.manager=(0,d.u)(this),this.reactiveUtils=(0,v.l)(f.i),this.viewModel=m(this),this.messages=this.manager.readonly((0,h.u)({blocking:!0})),this.allowEditingDisabled=!1,this.autoDestroyDisabled=!1,this.closable=!1,this.icon=void 0,this.label=void 0,this.mode=void 0,this.pageSize=5,this.position="top-right",this.referenceElement=void 0,this.state=this.viewModel.state,this.versioningStates=this.viewModel.versioningStates,this.view=this.viewModel.view}return(0,l.Z)(e,[{key:"componentWillLoad",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t,n=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.reactiveUtils.watch,this.manager.onLifecycle((function(){return[t((function(){return n.viewModel.state}),(function(e){var t=n.flowElement,i=null===t||void 0===t?void 0:t.getElementsByTagName("arcgis-version-management-version-properties")[0],r=null===t||void 0===t?void 0:t.getElementsByTagName("arcgis-version-management-version-list")[0];if("disabled"===e)return i&&n._removeVersionPropertiesFlowItem(t),void(r&&n._removeVersionListFlowItem(t));r&&(r.versionListElementProps=(0,s.Z)((0,s.Z)({},r.versionListElementProps),{},{executionError:n.viewModel.executionError}),r.versionListElementProps=(0,s.Z)((0,s.Z)({},r.versionListElementProps),{},{state:e})),i&&(i.versionPropertiesElementProps=(0,s.Z)((0,s.Z)({},i.versionPropertiesElementProps),{},{state:e}))}))]}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.manager.destroy();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.allowEditingDisabled,n=this.closable,i=this.flowElement,s=this.label,c=this.messages,l=this.pageSize,v=this.viewModel,d=this.viewModel,f=d.loadError,h=d.state,m=Array.from(v.serviceNameLookup,(function(e){var t=(0,r.Z)(e,2);return{url:t[0],name:t[1]}})),p="disabled"!==h?(0,u.h)(u.F,null,m.map((function(r){var d,f,m,p={allowEditing:!t,closable:n,currentUser:v.userLookup.get(r.url),currentVersionIdentifier:v.versioningStateLookup.get(r.url).currentVersionInfo.versionIdentifier,executionError:void 0,flowElement:i,hasAdvEditingUte:v.advancedEditingUserTypeExtensionLookup.get(r.url),heading:s,isVersioningApiAvailable:(null!==(d=v.serverVersionLookup.get(r.url))&&void 0!==d?d:0)>=11.2,pageSize:l,serviceName:r.name,state:h,serviceUrl:r.url,strings:c,versionInfos:null!==(f=null===(m=v.versioningStateLookup.get(r.url))||void 0===m?void 0:m.versionInfos)&&void 0!==f?f:[]};return(0,u.h)("arcgis-version-management-service-item",{serviceItemElementProps:p,onArcgisGetVersions:function(){var t=(0,a.Z)((0,o.Z)().mark((function t(n){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._refreshVersionList(n.detail.serviceUrl);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onArcgisFlowItemBack:function(){e._removeVersionListFlowItem(i)},onArcgisFlowItemClose:function(){e._handleFlowItemClose()},onArcgisManageVersion:function(t){e._handleManageVersionAction(t,i)},onArcgisNewVersion:function(t){var n=e._createVersionPropertiesFlowItem(t.detail.serviceUrl,void 0);null===i||void 0===i||i.appendChild(n)}})}))):void 0,g="disabled"===h?(0,u.h)("calcite-notice",{class:"notice",closable:!1,kind:"warning",open:!0,scale:"s",slot:"footer",width:"full"},(0,u.h)("div",{slot:"message"},this._getLoadError(f))):void 0;return(0,u.h)("calcite-flow",{ref:function(t){e.flowElement=t},class:"dialog"===this.mode?"":"calcite-flow-widget"},(0,u.h)("calcite-flow-item",{closable:this.closable,heading:s,onCalciteFlowItemClose:function(){e._handleFlowItemClose()}},(0,u.h)("calcite-panel",{loading:"loading"===h||"executing"===h},p,g)))}},{key:"_createVersionPropertiesFlowItem",value:function(e,t){var n=this,i=this.closable,r=this.flowElement,s=this.viewModel,c=this.viewModel.state,l=document.createElement("arcgis-version-management-version-properties");return l.versionPropertiesElementProps={closable:i,currentUser:s.userLookup.get(e),hasAdvEditingUte:s.advancedEditingUserTypeExtensionLookup.get(e),serviceUrl:e,state:c,strings:this.messages,versionInfo:t},l.addEventListener("arcgisCreateVersion",(function(t){var i=t.detail,c=i.createVersionParameters,l=i.switchToVersion;s.createVersion(c).then(function(){var t=(0,a.Z)((0,o.Z)().mark((function t(i){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i&&n.arcgisVersioningStateChanged.emit({type:"version-created",versionIdentifier:i.versionIdentifier,versioningState:s.versioningStateLookup.get(e)}),!l){t.next=4;break}return t.next=4,n.viewModel.changeVersion(e,i.versionIdentifier.name,i.versionIdentifier.guid).then((function(t){t&&n.arcgisVersioningStateChanged.emit({type:"version-switched",versionIdentifier:i.versionIdentifier,versioningState:s.versioningStateLookup.get(e)})}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((0,a.Z)((0,o.Z)().mark((function t(){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._refreshVersionList(e);case 2:n._removeVersionPropertiesFlowItem(r);case 3:case"end":return t.stop()}}),t)}))))})),l.addEventListener("arcgisAlterVersion",function(){var t=(0,a.Z)((0,o.Z)().mark((function t(i){var r,c;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.flowElement,c=i.detail.alterVersionParameters,t.next=4,s.alterVersion(c).then(function(){var t=(0,a.Z)((0,o.Z)().mark((function t(i){return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i&&n.arcgisVersioningStateChanged.emit({type:"version-changed",versionIdentifier:c.versionIdentifier,versioningState:s.versioningStateLookup.get(e)}),t.next=3,n._refreshVersionList(e);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).finally((function(){n._removeVersionPropertiesFlowItem(r)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),l.addEventListener("arcgisFlowItemBack",(function(){n._removeVersionPropertiesFlowItem(n.flowElement)})),l.addEventListener("calciteFlowItemBack",(function(e){e.preventDefault(),n._removeVersionPropertiesFlowItem(n.flowElement)})),l.addEventListener("calciteFlowItemClose",(function(){n._handleFlowItemClose()})),l}},{key:"_getLoadError",value:function(e){var t=this.messages;switch(e){case"no-feature-services":return t.loadErrors.noFeatureServices;case"no-view-property":return t.loadErrors.noViewProperty;default:return e}}},{key:"_handleFlowItemClose",value:function(){var e=document.querySelector("arcgis-version-management"),t=e.parentElement;null===t||void 0===t||t.removeChild(e)}},{key:"_handleManageVersionAction",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t,n){var i,r,c,l,u,v,d=this;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.detail,r=i.actionType,c=i.serviceUrl,l=i.versionInfo,u=this.viewModel,e.t0=r,e.next="changeVersion"===e.t0?5:"deleteVersion"===e.t0?7:"editVersion"===e.t0?9:12;break;case 5:return u.changeVersion(c,l.versionIdentifier.name,l.versionIdentifier.guid).then((function(e){e&&d.arcgisVersioningStateChanged.emit({type:"version-switched",versionIdentifier:l.versionIdentifier,versioningState:u.versioningStateLookup.get(c)});var t=null===n||void 0===n?void 0:n.getElementsByTagName("arcgis-version-management-version-list")[0];t&&t&&(t.versionListElementProps=(0,s.Z)((0,s.Z)({},t.versionListElementProps),{},{currentVersionIdentifier:u.versioningStateLookup.get(c).currentVersionInfo.versionIdentifier}))})),e.abrupt("break",12);case 7:return u.deleteVersion(c,l.versionIdentifier.name,l.versionIdentifier.guid).then(function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&d.arcgisVersioningStateChanged.emit({type:"version-deleted",versionIdentifier:l.versionIdentifier,versioningState:u.versioningStateLookup.get(c)}),e.next=3,d._refreshVersionList(c);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("break",12);case 9:return v=this._createVersionPropertiesFlowItem(c,l),n.appendChild(v),e.abrupt("break",12);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_refreshVersionList",value:function(){var e=(0,a.Z)((0,o.Z)().mark((function e(t){var n,r,a,c,l,u,v,d;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.flowElement,r=this.viewModel,!n){e.next=10;break}return e.next=4,r.getVersionInfos(t);case 4:a=e.sent,c=n.getElementsByTagName("arcgis-version-management-service-item"),l=(0,i.Z)(c);try{for(l.s();!(u=l.n()).done;)(v=u.value).serviceItemElementProps.serviceUrl===t&&(v.serviceItemElementProps=(0,s.Z)((0,s.Z)({},v.serviceItemElementProps),{},{versionInfos:a}))}catch(o){l.e(o)}finally{l.f()}(d=n.getElementsByTagName("arcgis-version-management-version-list")[0])&&(d.versionListElementProps=(0,s.Z)((0,s.Z)({},d.versionListElementProps),{},{currentVersionIdentifier:r.versioningStateLookup.get(t).currentVersionInfo.versionIdentifier,versionInfos:a}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_removeVersionListFlowItem",value:function(e){var t,n=(0,i.Z)(e.childNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;"ARCGIS-VERSION-MANAGEMENT-VERSION-LIST"===r.nodeName.toUpperCase()&&e.removeChild(r),"CALCITE-FLOW-ITEM"===r.nodeName.toUpperCase()&&(r.hidden=!1)}}catch(o){n.e(o)}finally{n.f()}}},{key:"_removeVersionPropertiesFlowItem",value:function(e){var t,n=(0,i.Z)(e.childNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;"ARCGIS-VERSION-MANAGEMENT-VERSION-PROPERTIES"===r.nodeName.toUpperCase()&&e.removeChild(r),"ARCGIS-VERSION-MANAGEMENT-VERSION-LIST"===r.nodeName.toUpperCase()&&(r.getElementsByTagName("calcite-flow-item")[0].hidden=!1)}}catch(o){n.e(o)}finally{n.f()}}},{key:"el",get:function(){return(0,u.g)(this)}}],[{key:"assetsDirs",get:function(){return["assets"]}}]),e}();p.style=".calcite-flow-widget{width:350px}calcite-block{margin:0}calcite-pagination{justify-content:center}"},53466:function(e,t,n){n.d(t,{l:function(){return s},m:function(){return a},u:function(){return c}});var i=n(1413),r=n(34872),o=n(62153),s=function(e){return(0,r.b)(e)},a=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.blocking,s=void 0!==n&&n,a=t.name;return(0,r.b)((function(t,n){if(n.onLifecycle((function(){return(0,o.s)(t.el,e("./assets"),(function(e){var r,o=e.t9nLocale,s=e.t9nStrings,a=e.lang;n.exports=(0,i.Z)((0,i.Z)({},s),{},{_lang:a,_t9nLocale:o});var c,l=null!==(r=s.componentLabel)&&void 0!==r?r:s.widgetLabel;"string"===typeof l&&"label"in t&&null==t.label&&(null!==(c=t.label)&&void 0!==c||(t.label=l))}),a)})),s)return n.ready;var r=(0,o.g)(t.el);return{_lang:r.lang,_t9nLocale:r.t9nLocale}}))}},c=function(e){return u},l="arcgisPropertyChange",u=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.b)((function(e,n){var i=e;e.manager.isLit&&(i[l]={emit:function(t){var n=new CustomEvent(l,{detail:t,cancelable:!0});return e.el.dispatchEvent(n),n}});var r=i[l];return n.onLoad((function(){return n.onLifecycle((function(){return t.map((function(t){return e.manager.watch(t,(function(){return r.emit({name:t})}))}))}))})),r}))}},64880:function(e,t,n){n.d(t,{m:function(){return m},u:function(){return w}});var i=n(74165),r=n(15861),o=n(15671),s=n(43144),a=n(88301),c=n(61120),l=n(60136),u=n(29388),v=n(34872),d=(n(62153),n(14285)),f=n(53466),h=n(62042),m=function(e,t){return function(t,n){return g(t,e,n)}},p=function(e){(0,l.Z)(n,e);var t=(0,u.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"hostConnected",value:function(){this.component.manager.didLoadCalled&&(0,d.a)(this.component)}},{key:"hostLoad",value:function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.Z)((0,c.Z)(n.prototype),"hostLoad",this).call(this);case 2:if(!this.component.manager.destroyed){e.next=4;break}return e.abrupt("return");case 4:this._watchMetaProperties(),v.a.reEmitAccessorEvents(this,this._instance,this.reactiveUtils,"viewModel");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hostLoaded",value:function(){var e,t,n,i=this,r=this.component.el,o=null!==(e=null!==(t=null===(n=r.shadowRoot)||void 0===n?void 0:n.firstElementChild)&&void 0!==t?t:r.firstElementChild)&&void 0!==e?e:void 0;r.childElem=null!==o&&void 0!==o?o:r.childElem,r.childElem;var s=!1,a=this.component.el.view;Object.defineProperty(this.component.el,"view",{get:function(){return i._instance.view},set:function(e){i._instance.view=e,i._watchViewDestroy(),i.component.requestUpdate(),s||(s=!0,i.component.arcgisReady.emit())},configurable:!0,enumerable:!0}),a&&(this._instance.view=a),this.component.el.isConnected&&((0,d.a)(this.component),this._watchViewDestroy())}},{key:"hostDisconnected",value:function(){var e,t;"object"===typeof this.component.el.childElem&&(null===(e=this.component.el.view)||void 0===e||null===(t=e.ui)||void 0===t||t.remove(this.component.el.childElem))}},{key:"hostDestroy",value:function(){var e;(0,a.Z)((0,c.Z)(n.prototype),"hostDestroy",this).call(this),null===(e=this._watchViewDestroyHandle)||void 0===e||e.remove()}},{key:"_watchMetaProperties",value:function(){var e=this;this.watch("position",(function(t){null!=e.component.el.childElem&&"string"===typeof t&&(0,d.a)(e.component)})),this.watch("referenceElement",(function(){return(0,d.a)(e.component)}))}},{key:"_watchViewDestroy",value:function(){var e,t=this;null===(e=this._watchViewDestroyHandle)||void 0===e||e.remove(),this._watchViewDestroyHandle=this.reactiveUtils.when((function(){var e;return!0===(null===(e=t.component.el.view)||void 0===e?void 0:e.destroyed)}),(function(){t.component.destroy().catch(console.error)}),{sync:!0})}}]),n}(v.A),g=(0,v.p)(p),w=(0,f.m)(h.a)}}]);
//# sourceMappingURL=77031.6889cabf.chunk.js.map