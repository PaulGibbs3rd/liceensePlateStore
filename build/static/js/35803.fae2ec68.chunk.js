"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[35803],{21389:function(e,t,r){function n(){return[1,0,0,0,1,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}function a(e,t,r,n,i,a,o,u,s){return[e,t,r,n,i,a,o,u,s]}r.d(t,{Ue:function(){return n},Wd:function(){return o},al:function(){return a},d9:function(){return i}});var o=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:o,clone:i,create:n,createView:function(e,t){return new Float64Array(e,t,9)},fromValues:a},Symbol.toStringTag,{value:"Module"}))},67593:function(e,t,r){r.d(t,{E:function(){return d},H:function(){return h}});var n=r(29439),i=r(29303),a=r(21389),o=r(13611),u=r(32035),s=(0,r(12400).Ue)(),l=(0,a.Ue)(),c=(0,a.Ue)(),f=(0,a.Ue)();function h(e,t,r){return(0,u.s)(s,t[0],t[1],1),(0,u.t)(s,s,(0,i.p4)(l,r)),0===s[2]?(0,o.t8)(e,s[0],s[1]):(0,o.t8)(e,s[0]/s[2],s[1]/s[2])}function d(e,t,r){return m(c,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),m(f,r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]),(0,i.Jp)(e,(0,i.uj)(c,c),f),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}function m(e,t,r,a,o,c,f,h,d){(0,i.t8)(e,t,a,c,r,o,f,1,1,1),(0,u.s)(s,h,d,1),(0,i.uj)(l,e);var m=(0,u.t)(s,s,(0,i.p4)(l,l)),v=(0,n.Z)(m,3),p=v[0],y=v[1],_=v[2];return(0,i.t8)(l,p,0,0,0,y,0,0,0,_),(0,i.Jp)(e,l,e)}},91958:function(e,t,r){r.d(t,{$7:function(){return m},$e:function(){return s},N5:function(){return d},lW:function(){return l}});var n=r(74165),i=r(15861),a=(r(93169),r(10064)),o=r(66978),u=r(35995);function s(e){var t=h(e);return null!=t?t.toDataURL():""}function l(e,t){return c.apply(this,arguments)}function c(){return c=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,u,s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(i=h(t))){e.next=3;break}throw new a.Z("imageToArrayBuffer","Unsupported image type");case 3:return u=f(t),e.next=6,new Promise((function(e){return i.toBlob(e,u)}));case 6:if(s=e.sent,(0,o.k_)(r),s){e.next=9;break}throw new a.Z("imageToArrayBuffer","Failed to encode image");case 9:return e.next=11,s.arrayBuffer();case 11:return l=e.sent,e.abrupt("return",((0,o.k_)(r),{data:l,type:u}));case 13:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function f(e){if(!(e instanceof HTMLImageElement))return"image/png";var t=e.src;if((0,u.HK)(t)){var r=(0,u.sJ)(t);return"image/jpeg"===(null===r||void 0===r?void 0:r.mediaType)?r.mediaType:"image/png"}return/\.png$/i.test(t)?"image/png":/\.(jpg|jpeg)$/i.test(t)?"image/jpeg":"image/png"}function h(e){if(e instanceof HTMLCanvasElement)return e;if(e instanceof HTMLVideoElement)return null;var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var r=t.getContext("2d");return e instanceof HTMLImageElement?r.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&r.putImageData(e,0,0),t}function d(e){for(var t=[],r=new Uint8Array(e),n=0;n<r.length;n++)t.push(String.fromCharCode(r[n]));return"data:application/octet-stream;base64,"+btoa(t.join(""))}function m(e){if(e.byteLength<8)return!1;var t=new Uint8Array(e);return 137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7]}},59568:function(e,t,r){r.d(t,{L:function(){return v}});var n=r(15671),i=r(43144),a=r(60136),o=r(29388),u=r(27366),s=r(7138),l=r(49861),c=(r(93169),r(32718),r(84936),r(69912)),f=r(80885),h=r(79803),d=r(65156),m=r(47991),v=function(e){(0,a.Z)(r,e);var t=(0,o.Z)(r);function r(e){return(0,n.Z)(this,r),t.call(this,e)}return(0,i.Z)(r,[{key:"bounds",get:function(){var e=this.coords;return null==(null===e||void 0===e?void 0:e.extent)?null:(0,d.oJ)(e.extent)}},{key:"coords",get:function(){var e,t=null===(e=this.element.georeference)||void 0===e?void 0:e.coords;return(0,h.projectOrLoad)(t,this.spatialReference).geometry}},{key:"normalizedCoords",get:function(){return f.Z.fromJSON((0,m.Ui)(this.coords))}},{key:"normalizedBounds",get:function(){var e=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=e?(0,d.oJ)(e):null}}]),r}(s.default);(0,u._)([(0,l.Cb)()],v.prototype,"spatialReference",void 0),(0,u._)([(0,l.Cb)()],v.prototype,"element",void 0),(0,u._)([(0,l.Cb)()],v.prototype,"bounds",null),(0,u._)([(0,l.Cb)()],v.prototype,"coords",null),(0,u._)([(0,l.Cb)()],v.prototype,"normalizedCoords",null),(0,u._)([(0,l.Cb)()],v.prototype,"normalizedBounds",null),v=(0,u._)([(0,c.j)("esri.layers.support.MediaElementView")],v)},70508:function(e,t,r){r.d(t,{Z:function(){return T}});var n=r(29439),i=r(93433),a=r(37762),o=r(15671),u=r(43144),s=r(88301),l=r(61120),c=r(60136),f=r(29388),h=r(29303),d=r(8768),m=r(30932),v=r(93311),p=r(91340),y=r(92975),_=r(86226),g=r(34702),w=r(80613),T=function(e){(0,c.Z)(r,e);var t=(0,f.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments))._viewStateId=-1,e._dvsMat3=(0,d.Ue)(),e}return(0,u.Z)(r,[{key:"dvsMat3",get:function(){return this._dvsMat3}},{key:"beforeRender",value:function(e){this._updateMatrices(e),this._updateOverlays(e,this.children);var t,r=(0,a.Z)(this.children);try{for(r.s();!(t=r.n()).done;){t.value.beforeRender(e)}}catch(n){r.e(n)}finally{r.f()}}},{key:"prepareRenderPasses",value:function(e){var t=this,n=e.registerRenderPass({name:"overlay",brushes:[g.U.overlay],target:function(){return t.children},drawPhase:w.jx.MAP});return[].concat((0,i.Z)((0,s.Z)((0,l.Z)(r.prototype),"prepareRenderPasses",this).call(this,e)),[n])}},{key:"_updateMatrices",value:function(e){var t=e.state,r=t.id,n=t.size,i=t.pixelRatio,a=t.resolution,o=t.rotation,u=t.viewpoint,s=t.displayMat3;if(this._viewStateId!==r){var l=Math.PI/180*o,c=i*n[0],f=i*n[1];this._localOrigin=u.targetGeometry.clone();var d=this._localOrigin,y=d.x,_=d.y,g=(0,p.or)(y,t.spatialReference);this._localOrigin.x=g,this._localOrigin.y=_;var w=a*c,T=a*f,E=(0,h.yR)(this._dvsMat3);(0,h.Jp)(E,E,s),(0,h.Iu)(E,E,(0,m.al)(c/2,f/2)),(0,h.bA)(E,E,(0,v.al)(c/w,-f/T,1)),(0,h.U1)(E,E,-l),this._viewStateId=r}}},{key:"_updateOverlays",value:function(e,t){var r,i=e.state,o=i.rotation,u=i.spatialReference,s=i.worldScreenWidth,l=i.size,c=i.viewpoint,f=this._localOrigin,h=0,d=(0,y.C5)(u);if(d&&u.isWrappable){var m=l[0],v=l[1],p=180/Math.PI*o,g=Math.abs(Math.cos(p)),w=Math.abs(Math.sin(p)),T=Math.round(m*g+v*w),E=(0,n.Z)(d.valid,2),Z=E[0],b=E[1],x=(0,_.ut)(u),A=c.targetGeometry,k=A.x,C=[k,A.y],R=[0,0];i.toScreen(R,C);var M,S=[0,0];M=T>s?.5*s:.5*T;var D=Math.floor((k+.5*x)/x),F=Z+D*x,U=b+D*x,I=[R[0]+M,0];i.toMap(S,I),S[0]>U&&(h=x),I[0]=R[0]-M,i.toMap(S,I),S[0]<F&&(h=-x),r={worldWidth:x,xBounds:[Z,b]}}var V,L=(0,a.Z)(t);try{for(L.s();!(V=L.n()).done;){V.value.updateDrawCoords(f,h,u,r)}}catch(P){L.e(P)}finally{L.f()}}}]),r}(r(86438).Z)},25999:function(e,t,r){r.d(t,{hY:function(){return h}});var n=r(15671),i=r(43144),a=r(42537),o=r(38499),u=(r(91958),r(48202)),s=r(93592);function l(e,t){var r=e.width,n=e.height,i=e.getFrame,a=e.frameDurations.slice(),u=a.pop();return a.push((0,o.HA)(u+t)),{frameCount:e.frameCount,duration:e.duration+t,frameDurations:a,getFrame:i,width:r,height:n}}var c=function(){function e(t,r,i,a){(0,n.Z)(this,e),this._animation=t,this._repeatType=i,this._onFrameData=a,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];for(var o=0;r>o;)o+=this.timeToFrame,this.nextFrame();var u=this._animation.getFrame(this._currentFrame);this._onFrameData(u)}return(0,i.Z)(e,[{key:"nextFrame",value:function(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case u.of.None:this._currentFrame-=this._direction;break;case u.of.Loop:this._currentFrame=0;break;case u.of.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case u.of.None:this._currentFrame-=this._direction;break;case u.of.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case u.of.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];var e=this._animation.getFrame(this._currentFrame);this._onFrameData(e)}}]),e}();function f(e,t,r,n){var i,a=t.repeatType;if(null==a&&(a=u.of.Loop),!0===t.reverseAnimation&&(e=function(e){var t=e.width,r=e.height,n=e.frameDurations.reverse();return{frameCount:e.frameCount,duration:e.duration,frameDurations:n,getFrame:function(t){var r=e.frameDurations.length-1-t;return e.getFrame(r)},width:t,height:r}}(e)),null!=t.duration&&(e=function(e,t){var r=e.width,n=e.height,i=e.getFrame,a=t/e.duration,u=e.frameDurations.map((function(e){return(0,o.HA)(e*a)}));return{frameCount:e.frameCount,duration:e.duration,frameDurations:u,getFrame:i,width:r,height:n}}(e,(0,o.HA)(1e3*t.duration))),null!=t.repeatDelay){var f=1e3*t.repeatDelay;a===u.of.Loop?e=l(e,(0,o.HA)(f)):a===u.of.Oscillate&&(e=function(e,t){var r=e.width,n=e.height,i=e.getFrame,a=e.frameDurations.slice(),u=a.shift();return a.unshift((0,o.HA)(u+t)),{frameCount:e.frameCount,duration:e.duration+t,frameDurations:a,getFrame:i,width:r,height:n}}(l(e,(0,o.HA)(f/2)),(0,o.HA)(f/2)))}if(null!=t.startTimeOffset)i=(0,o.HA)(1e3*t.startTimeOffset);else if(null!=t.randomizeStartTime){var h=null!=t.randomizeStartSeed?t.randomizeStartSeed:82749913,d=(0,s.f)(r,h);i=(0,o.HA)(d*function(e){return(0,o.HA)(e.frameDurations.reduce((function(e,t){return e+t}),0))}(e))}else i=(0,o.HA)(0);return new c(e,i,a,n)}function h(e,t,r,n){var i,o=null==t.playAnimation||t.playAnimation,u=f(e,t,r,n),s=u.timeToFrame;return function e(){i=o?setTimeout((function(){u.nextFrame(),s=u.timeToFrame,e()}),s):void 0}(),(0,a.kB)((function(){return o&&clearTimeout(i)}))}},93592:function(e,t,r){r.d(t,{c:function(){return a},f:function(){return i}});var n=r(643);function i(e,t){var r;if("string"==typeof e)r=(0,n.hP)(e+"-seed(".concat(t,")"));else{var i=12;r=e^t;do{r=107*(r>>8^r)+i|0}while(0!=--i)}return(1+r/(1<<31))/2}function a(e){return Math.floor(i(e,o)*u)}var o=53290320,u=10},62613:function(e,t,r){r.r(t),r.d(t,{default:function(){return re}});var n=r(29439),i=r(74165),a=r(37762),o=r(15861),u=r(15671),s=r(43144),l=r(88301),c=r(61120),f=r(60136),h=r(29388),d=r(27366),m=(r(59486),r(52639),r(94931),r(15126),r(98689),r(57823),r(32066),r(49018),r(34999),r(28189),r(9014),r(32718)),v=(r(51508),r(80987)),p=(r(93169),r(77427)),y=r(66978),_=r(94172),g=r(49861),w=(r(84936),r(69912)),T=r(65156),E=r(34066),Z=r(66504),b=r(59568),x=r(10064),A=(r(99346),r(86741),r(86950),r(42265),r(73268),r(13005),r(53866)),k=(r(32238),r(77577),r(848),r(80885),r(29909),r(14320),r(92975),r(40316),r(81241),r(8878),r(65057),r(53704),r(38901),r(13874),r(24434),r(12869),r(69093),r(91583),r(67993),r(64369),r(13957),r(38236),r(53986),r(1243),r(81624),r(50516),r(46628),r(93268),r(63156),r(48202)),C=(r(16889),r(94109),r(30932),r(38999),r(61574),r(26707),r(46228),r(41978),r(91505),r(39594),r(80613),r(13594),r(99894),r(37825),r(8548)),R=(r(53634),r(3667),r(46888),r(57808)),M=(r(52120),r(61441),r(68571),r(67466),r(15532),r(73271),r(34517),r(86909),r(21391),r(10106),r(53456),r(76200),r(35995),r(78084),r(92841),r(93985),r(13163),r(93560),r(29660),r(755),r(94538),r(61669),r(11486),r(35783),r(72516),r(5964),r(69986),r(41414),r(51995),r(24799),r(7467),r(4297),r(99536),r(16336),r(36207),r(98634),r(39416),r(70812),r(85992),r(79347),r(93311),r(76335),r(78952),r(22186),r(19545),r(582),r(14921),r(46634),r(69610),r(37995),r(73828),r(32344)),S=r(85269),D=r(1413),F=r(98928),U=r(92026),I=r(67593),V=r(21389),L=r(13611),P=r(6644),O=r(87422),X=r(25999),H=r(44070),Q=r(52311),j=r(45412),G=[1,1],B=(0,V.Ue)(),q={none:k.of.None,loop:k.of.Loop,oscillate:k.of.Oscillate};var z=function(e){(0,f.Z)(r,e);var t=(0,h.Z)(r);function r(e){var n;return(0,u.Z)(this,r),(n=t.call(this)).elementView=e,n.isWrapAround=!1,n.wrapAroundShift=0,n.perspectiveTransform=(0,P.Ue)(),n._playHandle=null,n._vertices=new Float32Array(20),n._handles=[],n._handles.push((0,_.watch)((function(){return n.elementView.element.opacity}),(function(e){return n.opacity=e}),_.initial),(0,_.watch)((function(){return[n.elementView.coords]}),(function(){n.requestRender()}),_.initial),(0,_.watch)((function(){return["animationOptions"in n.elementView.element&&n.elementView.element.animationOptions]}),(function(){var e;null!==(e=n._playHandle)&&void 0!==e&&e.remove(),n.texture=(0,U.M2)(n.texture),n.requestRender()}),_.initial),(0,_.when)((function(){return n.elementView.element.loaded}),(function(){var e=n.elementView.element;n.ready(),"video"===e.type&&null!=e.content&&n._handles.push((0,F.on)(e.content,"play",(function(){return n.requestRender()})))}),_.initial)),e.element.load().catch((function(t){m.Z.getLogger("esri.views.2d.layers.MediaLayerView2D").error(new x.Z("element-load-error","Element cannot be displayed",{element:e,error:t}))})),n}return(0,s.Z)(r,[{key:"getMesh",value:function(e){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){var e;null!==(e=this._playHandle)&&void 0!==e&&e.remove(),this._handles.forEach((function(e){return e.remove()})),this.texture=(0,U.M2)(this.texture)}},{key:"textureSize",get:function(){return G}},{key:"dvsMat3",get:function(){return this.parent.dvsMat3}},{key:"beforeRender",value:function(e){var t=this,n=e.context,i=this.elementView.element.content;if(null!=i){var a=i instanceof HTMLImageElement,o=i instanceof HTMLVideoElement,u=a?i.naturalWidth:o?i.videoWidth:i.width,s=a?i.naturalHeight:o?i.videoHeight:i.height;if(this._updatePerspectiveTransform(u,s),this.texture)o&&!i.paused&&(this.texture.setData(i),this.requestRender(),this.texture.generateMipmap());else{var f=new Q.X;if(f.wrapMode=C.e8.CLAMP_TO_EDGE,f.preMultiplyAlpha=!0,f.width=u,f.height=s,"getFrame"in i){"animationOptions"in this.elementView.element&&(this._playHandle=(0,X.hY)(i,function(e){return e?(0,D.Z)((0,D.Z)({},e),{},{playAnimation:e.playing,repeatType:e.repeatType?q[e.repeatType]:void 0}):{}}(this.elementView.element.animationOptions),null,(function(e){t.texture?t.texture.setData(e):t.texture=new R.x(n,f,e),t.requestRender()})))}else this.texture=new R.x(n,f,i);this.texture.generateMipmap(),o&&!i.paused&&this.requestRender()}}(0,l.Z)((0,c.Z)(r.prototype),"beforeRender",this).call(this,e)}},{key:"_createTransforms",value:function(){return null}},{key:"draw",value:function(e){e.drawArrays(C.MX.TRIANGLE_STRIP,0,4)}},{key:"updateDrawCoords",value:function(e,t,r,i){var a=this.elementView,o=a.coords,u=a.bounds;if(null!=o&&null!=u){var s=(0,n.Z)(o.rings[0],4),l=s[0],c=s[1],f=s[2],h=s[3],d=this._vertices,m=e.x,v=e.y;d.set([c[0]-m,c[1]-v,l[0]-m,l[1]-v,f[0]-m,f[1]-v,h[0]-m,h[1]-v]);var p=t;if(i){var y=(0,n.Z)(u,3),_=y[0],g=y[2],w=i.worldWidth,T=i.xBounds,E=(0,n.Z)(T,2),Z=E[0],b=E[1];_<Z&&g>Z?p=w:g>b&&_<b&&(p=-w)}this.wrapAroundShift=p,this.isWrapAround=0!==p}}},{key:"getVAO",value:function(e,t,r){if(null==this.elementView.coords)return null;var n=this._vertices;if(this._vao)this._geometryVbo.setData(n);else{this._geometryVbo=H.f.createVertex(e,C.l1.DYNAMIC_DRAW,n);var i=H.f.createVertex(e,C.l1.STATIC_DRAW,new Uint16Array([0,0,0,1,1,0,1,1,1,1,0,0,0,0,0,1,1,0,1,1]));this._vao=new j.U(e,r,t,{geometry:this._geometryVbo,tex:i})}return this._vao}},{key:"_updatePerspectiveTransform",value:function(e,t){var r=this._vertices;(0,I.E)(B,[0,0,e,0,0,t,e,t],[r[0],r[1],r[4],r[5],r[2],r[3],r[6],r[7]]),(0,L.t8)(this.perspectiveTransform,B[6]/B[8]*e,B[7]/B[8]*t)}}]),r}(O.s),N=r(70508),W=r(65457),Y=r(67581),J=function(e){(0,f.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;return(0,u.Z)(this,r),(e=t.apply(this,arguments))._overlayContainer=null,e._fetchQueue=null,e._tileStrategy=null,e._elementReferences=new Map,e._debugGraphicsView=null,e.layer=null,e.elements=new v.Z,e}return(0,s.Z)(r,[{key:"attach",value:function(){var e=this;this.addAttachHandles([(0,_.on)((function(){return e.layer.effectiveSource}),"refresh",(function(){e._tileStrategy.refresh((function(t){return e._updateTile(t)})),e.requestUpdate()})),(0,_.on)((function(){return e.layer.effectiveSource}),"change",(function(t){var r=t.element;return e._elementUpdateHandler(r)}))]),this._overlayContainer=new N.Z,this.container.addChild(this._overlayContainer),this._fetchQueue=new M.Z({tileInfoView:this.view.featuresTilingScheme,concurrency:10,process:function(t,r){return e._queryElements(t,r)}}),this._tileStrategy=new S.Z({cachePolicy:"purge",resampling:!0,acquireTile:function(t){return e._acquireTile(t)},releaseTile:function(t){return e._releaseTile(t)},tileInfoView:this.view.featuresTilingScheme}),this.requestUpdate()}},{key:"detach",value:function(){var e;this.elements.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.destroy(),this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this._elementReferences.clear(),null===(e=this._debugGraphicsView)||void 0===e||e.destroy()}},{key:"supportsSpatialReference",value:function(e){return!0}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"update",value:function(e){var t;this._tileStrategy.update(e),null===(t=this._debugGraphicsView)||void 0===t||t.update(e)}},{key:"hitTest",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,r){var n,o,u,s,l,c,f,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=t.normalize(),u=[o.x,o.y],s=(0,a.Z)(this._elementReferences.values());try{for(s.s();!(l=s.n()).done;)c=l.value.projectedElement,f=c.normalizedCoords,h=c.element,null!=f&&(0,E.wP)(f.rings,u)&&n.push({type:"media",element:h,layer:this.layer,mapPoint:t,sourcePoint:h.toSource(t)})}catch(r){s.e(r)}finally{s.f()}return e.abrupt("return",n.reverse());case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){return null!=this.layer.source&&(0,l.Z)((0,c.Z)(r.prototype),"canResume",this).call(this)}},{key:"doRefresh",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._fetchQueue.reset(),this._tileStrategy.refresh((function(e){return t._updateTile(e)}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_acquireTile",value:function(e){var t=new te(e.clone());return this._updateTile(t),t}},{key:"_updateTile",value:function(e){var t=this;this._updatingHandles.addPromise(this._fetchQueue.push(e.key).then((function(r){var i=e.setElements(r),a=(0,n.Z)(i,2),o=a[0],u=a[1];t._referenceElements(e,o),t._dereferenceElements(e,u),t.requestUpdate()}),(function(e){(0,y.D_)(e)||m.Z.getLogger(t).error(e)})))}},{key:"_releaseTile",value:function(e){this._fetchQueue.abort(e.key.id),e.elements&&this._dereferenceElements(e,e.elements),this.requestUpdate()}},{key:"_queryElements",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,r){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.layer.effectiveSource)){e.next=3;break}return e.abrupt("return",[]);case 3:return this.view.featuresTilingScheme.getTileBounds($,t,!0),a=new A.Z({xmin:$[0],ymin:$[1],xmax:$[2],ymax:$[3],spatialReference:this.view.spatialReference}),e.abrupt("return",n.queryElements(a,r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_referenceElements",value:function(e,t){if(null!=this.layer.source){var r,n=(0,a.Z)(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._referenceElement(e,i)}}catch(o){n.e(o)}finally{n.f()}}}},{key:"_referenceElement",value:function(e,t){var r=this;(0,p.s1)(this._elementReferences,t.uid,(function(){var e=new b.L({element:t,spatialReference:r.view.spatialReference}),n=new z(e);r._overlayContainer.addChild(n),r.elements.add(t);return{tiles:new Set,projectedElement:e,overlay:n,debugGraphic:null}})).tiles.add(e)}},{key:"_dereferenceElements",value:function(e,t){var r,n=(0,a.Z)(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._dereferenceElement(e,i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"_dereferenceElement",value:function(e,t){var r,n=this._elementReferences.get(t.uid);n.tiles.delete(e),n.tiles.size||(this._overlayContainer.removeChild(n.overlay),n.overlay.destroy(),n.projectedElement.destroy(),this._elementReferences.delete(t.uid),this.elements.remove(t),null===(r=this._debugGraphicsView)||void 0===r||r.graphics.remove(n.debugGraphic))}},{key:"_elementUpdateHandler",value:function(e){var t=this._elementReferences.get(e.uid);if(t){var r,n,i=t.projectedElement.normalizedCoords;if(null==i)return this._overlayContainer.removeChild(t.overlay),t.overlay.destroy(),t.projectedElement.destroy(),this._elementReferences.delete(e.uid),this.elements.remove(e),void(null===(r=this._debugGraphicsView)||void 0===r||r.graphics.remove(t.debugGraphic));var o,u=[],s=[],l=(0,a.Z)(this._tileStrategy.tiles);try{for(l.s();!(o=l.n()).done;){var c=o.value,f=ee(this.view.featuresTilingScheme,c,i);t.tiles.has(c)?f||s.push(c):f&&u.push(c)}}catch(E){l.e(E)}finally{l.f()}for(var h=0,d=u;h<d.length;h++){var m=d[h];this._referenceElement(m,e)}for(var v=0,p=s;v<p.length;v++){var y=p[v];this._dereferenceElement(y,e)}(null===(n=t=this._elementReferences.get(e.uid))||void 0===n?void 0:n.debugGraphic)&&(t.debugGraphic.geometry=t.projectedElement.normalizedCoords,this._debugGraphicsView.graphicUpdateHandler({graphic:t.debugGraphic,property:"geometry"}))}else{var _=new b.L({element:e,spatialReference:this.view.spatialReference}).normalizedCoords;if(null!=_){var g,w=(0,a.Z)(this._tileStrategy.tiles);try{for(w.s();!(g=w.n()).done;){var T=g.value;ee(this.view.featuresTilingScheme,T,_)&&this._referenceElement(T,e)}}catch(E){w.e(E)}finally{w.f()}}}}}]),r}((0,W.y)(Y.Z));(0,d._)([(0,g.Cb)()],J.prototype,"layer",void 0),(0,d._)([(0,g.Cb)({readOnly:!0})],J.prototype,"elements",void 0),J=(0,d._)([(0,w.j)("esri.views.2d.layers.MediaLayerView2D")],J);var $=(0,T.Ue)(),K={xmin:0,ymin:0,xmax:0,ymax:0};function ee(e,t,r){return e.getTileBounds($,t.key,!0),K.xmin=$[0],K.ymin=$[1],K.xmax=$[2],K.ymax=$[3],(0,Z.Nl)(K,r)}var te=function(){function e(t){(0,u.Z)(this,e),this.key=t,this.elements=null,this.isReady=!1,this.visible=!0}return(0,s.Z)(e,[{key:"setElements",value:function(e){var t=[],r=new Set(this.elements);this.elements=e;var n,i=(0,a.Z)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.has(o)?r.delete(o):t.push(o)}}catch(u){i.e(u)}finally{i.f()}return this.isReady=!0,[t,Array.from(r)]}},{key:"destroy",value:function(){}}]),e}(),re=J},81152:function(e,t,r){r.d(t,{G:function(){return o}});var n=r(15671),i=r(43144),a=r(92026),o=function(){function e(){(0,n.Z)(this,e),this._result=!1}return(0,i.Z)(e,[{key:"dispose",value:function(){this._program=(0,a.M2)(this._program)}},{key:"result",get:function(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}]),e}()},40235:function(e,t,r){r.d(t,{P9:function(){return o},mO:function(){return u}});var n=r(43144),i=r(15671),a=(0,n.Z)((function e(t,r,n,a,o,u,s,l,c){(0,i.Z)(this,e),this.createQuery=t,this.deleteQuery=r,this.resultAvailable=n,this.getResult=a,this.disjoint=o,this.beginTimeElapsed=u,this.endTimeElapsed=s,this.createTimestamp=l,this.timestampBits=c})),o=!1;function u(e,t){if(t.disjointTimerQuery)return null;var r=e.getExtension("EXT_disjoint_timer_query_webgl2");return r?new a((function(){return e.createQuery()}),(function(t){e.deleteQuery(t),o=!1}),(function(t){return e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE)}),(function(t){return e.getQueryParameter(t,e.QUERY_RESULT)}),(function(){return e.getParameter(r.GPU_DISJOINT_EXT)}),(function(t){o||(o=!0,e.beginQuery(r.TIME_ELAPSED_EXT,t))}),(function(){e.endQuery(r.TIME_ELAPSED_EXT),o=!1}),(function(e){return r.queryCounterEXT(e,r.TIMESTAMP_EXT)}),(function(){return e.getQuery(r.TIMESTAMP_EXT,r.QUERY_COUNTER_BITS_EXT)})):(r=e.getExtension("EXT_disjoint_timer_query"))?new a((function(){return r.createQueryEXT()}),(function(e){r.deleteQueryEXT(e),o=!1}),(function(e){return r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT)}),(function(e){return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)}),(function(){return e.getParameter(r.GPU_DISJOINT_EXT)}),(function(e){o||(o=!0,r.beginQueryEXT(r.TIME_ELAPSED_EXT,e))}),(function(){r.endQueryEXT(r.TIME_ELAPSED_EXT),o=!1}),(function(e){return r.queryCounterEXT(e,r.TIMESTAMP_EXT)}),(function(){return r.getQueryEXT(r.TIMESTAMP_EXT,r.QUERY_COUNTER_BITS_EXT)})):null}},39416:function(e,t,r){r.d(t,{d:function(){return p}});var n=r(15671),i=r(43144),a=r(88301),o=r(61120),u=r(60136),s=r(29388),l=r(61441),c=r(44070),f=r(8548),h=r(53634),d=r(57808),m=r(52311),v=r(45412),p=function(e){(0,u.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;(0,n.Z)(this,r),(i=t.call(this))._rctx=e;return i._program=e.programCache.acquire("\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ","\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ",new Map([["a_pos",0]])),i}return(0,i.Z)(r,[{key:"dispose",value:function(){(0,a.Z)((0,o.Z)(r.prototype),"dispose",this).call(this)}},{key:"_test",value:function(e){var t=this._rctx;if(!t.gl)return e.dispose(),!0;var r=new m.X(1);r.wrapMode=f.e8.CLAMP_TO_EDGE,r.samplingMode=f.cw.NEAREST;var n=new h.X(t,r),i=c.f.createVertex(t,f.l1.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),a=new v.U(t,new Map([["a_pos",0]]),l.cD,{geometry:i}),o=new m.X;o.samplingMode=f.cw.LINEAR,o.wrapMode=f.e8.CLAMP_TO_EDGE;var u=new d.x(t,o,y);t.useProgram(e),t.bindTexture(u,0),e.setUniform1i("u_texture",0);var s=t.getBoundFramebufferObject(),p=t.getViewport(),_=p.x,g=p.y,w=p.width,T=p.height;t.bindFramebuffer(n),t.setViewport(0,0,1,1),t.setClearColor(0,0,0,0),t.setBlendingEnabled(!1),t.clear(f.lk.COLOR_BUFFER_BIT),t.bindVAO(a),t.drawArrays(f.MX.TRIANGLE_STRIP,0,4);var E=new Uint8Array(4);return n.readPixels(0,0,1,1,f.VI.RGBA,f.Br.UNSIGNED_BYTE,E),a.dispose(),n.dispose(),u.dispose(),t.setViewport(_,g,w,T),t.bindFramebuffer(s),255!==E[0]}}]),r}(r(81152).G),y=new Image;y.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",y.width=5,y.height=5,y.decode()}}]);
//# sourceMappingURL=35803.fae2ec68.chunk.js.map