"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[90856,18277],{25889:function(e,t,n){n.d(t,{AC:function(){return f},Fz:function(){return h},Q_:function(){return g},_C:function(){return v},fB:function(){return y},i1:function(){return k},jO:function(){return w},kE:function(){return p},ks:function(){return d},s8:function(){return m},sc:function(){return c}});var r=n(43144),a=n(15671),i=n(60136),o=n(29388),s=n(10064),u="upload-assets",l=function(){return new Error},c=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"".concat(u,":unsupported"),"Layer does not support asset uploads.",l())}return(0,r.Z)(n)}(s.Z),d=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"".concat(u,":no-glb-support"),"Layer does not support glb.",l())}return(0,r.Z)(n)}(s.Z),p=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"".concat(u,":no-supported-source"),"No supported external source found",l())}return(0,r.Z)(n)}(s.Z),f=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"".concat(u,":not-base-64"),"Expected gltf data in base64 format after conversion.",l())}return(0,r.Z)(n)}(s.Z),v=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"".concat(u,":unable-to-prepare-options"),"Unable to prepare uploadAsset request options.",l())}return(0,r.Z)(n)}(s.Z),h=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){return(0,a.Z)(this,n),t.call(this,"".concat(u,":bad-response"),"Bad response. Uploaded ".concat(e," items and received ").concat(r," results."),l())}return(0,r.Z)(n)}(s.Z),y=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e,r){var i,o;return(0,a.Z)(this,n),t.call(this,"".concat(u,"-layer:upload-failed"),"Failed to upload mesh file ".concat(e,". Error code: ").concat(null!==(i=null===r||void 0===r?void 0:r.code)&&void 0!==i?i:"-1",". Error message: ").concat(null!==(o=null===r||void 0===r?void 0:r.messages)&&void 0!==o?o:"unknown"),l())}return(0,r.Z)(n)}(s.Z),w=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){return(0,a.Z)(this,n),t.call(this,"".concat(u,"-layer:unsupported-format"),"The service allowed us to upload an asset of FormatID ".concat(e,", but it does not list it in its supported formats."),l())}return(0,r.Z)(n)}(s.Z),m=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"".concat(u,":convert3D-failed"),"convert3D failed.")}return(0,r.Z)(n)}(s.Z),g=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"invalid-input:no-model","No supported model found")}return(0,r.Z)(n)}(s.Z),k=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,a.Z)(this,n),t.call(this,"invalid-input:multiple-models","Multiple supported models found")}return(0,r.Z)(n)}(s.Z)},18277:function(e,t,n){n.d(t,{$6:function(){return w},$z:function(){return o},F7:function(){return i},Ow:function(){return l},S0:function(){return u},d1:function(){return c},dm:function(){return d},ir:function(){return s}});var r=n(93433),a=[["binary","application/octet-stream","bin",""]];function i(e,t){var n;return null!=f(t.name,null!==(n=null===e||void 0===e?void 0:e.supportedFormats)&&void 0!==n?n:[])}function o(e,t){var n;if(!e)return!1;var r=d(t,null!==(n=e.supportedFormats)&&void 0!==n?n:[]);return null!=r&&e.editFormats.includes(r)}function s(e){var t;return p(null!==(t=null===e||void 0===e?void 0:e.supportedFormats)&&void 0!==t?t:[]).flatMap(y).map((function(e){return".".concat(e)}))}function u(e,t){return v(function(e,t){var n=e.toLowerCase();return p(t).find((function(e){return h(e)===n}))}(e,t))}function l(e,t){return v(f(e,t))}function c(e,t){return h(function(e,t){return p(t).find((function(t){return v(t)===e}))}(e,t))}function d(e,t){var n;return null!==(n=l(e.name,t))&&void 0!==n?n:u(e.type,t)}function p(e){return[].concat(a,(0,r.Z)(e))}function f(e,t){var n=e.toLowerCase();return p(t).find((function(e){return y(e).some((function(e){return n.endsWith(e)}))}))}function v(e){return null===e||void 0===e?void 0:e[0]}function h(e){return null===e||void 0===e?void 0:e[1].toLowerCase()}function y(e){var t;return null!==(t=null===e||void 0===e?void 0:e[2].split(",").map((function(e){return e.toLowerCase()})))&&void 0!==t?t:[]}function w(e){var t;return null===(t=e.tables)||void 0===t?void 0:t.find((function(e){return"assetMaps"===e.role}))}},96669:function(e,t,n){function r(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function a(e,t){var n;return"number"==typeof e?e:null!==e&&void 0!==e&&null!==(n=e.stops)&&void 0!==n&&n.length?function(e){for(var t=0,n=0,r=0;r<e.length;r++){var a=e[r].size;"number"==typeof a&&(t+=a,n++)}return t/n}(e.stops):t}function i(e,t){if(!t)return e;var n=t.filter((function(e){return"size"===e.type})).map((function(t){var n=t.maxSize,r=t.minSize;return(a(n,e)+a(r,e))/2})),r=0,i=n.length;if(0===i)return e;for(var o=0;o<i;o++)r+=n[o];var s=Math.floor(r/i);return Math.max(s,e)}function o(e){var t=null===e||void 0===e?void 0:e.renderer,n="touch"===(null===e||void 0===e?void 0:e.pointerType)?9:6;if(!t)return n;var a="visualVariables"in t?i(n,t.visualVariables):n;if("simple"===t.type)return r(a,t.symbol);if("unique-value"===t.type){var o,s=a;return null!==(o=t.uniqueValueInfos)&&void 0!==o&&o.forEach((function(e){s=r(s,e.symbol)})),s}if("class-breaks"===t.type){var u=a;return t.classBreakInfos.forEach((function(e){u=r(u,e.symbol)})),u}return"dot-density"===t.type||t.type,a}n.d(t,{k:function(){return o}})},94687:function(e,t,n){n.d(t,{F:function(){return d}});var r=n(43144),a=n(15671),i=n(60136),o=n(29388),s=n(27366),u=n(91505),l=n(49861),c=(n(93169),n(32718),n(84936),n(69912)),d=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).tracking=!1,r.displaying=!1,r.isDraped=!1,r}return(0,r.Z)(n)}(u.Z.EventedAccessor);(0,s._)([(0,l.Cb)({constructOnly:!0})],d.prototype,"graphic",void 0),(0,s._)([(0,l.Cb)()],d.prototype,"tracking",void 0),(0,s._)([(0,l.Cb)()],d.prototype,"displaying",void 0),(0,s._)([(0,l.Cb)()],d.prototype,"isDraped",void 0),d=(0,s._)([(0,c.j)("esri.views.3d.layers.graphics.GraphicState")],d)},74982:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(15671),a=n(43144),i=n(60136),o=n(29388),s=n(27366),u=n(7138),l=n(49861),c=(n(93169),n(32718),n(84936),n(69912)),d=n(83089),p=n(69787),f=n(45276),v=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;return(0,r.Z)(this,n),(a=t.call(this,e)).view=null,a}return(0,a.Z)(n,[{key:"add",value:function(e){var t=this,n=!e||Array.isArray(e)?e:[e];(null===n||void 0===n?void 0:n.length)&&n.forEach((function(e){return t._highlight(e)}))}},{key:"remove",value:function(e){var t=this,n=!e||Array.isArray(e)?e:[e];(null===n||void 0===n?void 0:n.length)&&n.forEach((function(e){return t._removeHighlight(e)}))}},{key:"removeAll",value:function(){this.removeAllHandles()}},{key:"_highlight",value:function(e){var t=(0,d.j)(this.view,e.layer);(0,p.tl)(t)&&this.addHandles(t.highlight(e),(0,f.wi)(e))}},{key:"_removeHighlight",value:function(e){e&&this.removeHandles((0,f.wi)(e))}}]),n}(u.default);(0,s._)([(0,l.Cb)()],v.prototype,"view",void 0);var h=v=(0,s._)([(0,c.j)("esri.views.draw.support.HighlightHelper")],v)},86547:function(e,t,n){function r(e,t){switch(e){case"point":case"multipoint":return"point";case"polyline":return function(e){return(null!=e&&"polyline"===e.type&&e.paths.length?e.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex"}(t);case"polygon":return function(e){var t=null!=e&&"polygon"===e.type&&e.rings.length?e.rings[0].length:0;return t<3?"polylineZeroVertices":t<4?"polygonOneVertex":"polygonTwoVertices"}(t);default:return}}n.d(t,{A:function(){return r}})},45008:function(e,t,n){n.d(t,{D:function(){return s},K:function(){return o}});n(59486);var r=n(68860),a=n(96669),i=n(53866);function o(e,t,n){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new i.Z,s=0;if("2d"===n.type)s=t*(null!==(a=n.resolution)&&void 0!==a?a:0);else if("3d"===n.type){var u=n.overlayPixelSizeInMapUnits(e),l=n.basemapSpatialReference;s=null==l||l.equals(n.spatialReference)?t*u:(0,r.c9)(l)/(0,r.c9)(n.spatialReference)}var c=e.x-s,d=e.y-s,p=e.x+s,f=e.y+s,v=n.spatialReference;return o.xmin=Math.min(c,p),o.ymin=Math.min(d,f),o.xmax=Math.max(c,p),o.ymax=Math.max(d,f),o.spatialReference=v,o}function s(e,t,n){var r=n.toMap(e);return null!=r&&o(r,(0,a.k)(),n,u).intersects(t)}var u=new i.Z},90856:function(e,t,n){n.r(t),n.d(t,{default:function(){return vr}});var r=n(1413),a=n(29439),i=n(74165),o=n(15861),s=n(15671),u=n(43144),l=n(97326),c=n(60136),d=n(29388),p=n(27366),f=(n(59166),n(44927)),v=n(32718),h=n(92026),y=n(66978),w=n(94172),m=n(49861),g=(n(93169),n(84936),n(69912)),k=n(47863),b=n(21993),_=n(76385),Z=n(72521),x=n(45966),C=n(33565),M="esri-editor",F={base:M,helpMessage:"".concat(M,"__help-message"),updateActions:"".concat(M,"__update-actions"),updateActionsList:"".concat(M,"__update-actions-list"),featureTemplatesContainer:"".concat(M,"__feature-templates-container"),templateItemContentEnd:"".concat(M,"__template-item-content-end")},I=n(37762),A=n(93433),E=n(14921),S=n(80987),W=n(10064),V=n(91505),O=n(42537),P=n(46634),T=n(93655),L=n(69767),U=n(37933),H=n(80139),D=n(59981),R=n(38856),z=n(98173),G=n(4819),B=n(88301),N=n(61120),j=n(52639),q=n(63780),Q=n(71907),K=n(86547),J=n(1614),X=n(22006),$=n(7138),Y=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).creationInfo=null,r.editorItem=null,r.parent=null,r.pendingFeatures=new S.Z,r.sketchOptions=null,r.snappingManager=null,r.viewModel=null,r.upload=null,r}return(0,u.Z)(n)}($.default);(0,p._)([(0,m.Cb)()],Y.prototype,"creationInfo",void 0),(0,p._)([(0,m.Cb)()],Y.prototype,"editorItem",void 0),(0,p._)([(0,m.Cb)()],Y.prototype,"parent",void 0),(0,p._)([(0,m.Cb)({constructOnly:!0})],Y.prototype,"sketchOptions",void 0),(0,p._)([(0,m.Cb)()],Y.prototype,"snappingManager",void 0),(0,p._)([(0,m.Cb)()],Y.prototype,"viewModel",void 0),(0,p._)([(0,m.Cb)()],Y.prototype,"upload",void 0),Y=(0,p._)([(0,g.j)("esri.widgets.Editor.CreateFeaturesWorkflowData")],Y);var ee=n(84652),te=n(17842),ne=n(48732),re=n(37270),ae=n(96669),ie=n(49229),oe=n(80724),se=n(56011),ue=n(23707),le=n(86828),ce=n(94687),de=n(45008),pe=n(74923),fe=n(36571);function ve(e){var t=e.sourceLayer;if(!t||"feature"!==t.type||!function(e){switch(null===e||void 0===e?void 0:e.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":case"pie-chart":return!0;default:return!1}}(t.renderer))return{rotation:null,size:null};var n=null,r=null,a=t.renderer.getVisualVariablesForType("rotation").filter((function(t){return(!t.axis||"heading"===t.axis)&&t.field&&!t.valueExpression&&null!=(0,se.getRotationAngle)(t,e)}));1===a.length&&(n=function(e,t){var n,r="heading"===(e.axis||"heading")&&"arithmetic"===e.rotationType?-1:1,a=e.field,i=t.fields&&t.fields.filter((function(e){return e.name===a})),o=i&&1===i.length?i[0].type:"double",s={initial:0,current:0};return{field:a,fieldType:o,getDefault:function(){return Promise.resolve(0)},getValue:function(e){return s.current=s.initial-r*e,me((s.current+360)%360,o)},setInitialValue:function(e){s.initial=e,s.current=0},isUpdatingInteractively:!1,rotationType:null!==(n=e.rotationType)&&void 0!==n?n:"geographic"}}(a[0],t));var s=t.renderer.getVisualVariablesForType("size").filter((function(t){return t.field&&!t.useSymbolValue&&!t.valueExpression&&(0,oe.QW)(t)===oe.hL.RealWorldSize&&null!=(0,se.getSize)(t,e)}));return 1===s.length&&(r=function(e,t){var n,r,a=e.field,s=e.axis,u=t.fields&&t.fields.filter((function(e){return e.name===a})),l=u&&1===u.length?u[0].type:"double",c={initial:0,current:0},d=null!==(n=ie.a[e.valueUnit])&&void 0!==n?n:1;return r="area"===e.valueRepresentation?function(e){return Math.pow(e*d/2,2)*Math.PI}:"radius"===e.valueRepresentation||"distance"===e.valueRepresentation?function(e){return e*d/2}:function(e){return e*d},{field:a,fieldType:l,getDefault:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=me,e.t1=r,e.next=4,ye(n,t,s);case 4:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=l,e.abrupt("return",(0,e.t0)(e.t3,e.t4));case 8:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),getValue:function(e,t){return c.initial||(c.initial=t.pixelSizeAt(t.center)),c.current=c.initial*e,me(c.current,l)},setInitialValue:function(e){c.initial=e,c.current=0},isUpdatingInteractively:!1,displayUnit:$e(e.valueUnit),axis:e.axis}}(s[0],t)),{rotation:n,size:r}}function he(e,t){switch(t){case"width":return e[0];case"depth":return e[1];case"height":return e[2];default:return e[2]||e[1]||e[0]}}function ye(e,t,n){return we.apply(this,arguments)}function we(){return we=(0,o.Z)((0,i.Z)().mark((function e(t,r,a){var o,s,u,l,c,d,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r){e.next=2;break}return e.abrupt("return",0);case 2:if(o=(0,ue.q)(r),null!=(s=o.symbol)&&"web-style"!==s.type&&"cim"!==s.type){e.next=5;break}return e.abrupt("return",0);case 5:if(u=s.symbolLayers.at(0)){e.next=8;break}return e.abrupt("return",0);case 8:e.t0=u.type,e.next="icon"===e.t0?11:"text"===e.t0?27:"line"===e.t0?28:"object"===e.t0?29:"path"===e.t0?39:"extrude"===e.t0?40:41;break;case 11:return e.next=13,n.e(23657).then(n.bind(n,23657));case 13:if(l=e.sent,c=l.computeIconLayerResourceSize,e.t2=u.size,e.t2){e.next=23;break}return e.t3=Math,e.t4=Ke.icon,e.next=21,c(u,Ke.icon);case 21:e.t5=e.sent[0],e.t2=e.t3.min.call(e.t3,e.t4,e.t5);case 23:if(e.t1=e.t2,e.t1){e.next=26;break}e.t1=Ke.icon;case 26:return e.abrupt("return",e.t1);case 27:return e.abrupt("return",u.size||Ke.text);case 28:return e.abrupt("return",u.size||Ke.line);case 29:return e.next=31,n.e(23657).then(n.bind(n,23657));case 31:return d=e.sent,p=d.computeObjectLayerResourceSize,e.t6=he,e.next=36,p(u,t.scale/Ke.viewScaleSizeFactor);case 36:return e.t7=e.sent,e.t8=a,e.abrupt("return",(0,e.t6)(e.t7,e.t8));case 39:return e.abrupt("return",(null!=u.width?u.width:u.height)||t.scale/Ke.viewScaleSizeFactor);case 40:return e.abrupt("return",u.size||t.scale/Ke.viewScaleSizeFactor);case 41:return e.abrupt("return",0);case 42:case"end":return e.stop()}}),e)}))),we.apply(this,arguments)}function me(e,t){switch(t){case"small-integer":case"integer":case"long":return Math.round(e);case"double":case"single":return e;default:return 0}}function ge(e,t,n){return ke.apply(this,arguments)}function ke(){return ke=(0,o.Z)((0,i.Z)().mark((function e(t,n,r){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,le.zd)(t,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:n,scale:r});case 2:a=e.sent,null!=(0,ne.Hg)(t.symbol,a)&&(t.symbol=a);case 4:case"end":return e.stop()}}),e)}))),ke.apply(this,arguments)}function be(e){if(!e)throw new Error("no geometry type");return"multipatch"===e?"mesh":e}function _e(e,t,n){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,o.Z)((0,i.Z)().mark((function e(t,n,a){var o,s,u,l,c,d,p,f,v,h,m,g;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=n.layer,c=(0,r.Z)((0,r.Z)({},null===(o=n.template)||void 0===o?void 0:o.prototype.attributes),n.attributeOverrides),d=null,p=t.view,f="2d"===(null===p||void 0===p?void 0:p.type),e.next=5,xe(t,l,c,a,f?p.scale:null);case 5:if(!f){e.next=8;break}v=(0,y.Ds)((function(e){return xe(t,l,c,a,e)})),d=(0,w.watch)((function(){return p.scale}),(function(e){return v(e)}));case 8:if(h=l.capabilities,m=h.data,g=h.editing,t.layer.elevationInfo=l.elevationInfo,null!=n.geometryToPlace){e.next=15;break}return e.next=13,t.create(be(l.geometryType),{graphicProperties:{attributes:c,sourceLayer:l},hasZ:m.supportsZ,defaultZ:null!==(s=f?g.zDefault:null)&&void 0!==s?s:t.defaultCreateOptions.defaultZ});case 13:e.next=17;break;case 15:return e.next=17,t.place(n.geometryToPlace,{graphicProperties:{attributes:c,sourceLayer:l}});case 17:return e.abrupt("return",null!==(u=d)&&void 0!==u?u:(0,O.kB)());case 18:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function xe(e,t,n,r,a){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,o.Z)((0,i.Z)().mark((function e(t,n,r,a,o){var s,u,l,c,d,p,f,v,h,y;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=new j.Z({sourceLayer:n,attributes:r}),l=ve(u),c=l.rotation,d=l.size,e.next=3,(0,le.zd)(u,{useSourceLayer:!0,webStyleCache:a,scale:o});case 3:p=e.sent,f=!1,v=0,h=[d,c];case 6:if(!(v<h.length)){e.next=19;break}if(null!=(y=h[v])){e.next=10;break}return e.abrupt("continue",16);case 10:if(e.t0=null==r[y.field],!e.t0){e.next=16;break}return e.next=14,y.getDefault(p,t.view);case 14:r[y.field]=e.sent,f=!0;case 16:v++,e.next=6;break;case 19:if(e.t2=f,!e.t2){e.next=24;break}return e.next=23,(0,le.zd)(u,{useSourceLayer:!0,webStyleCache:a,scale:o});case 23:p=e.sent;case 24:e.t1=null===(s=p)||void 0===s?void 0:s.type,e.next="simple-fill"===e.t1||"polygon-3d"===e.t1?27:"simple-line"===e.t1||"line-3d"===e.t1?29:"simple-marker"===e.t1||"picture-marker"===e.t1||"point-3d"===e.t1||"cim"===e.t1?31:"mesh-3d"===e.t1?33:34;break;case 27:return t.polygonSymbol=p,e.abrupt("break",34);case 29:return t.polylineSymbol=p,e.abrupt("break",34);case 31:return t.pointSymbol=p,e.abrupt("break",34);case 33:t.meshSymbol=p;case 34:Me(t.tooltipOptions,d,c);case 35:case"end":return e.stop()}}),e)}))),Ce.apply(this,arguments)}function Me(e,t,n){var r;e.visualVariables=null!=t||null!=n?{size:null!=t?{unit:t.displayUnit,axis:t.axis,valueType:t.fieldType}:null,rotation:null!=n?{valueType:n.fieldType,rotationType:null!==(r=n.rotationType)&&void 0!==r?r:"geographic"}:null}:null}function Fe(e,t){return null===e||void 0===e?void 0:e.find((function(e){return e.layer===t}))}function Ie(e,t,n,r){return Ae.apply(this,arguments)}function Ae(){return Ae=(0,o.Z)((0,i.Z)().mark((function e(t,n,r,a){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.type,e.next="3d"===e.t0?3:"2d"===e.t0?4:5;break;case 3:return e.abrupt("return",Ee(t,n,r,a));case 4:return e.abrupt("return",We(t,n,r,a));case 5:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}function Ee(e,t,n,r){return Se.apply(this,arguments)}function Se(){return Se=(0,o.Z)((0,i.Z)().mark((function e(t,n,r,a){var s,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,r.async((0,o.Z)((0,i.Z)().mark((function e(){var o,s,u,l,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)((0,pe.ZV)(n,r),a);case 2:return o=e.sent,s=o.results,u=new Map,l=function(e){var t=e.layer,n=u.get(t);if(!n){var r=new Array;return u.set(t,r),r}return n},(0,pe.HV)(s).forEach((function(e){var t=e.graphic;return l(t).push(t)})),c=t.filter((function(e){var t=e.capabilities,n=e.layer;return t.update.enabled&&u.has(n)})),e.abrupt("return",(0!==c.length&&r.stopPropagation(),{updatable:c,graphicsByLayer:u}));case 9:case"end":return e.stop()}}),e)}))));case 4:return s=e.sent,u=s.updatable,l=s.graphicsByLayer,e.abrupt("return",(0,y.Hl)(Promise.allSettled(u.map(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,o,s,u,c,d,p,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.layer,r=l.get(n),o=Oe(n),!r.every((function(e){return(0,re.R9)(o,e)}))){e.next=4;break}return e.abrupt("return",r);case 4:s=[],u=(0,I.Z)(r);try{for(u.s();!(c=u.n()).done;)d=c.value,s.push(d.getObjectId()),p=Object.keys(d.attributes),(0,q.w6)(o,p)}catch(i){u.e(i)}finally{u.f()}return f=n.createQuery(),e.abrupt("return",(f.returnGeometry=!1,f.objectIds=s,f.outFields=(0,re.Q0)(n.fieldsIndex,o),n.queryFeatures(f,{signal:a}).then((function(e){return e.features}))));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),a));case 8:case"end":return e.stop()}}),e)}))),Se.apply(this,arguments)}function We(e,t,n,r){return Ve.apply(this,arguments)}function Ve(){return Ve=(0,o.Z)((0,i.Z)().mark((function e(t,n,r,a){var s,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:if(null!=(s=r.mapPoint)){e.next=5;break}return e.abrupt("return",[]);case 5:return u=null,e.next=8,r.async((0,o.Z)((0,i.Z)().mark((function e(){var o,s,l,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Hl)(n.hitTest(r),a);case 2:if(o=e.sent,0!==(s=o.results).length){e.next=6;break}return e.abrupt("return",[]);case 6:return l=new Set,(u=(0,pe.HV)(s)).forEach((function(e){var t=e.graphic;return t&&l.add(t.layer)})),c=t.filter((function(e){return l.has(e.layer)&&e.supportsUpdateWorkflow})),e.abrupt("return",(c.length>0&&r.stopPropagation(),c));case 10:case"end":return e.stop()}}),e)}))));case 8:return l=e.sent,e.abrupt("return",(0,y.Hl)(Promise.allSettled(l.map(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var o,l,c,d,p,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.layer,(c=l.createQuery()).returnGeometry=!1,c.outFields=Oe(l),d="renderer"in l?(0,ae.k)({renderer:l.renderer,pointerType:r.pointerType}):0,c.geometry=(0,de.K)(s,d,n),c.outSpatialReference=n.spatialReference,e.next=7,l.queryFeatures(c,{signal:a});case 7:return p=e.sent,f=p.features,e.abrupt("return",(null!==(o=u)&&void 0!==o&&o.forEach((function(e){var t=e.graphic;t.layer!==l||f.some((function(e){return e.getObjectId()===t.getObjectId()}))||f.push(t)})),f));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),a));case 10:case"end":return e.stop()}}),e)}))),Ve.apply(this,arguments)}function Oe(e){return(0,re.Q0)(e.fieldsIndex,[e.objectIdField,(0,re.O5)({displayField:"displayField"in e?e.displayField:null,fields:e.fields})])}function Pe(){return Pe=(0,o.Z)((0,i.Z)().mark((function e(t,n,r){var a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.sourceLayer,(o=a.createQuery()).objectIds=[t.getAttribute(a.objectIdField)],o.outFields=["*"],o.returnM=a.capabilities.data.supportsM,o.returnZ=a.capabilities.data.supportsZ,"scene"===a.type&&null!=a.infoFor3D||(o.outSpatialReference=n),e.next=4,a.queryFeatures(o,{signal:r});case 4:return s=e.sent,(0,y.k_)(r),e.abrupt("return",s.features[0]);case 7:case"end":return e.stop()}}),e)}))),Pe.apply(this,arguments)}function Te(e){return Le.apply(this,arguments)}function Le(){return Le=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,s,u,l,c,d,p,f,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.graphic,r=t.sketchViewModel,a=t.sourceLayer,s=t.visualVariables,u=t.webStyleCache,l=!1,c=s.rotation,d=s.size,[c,d].forEach(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:if(null==(a=n.getAttribute(t.field))){e.next=7;break}t.setInitialValue(a),e.next=11;break;case 7:return e.next=9,t.getDefault(n.symbol,r.view);case 9:o=e.sent,t.setInitialValue(o),n.setAttribute(t.field,o),l=!0;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),!l){e.next=7;break}return f="2d"===(null===(p=r.view)||void 0===p?void 0:p.type)?r.view.scale:null,e.next=7,ge(n,u,f);case 7:return v={multipleSelectionEnabled:!1},e.abrupt("return",("point"===a.geometryType&&(v.enableRotation=null!=c,v.enableScaling=null!=d),Me(r.tooltipOptions,d,c),r.layer.elevationInfo=a.elevationInfo,r.update(n,v)));case 9:case"end":return e.stop()}}),e)}))),Le.apply(this,arguments)}function Ue(e){return null==e||"rotate-start"!==e.type&&"rotate"!==e.type&&"rotate-stop"!==e.type?null:e}function He(e){return null==e||"scale-start"!==e.type&&"scale"!==e.type&&"scale-stop"!==e.type?null:e}function De(e,t,n,r,a){return Re.apply(this,arguments)}function Re(){return Re=(0,o.Z)((0,i.Z)().mark((function e(t,n,r,a,o){var s,u,l,c,d,p,f,v,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n.geometry&&"point"===(null===(s=n.geometry)||void 0===s?void 0:s.type)){e.next=2;break}return e.abrupt("return");case 2:return u=a.rotation,l=Ue(r.toolEventInfo),null!=u&&null!=l&&(c=u.field,d=u.getValue,"rotate-stop"===l.type?(u.isUpdatingInteractively=!1,u.setInitialValue(n.getAttribute(c))):(u.isUpdatingInteractively=!0,n.setAttribute(c,d(l.angle,t)))),p=a.size,f=He(r.toolEventInfo),null!=p&&null!=f&&(v=p.field,h=p.getValue,"scale-stop"===f.type?(p.isUpdatingInteractively=!1,p.setInitialValue(n.getAttribute(v))):(p.isUpdatingInteractively=!0,n.setAttribute(v,h(f.xScale,t)))),e.next=8,ge(n,o,"2d"===t.type?t.scale:null);case 8:case"end":return e.stop()}}),e)}))),Re.apply(this,arguments)}function ze(e){return Ge.apply(this,arguments)}function Ge(){return Ge=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,s,u,l,c,d,p,f,v,h,m,g,k,b,_,Z;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.feature,a=t.featureClone,s=t.visualVariableAttributes,u=t.sketchViewModel,l=t.view,c=t.onUpdate,d=t.webStyleCache,e.next=3,ge(a,d,"2d"===l.type?l.scale:null);case 3:return p=null,"2d"===(null===u||void 0===u||null===(n=u.view)||void 0===n?void 0:n.type)&&(f=(0,y.Ds)((function(e){return ge(a,d,e)})),p=(0,w.watch)((function(){var e;return null===u||void 0===u||null===(e=u.view)||void 0===e?void 0:e.scale}),(function(e){return f(e)}))),v=a.sourceLayer,h=tt(l,v),e.next=8,Te({graphic:a,sketchViewModel:u,sourceLayer:v,visualVariables:s,webStyleCache:d});case 8:return m=null,h.then((function(e){return m=e})).catch((function(){})),g=s.size,k=s.rotation,b=(0,w.watch)((function(){return r.attributes}),function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in n=!1,t)(o=t[r])!==a.getAttribute(r)&&(a.setAttribute(r,o),null==g||g.isUpdatingInteractively||g.field!==r||g.setInitialValue(o),null==k||k.isUpdatingInteractively||k.field!==r||k.setInitialValue(o),(null==m||m.requiredFields.includes(r))&&(n=!0));if(e.t0=n,!e.t0){e.next=6;break}return e.next=6,ge(a,d,"2d"===l.type?l.scale:null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_=u.on("update",function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.graphics[0],"complete"!==t.state){e.next=3;break}return e.abrupt("return",Te({graphic:n,sketchViewModel:u,sourceLayer:v,visualVariables:s,webStyleCache:d}));case 3:return e.next=5,De(l,n,t,s,d);case 5:c(nt(n),t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Z=u.on(["undo","redo"],function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(nt(t.graphics[0]),t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",(0,O.AL)([Z,_,(0,O.kB)((function(){return u.cancel()})),b,p]));case 12:case"end":return e.stop()}}),e)}))),Ge.apply(this,arguments)}function Be(e,t,n){return Ne.apply(this,arguments)}function Ne(){return Ne=(0,o.Z)((0,i.Z)().mark((function e(t,n,r){var a,s,u,l,c,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=function(e){var t;null!==(t=c)&&void 0!==t&&t.abort(),c=(0,E.vr)(function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n){var r,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,tt(a,s);case 2:o=t.sent,(0,y.k_)(n),null===(r=o.setVisibility)||void 0===r||r.call(o,l,e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},a=t.view,t.layer.add(r),s=n.sourceLayer,u=n.layer,l=n.getAttribute(u.objectIdField),c=null,e.next=7,qe(a,r);case 7:return d(!1),e.abrupt("return",(0,O.AL)([je(a,r,(function(e){return d(!e)})),(0,O.kB)((0,o.Z)((0,i.Z)().mark((function e(){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,tt(a,s);case 4:return n=e.sent,e.next=7,(0,w.whenOnce)((function(){return!n.updating}));case 7:return e.prev=7,t.layer.remove(r),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[1,,7,10]])}))))]));case 9:case"end":return e.stop()}}),e)}))),Ne.apply(this,arguments)}function je(e,t,n){if("3d"===e.type){var r=new ce.F({graphic:t});return(0,O.AL)([e.trackGraphicState(r),(0,w.watch)((function(){return r.displaying}),n)])}return(0,w.watch)((function(){return t.visible}),n)}function qe(e,t){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,o.Z)((0,i.Z)().mark((function e(t,n){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("3d"!==t.type){e.next=7;break}return r=new ce.F({graphic:n}),a=t.trackGraphicState(r),e.next=4,(0,w.whenOnce)((function(){return r.displaying}));case 4:a.remove(),e.next=9;break;case 7:return e.next=9,(0,w.whenOnce)((function(){return n.visible}));case 9:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}var Ke={icon:(0,te.Wz)(24),text:(0,te.Wz)(12),line:(0,te.Wz)(1),viewScaleSizeFactor:100};function Je(e,t,n){var r=!1;return e.filter((function(e){return!!r||(r=e===t)})).map((function(e){return n[e]()}))}function Xe(e,t){e.viewModel.syncFeatureTemplates();var n=e.creationInfo;if("awaiting-feature-creation-info"===t[0].id&&n){var r=n.layer,a=(0,fe.J)(r);1===a.length&&"scene"!==r.type&&(n.template=a[0],t.shift())}return t}function $e(e){switch(e){case"unknown":case"decimal-degrees":return null;default:return e}}function Ye(e){e.filesEnabled=!0,e.mode="view",e.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}}var et=function(e){return/-stop/.test(e)||/vertex-/.test(e)},tt=function(e,t){var n="subtype-sublayer"===t.type?t.parent:t;return e.whenLayerView(n)};function nt(e){var t=e.geometry;if("mesh"===(null===t||void 0===t?void 0:t.type)){var n,r,a=e.cloneShallow();return a.attributes=(0,ee.d9)(e.attributes),a.geometry=t.cloneShallow(),a.geometry.transform=null!==(n=null===(r=t.transform)||void 0===r?void 0:r.clone())&&void 0!==n?n:null,a}return e.clone()}function rt(e){var t=e.cursor;return e.cursor="progress",(0,O.kB)((function(){return e.cursor=t}))}function at(e){return it.apply(this,arguments)}function it(){return it=(0,o.Z)((0,i.Z)().mark((function e(t){var r,a,o,s,u,l,c,d,p,f,v,h,m,g;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.view,a=t.data,o=t.signal,s=t.next,u=t.cancel,l=a.creationInfo){e.next=4;break}return e.abrupt("return",(0,O.kB)());case 4:if(ot(l)){e.next=6;break}return e.abrupt("return",(0,O.kB)());case 6:if(c=l.layer,d=null!=l.geometryToPlace,l.geometryToPlace=null,!d){e.next=9;break}return e.abrupt("return",(u(),(0,O.kB)()));case 9:return e.next=11,n.e(24931).then(n.bind(n,85079));case 11:return p=e.sent,f=p.Upload,(0,y.k_)(o),v=new f,a.upload=v,h=null,m=function(){var e;return null===(e=h)||void 0===e?void 0:e.remove()},g=(0,O.AL)([(0,w.watch)((function(){return v.state}),(function(e){switch(e){case"default":case"error":m();break;case"pending":m(),h=rt(r);break;case"success":l.maxFeatures=1,l.geometryToPlace=v.result,m(),s()}})),(0,O.kB)((function(){v.cancel(),m()}))]),e.abrupt("return",(v.uploadTo(c),g));case 19:case"end":return e.stop()}}),e)}))),it.apply(this,arguments)}function ot(e){var t=null===e||void 0===e?void 0:e.layer;return"scene"===(null===t||void 0===t?void 0:t.type)}var st=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e))._indexHistory=[],r._lastStepIndex=-1,r._stepIndex=-1,r._updatingHandles=new P.R,r._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"},r.data=void 0,r.started=!1,r.steps=[],r.type=null,r._pendingOperation=null,r}return(0,u.Z)(n,[{key:"destroy",value:function(){this._updatingHandles.destroy()}},{key:"hasNextStep",get:function(){var e=this.steps;return!!(e&&this._stepIndex<e.filter((function(e){return!e.parent})).length-1)}},{key:"hasPreviousStep",get:function(){return this._stepIndex>0}},{key:"reliesOnOwnerAdminPrivileges",get:function(){return!1}},{key:"hasInvalidFormTemplate",get:function(){return!1}},{key:"shouldShowAttachments",get:function(){return!1}},{key:"shouldAllowAttachmentEditing",get:function(){return!1}},{key:"stepId",get:function(){var e=this.steps,t=e&&e[this._stepIndex];return t&&t.id}},{key:"helpMessage",get:function(){}},{key:"hasPendingEdits",get:function(){return!1}},{key:"keyboardCancellationEnabled",get:function(){return!0}},{key:"updating",get:function(){return this._updatingHandles.updating}},{key:"back",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:function(){return Promise.resolve(!0)},!this.hasPendingEdits){e.next=6;break}return e.next=4,t();case 4:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:if(!this.hasPreviousStep){e.next=11;break}return e.next=9,this.previous({cancelCurrentStep:!0});case 9:e.next=13;break;case 11:return e.next=13,this.cancel({force:!0});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n=this,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{force:!0},e.abrupt("return",!1!==t.force?this._cancel(t):new Promise((function(e,a){n.emit("cancel-request",{controller:{allow:function(){n._cancel((0,r.Z)((0,r.Z)({},t),{},{force:!0})).then(e)},deny:function(){return a(new W.Z("workflow:cancel-denied","Request to cancel workflow was denied."))}}})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"commit",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.removeHandles(this._handleKeys.beforeCommit),e.t0=this.onCommit,!e.t0){e.next=5;break}return e.next=5,this.onCommit(this.data);case 5:this.removeHandles(this._handleKeys.afterCommit),this.emit("commit");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"go",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.steps,r=n.findIndex((function(e){return e.id===t})),this._indexHistory.push(this._stepIndex),e.next=4,this._go(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._indexHistory.push(this._stepIndex),e.next=3,this._go(this._stepIndex+1);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"previous",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{cancelCurrentStep:!1},e.next=3,this._go(this._indexHistory.pop(),t.cancelCurrentStep);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._cancel({emitCancelEvent:!1});case 2:return e.next=4,this.start();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commit();case 2:return e.next=4,this.reset();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._set("started",!0),t=-1===this._stepIndex?0:this._stepIndex,e.next=4,this._go(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_cancel",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r,a,o=this,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},n=t.emitCancelEvent,r=void 0===n||n,a=t.error,e.t0=this.started,!e.t0){e.next=6;break}return this._set("started",!1),e.next=6,this._transaction((function(){var e;return null===(e=o.steps[o._stepIndex])||void 0===e?void 0:e.tearDown({canceled:!0})}));case 6:this.removeHandles([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(r),r&&this.emit("cancel",{error:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_go",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._transaction((0,o.Z)((0,i.Z)().mark((function r(){var a;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=e.steps,t<=-1||t>=a.length){r.next=17;break}if(e.started){r.next=4;break}return r.abrupt("return",(e._stepIndex=t,void e._notifyStepProps()));case 4:if(r.t0=e._lastStepIndex>-1,!r.t0){r.next=8;break}return r.next=8,a[e._lastStepIndex].tearDown({canceled:n});case 8:return r.prev=8,r.next=11,a[t].setUp();case 11:r.next=16;break;case 13:r.prev=13,r.t1=r.catch(8),(0,y.H9)(r.t1);case 16:e._lastStepIndex=t,e._stepIndex=t,e._notifyStepProps();case 17:case"end":return r.stop()}}),r,null,[[8,13]])}))))}},{key:"_transaction",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._pendingOperation,r=(0,y.hh)(),a=(null!==n&&void 0!==n?n:Promise.resolve()).then((function(){return r.promise})),this._pendingOperation=a,this._updatingHandles.addPromise(a),e.prev=2,e.t0=n,!e.t0){e.next=7;break}return e.next=7,n;case 7:return e.next=9,t();case 9:return e.prev=9,r.resolve(),a===this._pendingOperation&&(this._pendingOperation=null),e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[2,,9,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_resetIndexing",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._stepIndex=-1,this._lastStepIndex=-1,this._indexHistory.length=0,e&&this._notifyStepProps()}},{key:"_notifyStepProps",value:function(){this.notifyChange("stepId"),this.notifyChange("hasPreviousStep"),this.notifyChange("hasNextStep")}}]),n}(V.Z.EventedAccessor);(0,p._)([(0,m.Cb)()],st.prototype,"data",void 0),(0,p._)([(0,m.Cb)()],st.prototype,"hasNextStep",null),(0,p._)([(0,m.Cb)()],st.prototype,"hasPreviousStep",null),(0,p._)([(0,m.Cb)()],st.prototype,"onCommit",void 0),(0,p._)([(0,m.Cb)()],st.prototype,"reliesOnOwnerAdminPrivileges",null),(0,p._)([(0,m.Cb)()],st.prototype,"hasInvalidFormTemplate",null),(0,p._)([(0,m.Cb)()],st.prototype,"shouldShowAttachments",null),(0,p._)([(0,m.Cb)()],st.prototype,"shouldAllowAttachmentEditing",null),(0,p._)([(0,m.Cb)()],st.prototype,"started",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],st.prototype,"stepId",null),(0,p._)([(0,m.Cb)()],st.prototype,"steps",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],st.prototype,"type",void 0),(0,p._)([(0,m.Cb)()],st.prototype,"helpMessage",null),(0,p._)([(0,m.Cb)()],st.prototype,"hasPendingEdits",null),(0,p._)([(0,m.Cb)()],st.prototype,"keyboardCancellationEnabled",null),(0,p._)([(0,m.Cb)()],st.prototype,"updating",null);var ut,lt=st=(0,p._)([(0,g.j)("esri.widgets.Editor.Workflow")],st),ct=n(16458),dt=n(40763),pt=Symbol(),ft=Symbol(),vt=Symbol(),ht=ut=function(e){(0,c.Z)(a,e);var t=(0,d.Z)(a);function a(e){var n;return(0,s.Z)(this,a),(n=t.call(this,e)).type="create-features",n.createFeatureState="create-new",n.data=void 0,n.isNested=!1,n._getDrawMeshHelpMessage=void 0,n._featureFormHandle=null,n._visualVariableAttributes={rotation:null,size:null},n._featureFormViewModel=new ct.Z,n._sketchViewModel=null,n._attachmentFileInfos=new Map,n._highlightHandles=new Map,n._preventDefaultActionOnCancel=!1,n._lastActiveGraphics=[],n._isActive=!0,n._updateGraphicDebounced=(0,y.Ds)((function(e,t,n){return ge(e,t,n)})),n}return(0,u.Z)(a,[{key:"initialize",value:function(){this.isNested&&(this._isActive=!1),this._initializeSketchViewModel()}},{key:"destroy",value:function(){this._sketchViewModel.destroy()}},{key:"featureFormViewModel",get:function(){return this._featureFormViewModel}},{key:"hasPendingEdits",get:function(){var e,t;if(this.numPendingFeatures>0)return!0;var n=this.data,r=n.creationInfo,a=n.upload,i=this._sketchViewModel,o=i.activeComponent,s=null===(e=i.createGraphic)||void 0===e||null===(t=e.geometry)||void 0===t?void 0:t.type;return!("polyline"!==s&&"polygon"!==s&&"multipoint"!==s||"draw-2d"!==(null===o||void 0===o?void 0:o.type)&&"draw-3d"!==(null===o||void 0===o?void 0:o.type))&&o.drawOperation.committedVertices.length>0||!(!a||"pending"!==a.state&&"success"!==a.state)||!(null===r||void 0===r||!r.geometryToPlace)}},{key:"helpMessage",get:function(){var e=this,t=this.data,r=t.creationInfo,a=t.viewModel;if("creating-features"===this.stepId&&r){var i=r.layer.geometryType,o=this._sketchViewModel.createGraphic;if("mesh"===i){var s;this._getDrawMeshHelpMessage||n.e(4035).then(n.bind(n,79422)).then((function(t){e._getDrawMeshHelpMessage=t.getDrawMeshHelpMessage}));var u=a.view;return"3d"===(null===u||void 0===u?void 0:u.type)?null===(s=this._getDrawMeshHelpMessage)||void 0===s?void 0:s.call(this,o,u):void 0}return(0,K.A)(i,null===o||void 0===o?void 0:o.geometry)}}},{key:"layer",get:function(){var e;return null===(e=this.data.creationInfo)||void 0===e?void 0:e.layer}},{key:"numPendingFeatures",get:function(){return this.pendingFeatures.length}},{key:"parent",get:function(){return this.data.parent}},{key:"parentLayer",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.data.editorItem.layer}},{key:"pendingFeatures",get:function(){return this.data.pendingFeatures}},{key:"keyboardCancellationEnabled",get:function(){return 0===this.numPendingFeatures}},{key:"reliesOnOwnerAdminPrivileges",get:function(){var e,t;return null!==(e=null===(t=this.data.editorItem)||void 0===t?void 0:t.capabilities.create.reliesOnOwnerAdminPrivileges)&&void 0!==e&&e}},{key:"shouldShowAttachments",get:function(){var e,t;return null!==(e=null===(t=this.data.editorItem)||void 0===t?void 0:t.capabilities.create.attachments.enabled)&&void 0!==e&&e}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"sketchViewModel",get:function(){return this._sketchViewModel}},{key:"test",get:function(){}},{key:"enter",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._isActive=!0,"awaiting-feature-creation-info"!==this.stepId&&this._setUpCreatingFeaturesStep();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"exit",value:function(){this._isActive=!1,this.removeHandles([vt])}},{key:"updatePendingFeature",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this._preventDefaultActionOnCancel=!0,this._sketchViewModel.cancel(),(0,q.Od)(this._lastActiveGraphics,t),this._startUpdating(t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,B.Z)((0,N.Z)(a.prototype),"start",this).call(this);case 2:return e.abrupt("return",(0,U.wb)(null===(t=this.data.creationInfo)||void 0===t?void 0:t.layer)?null:{enter:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),exit:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),viewModel:this._sketchViewModel});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_fadeExistingFeatures",value:function(e){if("effect"in e){var t=e.effect;return e.effect="saturate(0.6) opacity(0.8)",(0,O.kB)((function(){return e.effect=t}))}var n=e.opacity;return e.opacity=.7,(0,O.kB)((function(){return e.opacity=n}))}},{key:"_highlight",value:function(e){var t=this.data.viewModel.view;"3d"===(null===t||void 0===t?void 0:t.type)&&this._highlightHandles.set(e,t.highlight(e))}},{key:"_removeHighlight",value:function(e){(0,h.hw)(this._highlightHandles.get(e)),this._highlightHandles.delete(e)}},{key:"_startCreating",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.removeHandles(ft),n=this.data.creationInfo){e.next=4;break}return e.abrupt("return");case 4:return this.createFeatureState="create-new",e.next=7,_e(this._sketchViewModel,n,t);case 7:r=e.sent,this.addHandles(r,ft);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_startUpdating",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n){var r,a,s,u,l,c,d,p,f,v,y,m,g,k,b,_=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.pendingFeatures).includes(t)||a.add(t),s=this._featureFormViewModel,u=this._sketchViewModel,l=this.data,c=l.creationInfo,d=l.viewModel,p=d.attachmentsViewModel,f=d.layerInfos,(v=d.view)&&c){e.next=5;break}return e.abrupt("return");case 5:return y=c.layer,m=Fe(f,y),g=null===m||void 0===m?void 0:m.formTemplate,k=v.spatialReference,s.set({arcadeEditType:"INSERT",feature:t,formTemplate:g,spatialReference:k,map:v.map}),"add"!==p.mode&&"edit"!==p.mode||null!==(r=d.activeWorkflow)&&void 0!==r&&r.previous(),p.graphic=t,p.fileInfos.removeAll(),p.mode="view",(this._attachmentFileInfos.get(t)||[]).forEach((function(e){var t=e.file,n=e.form;return p.addFile(t,n)})),this._removeHighlight(t),e.next=11,ge(t,n,"2d"===v.type?v.scale:null);case 11:if(this.removeHandles(ft),(0,h.hw)(this._featureFormHandle),"2d"!==v.type){e.next=16;break}b=(0,w.watch)((function(){return v.scale}),(function(e){return _._updateGraphicDebounced(t,n,e)})),this.addHandles(b,ft);case 16:return e.abrupt("return",(this._featureFormHandle=(0,O.AL)([s.on("value-change",(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.attributes=s.getValues(),e.next=3,ge(t,n,"2d"===v.type?v.scale:null);case 3:case"end":return e.stop()}}),e)})))),u.on(["update","undo","redo"],(function(e){("undo"===e.type||"redo"===e.type||"update"===e.type&&null!=e.toolEventInfo&&et(e.toolEventInfo.type))&&s.notifyFeatureGeometryChanged()}))]),this.createFeatureState="update-pending",this._visualVariableAttributes=ve(t),(0,U.wb)(y)?void 0:Te({graphic:t,sketchViewModel:u,sourceLayer:y,visualVariables:this._visualVariableAttributes,webStyleCache:n})));case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_initializeSketchViewModel",value:function(){var e,t=this.data,n=t.viewModel.view,r=new T.default({elevationInfo:null===(e=t.creationInfo)||void 0===e?void 0:e.layer.elevationInfo,internal:!0,listMode:"hide"}),a=new dt.Z({layer:r,sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,view:n});this._sketchViewModel=a,null!==n&&void 0!==n&&n.map.add(r),this.addHandles((0,O.kB)((function(){null!==n&&void 0!==n&&n.destroyed||null!==n&&void 0!==n&&n.map.remove(r),r.destroy()})))}},{key:"_setUpCreatingFeaturesStep",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,a,o,s,u,l,c,d,p,f,v,y,m,g,k,b,_=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasHandles(vt)){e.next=2;break}return e.abrupt("return");case 2:if(t=this.data,n=t.creationInfo,a=t.viewModel,o=a.attachmentsViewModel,(s=a.view)&&null!==n&&void 0!==n&&n.layer){e.next=5;break}throw new W.Z("missing-parameters","CreateFeaturesWorkflow requires a view and creationInfo.");case 5:if(u=n.initialFeature,l=n.layer,c=this._sketchViewModel,d=new Map,p=[],this._lastActiveGraphics=[],this._featureFormHandle=(0,h.hw)(this._featureFormHandle),this._visualVariableAttributes={rotation:null,size:null},this.data.editorItem=a.findEditorItemForLayer(n.layer),Ye(o),p.push((0,w.watch)((function(){return o.mode}),(function(e){switch(e){case"add":_.go("adding-attachment");break;case"edit":_.go("editing-attachment")}}))),f=rt(s),p.push(f),v=(0,U.wb)(n.layer),e.prev=10,!v){e.next=17;break}return m=null!==u&&void 0!==u?u:new j.Z({attributes:(0,r.Z)((0,r.Z)({},null===(y=n.template)||void 0===y?void 0:y.prototype.attributes),n.attributeOverrides),sourceLayer:l}),e.next=15,this._startUpdating(m,d);case 15:e.next=26;break;case 17:if(p.push(ut._configureSketchViewModel(this,d)),!u){e.next=24;break}return c.layer.add(u),e.next=22,this._startUpdating(u,d);case 22:e.next=26;break;case 24:return e.next=26,this._startCreating(d);case 26:return e.prev=26,f.remove(),e.finish(26);case 29:g=(0,O.kB)((function(){return _.pendingFeatures.drain((function(e){return c.layer.remove(e)}))})),k=(0,w.watch)((function(){return null===s||void 0===s?void 0:s.timeZone}),(function(e){return _._featureFormViewModel.timeZone=e}),w.initial),b=(0,O.kB)((function(){ot(n)&&a.cancelWorkflow({warnIfNoWorkflow:!1})})),this._featureFormHandle&&p.push(this._featureFormHandle),this.addHandles(p,this._handleKeys.beforeCommit),this.addHandles([(0,O.kB)((function(){return o.fileInfos.removeAll()})),(0,O.AL)(p),b,g,k],vt);case 31:case"end":return e.stop()}}),e,this,[[10,,26,29]])})));return function(){return e.apply(this,arguments)}}()}],[{key:"create",value:function(e){var t,n=e.addAttachmentsCallback,r=e.applyEditsCallback,a=e.isNested,s=e.creationInfo,u=e.parent,l=e.snappingManager,c=e.startAt,d=e.viewModel,p=null!==(t=e.sketchOptions)&&void 0!==t?t:new D.Z,f=null===s||void 0===s?void 0:s.layer,v=f?d.findEditorItemForLayer(f):void 0,h=new ut({data:new Y({creationInfo:s,editorItem:v,parent:u,sketchOptions:p,snappingManager:l,viewModel:d}),isNested:a,onCommit:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var a,o,s,u,l,c,d,p,f,v;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.creationInfo){e.next=3;break}return e.abrupt("return");case 3:if(s=t.pendingFeatures.toArray(),u=o.layer,l=(null===(a=u.capabilities)||void 0===a?void 0:a.editing.supportsGlobalId)&&"globalIdField"in u,c=h._attachmentFileInfos,!l){e.next=9;break}return d=wt(s,u,c),e.next=8,r(u,d,{globalIdUsed:!0});case 8:return e.abrupt("return",void e.sent);case 9:return e.next=11,r(u,{addFeatures:s});case 11:if(p=e.sent,!(c.size>0)){e.next=16;break}return v=null!==(f=null===p||void 0===p?void 0:p.addFeatureResults)&&void 0!==f?f:[],e.next=16,n(u,yt(s,v,u,c));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});return h._set("steps",this._createWorkflowSteps(h,c)),h}},{key:"_createWorkflowSteps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"awaiting-feature-creation-info",n=e.data,a=Je(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],t,{"awaiting-feature-creation-info":function(){return{id:"awaiting-feature-creation-info",setUp:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function a(){var o,s,u;return(0,i.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=n.creationInfo,s=n.viewModel,u=s.view,a.t0=u,!a.t0){a.next=13;break}if(!ot(o)){a.next=12;break}return a.t1=e,a.next=7,at({view:u,data:n,next:function(){return e.next()},cancel:function(){return s.cancelWorkflow({warnIfNoWorkflow:!1})}});case 7:a.t2=a.sent,a.t3=t.id,a.t1.addHandles.call(a.t1,a.t2,a.t3),a.next=13;break;case 12:n.parent&&o&&(e.addHandles(s.lockFeatureTemplatesViewModel(),t.id),s.featureTemplatesViewModel.layers=[o.layer]),e.addHandles(s.featureTemplatesViewModel.on("select",(function(t){var a=t.item;a&&(n.creationInfo=(0,r.Z)((0,r.Z)({},n.creationInfo),{},{layer:a.layer,template:a.template}),e.next())})),t.id);case 13:case"end":return a.stop()}}),a)})))()},tearDown:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.removeHandles([t.id,ft]);case 1:case"end":return n.stop()}}),n)})))()}}},"creating-features":function(){return{id:"creating-features",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e._isActive,!t.t0){t.next=4;break}return t.next=4,e._setUpCreatingFeaturesStep();case 4:case"end":return t.stop()}}),t)})))()},tearDown:function(t){return(0,o.Z)((0,i.Z)().mark((function r(){var a;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=n.viewModel,t.canceled&&(e.removeHandles([vt,pt,ft]),a.attachmentsViewModel.fileInfos.removeAll(),e._attachmentFileInfos.clear());case 2:case"end":return r.stop()}}),r)})))()}}},"adding-attachment":function(){return{id:"adding-attachment",parent:"creating-features",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function t(){var r,a,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.viewModel.attachmentsViewModel,a=r.graphic,o=r.fileInfos,e._attachmentFileInfos.set(a,o.toArray()),r.mode="view";case 2:case"end":return t.stop()}}),t)})))()}}},"editing-attachment":function(){return{id:"editing-attachment",parent:"creating-features",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function t(){var r,a,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.viewModel.attachmentsViewModel,a=r.graphic,o=r.fileInfos,e._attachmentFileInfos.set(a,o.toArray()),r.mode="view";case 2:case"end":return t.stop()}}),t)})))()}}}});return Xe(n,a)}},{key:"_configureSketchViewModel",value:function(e,t){var n=e.data,r=n.creationInfo,a=n.viewModel,s=a.view,u=e._sketchViewModel,l=null,c=[];if(!s)return(0,O.kB)();"2d"===s.type&&r&&c.push(e._fadeExistingFeatures(r.layer));var d=function(){var n=(0,o.Z)((0,i.Z)().mark((function n(r){var a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("cancel"!==r.state){n.next=7;break}if(!e._preventDefaultActionOnCancel){n.next=3;break}return n.abrupt("return",void(e._preventDefaultActionOnCancel=!1));case 3:if(!(e._lastActiveGraphics.length<1)){n.next=5;break}return n.abrupt("return",e._startCreating(t));case 5:return a=e._lastActiveGraphics.pop(),n.abrupt("return",e._startUpdating(a,t));case 7:if("complete"!==r.state||!r.graphic){n.next=9;break}return n.abrupt("return",e._startUpdating(r.graphic,t));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),p=function(){var n=(0,o.Z)((0,i.Z)().mark((function n(o){var u,c,d,p,f,v,h,y,m,g,k,b,_;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(u=a.attachmentsViewModel,c=e._featureFormViewModel,d=o.graphics[0],"complete"!==o.state){n.next=15;break}if(d!==l&&(e._lastActiveGraphics.push(d),e._highlight(d)),l=null,f=c.hasPendingSubtypeChoice,v=c.submittable,e.numPendingFeatures!==(null===r||void 0===r?void 0:r.maxFeatures)&&!f&&v){n.next=8;break}return!v&&c.submit(),h=e._lastActiveGraphics.pop(),n.abrupt("return",e._startUpdating(h,t));case 8:if("add"!==u.mode&&"edit"!==u.mode||null!==(p=a.activeWorkflow)&&void 0!==p&&p.previous(),!o.aborted||!e._preventDefaultActionOnCancel){n.next=10;break}return n.abrupt("return",void(e._preventDefaultActionOnCancel=!1));case 10:return e.addHandles([rt(s),s.on("click",(function(e){return e.preventDefault()}))],pt),n.next=13,(0,w.whenOnce)((function(){return!c.updating}));case 13:e.removeHandles(pt),e._startCreating(t);case 15:return"start"===o.state&&e._removeHighlight(d),y=e._visualVariableAttributes,n.next=19,De(s,d,o,y,t);case 19:m=d.attributes,g=y.rotation,k=y.size,null!=g&&(b=g.field,c.setValue(b,m[b])),null!=k&&(_=k.field,c.setValue(_,m[_]));case 22:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),f=function(t){var n=t.graphics[0];e.pendingFeatures.remove(n),(0,q.Od)(e._lastActiveGraphics,n),l=n},v=function(){var n=(0,o.Z)((0,i.Z)().mark((function n(a){var o,l,c,d,p,f,v;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!ot(r)){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,s.hitTest(a,{include:u.layer});case 4:if(o=n.sent,l=o.results,c=l.find((function(e){return"graphic"===e.type&&e.graphic.sourceLayer===(null===r||void 0===r?void 0:r.layer)})),c){n.next=9;break}return n.abrupt("return");case 9:if(d=c.graphic,"transform"!==u.activeTool&&"reshape"!==u.activeTool){n.next=18;break}if(u.updateGraphics.at(0)!==d){n.next=13;break}return n.abrupt("return");case 13:if(p=e._featureFormViewModel,f=p.submittable,v=p.hasPendingSubtypeChoice,f&&!v){n.next=16;break}return n.abrupt("return");case 16:return n.next=18,e.updatePendingFeature(d,t);case 18:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();c.push(u.on("create",(function(t){return e._updatingHandles.addPromise(d(t))})),u.on("update",(function(t){return e._updatingHandles.addPromise(p(t))})),u.on("delete",(function(e){return f(e)})),s.on("immediate-click",(function(t){return e._updatingHandles.addPromise(v(t))}),J.f.TOOL),(0,O.kB)((function(){e._preventDefaultActionOnCancel=!0,u.cancel()})),function(e,t){var n=null,r=function(){return e.snappingOptions.featureSources},a=function(){return n=new X.Z({layer:e.layer}),r().add(n),n},i=function(){null!=n&&(r().remove(n),n=(0,h.SC)(n))};return(0,O.AL)([(0,w.watch)((function(){var e,n,a=null===(e=t.creationInfo)||void 0===e?void 0:e.layer,i=r().find((function(e){return e.layer===a}));return{hasFeatureLayerSource:!!i,enabled:null!==(n=null===i||void 0===i?void 0:i.enabled)&&void 0!==n&&n}}),(function(e){var t,r=e.hasFeatureLayerSource,o=e.enabled;if(!r)return i();null!==(t=n)&&void 0!==t||(n=a()),n.enabled=o}),w.syncAndInitial),(0,O.kB)(i)])}(u,n));var y=(0,O.AL)(c);return u.addHandles(y),y}}]),a}(lt);function yt(e,t,n,r){var a=[];return t.forEach((function(t,i){if(!t.error){var o=e[i],s=r.get(o)||[];o.attributes[n.objectIdField]=t.objectId,s.forEach((function(e){var t=e.form;return a.push({feature:o,attachment:t})}))}})),a}function wt(e,t,n){var r=[],a=t.globalIdField;return e.forEach((function(t,i){var o,s;null!==(s=(o=e[i].attributes)[a])&&void 0!==s||(o[a]=(0,Q.zS)()),((null===n||void 0===n?void 0:n.get(t))||[]).forEach((function(e){var n=e.file;return r.push({feature:t,attachment:{globalId:(0,Q.zS)(),data:n}})}))})),r.length?{addFeatures:e,addAttachments:r}:{addFeatures:e}}(0,p._)([(0,m.Cb)()],ht.prototype,"createFeatureState",void 0),(0,p._)([(0,m.Cb)()],ht.prototype,"data",void 0),(0,p._)([(0,m.Cb)({constructOnly:!0})],ht.prototype,"isNested",void 0),(0,p._)([(0,m.Cb)()],ht.prototype,"featureFormViewModel",null),(0,p._)([(0,m.Cb)()],ht.prototype,"hasPendingEdits",null),(0,p._)([(0,m.Cb)()],ht.prototype,"_getDrawMeshHelpMessage",void 0),(0,p._)([(0,m.Cb)()],ht.prototype,"helpMessage",null),(0,p._)([(0,m.Cb)()],ht.prototype,"layer",null),(0,p._)([(0,m.Cb)()],ht.prototype,"parent",null),(0,p._)([(0,m.Cb)()],ht.prototype,"parentLayer",null),(0,p._)([(0,m.Cb)()],ht.prototype,"keyboardCancellationEnabled",null),(0,p._)([(0,m.Cb)()],ht.prototype,"reliesOnOwnerAdminPrivileges",null),(0,p._)([(0,m.Cb)()],ht.prototype,"shouldShowAttachments",null),(0,p._)([(0,m.Cb)()],ht.prototype,"shouldAllowAttachmentEditing",null),(0,p._)([(0,m.Cb)()],ht.prototype,"sketchViewModel",null);var mt=ht=ut=(0,p._)([(0,g.j)("esri.widgets.Editor.CreateFeaturesWorkflow")],ht),gt=n(4942),kt=n(43e3),bt=n(92377),_t=n(74982),Zt=n(74509),xt=n(69787);function Ct(e){return null==e?null:JSON.stringify(e)}var Mt,Ft=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e))._stagedForDelete=!1,r.feature=null,r.initialFeature=null,r}return(0,u.Z)(n,[{key:"attributesModified",get:function(){return this._stringifyAttributes(this.feature)!==this._stringifyAttributes(this.initialFeature)}},{key:"geometryModified",get:function(){return this._stringifyGeometry(this.feature)!==this._stringifyGeometry(this.initialFeature)}},{key:"stagedForDelete",get:function(){return this._stagedForDelete}},{key:"modified",get:function(){return this.attributesModified||this.geometryModified||this._stagedForDelete}},{key:"stageDelete",value:function(){this._stagedForDelete=!0}},{key:"unstageDelete",value:function(){this._stagedForDelete=!1}},{key:"trackChanges",value:function(){var e;this.initialFeature=null===(e=this.feature)||void 0===e?void 0:e.clone()}},{key:"updateAttributes",value:function(e){var t=this.feature;t&&(t.attributes=e,this.notifyChange("attributesModified"))}},{key:"updateGeometry",value:function(e){var t=this.feature;t&&(t.geometry=e,this.notifyChange("geometryModified"))}},{key:"_stringifyAttributes",value:function(e){return Ct(null===e||void 0===e?void 0:e.attributes)}},{key:"_stringifyGeometry",value:function(e){var t=null===e||void 0===e?void 0:e.geometry;return Ct("mesh"===(null===t||void 0===t?void 0:t.type)?{transform:t.transform,vertexSpace:t.vertexSpace}:t)}}]),n}($.default);(0,p._)([(0,m.Cb)()],Ft.prototype,"_stagedForDelete",void 0),(0,p._)([(0,m.Cb)()],Ft.prototype,"attributesModified",null),(0,p._)([(0,m.Cb)()],Ft.prototype,"feature",void 0),(0,p._)([(0,m.Cb)()],Ft.prototype,"geometryModified",null),(0,p._)([(0,m.Cb)()],Ft.prototype,"initialFeature",void 0),(0,p._)([(0,m.Cb)()],Ft.prototype,"modified",null),Ft=(0,p._)([(0,g.j)("esri.widgets.Editor.Edits")],Ft);var It=Mt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).editorItem=null,r.edits=null,r.parent=null,r.relatedRecordCallbacks=null,r.viewModel=null,r}return(0,u.Z)(n,[{key:"attachmentsCapabilities",get:function(){var e=this.editorItem.capabilities.update.attachments.enabled;return{editing:!0,operations:{add:e,update:e,delete:e}}}},{key:"formTemplate",get:function(){return this.editorItem.formTemplate}}],[{key:"create",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Mt._makeConstructorProps(t),e.abrupt("return",new Mt(n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_makeConstructorProps",value:function(e){var t=e.feature,n=e.parent,r=e.relatedRecordCallbacks,a=e.viewModel,i=a.editorItems.find((function(e){return e.layer===t.layer}));if(!i)throw new W.Z("no-editorItem-found","The EditorViewModel provided did not have an EditorItem associated with the specified Graphic's layer");return{editorItem:i,edits:new Ft({feature:t}),parent:n,relatedRecordCallbacks:r,viewModel:a}}}]),n}($.default);(0,p._)([(0,m.Cb)()],It.prototype,"attachmentsCapabilities",null),(0,p._)([(0,m.Cb)({constructOnly:!0})],It.prototype,"editorItem",void 0),(0,p._)([(0,m.Cb)()],It.prototype,"edits",void 0),(0,p._)([(0,m.Cb)()],It.prototype,"formTemplate",null),(0,p._)([(0,m.Cb)()],It.prototype,"parent",void 0),(0,p._)([(0,m.Cb)()],It.prototype,"relatedRecordCallbacks",void 0),(0,p._)([(0,m.Cb)()],It.prototype,"viewModel",void 0);var At,Et=It=Mt=(0,p._)([(0,g.j)("esri.widgets.Editor.UpdateRecordWorkflowData")],It),St=At=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).sketchOptions=null,r.snappingManager=null,r}return(0,u.Z)(n,null,[{key:"create",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,a,o,s,u,l,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.feature,o=t.snappingManager,s=t.viewModel,u=null!==(n=t.sketchOptions)&&void 0!==n?n:new D.Z,l=s.view){e.next=3;break}throw new W.Z("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");case 3:return e.next=5,tt(l,a.layer);case 5:return c=e.sent,e.abrupt("return",new At((0,r.Z)((0,r.Z)({},At._makeConstructorProps(t)),{},{layerView:c,sketchOptions:u,snappingManager:o})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Et);(0,p._)([(0,m.Cb)()],St.prototype,"layerView",void 0),(0,p._)([(0,m.Cb)({constructOnly:!0})],St.prototype,"sketchOptions",void 0),(0,p._)([(0,m.Cb)()],St.prototype,"snappingManager",void 0);var Wt,Vt,Ot=St=At=(0,p._)([(0,g.j)("esri.widgets.Editor.UpdateFeatureWorkflowData")],St),Pt=n(28554),Tt={exit:Symbol()},Lt=Wt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e))._highlightHelper=null,r.fullFeature=null,r.type="update-table-record",r}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this,t=this.data,n=t.edits,r=t.viewModel.view,a=n.feature,i=new AbortController;this.addHandles((0,O.F2)(i)),this._updatingHandles.addPromise(function(e,t,n){return Pe.apply(this,arguments)}(a,t.viewModel.view.spatialReference,i.signal).then((function(t){(0,y.Hc)(i)||(e._onFullFeatureLoaded(t),e._initializeFeatureFormViewModel())}),(function(t){return e.cancel({force:!0,error:new W.Z("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:t}})})}))),r&&(this._highlightHelper=new _t.Z({view:r}),this.addHandles((0,O.kB)((function(){var t;return null===(t=e._highlightHelper)||void 0===t?void 0:t.removeAll()}))))}},{key:"editorItem",get:function(){return this.data.editorItem}},{key:"featureFormViewModel",get:function(){return this._featureFormViewModel}},{key:"hasPendingEdits",get:function(){return this.data.edits.modified}},{key:"layer",get:function(){return this.data.editorItem.layer}},{key:"parent",get:function(){return this.data.parent}},{key:"parentLayer",get:function(){var e;return null===(e=this.parent)||void 0===e?void 0:e.data.editorItem.layer}},{key:"shouldShowAttachments",get:function(){return this.editorItem.capabilities.attachments.enabled}},{key:"shouldAllowAttachmentEditing",get:function(){return this.editorItem.capabilities.update.attachments.enabled}},{key:"reliesOnOwnerAdminPrivileges",get:function(){var e=this.editorItem.capabilities;return e.update.reliesOnOwnerAdminPrivileges||e.delete.reliesOnOwnerAdminPrivileges}},{key:"deleteAndCommit",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.data.edits.stageDelete(),this.commit()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enter",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._configureAttachmentsViewModel();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"exit",value:function(e){this.removeHandles(Tt.exit)}},{key:"start",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,B.Z)((0,N.Z)(n.prototype),"start",this).call(this);case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_configureAttachmentsViewModel",value:function(){var e=this,t=this.data,n=this.fullFeature,r=t.attachmentsCapabilities,a=t.viewModel.attachmentsViewModel;a.set({capabilities:r,graphic:n,filesEnabled:!1,mode:"view"}),this.addHandles([(0,O.kB)((function(){return a.fileInfos.removeAll()})),(0,w.watch)((function(){return a.mode}),(function(t){switch(t){case"add":e.go("adding-attachment");break;case"edit":e.go("editing-attachment")}}))],Tt.exit)}},{key:"_initializeFeatureFormViewModel",value:function(){var e=this,t=this.data,n=t.edits,a=t.formTemplate,i=t.viewModel.view,o=this._featureFormViewModel=new ct.Z({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:a,highlightHelper:this._highlightHelper,map:null===i||void 0===i?void 0:i.map,spatialReference:i.spatialReference,timeZone:null===i||void 0===i?void 0:i.timeZone});o.relatedRecordCallbacks=(0,r.Z)((0,r.Z)({},this.data.relatedRecordCallbacks),{},{showAllRelatedRecords:function(e){return o.relationshipId=e.relationshipId}});var s=n.initialFeature;s&&o.overrideInitialFeature(s),this.addHandles([o.on("value-change",(function(){n.updateAttributes(o.getValues()),e.fullFeature.attributes=n.feature.attributes})),(0,w.watch)((function(){return null===i||void 0===i?void 0:i.timeZone}),(function(e){return o.timeZone=e}))])}},{key:"_onFullFeatureLoaded",value:function(e){this.fullFeature=e;var t=this.data.edits;t.updateAttributes(e.attributes),t.trackChanges()}}],[{key:"create",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Wt,e.next=3,Et.create(t);case 3:return e.t1=e.sent,e.t2=this._onCommitFactory(t.applyEdits),e.t3={data:e.t1,onCommit:e.t2},n=new e.t0(e.t3),e.abrupt("return",(n._set("steps",this._createWorkflowSteps(n)),n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createWorkflowSteps",value:function(e){var t=e.data.viewModel.attachmentsViewModel;return[{id:"editing-attributes",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{id:"adding-attachment",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.mode="view";case 1:case"end":return e.stop()}}),e)})))()}},{id:"editing-attachment",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.mode="view";case 1:case"end":return e.stop()}}),e)})))()}}]}}]),n}(lt);Lt._onCommitFactory=function(e){return function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n){var r,a,o,s,u,l,c,d;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.edits,a=r.feature){t.next=3;break}return t.abrupt("return");case 3:return o=a.sourceLayer,s=a.clone(),r.attributesModified&&!r.stagedForDelete||(u=o.objectIdField,s.attributes=(0,gt.Z)({},u,a.getAttribute(u)),(0,Pt.Rx)()&&(0,Pt.yA)()&&"scene"===o.type&&null!=o.infoFor3D&&null!=(c=null===(l=o.associatedLayer)||void 0===l?void 0:l.globalIdField)&&s.setAttribute(c,a.getAttribute(c))),r.geometryModified&&!r.stagedForDelete||(s.geometry=null),d=r.stagedForDelete?"deleteFeatures":"updateFeatures",t.next=9,e(o,(0,gt.Z)({},d,[s]));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},(0,p._)([(0,m.Cb)()],Lt.prototype,"editorItem",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"featureFormViewModel",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"fullFeature",void 0),(0,p._)([(0,m.Cb)()],Lt.prototype,"hasPendingEdits",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"layer",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"parent",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"parentLayer",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"shouldShowAttachments",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"shouldAllowAttachmentEditing",null),(0,p._)([(0,m.Cb)()],Lt.prototype,"reliesOnOwnerAdminPrivileges",null),Lt=Wt=(0,p._)([(0,g.j)("esri.widgets.Editor.UpdateRecordWorkflow")],Lt);var Ut=(0,r.Z)((0,r.Z)({},Tt),{},{highlights:Symbol(),sketchGraphics:Symbol(),sketchViewModel:Symbol()}),Ht=Vt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).type="update-feature",r._layerViewEditSession=null,r._sketchGraphicClone=null,r._sketchViewModel=null,r._webStyleCache=new Map,r}return(0,u.Z)(n,[{key:"destroy",value:function(){var e;null===(e=this._layerViewEditSession)||void 0===e||e.rollback()}},{key:"commit",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.removeHandles(Ut.sketchGraphics),e.prev=1,t=this.data.edits.stagedForDelete,e.next=5,(0,B.Z)((0,N.Z)(n.prototype),"commit",this).call(this);case 5:r=this._layerViewEditSession,t?null===r||void 0===r||r.rollback():null===r||void 0===r||r.commit(),e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(1),e.next=13,this._configureSketchViewModel();case 13:throw new W.Z("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:e.t0});case 14:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,B.Z)((0,N.Z)(n.prototype),"start",this).call(this);case 2:return e.next=4,this._initializeSketchViewModel();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_initializeFeatureFormViewModel",value:function(){var e=this;(0,B.Z)((0,N.Z)(n.prototype),"_initializeFeatureFormViewModel",this).call(this),this.addHandles(this._featureFormViewModel.on("value-change",(function(t){var n;null===(n=e._layerViewEditSession)||void 0===n||n.setAttribute(t.fieldName,t.value)})))}},{key:"_configureHighlight",value:function(){var e=this.data,t=e.edits,n=e.layerView;(0,xt.tl)(n)&&this.addHandles(n.highlight(t.feature),Ut.highlights)}},{key:"_configureSketchViewModel",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r,a,o,s,u,l,c,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._sketchViewModel){e.next=3;break}return e.abrupt("return");case 3:return n=this.data,r=this._featureFormViewModel,a=this._sketchGraphicClone,o=n.edits,s=n.viewModel,u=o.feature,l=s.view,c=ve(u),e.next=13,ze({feature:u,featureClone:a,visualVariableAttributes:c,sketchViewModel:t,view:l,onUpdate:function(e,t){var n=e.geometry,a=e.attributes;if(o.updateAttributes(a),o.updateGeometry(n),r.feature.geometry=n,null!=c.rotation){var i=c.rotation.field;r.setValue(i,a[i])}if(null!=c.size){var s=c.size.field;r.setValue(s,a[s])}("undo"===t.type||"redo"===t.type||"update"===t.type&&null!=t.toolEventInfo&&et(t.toolEventInfo.type))&&r.notifyFeatureGeometryChanged()},webStyleCache:this._webStyleCache});case 13:d=e.sent,this.addHandles(d,Ut.sketchGraphics),t.addHandles(d);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_initializeSketchViewModel",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r,a,s,u,l,c,d,p=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.data,n=this._sketchGraphicClone,r=t.edits.feature,a=t.editorItem,s=a.capabilities,u=a.layer,l=t.viewModel.view,this.removeHandles([Ut.highlights,Ut.sketchGraphics,Ut.sketchViewModel]),s.update.geometry&&("3d"!==(null===l||void 0===l?void 0:l.type)||!(0,Zt.XH)(u.elevationInfo))){e.next=3;break}return e.abrupt("return",{enter:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.hasHandles(Ut.highlights)||p._configureHighlight();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),exit:function(){return p.removeHandles([Ut.highlights])}});case 3:return c=new T.default({elevationInfo:u.elevationInfo,internal:!0,listMode:"hide"}),d=new dt.Z({allowDeleteKey:!1,layer:c,sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,view:l}),this._sketchViewModel=d,null!==l&&void 0!==l&&l.map.add(c),this.addHandles((0,O.kB)((function(){null!==l&&void 0!==l&&l.destroyed||null!==l&&void 0!==l&&l.map.remove(c),c.destroy(),p._sketchViewModel=(0,h.SC)(d)})),Ut.sketchViewModel),e.next=9,ge(n,this._webStyleCache,"2d"===(null===l||void 0===l?void 0:l.type)?l.scale:null);case 9:return e.t0=this,e.next=12,Be(d,r,n);case 12:return e.t1=e.sent,e.t2=[e.t1],e.t0.addHandles.call(e.t0,e.t2),e.abrupt("return",{enter:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=p.hasHandles(Ut.sketchGraphics),e.t0){e.next=4;break}return e.next=4,p._configureSketchViewModel();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),exit:function(){return p.removeHandles([Ut.sketchGraphics])},viewModel:d});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_onFullFeatureLoaded",value:function(e){(0,B.Z)((0,N.Z)(n.prototype),"_onFullFeatureLoaded",this).call(this,e);var t=this._sketchGraphicClone=nt(e),r=this.data,a=r.edits,i=r.layerView;a.updateGeometry(e.geometry),a.trackChanges(),function(e){return"createInteractiveEditSession"in e}(i)&&(this._layerViewEditSession=i.createInteractiveEditSession(t))}},{key:"test",get:function(){}}],[{key:"create",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Vt,e.next=3,Ot.create(t);case 3:return e.t1=e.sent,e.t2=this._onCommitFactory(t.applyEdits),e.t3={data:e.t1,onCommit:e.t2},n=new e.t0(e.t3),e.abrupt("return",(n._set("steps",this._createWorkflowSteps(n)),n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Lt);(0,p._)([(0,m.Cb)()],Ht.prototype,"_layerViewEditSession",void 0),(0,p._)([(0,m.Cb)()],Ht.prototype,"_sketchGraphicClone",void 0),(0,p._)([(0,m.Cb)()],Ht.prototype,"_sketchViewModel",void 0),Ht=Vt=(0,p._)([(0,g.j)("esri.widgets.Editor.UpdateFeatureWorkflow")],Ht);var Dt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).addAttachmentsCallback=null,r.applyEditsCallback=null,r.candidates=null,r.rootFeature=null,r.sketchOptions=null,r.snappingManager=null,r.viewModel=null,r}return(0,u.Z)(n)}($.default);(0,p._)([(0,m.Cb)()],Dt.prototype,"addAttachmentsCallback",void 0),(0,p._)([(0,m.Cb)()],Dt.prototype,"applyEditsCallback",void 0),(0,p._)([(0,m.Cb)()],Dt.prototype,"candidates",void 0),(0,p._)([(0,m.Cb)()],Dt.prototype,"rootFeature",void 0),(0,p._)([(0,m.Cb)({constructOnly:!0})],Dt.prototype,"sketchOptions",void 0),(0,p._)([(0,m.Cb)()],Dt.prototype,"snappingManager",void 0),(0,p._)([(0,m.Cb)()],Dt.prototype,"viewModel",void 0);var Rt,zt=Dt=(0,p._)([(0,g.j)("esri.widgets.Editor.UpdateWorkflowData")],Dt),Gt=n(45276),Bt="esri.widgets.Editor.UpdateWorkflow",Nt=Rt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e))._workflowStack=new kt.Z(bt.Z$),r._sketchStack=new kt.Z(bt.Z$),r.data=void 0,r.type="update",r}return(0,u.Z)(n,[{key:"activeEditorItem",get:function(){var e,t;return null!==(e=null===(t=this.activeWorkflow)||void 0===t?void 0:t.data.editorItem)&&void 0!==e?e:void 0}},{key:"activeFeatureFormViewModel",get:function(){var e;return null===(e=this.activeWorkflow)||void 0===e?void 0:e.featureFormViewModel}},{key:"activeSketchViewModel",get:function(){var e;return null===(e=this._sketchStack.peek())||void 0===e?void 0:e.viewModel}},{key:"activeWorkflow",get:function(){return this._workflowStack.last()}},{key:"hasUpdatableCandidates",get:function(){var e=this.data,t=e.candidates,n=e.viewModel;return t.some((function(e){var t,r=e.layer;return null===(t=n.findEditorItemForLayer(r))||void 0===t?void 0:t.supportsUpdateWorkflow}))}},{key:"nestedWorkflowCount",get:function(){return this._workflowStack.length}},{key:"shouldShowAttachments",get:function(){var e;return!(null===(e=this.activeEditorItem)||void 0===e||!e.capabilities.attachments.enabled)}},{key:"shouldAllowAttachmentEditing",get:function(){var e;return!(null===(e=this.activeEditorItem)||void 0===e||!e.capabilities.update.attachments.enabled)}},{key:"hasPendingEdits",get:function(){return Array.from(this._workflowStack).some((function(e){return e.hasPendingEdits}))}},{key:"helpMessage",get:function(){var e;return null!==(e=this.activeWorkflow)&&void 0!==e&&e.helpMessage?this.activeWorkflow.helpMessage:"awaiting-feature-to-update"===this.stepId?"select":void 0}},{key:"reliesOnOwnerAdminPrivileges",get:function(){var e,t;return null!==(e=null===(t=this.activeWorkflow)||void 0===t?void 0:t.reliesOnOwnerAdminPrivileges)&&void 0!==e&&e}},{key:"hasInvalidFormTemplate",get:function(){var e;return!(null===(e=this.activeEditorItem)||void 0===e||!e.hasInvalidFormTemplate)}},{key:"back",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:function(){return Promise.resolve(!0)},null!=(null===(n=this.activeWorkflow)||void 0===n?void 0:n.featureFormViewModel.relationshipId)){e.next=27;break}if(!n){e.next=18;break}if(!n.hasPendingEdits){e.next=9;break}return e.next=7,t();case 7:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:if(!n.hasPreviousStep){e.next=14;break}return e.next=12,n.previous({cancelCurrentStep:!0});case 12:e.next=16;break;case 14:return e.next=16,this.cancelActiveWorkflow({force:!0});case 16:e.next=25;break;case 18:if(!this.hasPreviousStep){e.next=23;break}return e.next=21,this.previous({cancelCurrentStep:!0});case 21:e.next=25;break;case 23:return e.next=25,this.cancel({force:!0});case 25:e.next=28;break;case 27:n.featureFormViewModel.relationshipId=null;case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancelActiveWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.activeWorkflow)||void 0===n?void 0:n.cancel(t);case 2:return e.next=4,this._popWorkflow();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"commit",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._drainWorkflowStack((function(e){return e.commit()}));case 2:return e.next=4,(0,B.Z)((0,N.Z)(n.prototype),"commit",this).call(this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.nestedWorkflowCount>1)){e.next=7;break}return e.next=3,null===(t=this.activeWorkflow)||void 0===t?void 0:t.commit();case 3:return e.next=5,this._popWorkflow();case 5:e.next=9;break;case 7:return e.next=9,this.commit();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startCreatingRelatedRecord",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._createNestedCreateFeaturesWorkflow(t);case 3:return n=e.sent,e.next=6,this._pushWorkflow(n);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new W.Z("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",{error:e.t0});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"startUpdating",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._createNestedUpdateWorkflow(t);case 3:return n=e.sent,e.next=6,this._pushWorkflow(n);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new W.Z("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:e.t0});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteActiveFeature",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.activeWorkflow){e.next=3;break}throw new W.Z("editor:nothing-to-delete","There is no feature to delete");case 3:if(!qt(t)){e.next=8;break}return e.next=6,t.deleteAndCommit();case 6:e.next=10;break;case 8:return e.next=10,t.cancel();case 10:if(1!==this.nestedWorkflowCount){e.next=15;break}return e.next=13,this.reset();case 13:e.next=17;break;case 15:return e.next=17,this._popWorkflow();case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancelAll",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._drainWorkflowStack((function(e){return e.cancel({force:!0})}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_createNestedCreateFeaturesWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s,u,l,c,d,p,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.relatedLayer,a=this.data,o=a.addAttachmentsCallback,s=a.applyEditsCallback,u=a.sketchOptions,l=a.snappingManager,c=a.viewModel,(0,L.K)(r)){e.next=3;break}throw new W.Z("editor:unsupported-layer","Editing is not supported on the provided layer");case 3:return d=this._getCreationInfoForNestedCreateFeaturesWorkflow(t),p=d.template||d.initialFeature?"creating-features":"awaiting-feature-creation-info",f="create-features"!==(null===(n=this.activeWorkflow)||void 0===n?void 0:n.type)?this.activeWorkflow:void 0,e.abrupt("return",mt.create({addAttachmentsCallback:o,applyEditsCallback:s,creationInfo:d,isNested:!0,parent:f,sketchOptions:u,snappingManager:l,startAt:p,viewModel:c}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getCreationInfoForNestedCreateFeaturesWorkflow",value:function(e){var t=e.relatedLayer;if(!(0,L.K)(t)||(0,U.e9)(t))throw new W.Z("editor:unsupported-layer","Editing is not supported on the provided layer");var n={layer:t,maxFeatures:1},r=this._makeRelatedRecordAttributes(e),a=(0,fe.J)(t);return(null===a||void 0===a?void 0:a.length)>0?(n.attributeOverrides=r,1===a.length&&(n.template=a[0])):n.initialFeature=new j.Z({sourceLayer:t,attributes:r}),n}},{key:"_createNestedUpdateWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,s,u,l,c,d,p,f=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,U.wb)(t.sourceLayer)?Lt:Ht,a=this.data,s=a.applyEditsCallback,u=a.sketchOptions,l=a.snappingManager,c=a.viewModel,d="create-features"!==(null===(n=this.activeWorkflow)||void 0===n?void 0:n.type)?this.activeWorkflow:void 0,e.next=9,r.create({feature:t,parent:d,sketchOptions:u,snappingManager:l,viewModel:c,applyEdits:s,relatedRecordCallbacks:{addRelatedRecord:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.startCreatingRelatedRecord(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),editRelatedRecord:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.relatedFeature,e.next=3,f.startUpdating(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}});case 9:return p=e.sent,e.next=12,(0,w.whenOnce)((function(){return!p.updating}));case 12:return e.abrupt("return",p);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_drainWorkflowStack",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,o=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this._workflowStack,r=[],a=function(){var e=n.pop();o._sketchStack.pop();var a=t(e).then((function(){return e.destroy()}));o._updatingHandles.addPromise(a),r.push(a)};n.length>0;)a();return e.next=5,Promise.all(r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_makeRelatedRecordAttributes",value:function(e){var t,n,r=e.parentFeature,a=e.relatedLayer,i=e.relationshipId;if((0,Gt.tJ)(r)){var o=null===(t=a.relationships)||void 0===t?void 0:t.find((function(e){return e.id===i}));if(o)if("origin"!==o.role){var s=r.sourceLayer;o.relatedTableId!==s.layerId&&jt("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");var u=null===(n=s.relationships)||void 0===n?void 0:n.find((function(e){return e.id===i}));if(u){var l=r.getAttribute(u.keyField);return l||jt("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),(0,gt.Z)({},o.keyField,l)}jt("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.")}else jt("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");else jt("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.")}}},{key:"_popWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!==(t=this._workflowStack.pop())&&void 0!==t&&t.destroy(),this._sketchStack.pop(),e.next=3,this._reconcileWorkflowStack();case 3:if(!((n=e.sent).failureCount>0)){e.next=6;break}throw new W.Z("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_pushWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._workflowRequiresSketchViewModel(t),null===(n=this.activeWorkflow)||void 0===n||n.exit({removeSketchHandles:r}),a=this._sketchStack,e.next=5,null===t||void 0===t?void 0:t.start();case 5:return o=e.sent,s=a.peek(),o?(null!==s&&void 0!==s&&s.exit(),a.push(o)):a.push(this._cloneSketchController(s)),this._workflowStack.push(t),e.next=10,this._reconcileWorkflowStack();case 10:if(!((u=e.sent).failureCount>0)){e.next=13;break}throw new W.Z("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",u);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_reconcileWorkflowStack",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r,a,o,s,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._workflowStack,n=this._sketchStack,e.prev=1,a=t.peek(),e.next=5,null===a||void 0===a?void 0:a.enter();case 5:return e.next=7,null===(r=n.peek())||void 0===r?void 0:r.enter();case 7:return e.abrupt("return",{activeWorkflow:a,failureCount:0});case 10:return e.prev=10,e.t0=e.catch(1),t.pop().destroy(),n.pop(),e.next=15,this._reconcileWorkflowStack();case 15:return o=e.sent,s=o.activeWorkflow,u=o.failureCount,e.abrupt("return",{activeWorkflow:s,failureCount:u+1});case 19:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"_cloneSketchController",value:function(e){var t,n;return{enter:null!==(t=null===e||void 0===e?void 0:e.enter)&&void 0!==t?t:(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),exit:null!==(n=null===e||void 0===e?void 0:e.exit)&&void 0!==n?n:(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),viewModel:null===e||void 0===e?void 0:e.viewModel}}},{key:"_workflowRequiresSketchViewModel",value:function(e){var t,n=e.type;return"update-feature"===n||"create-features"===n&&!(0,U.wb)(null===(t=e.data.creationInfo)||void 0===t?void 0:t.layer)}}],[{key:"create",value:function(e){var t,n=e.viewModel,r=e.snappingManager,a=e.startAt,s=e.addAttachmentsCallback,u=e.applyEditsCallback,l=null!==(t=e.sketchOptions)&&void 0!==t?t:new D.Z,c=new Rt({data:new zt({addAttachmentsCallback:s,applyEditsCallback:u,sketchOptions:l,snappingManager:r,viewModel:n}),onCommit:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});return c._set("steps",this._createWorkflowSteps(c,a)),c}},{key:"_createWorkflowSteps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"awaiting-feature-to-update",n=e.data;return Je(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],t,{"awaiting-feature-to-update":function(){return{id:"awaiting-feature-to-update",setUp:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function r(){var a,s,u,l;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=n.viewModel.spinnerViewModel,s=n.viewModel.view,u=null,e.addHandles((0,O.kB)((function(){u=(0,h.IM)(u)})),t.id),n.rootFeature=null,n.candidates=[],l=s.on("immediate-click",function(){var t=(0,o.Z)((0,i.Z)().mark((function t(r){var o,l,c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.location=r.mapPoint,a.visible=!0,null===(o=u)||void 0===o||o.abort(),l=n.viewModel.editorItems,u=new AbortController,t.next=5,r.async((function(){return new Promise((function(e,t){var n,a;(0,y.fu)(null===(n=u)||void 0===n?void 0:n.signal,(function(){return t((0,y.zE)())})),e(Ie(l,s,r,null===(a=u)||void 0===a?void 0:a.signal))}))}));case 5:c=t.sent,(0,y.k_)(u),n.candidates=c.filter((function(e){return"fulfilled"===e.status})).flatMap((function(e){return e.value})).filter((function(e){return!e.isAggregate})),a.visible=1===n.candidates.length,0!==n.candidates.length&&(r.stopPropagation(),1===n.candidates.length?(n.rootFeature=n.candidates[0],e.go("editing-existing-feature").catch((function(){})).then((function(){return a.visible=!1}))):e.next());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J.f.TOOL),s.focus(),e.addHandles(l,t.id);case 5:case"end":return r.stop()}}),r)})))()},tearDown:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function r(){return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:0===n.candidates.length&&(n.viewModel.spinnerViewModel.visible=!1),e.removeHandles(t.id);case 1:case"end":return r.stop()}}),r)})))()}}},"awaiting-update-feature-candidate":function(){return{id:"awaiting-update-feature-candidate",setUp:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function r(){var a,o;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.rootFeature=null,a=n.viewModel.view){r.next=4;break}return r.abrupt("return");case 4:o=new _t.Z({view:a}),e.addHandles([(0,w.watch)((function(){return n.rootFeature}),(function(e,t){o.remove(t),o.add(e)}),w.sync),(0,O.kB)((function(){return o.removeAll()}))],t.id);case 6:case"end":return r.stop()}}),r)})))()},tearDown:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.removeHandles(t.id);case 1:case"end":return n.stop()}}),n)})))()}}},"editing-existing-feature":function(){return{id:"editing-existing-feature",setUp:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function n(){var r,a,s,u;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.data,a=r.rootFeature,s=r.viewModel,a){n.next=3;break}throw new W.Z("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");case 3:return n.next=5,e.startUpdating(a);case 5:s.spinnerViewModel.visible=!1,u=(0,y.Ds)((0,o.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,w.whenOnce)((function(){return!e.updating}));case 2:e.previous();case 3:case"end":return t.stop()}}),t)})))),e.addHandles([(0,w.watch)((function(){return e.nestedWorkflowCount}),(function(e,t){0===e&&0!==t&&u()}),w.sync)],t.id);case 8:case"end":return n.stop()}}),n)})))()},tearDown:function(){var t=this;return(0,o.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.cancelAll();case 2:e.removeHandles(t.id);case 3:case"end":return n.stop()}}),n)})))()}}},"adding-attachment":function(){return{id:"adding-attachment",parent:"editing-existing-feature",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.viewModel.attachmentsViewModel.mode="view";case 1:case"end":return e.stop()}}),e)})))()}}},"editing-attachment":function(){return{id:"editing-attachment",parent:"editing-existing-feature",setUp:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},tearDown:function(){return(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.viewModel.attachmentsViewModel.mode="view";case 1:case"end":return e.stop()}}),e)})))()}}}})}}]),n}(lt);(0,p._)([(0,m.Cb)()],Nt.prototype,"activeEditorItem",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"activeFeatureFormViewModel",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"activeSketchViewModel",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"activeWorkflow",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"data",void 0),(0,p._)([(0,m.Cb)()],Nt.prototype,"hasUpdatableCandidates",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"nestedWorkflowCount",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"shouldShowAttachments",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"shouldAllowAttachmentEditing",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"hasPendingEdits",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"helpMessage",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"reliesOnOwnerAdminPrivileges",null),(0,p._)([(0,m.Cb)()],Nt.prototype,"hasInvalidFormTemplate",null),Nt=Rt=(0,p._)([(0,g.j)(Bt)],Nt);var jt=function(e,t){return v.Z.getLogger(Bt).warn("editor:".concat(e),t,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature.")},qt=function(e){return!!e&&/update-/.test(e.type)},Qt=Nt,Kt=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).layer=null,r}return(0,u.Z)(n,[{key:"attachments",get:function(){var e;return{enabled:this._effectiveEnabled&&!(null===(e=this._effectiveCapabilities)||void 0===e||!e.data.supportsAttachment)}}},{key:"create",get:function(){var e,t=this._effectiveCapabilities,n=this.layer,r=this._createEnabled,a=r,i=null===(e=n.capabilities)||void 0===e?void 0:e.operations.supportsAdd,o=!(null===t||void 0===t||!t.operations.supportsAdd);return{attachments:{enabled:r&&this.attachments.enabled},attributes:r,enabled:r,geometry:a,reliesOnOwnerAdminPrivileges:!i&&o}}},{key:"delete",get:function(){var e,t=this._effectiveCapabilities,n=null===(e=this.layer.capabilities)||void 0===e?void 0:e.operations.supportsDelete,r=!(null===t||void 0===t||!t.operations.supportsDelete);return{enabled:this._effectiveEnabled&&!(null===t||void 0===t||!t.operations.supportsDelete),reliesOnOwnerAdminPrivileges:!n&&r}}},{key:"reliesOnOwnerAdminPrivileges",get:function(){return this._effectiveEnabled&&!this.layer.editingEnabled||this.create.reliesOnOwnerAdminPrivileges||this.update.reliesOnOwnerAdminPrivileges||this.delete.reliesOnOwnerAdminPrivileges}},{key:"update",get:function(){var e,t=this._effectiveCapabilities,n=this.layer,r=this._updateEnabled,a=!(!r||null===t||void 0===t||!t.editing.supportsGeometryUpdate),i=null===(e=n.capabilities)||void 0===e?void 0:e.operations.supportsUpdate,o=!(null===t||void 0===t||!t.operations.supportsUpdate),s=this.attachments.enabled,u=s&&this._canCreateOrUpdate;return{attachments:{enabled:s,create:u,update:u},attributes:r,enabled:r,geometry:a,reliesOnOwnerAdminPrivileges:!i&&o}}},{key:"_createEnabled",get:function(){var e;return this._effectiveEnabled&&!(null===(e=this._effectiveCapabilities)||void 0===e||!e.operations.supportsAdd)}},{key:"_updateEnabled",get:function(){var e;return this._effectiveEnabled&&!(null===(e=this._effectiveCapabilities)||void 0===e||!e.operations.supportsUpdate)}},{key:"_canCreateOrUpdate",get:function(){return!(!this._createEnabled&&!this._updateEnabled)}},{key:"_effectiveEnabled",get:function(){return(0,U.ln)(this.layer)}},{key:"_effectiveCapabilities",get:function(){return(0,U.S1)(this.layer)}}]),n}($.default);(0,p._)([(0,m.Cb)()],Kt.prototype,"attachments",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"create",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"delete",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"layer",void 0),(0,p._)([(0,m.Cb)()],Kt.prototype,"reliesOnOwnerAdminPrivileges",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"update",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"_createEnabled",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"_updateEnabled",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"_canCreateOrUpdate",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"_effectiveEnabled",null),(0,p._)([(0,m.Cb)()],Kt.prototype,"_effectiveCapabilities",null);var Jt=Kt=(0,p._)([(0,g.j)("esri.layers.support.EditingCapabilities")],Kt),Xt=n(92975),$t=n(18277),Yt=n(50951),en="esri.views.layers.support.editableLayerViews";var tn=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).layerInfo=null,r.layerView=null,r}return(0,u.Z)(n,[{key:"attachments",get:function(){var e=this.defaults.attachments.enabled,t=this.layerInfo;return{enabled:e&&!1!==(null===t||void 0===t?void 0:t.enabled)}}},{key:"create",get:function(){var e=this.attachments,t=this.defaults,n=this.layerInfo,r=this.layer,a=this.layerView,i=t.create,o=!1!==(null===n||void 0===n?void 0:n.enabled)&&!1!==(null===n||void 0===n?void 0:n.addEnabled),s=i.enabled&&o;return{attributes:s&&i.attributes,enabled:s,geometry:s&&i.geometry&&nn(r,a),attachments:{enabled:e.enabled&&s&&!1!==(null===n||void 0===n?void 0:n.attachmentsOnCreateEnabled)},reliesOnOwnerAdminPrivileges:i.reliesOnOwnerAdminPrivileges}}},{key:"defaults",get:function(){return new Jt({layer:this.layer})}},{key:"delete",get:function(){var e=this.defaults,t=this.layerInfo,n=e.delete,r=!1!==(null===t||void 0===t?void 0:t.enabled)&&!1!==(null===t||void 0===t?void 0:t.deleteEnabled);return{enabled:n.enabled&&r,reliesOnOwnerAdminPrivileges:n.reliesOnOwnerAdminPrivileges}}},{key:"formTemplate",get:function(){var e=this.layer,t=this.layerInfo;return null!==t&&void 0!==t&&t.formTemplate?t.formTemplate:e&&"formTemplate"in e?e.formTemplate:null}},{key:"relationship",get:function(){var e,t,n,r=this.layer,a=!(!(0,Gt.Um)(r)||null===(e=r.relationships)||void 0===e||!e.length),i=!(null===(t=this.formTemplate)||void 0===t||null===(n=t.elements)||void 0===n||!n.some((function(e){return"relationship"===e.type})));return{enabled:a&&i}}},{key:"update",get:function(){var e=this.attachments,t=this.defaults,n=this.layerInfo,r=this.layer,a=this.layerView,i=t.update,o=!1!==(null===n||void 0===n?void 0:n.enabled)&&!1!==(null===n||void 0===n?void 0:n.updateEnabled),s=i.enabled&&o,u=s&&i.attributes&&!1!==(null===n||void 0===n?void 0:n.attributeUpdatesEnabled),l=s&&i.geometry&&!1!==(null===n||void 0===n?void 0:n.geometryUpdatesEnabled)&&nn(r,a),c=e.enabled&&!1!==(null===n||void 0===n?void 0:n.attachmentsOnUpdateEnabled);return{attributes:u,enabled:s,geometry:l,attachments:{enabled:c,create:c&&i.attachments.create,update:c&&i.attachments.update},reliesOnOwnerAdminPrivileges:i.reliesOnOwnerAdminPrivileges}}}]),n}(Jt);function nn(e,t){return"scene"!==e.type||null!=t&&"type"in t&&"scene-layer-3d"===t.type&&function(e,t){var n,r,a,i,o,s,u,l=e.associatedLayer,c=null===l||void 0===l?void 0:l.infoFor3D;if(!c)return!1;var d=c.supportedFormats,p=c.queryFormats,f=null!==(n=(0,$t.S0)("model/gltf-binary",d))&&void 0!==n?n:(0,$t.Ow)("glb",d);if(null==f||!p.includes(f))return v.Z.getLogger(en).warnOnce("SceneLayer (".concat(null!==(r=e.title)&&void 0!==r?r:"Untitled layer",", ").concat(e.id,") does not support geometry edits because it does not support GLB queries.")),!1;var h=e.spatialReference,y=l.spatialReference;if(!(0,Xt.fS)(h,y))return v.Z.getLogger(en).warnOnce("SceneLayer (".concat(null!==(a=e.title)&&void 0!==a?a:"Untitled layer",", ").concat(e.id,") does not support geometry edits because its spatial reference (wkid:").concat(h.wkid,") is different from its associated FeatureLayer's spatial reference (wkid:").concat(y.wkid,").")),!1;var w=l.sourceJSON.sourceSpatialReference;if(null!=w&&!(0,Xt.fS)(w,y))return v.Z.getLogger(en).warnOnce("SceneLayer (".concat(null!==(i=e.title)&&void 0!==i?i:"Untitled layer",", ").concat(e.id,") does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:").concat(y.wkid,") is different from its source spatial reference (wkid:").concat(w.wkid,").")),!1;var m=t.view;if(t.destroyed||null==m)return!1;var g=m.spatialReference,k=m.state.viewingMode,b=(0,Xt.sT)(h),_=k===Yt.JY.Global;return b&&!_?(v.Z.getLogger(en).warnOnce("SceneLayer (".concat(null!==(o=e.title)&&void 0!==o?o:"Untitled layer",", ").concat(e.id,") does not support geometry edits in local viewing mode because its spatial reference (wkid:").concat(h.wkid,") is geographic. Please consider changing the viewing mode to global.")),!1):!b&&_?(v.Z.getLogger(en).warnOnce("SceneLayer (".concat(null!==(s=e.title)&&void 0!==s?s:"Untitled layer",", ").concat(e.id,") does not support geometry edits in global viewing mode because its spatial reference (wkid:").concat(h.wkid,") is projected. Please consider changing the viewing mode to local.")),!1):!!((0,Xt.fS)(h,g)||_&&(0,Xt.sS)(g)&&(0,Xt.oR)(h))||(v.Z.getLogger(en).warnOnce("SceneLayer (".concat(null!==(u=e.title)&&void 0!==u?u:"Untitled layer",", ").concat(e.id,") does not support geometry edits because its spatial reference (wkid:").concat(h.wkid,") does not match the view spatial reference (wkid:").concat(g.wkid,").")),!1)}(e,t)}(0,p._)([(0,m.Cb)()],tn.prototype,"attachments",null),(0,p._)([(0,m.Cb)()],tn.prototype,"create",null),(0,p._)([(0,m.Cb)()],tn.prototype,"defaults",null),(0,p._)([(0,m.Cb)()],tn.prototype,"delete",null),(0,p._)([(0,m.Cb)()],tn.prototype,"formTemplate",null),(0,p._)([(0,m.Cb)()],tn.prototype,"layerInfo",void 0),(0,p._)([(0,m.Cb)()],tn.prototype,"layerView",void 0),(0,p._)([(0,m.Cb)()],tn.prototype,"relationship",null),(0,p._)([(0,m.Cb)()],tn.prototype,"update",null);var rn=tn=(0,p._)([(0,g.j)("esri.widgets.Editor.support.EditorEditingCapabilities")],tn),an=n(73238),on=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).disabled=!1,r.layer=null,r.layerInfo=null,r.layerView=null,r}return(0,u.Z)(n,[{key:"_suspended",get:function(){var e;return!(null===(e=this.layerView)||void 0===e||!e.suspended)}},{key:"capabilities",get:function(){return new rn({layer:this.layer,layerInfo:this.layerInfo,layerView:this.layerView})}},{key:"editable",get:function(){var e=this.capabilities,t=e.create,n=e.relationship,r=e.update,a=e.delete.enabled,i=t.attachments.enabled||r.attachments.enabled;return!this.disabled&&(t.enabled||r.enabled||i||a||n.enabled)}},{key:"formTemplate",get:function(){return this.capabilities.formTemplate}},{key:"hasInvalidFormTemplate",get:function(){return(0,an.cs)(this.layer,this.formTemplate)}},{key:"isTable",get:function(){return(0,U.wb)(this.layer)}},{key:"supportsCreateFeaturesWorkflow",get:function(){if(this.disabled)return!1;var e=this.capabilities.create,t=e.enabled,n=e.geometry;return this.isTable?t:t&&n}},{key:"supportsUpdateWorkflow",get:function(){var e=this.capabilities;return!this.disabled&&(e.update.enabled||e.update.attachments.enabled||e.delete.enabled)}},{key:"visible",get:function(){var e=this.layer,t=e.parent;return!this._suspended&&e.visible&&(!t||!("visible"in t)||t.visible)}}]),n}($.default);(0,p._)([(0,m.Cb)()],on.prototype,"_suspended",null),(0,p._)([(0,m.Cb)()],on.prototype,"capabilities",null),(0,p._)([(0,m.Cb)()],on.prototype,"disabled",void 0),(0,p._)([(0,m.Cb)()],on.prototype,"editable",null),(0,p._)([(0,m.Cb)()],on.prototype,"formTemplate",null),(0,p._)([(0,m.Cb)()],on.prototype,"hasInvalidFormTemplate",null),(0,p._)([(0,m.Cb)()],on.prototype,"isTable",null),(0,p._)([(0,m.Cb)()],on.prototype,"layer",void 0),(0,p._)([(0,m.Cb)()],on.prototype,"layerInfo",void 0),(0,p._)([(0,m.Cb)()],on.prototype,"layerView",void 0),(0,p._)([(0,m.Cb)()],on.prototype,"supportsCreateFeaturesWorkflow",null),(0,p._)([(0,m.Cb)()],on.prototype,"supportsUpdateWorkflow",null),(0,p._)([(0,m.Cb)()],on.prototype,"visible",null);var sn=on=(0,p._)([(0,g.j)("esri.widgets.Editor.support.EditorItem")],on),un=n(26138),ln=n(67354),cn="esri.widgets.Editor.EditorViewModel",dn=["create-features","update"];function pn(e,t,n){v.Z.getLogger(cn).error(new W.Z(e,t,n))}function fn(e,t){return null===e||void 0===e?void 0:e.find((function(e){return e.layer===t}))}var vn=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e))._sketchEventListenerHandle=null,r._sketchGraphicsLayer=new T.default({listMode:"hide",internal:!0}),r._snappingManager=null,r._updateItemsTask=null,r._updatingHandles=new P.R,r._featureTemplatesViewModelLocked=!1,r.activeWorkflow=null,r._activityQueue=new S.Z,r.editorItems=new S.Z,r.failures=[],r.hideTemplatesForInactiveLayers=!1,r.attachmentsViewModel=new G.Z({capabilities:{editing:!0}}),r.featureTemplatesViewModel=new un.Z({disabledItemFunction:function(e){var t=e.layer;return r._itemIsSuspended(t)}}),r.layerInfos=null,r.ownSketchViewModel=new dt.Z({layer:r._sketchGraphicsLayer}),r.sketchOptions=new D.Z,r.snappingOptions=new z.Z({attributeRulesEnabled:!0}),r.spinnerViewModel=new ln.Z,r.pageStack=[],r.showDiscardEditsPrompt=function(){return Promise.resolve(!0)},r._candidateCommitted=!1,r.back=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.canGoBack,!e.t0){e.next=9;break}if(null===(t=r.activeWorkflow)||void 0===t||!t.hasPreviousStep){e.next=7;break}return e.next=5,r.activeWorkflow.back(r.showDiscardEditsPrompt);case 5:e.next=9;break;case 7:return e.next=9,r._cancelWorkflow({force:!r.hasPendingEdits});case 9:case"end":return e.stop()}}),e)}))),r.saveWorkflow=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,l.Z)(r),!(a=n.featureFormViewModel)){e.next=7;break}if(a.submit(),a.submittable&&!a.hasPendingSubtypeChoice){e.next=4;break}return e.abrupt("return");case 4:if(o=a.getValues(),!(a.validateContingencyConstraints(o,{includeIncompleteViolations:!0}).length>0)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,null===(t=r.activeWorkflow)||void 0===t?void 0:t.save();case 9:case"end":return e.stop()}}),e)}))),r.selectFeature=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=r.activeWorkflow;r._candidateCommitted||"update"!==(null===n||void 0===n?void 0:n.type)||(n.data.rootFeature=e,t&&(n.next(),r._candidateCommitted=!0))},r}return(0,u.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,w.watch)((function(){var t,n=e.view,r=null===n||void 0===n||null===(t=n.map)||void 0===t?void 0:t.editableLayers,a=null===n||void 0===n?void 0:n.allLayerViews,i=null===a||void 0===a?void 0:a.filter((function(e){return!(null===r||void 0===r||!r.includes(e.layer))}));return[r,i,e.layerInfos,e.allowedWorkflows]}),(function(){return e._updateEditorItems()}),w.syncAndInitial),(0,w.watch)((function(){return e.hideTemplatesForInactiveLayers}),(function(){return e.syncFeatureTemplates()})),(0,w.on)((function(){return e.activeWorkflow}),"cancel",(function(){return e.emit("workflow-cancel")})),(0,w.on)((function(){return e.activeWorkflow}),"commit",(function(){return e.emit("workflow-commit")})),(0,w.on)((function(){return e.activeWorkflow}),"complete",(function(){e.emit("workflow-commit"),e._set("activeWorkflow",null)})),(0,w.when)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.map}),(function(t){return t.add(e._sketchGraphicsLayer)}),w.initial),(0,w.on)((function(){return e.editorItems}),"change",(function(){return e._afterEditorItemsChange()})),(0,w.watch)((function(){return[e.canCreate,e.canUpdateVisible]}),(function(){return e._afterEditorItemsChange()})),(0,w.watch)((function(){return e.page}),(function(t,n){var r=(0,A.Z)(e.pageStack);if(-1===r.indexOf(t))r.push(t);else for(;r.length&&r.at(-1)!==t;)r.pop();e.pageStack=r}),w.syncAndInitial),(0,w.when)((function(){return"awaiting-update-feature-candidate"===e.state}),(function(){return e._candidateCommitted=!1})),(0,w.on)((function(){return e.featureTemplatesViewModel}),"select",function(){var t=(0,o.Z)((0,i.Z)().mark((function t(n){var r,a,o,s,u;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.item,a=n.oldItem,!(o=e.activeWorkflow)){t.next=13;break}if("update"!==o.type||"awaiting-feature-creation-info"!==(null===(s=o.activeWorkflow)||void 0===s?void 0:s.stepId)){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,t.next=8,e.cancelWorkflow({force:!e.hasPendingEdits});case 8:t.next=13;break;case 10:return t.prev=10,t.t0=t.catch(5),t.abrupt("return",void e.featureTemplatesViewModel.select(a,{emit:!1}));case 13:if(r){t.next=15;break}return t.abrupt("return");case 15:if(u={layer:r.layer,template:r.template},!r.supportsUpload){t.next=18;break}return t.abrupt("return",(e.featureTemplatesViewModel.select(a,{emit:!1}),e.startCreateFeaturesWorkflow(u)));case 18:e.startCreateFeaturesWorkflowAtFeatureCreation(u);case 19:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e){return t.apply(this,arguments)}}()),(0,w.on)((function(){return e.view}),"key-down",(function(t){var n;"Escape"===t.key&&(null===(n=e.activeWorkflow)||void 0===n?void 0:n.keyboardCancellationEnabled)&&(t.stopPropagation(),e.back())})),(0,w.on)((function(){return e.sketchViewModel}),["create","delete","update"],(function(t){var n,r,a=e.activeWorkflow,i="update"===(null===a||void 0===a?void 0:a.type),o=i?null===(n=a.activeWorkflow)||void 0===n?void 0:n.layer:null===a||void 0===a?void 0:a.layer,s=i?null===a||void 0===a||null===(r=a.activeWorkflow)||void 0===r?void 0:r.parentLayer:void 0,u="sketch-".concat(t.type);e.emit(u,{type:u,detail:t,layer:o,parentLayer:s})}),w.sync),(0,w.watch)((function(){return e.view}),(function(t){if(e._snappingManager=(0,h.SC)(e._snappingManager),t){var n=e.snappingOptions;e._snappingManager=new R.N({view:t,options:n})}}),w.syncAndInitial),(0,w.watch)((function(){return e.snappingOptions}),(function(t){e._snappingManager&&(e._snappingManager.options=t)}),w.syncAndInitial)])}},{key:"destroy",value:function(){var e=this;this._cancelWorkflow({warnIfNoWorkflow:!1}).then((function(){var t,n;null!==(t=e.view)&&void 0!==t&&null!==(n=t.map)&&void 0!==n&&n.remove(e._sketchGraphicsLayer),e.view=null})),this._updateItemsTask=(0,h.IM)(this._updateItemsTask),this._updatingHandles.destroy(),this._sketchEventListenerHandle=(0,h.hw)(this._sketchEventListenerHandle)}},{key:"allowedWorkflows",get:function(){return this._get("allowedWorkflows")},set:function(e){(0,f.Mr)(v.Z.getLogger(this),"allowedWorkflows",{replacement:"Editor.visibleElements",version:"4.29",warnOnce:!0}),e&&0!==e.length||(e=[].concat(dn)),this._set("allowedWorkflows",e)}},{key:"canCreate",get:function(){return this.editorItems.some((function(e){return e.supportsCreateFeaturesWorkflow}))}},{key:"canCreateVisible",get:function(){return!!this.featureTemplatesLayers.length}},{key:"canUpdate",get:function(){return this.editorItems.some((function(e){return e.supportsUpdateWorkflow}))}},{key:"canUpdateVisible",get:function(){return this.editorItems.some((function(e){return e.supportsUpdateWorkflow&&e.visible}))}},{key:"featureTemplatesLayers",get:function(){var e,t=new S.Z,n=(0,I.Z)(this.editorItems);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.supportsCreateFeaturesWorkflow&&!r.isTable,i=this.hideTemplatesForInactiveLayers&&!r.visible;a&&!i&&t.push(r.layer)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"editableItems",get:function(){return(0,f.Mr)(v.Z.getLogger(this),"editableItems",{replacement:"editorItems",version:"4.29",warnOnce:!0}),this.editorItems.map((function(e){var t=e.capabilities,n=e.disabled,r=e.hasInvalidFormTemplate,a=e.layer,i=[],o=t.create,s=t.update,u=t.delete;return o.enabled&&i.push("create"),s.enabled&&i.push("update"),u.enabled&&i.push("delete"),{layer:a,supports:i,suspended:n,attributeUpdatesEnabled:s.attributes,geometryUpdatesEnabled:s.geometry,attachmentsOnCreateEnabled:o.attachments.enabled,attachmentsOnUpdateEnabled:s.attachments.enabled,hasInvalidFormTemplate:r,hasAttachments:t.attachments.enabled}}))}},{key:"featureFormViewModel",get:function(){var e=this.activeWorkflow;return"update"===(null===e||void 0===e?void 0:e.type)?e.activeFeatureFormViewModel:"create-features"===(null===e||void 0===e?void 0:e.type)?e.featureFormViewModel:null}},{key:"labelOptions",get:function(){return this.sketchOptions.labels},set:function(e){this.sketchOptions.labels=e}},{key:"sketchViewModel",get:function(){var e=this.activeWorkflow;return"update"===(null===e||void 0===e?void 0:e.type)?e.activeSketchViewModel:"create-features"===(null===e||void 0===e?void 0:e.type)?e.sketchViewModel:this.ownSketchViewModel}},{key:"state",get:function(){var e,t;if(null===(e=this.view)||void 0===e||!e.ready)return"disabled";var n=this.attachmentsViewModel.mode;if("add"===n)return"adding-attachment";if("edit"===n)return"editing-attachment";var r=this.activeWorkflow;return null!==r&&void 0!==r&&r.stepId?"update"===r.type&&null!==(t=r.activeWorkflow)&&void 0!==t&&t.stepId?r.activeWorkflow.stepId:r.stepId:"ready"}},{key:"syncing",get:function(){return this._activityQueue.length>0}},{key:"updating",get:function(){var e;return this._updatingHandles.updating||!0===(null===(e=this.activeWorkflow)||void 0===e?void 0:e.updating)}},{key:"tooltipOptions",get:function(){return this.sketchOptions.tooltips},set:function(e){this.sketchOptions.tooltips=e}},{key:"valueOptions",get:function(){return this.sketchOptions.values},set:function(e){this.sketchOptions.values=e}},{key:"view",set:function(e){this.ownSketchViewModel.view=e,this.spinnerViewModel.view=e,this._set("view",e)}},{key:"page",get:function(){var e=this.activeWorkflow,t=this.state;if("update"===(null===e||void 0===e?void 0:e.type)&&"awaiting-feature-to-update"===e.stepId)return"ready";if("create-features"===(null===e||void 0===e?void 0:e.type)&&0===e.numPendingFeatures){var n=e.data.upload;if(n)return"default"===n.state?"ready":"creating-features-upload-details"}return null!==t&&void 0!==t?t:"disabled"}},{key:"featureFormDisabled",get:function(){var e,t=this.activeWorkflow;return"update"===(null===t||void 0===t?void 0:t.type)&&!1===(null===(e=t.activeEditorItem)||void 0===e?void 0:e.capabilities.update.attributes)}},{key:"canGoBack",get:function(){return null!=this.activeWorkflow&&!this.syncing}},{key:"shouldShowDeleteButton",get:function(){var e,t=this.activeWorkflow;return!!t&&"update"===t.type&&!(null===(e=t.activeEditorItem)||void 0===e||!e.capabilities.delete.enabled)}},{key:"hasPendingEdits",get:function(){var e,t;return null!==(e=null===(t=this.activeWorkflow)||void 0===t?void 0:t.hasPendingEdits)&&void 0!==e&&e}},{key:"startCreateFeaturesWorkflowAtFeatureTypeSelection",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.startCreateFeaturesWorkflow());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startCreateFeaturesWorkflowAtFeatureCreation",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.startCreateFeaturesWorkflow(t,"creating-features"));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startCreateFeaturesWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,o=this,s=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"awaiting-feature-creation-info",e.next=3,(0,w.whenOnce)((function(){return!o.updating}));case 3:if(this.canCreate){e.next=5;break}throw new W.Z("editing:unsupported-workflow","Creating features is unsupported or disabled.");case 5:return r=this._createUpdatingResolver(),e.prev=6,e.next=9,this._cancelWorkflow();case 9:return a=this._createCreateFeaturesWorkflow(t,n),this._set("activeWorkflow",a),e.next=13,a.start();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(6),this._logErrorAndCancelWorkflow(e.t0);case 18:return e.prev=18,r.resolve(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[6,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"startCreateFeaturesWorkflowAtFeatureEdit",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s,u=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.whenOnce)((function(){return!u.updating}));case 2:if(n=this._createUpdatingResolver(),e.prev=3,r=t.initialFeature,a=r.sourceLayer=r.layer,null!==(o=a?this.findEditorItemForLayer(a):void 0)&&void 0!==o&&o.supportsCreateFeaturesWorkflow){e.next=7;break}throw new W.Z("editing:unsupported-workflow","Creating features is unsupported or disabled for this layer.");case 7:return e.next=9,this._cancelWorkflow();case 9:return s=this._createCreateFeaturesWorkflow({initialFeature:r,layer:o.layer,maxFeatures:1},"creating-features"),this._set("activeWorkflow",s),e.next=13,s.start();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),this._logErrorAndCancelWorkflow(e.t0);case 18:return e.prev=18,n.resolve(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[3,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"startUpdateWorkflowAtFeatureSelection",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.whenOnce)((function(){return!r.updating}));case 2:if(this.canUpdate){e.next=4;break}return e.abrupt("return",void pn("editing:unsupported-workflow","Update workflow is unsupported or disabled."));case 4:return t=this._createUpdatingResolver(),e.prev=5,e.next=8,this._cancelWorkflow();case 8:return n=this._createUpdateWorkflow(),this._set("activeWorkflow",n),e.next=12,n.start();case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),this._logErrorAndCancelWorkflow(e.t0);case 17:return e.prev=17,t.resolve(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[5,14,17,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"startUpdateWorkflowAtMultipleFeatureSelection",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.whenOnce)((function(){return!a.updating}));case 2:if(this.canUpdate){e.next=4;break}return e.abrupt("return",void pn("editing:unsupported-workflow","Update workflow is unsupported or disabled."));case 4:return n=this._createUpdatingResolver(),e.prev=5,e.next=8,this._cancelWorkflow();case 8:return(r=this._createUpdateWorkflow("awaiting-update-feature-candidate")).data.candidates=t,this._set("activeWorkflow",r),e.next=13,r.start();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),this._logErrorAndCancelWorkflow(e.t0);case 18:return e.prev=18,n.resolve(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"startUpdateWorkflowAtFeatureEdit",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,w.whenOnce)((function(){return!a.updating}));case 2:if(this.canUpdate){e.next=4;break}return e.abrupt("return",void pn("editing:unsupported-workflow","Update workflow is unsupported or disabled."));case 4:return n=this._createUpdatingResolver(),e.prev=5,e.next=8,this._cancelWorkflow();case 8:return(r=this._createUpdateWorkflow("editing-existing-feature")).data.rootFeature=t,this._set("activeWorkflow",r),e.next=13,r.start();case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),this._logErrorAndCancelWorkflow(e.t0);case 18:return e.prev=18,n.resolve(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFeatureFromWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.activeWorkflow)||"update"!==t.type){e.next=6;break}return e.next=4,t.deleteActiveFeature();case 4:e.next=7;break;case 6:pn("editing:unsupported-workflow","Deleting requires an active update workflow.");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cancelWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._cancelWorkflow((0,r.Z)({warnIfNoWorkflow:!0},t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"findEditorItemForLayer",value:function(e){return this.editorItems.find((function(t){return t.layer===e}))}},{key:"itemHasInvalidFormTemplate",value:function(e){var t;return null!=e&&!0===(null===(t=this.findEditorItemForLayer(e.layer))||void 0===t?void 0:t.hasInvalidFormTemplate)}},{key:"syncFeatureTemplates",value:function(){this._featureTemplatesViewModelLocked||(this.featureTemplatesViewModel.layers=this.featureTemplatesLayers.toArray())}},{key:"toggleUpdateWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.canUpdate,!e.t0){e.next=16;break}if(e.t1=this.hasPendingEdits,!e.t1){e.next=7;break}return e.next=6,this.showDiscardEditsPrompt();case 6:e.t1=!e.sent;case 7:if(e.t2=e.t1,e.t2){e.next=16;break}if(!this.activeWorkflow||"awaiting-feature-to-update"!==this.state){e.next=14;break}return e.next=12,this.cancelWorkflow({force:!0});case 12:e.next=16;break;case 14:return e.next=16,this.startUpdateWorkflowAtFeatureSelection();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"lockFeatureTemplatesViewModel",value:function(){var e=this;return this._featureTemplatesViewModelLocked=!0,(0,O.kB)((function(){e._featureTemplatesViewModelLocked=!1,e.syncFeatureTemplates()}))}},{key:"_getEditorItemCandidates",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(a=this.view)&&void 0!==a&&a.map){e.next=3;break}return e.abrupt("return",[]);case 3:return o=a.map,s=null!==(n=o.editableLayers.toArray())&&void 0!==n?n:[],u=null!==(r=o.allTables.toArray().filter(U.Te))&&void 0!==r?r:[],e.next=6,Promise.allSettled([].concat((0,A.Z)(s.map((function(e){return"subtype-group"===e.type?e.loadAll():Promise.resolve()}))),(0,A.Z)(u.map((function(e){return e.load()})))));case 6:return(0,y.k_)(t),e.abrupt("return",[].concat((0,A.Z)(s.reverse()),(0,A.Z)(u.reverse())).filter((function(e){return(0,L.K)(e)&&("mesh"!==e.geometryType||"3d"===a.type)})).flatMap((function(e){return"subtype-group"===e.type?e.sublayers.toArray():e})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_drainEditorItems",value:function(){this.editorItems.drain((function(e){return e.destroy()}))}},{key:"_updateEditorItems",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,h.IM)(this._updateItemsTask),t=this.view,n=(0,E.vr)(function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n){var a,o,s,u,l,c,d,p,f,v,h;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&t.map&&null!==t&&void 0!==t&&t.allLayerViews){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r._getEditorItemCandidates(n);case 4:if((a=e.sent).length){e.next=7;break}return e.abrupt("return",void r._drainEditorItems());case 7:o=[],s=[],u=[],l=r.layerInfos,c=(0,I.Z)(a),e.prev=9,c.s();case 11:if((d=c.n()).done){e.next=20;break}return p=d.value,f=fn(l,p),e.next=16,tt(t,p).catch((function(){return null}));case 16:v=e.sent,(f?o:v?s:u).push(new sn({layer:p,layerInfo:f,layerView:v}));case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),c.e(e.t0);case 25:return e.prev=25,c.f(),e.finish(25);case 28:(null===l||void 0===l?void 0:l.length)&&o.sort((function(e,t){return l.findIndex((function(t){return t.layer===e.layer}))-l.findIndex((function(e){return e.layer===t.layer}))})),h=[].concat(o,s,u),n.aborted||(r._drainEditorItems(),r.editorItems.addMany(h));case 31:case"end":return e.stop()}}),e,null,[[9,22,25,28]])})));return function(t){return e.apply(this,arguments)}}()),this._updatingHandles.addPromise(n.promise),this._updateItemsTask=n;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_afterEditorItemsChange",value:function(){var e=this.activeWorkflow;if(this.syncFeatureTemplates(),e){var t=e.stepId;"create-features"!==e.type?"update"===e.type&&("awaiting-feature-to-update"===t&&!this.canUpdateVisible||"awaiting-update-feature-candidate"===t&&!e.hasUpdatableCandidates)&&this._cancelWorkflow():"awaiting-feature-creation-info"!==t||this.canCreate||this._cancelWorkflow()}}},{key:"_cancelWorkflow",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeWorkflow){e.next=3;break}return e.abrupt("return",void((null===t||void 0===t?void 0:t.warnIfNoWorkflow)&&pn("editing:no-active-workflow","There is no active workflow to cancel.")));case 3:if(t&&!1===t.force){e.next=9;break}return this.emit("workflow-cancel"),this._set("activeWorkflow",null),e.next=8,n.cancel(t);case 8:return e.abrupt("return",void e.sent);case 9:return e.next=11,n.cancel(t);case 11:this._set("activeWorkflow",null);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCreateFeaturesWorkflow",value:function(e,t){var n=this;return mt.create({viewModel:this,creationInfo:e,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:t,applyEditsCallback:function(e,t,r){return n._applyEdits(e,t,r)},addAttachmentsCallback:function(e,t){return n._addAttachments(e,t)}})}},{key:"_createUpdateWorkflow",value:function(e){var t=this;return Qt.create({viewModel:this,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:e,applyEditsCallback:function(e,n,r){return t._applyEdits(e,n,r)},addAttachmentsCallback:function(e,n){return t._addAttachments(e,n)}})}},{key:"_addAttachments",value:function(e,t){var n,r=this,a=null!==(n=t.map((function(t){return r._addAttachment(e,t.feature,t.attachment)})))&&void 0!==n?n:[];return Promise.all(a)}},{key:"_addAttachment",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n,r){var a,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null,"addAttachment"in t&&null!=(null===(a=t.capabilities)||void 0===a?void 0:a.attachment)){e.next=3;break}throw new W.Z("editor:attachments-not-supported","Adding attachments is not supported for this layer type");case 3:return e.next=5,this._queueOperation((0,o.Z)((0,i.Z)().mark((function e(){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(o=t.addAttachment)||void 0===o?void 0:o.call(t,n,r).catch((function(e){throw(null===e||void 0===e?void 0:e.error)||e}));case 2:if(e.t1=a=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==a;case 6:if(!e.t0){e.next=10;break}e.t2=a,e.next=11;break;case 10:e.t2=null;case 11:return s=e.t2,e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))));case 5:return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_applyEdits",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t,n,a){var s,u,l,c=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null,!t.url){e.next=7;break}return e.next=4,(0,U.oP)(t.url);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=null;case 8:return u=e.t0,l=(0,r.Z)({returnServiceEditsOption:u&&(0,H.a5)(u)||RegExp("/hosted/","i").test(t.url)?void 0:"original-and-current-features"},a),e.next=12,this._queueOperation((0,o.Z)((0,i.Z)().mark((function e(){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.view){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,tt(r,t).catch((function(){return null}));case 5:return a=e.sent,e.next=8,t.applyEdits(n,l);case 8:if(s=e.sent,e.t0=a,!e.t0){e.next=13;break}return e.next=13,(0,w.whenOnce)((function(){return!a.updating}));case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))));case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_queueOperation",value:function(e){var t=this;this._activityQueue.push(e);var n=function(e,t){var n=t.indexOf(e);n>-1&&t.splice(n,1)};return e().then((function(e){if(null!=e&&"error"in e&&null!=e.error)throw e.error;if(null!=e&&"addFeatureResults"in e){var t=e.addFeatureResults,n=e.deleteFeatureResults,r=e.updateFeatureResults,a=t.find((function(e){return!!e.error}))||r.find((function(e){return!!e.error}))||n.find((function(e){return!!e.error}));if(a)throw a.error}return e})).catch((function(r){pn("editing:operation-error","An error occurred.",{error:r});var a={error:r,retry:function(){return n(a,t.failures),t._queueOperation(e)},cancel:function(){n(a,t.failures)}};t._set("failures",[].concat((0,A.Z)(t.failures),[a]))})).then((function(){n(e,t._activityQueue)}))}},{key:"_createUpdatingResolver",value:function(){var e=(0,y.hh)();return this._updatingHandles.addPromise(e.promise),e}},{key:"_logErrorAndCancelWorkflow",value:function(e){var t=e.name,n=e.message,r=e.details;pn(null!==t&&void 0!==t?t:"editing:workflow-start-failed",null!==n&&void 0!==n?n:void 0,null!==r&&void 0!==r?r:e),this._cancelWorkflow({force:!0})}},{key:"_itemIsSuspended",value:function(e){var t=this.findEditorItemForLayer(e);return null!=t&&(!t.visible||t.disabled)}}]),n}(V.Z.EventedAccessor);(0,p._)([(0,m.Cb)({readOnly:!0})],vn.prototype,"activeWorkflow",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],vn.prototype,"_activityQueue",void 0),(0,p._)([(0,m.Cb)({value:[].concat(dn)})],vn.prototype,"allowedWorkflows",null),(0,p._)([(0,m.Cb)({readOnly:!0})],vn.prototype,"canCreate",null),(0,p._)([(0,m.Cb)()],vn.prototype,"canCreateVisible",null),(0,p._)([(0,m.Cb)({readOnly:!0})],vn.prototype,"canUpdate",null),(0,p._)([(0,m.Cb)()],vn.prototype,"canUpdateVisible",null),(0,p._)([(0,m.Cb)()],vn.prototype,"featureTemplatesLayers",null),(0,p._)([(0,m.Cb)()],vn.prototype,"editableItems",null),(0,p._)([(0,m.Cb)()],vn.prototype,"editorItems",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],vn.prototype,"failures",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"hideTemplatesForInactiveLayers",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"attachmentsViewModel",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"featureFormViewModel",null),(0,p._)([(0,m.Cb)()],vn.prototype,"featureTemplatesViewModel",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"labelOptions",null),(0,p._)([(0,m.Cb)()],vn.prototype,"layerInfos",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"ownSketchViewModel",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"sketchOptions",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"sketchViewModel",null),(0,p._)([(0,m.Cb)({type:z.Z,nonNullable:!0})],vn.prototype,"snappingOptions",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"spinnerViewModel",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"state",null),(0,p._)([(0,m.Cb)({readOnly:!0})],vn.prototype,"syncing",null),(0,p._)([(0,m.Cb)()],vn.prototype,"updating",null),(0,p._)([(0,m.Cb)()],vn.prototype,"tooltipOptions",null),(0,p._)([(0,m.Cb)()],vn.prototype,"valueOptions",null),(0,p._)([(0,m.Cb)()],vn.prototype,"view",null),(0,p._)([(0,m.Cb)()],vn.prototype,"pageStack",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"showDiscardEditsPrompt",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"_candidateCommitted",void 0),(0,p._)([(0,m.Cb)()],vn.prototype,"page",null),(0,p._)([(0,m.Cb)()],vn.prototype,"featureFormDisabled",null),(0,p._)([(0,m.Cb)()],vn.prototype,"canGoBack",null),(0,p._)([(0,m.Cb)()],vn.prototype,"shouldShowDeleteButton",null),(0,p._)([(0,m.Cb)()],vn.prototype,"hasPendingEdits",null);var hn=vn=(0,p._)([(0,g.j)(cn)],vn),yn=n(61631),wn=n(48346),mn=function(e){(0,c.Z)(n,e);var t=(0,d.Z)(n);function n(e){var r;return(0,s.Z)(this,n),(r=t.call(this,e)).createFeaturesSection=!0,r.directionModePicker=!1,r.editFeaturesSection=!0,r.labelsToggle=!0,r.settingsMenu=!0,r.snappingControls=!0,r.snappingControlsElements=new wn.Z,r.tooltipsToggle=!0,r.undoRedoButtons=!1,r}return(0,u.Z)(n)}($.default);(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"createFeaturesSection",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"directionModePicker",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"editFeaturesSection",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"labelsToggle",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"settingsMenu",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"snappingControls",void 0),(0,p._)([(0,m.Cb)({type:wn.Z,nonNullable:!0})],mn.prototype,"snappingControlsElements",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"tooltipsToggle",void 0),(0,p._)([(0,m.Cb)({type:Boolean,nonNullable:!0})],mn.prototype,"undoRedoButtons",void 0);var gn=mn=(0,p._)([(0,g.j)("esri.widgets.Editor.VisibleElements")],mn),kn=n(8905),bn=n(80975),_n=n(67005),Zn="esri-editor__panel-content",xn={base:Zn,message:"".concat(Zn,"__message"),section:"".concat(Zn,"__section"),sectionGroup:"".concat(Zn,"__section__group"),scrimContainer:"".concat(Zn,"__scrim-container")},Cn=function(){return(0,kn.h)({scrim:function(){return Promise.all([n.e(92358),n.e(46895),n.e(99174)]).then(n.bind(n,99174))}})};function Mn(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return _n.u.apply(void 0,["div",{class:(0,bn.Sh)(xn.base,null!==e&&void 0!==e&&e.showScrimOverlay?xn.scrimContainer:void 0),key:null!==(t=null===e||void 0===e?void 0:e.key)&&void 0!==t?t:"panel-content"}].concat(r,[null!==e&&void 0!==e&&e.showScrimOverlay?(0,_n.u)("calcite-scrim",null):void 0]))}function Fn(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return _n.u.apply(void 0,["div",{class:xn.message,"data-testid":"panel-content-message",key:null!==(t=null===e||void 0===e?void 0:e.key)&&void 0!==t?t:"panel-content-message"}].concat(r))}function In(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return _n.u.apply(void 0,["div",{class:xn.section,key:null!==(t=null===e||void 0===e?void 0:e.key)&&void 0!==t?t:"panel-content-section"}].concat(r))}function An(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return _n.u.apply(void 0,["div",{class:xn.sectionGroup,key:null!==(t=null===e||void 0===e?void 0:e.key)&&void 0!==t?t:"panel-content-section-group"}].concat(r))}function En(e){var t=e.helpMessage;return(0,_n.u)(Mn,{key:"creating-features-panel-content"},(0,_n.u)(Fn,{key:"content-message"},t))}var Sn=n(63535);function Wn(e){var t=e.editorItems,n=e.filterText,r=e.id,a=e.messagesTemplates,i=e.onFilterTextChange,o=e.onSelectFeature,s=e.workflow,u=new Map,l=s.data.candidates,c=0;l.map((function(e){return{label:Vn(e),id:e.attributes[e.layer.objectIdField],data:e}})).filter((function(e){var r=e.label,a=e.data,i=n.toLowerCase(),o=a.layer.title,s=t.find((function(e){return e.layer===a.sourceLayer}));return s?s.supportsUpdateWorkflow&&(!i||(null===r||void 0===r?void 0:r.toLowerCase().includes(i))||(null===o||void 0===o?void 0:o.toLowerCase().includes(i))):null})).filter(q.pC).forEach((function(e){var t,n;c++;var r=e.data.layer;u.has(r)?null===(t=u.get(r))||void 0===t||t.items.push(e):u.set(r,{id:"".concat(r.id),label:null!==(n=r.title)&&void 0!==n?n:"",items:[e]})}));var d=t.toArray().map((function(e){var t=e.layer;return u.get(t)})).filter(q.pC),p=c>10||n.length>0;return(0,_n.u)(Mn,{key:"feature-list"},(0,_n.u)(In,null,(0,Sn.sr)({enableListScroll:!1,filterEnabled:p,filterText:n,id:r,items:d,messages:{filterPlaceholder:a.filterPlaceholder,noItems:a.noItems,noMatches:a.noMatches},onFilterChange:function(e){return i(e)},onItemMouseEnter:function(e){return o(e.data)},onItemMouseLeave:function(){return o(null)},onItemSelect:function(e){return o(e.data,!0)}})))}function Vn(e){var t=e.layer;if(!t)return null;var n=t.fieldsIndex.get(t.objectIdField),r=n.alias||n.name,a=e.attributes,i=(0,re.O5)(t);return i&&a[i]&&"".concat(a[i])||"".concat(r,": ").concat(a[n.name])}var On=n(44925),Pn=["disabled","onClick","label"],Tn="esri-editor__actions",Ln=function(){return(0,kn.h)({button:function(){return Promise.all([n.e(92358),n.e(46895),n.e(54438),n.e(14105),n.e(32275)]).then(n.bind(n,32275))}})};function Un(e){var t=e.buttons,n=e.key;return(0,_n.u)("div",{class:Tn,key:null!==n&&void 0!==n?n:"footer-actions",slot:"footer"},t.filter(q.pC).map((function(e,t){var n=e.disabled,a=e.onClick,i=e.label,o=(0,On.Z)(e,Pn);return(0,_n.u)("calcite-button",(0,r.Z)({disabled:null!==n&&void 0!==n&&n,key:"action-".concat(t),onclick:function(){n||a()},slot:"footer-actions",width:"full"},o),i)})))}var Hn=["message"],Dn="esri-editor__notice",Rn=function(){return(0,kn.h)({notice:function(){return Promise.all([n.e(92358),n.e(46895),n.e(15669)]).then(n.bind(n,15669))}})};function zn(e){var t=e.workflow,n=e.messages;return(0,_n.u)(_n.D,null,null!==t&&void 0!==t&&t.reliesOnOwnerAdminPrivileges?(0,_n.u)(Gn,{message:n.ownerAdminNotice}):void 0,null!==t&&void 0!==t&&t.hasInvalidFormTemplate?(0,_n.u)(Gn,{icon:yn.t,message:n.formFieldUpdateError}):void 0)}function Gn(e){var t=e.message,n=(0,On.Z)(e,Hn);return(0,_n.u)("calcite-notice",(0,r.Z)({class:Dn,open:!0,scale:"s"},n),(0,_n.u)("div",{slot:"message"},t))}var Bn=n(70381),Nn=n(29840),jn="esri-editor__settings";function qn(e){var t,n=e.editorViewModel,r=e.messagesCommon,a=e.visibleElements,i=n.snappingOptions,o=n.sketchOptions,s=n.view,u=[],l={directionModePicker:a.directionModePicker,labelsToggle:a.labelsToggle,tooltipsToggle:a.tooltipsToggle};return(0,bn.Mz)(l)&&u.push((0,_n.u)(Bn.Z,{sketchOptions:o,viewType:null===s||void 0===s?void 0:s.type,visibleElements:l})),a.snappingControls&&u.push((0,_n.u)(Nn.Z,{afterCreate:function(e){return e.layerListOpen=!1},snappingOptions:i,view:s,visibleElements:null!==(t=a.snappingControlsElements)&&void 0!==t?t:new wn.Z})),0===u.length?null:(0,_n.u)("calcite-accordion",{appearance:"transparent",class:jn,key:"settings"},(0,_n.u)("calcite-accordion-item",{"data-testid":"settings",heading:r.settings,iconStart:"gear"},u))}var Qn="esri-editor__panel-toolbar";function Kn(e){var t=e.editorViewModel,n=e.messagesCommon,r=e.visibleElements,a=t.sketchViewModel;return(0,_n.u)("div",{class:Qn,key:"panel-toolbar"},(0,_n.u)(qn,{editorViewModel:t,messagesCommon:n,visibleElements:r}),r.undoRedoButtons?[(0,_n.u)("calcite-button",{alignment:"center",appearance:"transparent",disabled:!(null!==a&&void 0!==a&&a.canUndo()),iconStart:"undo",key:"undo-button",kind:"neutral",label:n.undo,onclick:function(){return null===a||void 0===a?void 0:a.undo()},scale:"l"},n.undo),(0,_n.u)("calcite-button",{alignment:"center",appearance:"transparent",disabled:!(null!==a&&void 0!==a&&a.canRedo()),iconStart:"redo",key:"redo-button",kind:"neutral",label:n.redo,onclick:function(){return null===a||void 0===a?void 0:a.redo()},scale:"l"},n.redo)]:null)}var Jn=n(8234),Xn=n(8704),$n=n(96919);function Yn(e){var t=e.editorViewModel,n=e.headingLevel,r=e.messages,a=e.messagesCommon,i=e.onDelete,o=e.onSave,s=e.renderAttachments,u=e.renderFeatureForm,l=t.activeWorkflow,c=t.featureFormViewModel,d=t.syncing;if(!l||!c)return null;var p=l.type,f="activeWorkflow"in l?l.activeWorkflow:void 0,v=null===f||void 0===f?void 0:f.type,h=f&&!f.hasPendingEdits||"update"===p&&!l.hasPendingEdits||d||c.updating,y="update"===p&&"create-features"!==v?a.update:a.create,w="create-features"===p&&"create-new"===l.createFeatureState,m="create-features"===p?l.numPendingFeatures:0,g=m>1?(0,Xn.n)(r.createFeaturesTemplate,{numFeatures:m}):y,k=l.shouldShowAttachments&&!c.activeRelationshipInput,b=c.inputs.every((function(e){return!e.visible}))&&!k?(0,_n.u)(Fn,{key:"panel-content-message"},(0,Xn.n)(r.clickToFinishTemplate,{button:y})):(0,_n.u)(In,{key:"panel-content-section"},(0,_n.u)(zn,{messages:r,workflow:l}),(0,_n.u)(An,null,u(),k?(0,_n.u)("div",{key:"attachments"},(0,_n.u)($n.X,{level:(0,$n.M)(n)},r.attachments),s()):null));return(0,_n.u)(_n.D,null,(0,_n.u)(Mn,{key:"attribute-panel-content",showScrimOverlay:w},b),(0,_n.u)(Un,{buttons:[{onClick:o,disabled:h,label:g},t.shouldShowDeleteButton?{appearance:"outline",onClick:i,disabled:d,kind:"danger",label:a.delete}:void 0]}))}var er=n(25889),tr="esri-editor__upload-details",nr={base:tr,status:"".concat(tr,"__status"),titleWrapper:"".concat(tr,"__title-wrapper"),title:"".concat(tr,"__title"),description:"".concat(tr,"__description"),loader:"".concat(tr,"__loader"),iconSuccess:"".concat(tr,"__icon ").concat(tr,"__icon--success"),iconError:"".concat(tr,"__icon ").concat(tr,"__icon--error"),fileList:"".concat(tr,"__file-list"),file:"".concat(tr,"__file"),fileIcon:"".concat(tr,"__file-icon"),fileName:"".concat(tr,"__file-name")};function rr(e){var t=e.messages,n=e.key,r=e.upload;return(0,_n.u)(_n.D,null,(0,_n.u)(Mn,{key:null!==n&&void 0!==n?n:"upload-details"},(0,_n.u)(In,null,function(e){var t=function(e){var t=e.helpMessage,n=e.messages,r=e.upload;switch(r.state){case"pending":var a=n.modelUploads.pending;return{title:a.title,description:a.description,iconContent:(0,_n.u)("calcite-loader",{"aria-hidden":"true",class:nr.loader,label:"",scale:"s",type:"determinate",value:Math.min(Math.round(100*r.progress),1===r.progress?100:99)})};case"success":return{title:n.modelUploads.success.title,description:t||n.helpMessages3d.mesh,iconContent:(0,_n.u)("calcite-icon",{class:(0,bn.Sh)(nr.iconSuccess),icon:"check",scale:"l"})};case"error":return{title:n.modelUploads.error.title,description:ar(r.error,n),iconContent:(0,_n.u)("calcite-icon",{class:(0,bn.Sh)(nr.iconError),icon:"exclamation-mark-circle",scale:"l"})};default:return null}}(e);return t?(0,_n.u)("div",{class:nr.base,"data-testid":"upload-details",key:"upload-details-content"},(0,_n.u)("div",{class:nr.status,key:"status"},t.iconContent,(0,_n.u)("div",{class:nr.titleWrapper,key:"text"},(0,_n.u)("div",{class:nr.title,key:"title"},t.title),(0,_n.u)("div",{class:nr.description,key:"description"},t.description))),function(e){return(0,_n.u)("div",{class:nr.fileList,key:"file-list"},e.files.map((function(e){return(0,_n.u)("div",{class:nr.file,key:"file-".concat(e.name)},(0,_n.u)("calcite-icon",{class:nr.fileIcon,icon:ir(e),scale:"s"}),(0,_n.u)("span",{class:nr.fileName},function(e){var t,n;return null!==(t=null===(n=e.split("/").pop())||void 0===n?void 0:n.split("\\").pop())&&void 0!==t?t:""}(e.name)))})))}(e.upload)):null}(e))),"error"===r.state?(0,_n.u)(Un,{buttons:[{onClick:function(){return r.retry()},label:t.modelUploads.error.uploadNew,iconStart:"upload-to"}],key:"upload-details-footer-actions"}):null)}function ar(e,t){if(!e)return null;var n=t.modelUploads.error.messages;switch(e.constructor){case er.Q_:return n.noModel;case er.i1:return n.multipleModels;case er.s8:return n.conversionFailed;default:return n.default}}function ir(e){var t,n,r=null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();return null!==(n=r?lr[r]:null)&&void 0!==n?n:or}var or="file",sr="file-shape",ur="file-image",lr={glb:sr,gltf:sr,jpeg:ur,jpg:ur,png:ur,svg:ur,zip:"file-zip"},cr=n(7021),dr=n(80532),pr=n(28907),fr=function(e){(0,c.Z)(p,e);var t=(0,d.Z)(p);function p(e,n){var r;return(0,s.Z)(this,p),(r=t.call(this,e,n))._featureForm=new _.default,r._attachments=new b.default({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),r._featureTemplates=new Z.default({enableListScroll:!1,renderItemContentEnd:function(e){return e.supportsUpload?(0,_n.u)("calcite-icon",{class:F.templateItemContentEnd,icon:"upload-to",key:"upload-icon"}):null},renderItemLabel:function(e){return e.label},renderCustomGroupContent:function(e){return r._renderCustomTemplateGroupContent(e)}}),r._filterText="",r._prompt=null,r._spinner=new x.Z,r.headingLevel=4,r.messages=null,r.messagesCommon=null,r.messagesTemplates=null,r.supportingWidgetDefaults=null,r.viewModel=new hn,r.visibleElements=new gn,r._renderSelectIcon=function(){return(0,_n.u)("calcite-icon",{icon:"cursor",slot:"content-start"})},r.EditorPanel=function(e){for(var t=e.heading,n=e.key,a=(0,l.Z)(r),i=a.visibleElements,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];return _n.u.apply(void 0,["calcite-flow-item",{closable:!1,heading:t,headingLevel:r.headingLevel,key:n,loading:r._loading,onCalciteFlowItemBack:r._onBack},i.settingsMenu?(0,_n.u)(Kn,{editorViewModel:r.viewModel,messagesCommon:r.messagesCommon,visibleElements:i}):null].concat(s))},r._showDiscardEditsPrompt=function(){var e,t=(0,l.Z)(r),n=t.messages,a=t.activeWorkflow;return"create-features"===(null===a||void 0===a?void 0:a.type)&&ot(a.data.creationInfo)?r._showPromptAndWait("success"===(null===(e=a.data.upload)||void 0===e?void 0:e.state)?n.modelUploads.cancelPlacementPrompt:n.modelUploads.cancelUploadPrompt):r._showPromptAndWait({title:n.cancelEditTitle,message:n.cancelEditWarningMessage,yesLabel:n.discardEdits,noLabel:n.continueEditing})},r._showGenericCancelPrompt=function(){var e=(0,l.Z)(r),t=e.messages,n=e.messagesCommon;return r._showPromptAndWait({title:t.cancelRequestTitle,message:t.cancelRequestWarningMessage,yesLabel:n.form.yes,noLabel:n.form.no})},r._showPrompt=function(e){var t,n;null!==(t=r._prompt)&&void 0!==t&&null!==(n=t.cancel)&&void 0!==n&&n.call(t),r._prompt=e},r._clearPrompt=function(){r._prompt=null},r._onSave=function(){r.viewModel.saveWorkflow()},r._onDelete=function(){var e=(0,l.Z)(r),t=e.messages,n=e.messagesCommon;r._showPrompt({title:t.deleteWarningTitle,message:t.deleteWarningMessage,context:"danger",actions:{primary:{label:n.delete,action:function(){r.deleteFeatureFromWorkflow(),r._clearPrompt()}},secondary:{label:t.keepFeature,action:r._clearPrompt}}})},r._onToggleUpdateWorkflow=function(){return r.viewModel.toggleUpdateWorkflow()},r._onBack=function(e){return null!==e&&void 0!==e&&e.stopPropagation(),r.viewModel.back()},r._onAttachmentAdd=function(){var e,t=r.viewModel.activeWorkflow;t&&("create-features"===t.type||"update"===t.type&&"create-features"===(null===(e=t.activeWorkflow)||void 0===e?void 0:e.type)?(r._attachments.addFile(),t.back()):r._attachments.addAttachment().then((function(){return t.back()})))},r._onAttachmentUpdate=function(){var e=r.viewModel.activeWorkflow;e&&("create-features"===e.type?(r._attachments.updateFile(),e.back()):r._attachments.updateAttachment().then((function(){return e.back()})))},r._onAttachmentDelete=function(){var e=(0,l.Z)(r),t=e.messages,n=e.messagesCommon;r._showPrompt({title:t.deleteAttachmentWarningTitle,message:t.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:n.delete,action:r._onAttachmentDeleteConfirm},secondary:{label:t.keepAttachment,action:r._clearPrompt}}})},r._onAttachmentDeleteConfirm=(0,o.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r._attachments,n=r.viewModel.activeWorkflow,e.t0=n,!e.t0){e.next=13;break}if("create-features"!==n.type){e.next=7;break}t.deleteFile(),e.next=10;break;case 7:return e.next=9,t.deleteAttachment(t.viewModel.activeAttachmentInfo);case 9:r._clearPrompt();case 10:return e.next=12,n.back();case 12:r._clearPrompt();case 13:case"end":return e.stop()}}),e)}))),r._onAttachmentsError=function(e){r._showPrompt({title:r.messages.errorWarningTitle,message:e.message,context:"warning",actions:{primary:{label:r.messagesCommon.form.ok,action:r._clearPrompt}}})},r}return(0,u.Z)(p,[{key:"initialize",value:function(){var e=this;this._featureForm.showPrompt=this._showPrompt,this._featureForm.clearPrompt=this._clearPrompt,this.addHandles([(0,w.watch)((function(){return(0,$n.M)(e.headingLevel)}),(function(t){e._featureForm.headingLevel=t,e._featureTemplates.headingLevel=t}),w.initial),(0,w.on)((function(){return e.viewModel.activeWorkflow}),"cancel-request",(function(t){var n=t.controller;(e.viewModel.hasPendingEdits?e._showDiscardEditsPrompt():e._showGenericCancelPrompt()).then((function(e){return e?n.allow():n.deny()}))})),(0,w.when)((function(){return e.viewModel.featureFormViewModel}),(function(t){e._featureForm.viewModel=t}),w.initial),(0,w.watch)((function(){return e.viewModel}),(function(t){var n,r,a;e._attachments.viewModel=null!==(n=null===t||void 0===t?void 0:t.attachmentsViewModel)&&void 0!==n?n:null,e._featureTemplates.viewModel=null!==(r=null===t||void 0===t?void 0:t.featureTemplatesViewModel)&&void 0!==r?r:null,e._spinner.viewModel=null!==(a=null===t||void 0===t?void 0:t.spinnerViewModel)&&void 0!==a?a:null,t.showDiscardEditsPrompt=e._showDiscardEditsPrompt}),w.initial),(0,w.watch)((function(){return e.view}),(function(t,n){var r="editor-".concat(e.id,"-spinner");null!==n&&void 0!==n&&n.ui.remove(e._spinner,r),null===t||void 0===t||t.ui.add(e._spinner,{key:r,position:"manual"})}),w.initial),(0,w.watch)((function(){return[e.supportingWidgetDefaults,e.viewModel.sketchViewModel]}),(function(t){var n,r=(0,a.Z)(t,1)[0];r&&(e._featureForm.set(r.featureForm),e._attachments.set(r.attachments),e._featureTemplates.set(r.featureTemplates),null===(n=e.viewModel.sketchViewModel)||void 0===n||n.set(r.sketch))}),w.initial),(0,w.when)((function(){var t;return null===(t=e._attachments)||void 0===t?void 0:t.error}),(function(t){return e._onAttachmentsError(t)})),(0,w.when)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.failures}),(function(t){var n=e.messages,r=(0,a.Z)(t,1)[0],i=r.error,o=r.retry,s=r.cancel;e._showPrompt({title:n.errorWarningTitle,message:(0,Xn.n)(n.errorWarningMessageTemplate,{errorMessage:i.message}),context:"warning",actions:{primary:{label:n.retry,action:function(){o(),e._clearPrompt()}},secondary:{label:n.ignore,action:function(){s(),e._clearPrompt()}}}})})),(0,w.watch)((function(){var t;return null===(t=e.viewModel)||void 0===t?void 0:t.state}),(function(t){switch(t){case"awaiting-feature-to-update":case"ready":case"disabled":e._filterText="",e._featureTemplates.filterText=""}})),(0,w.watch)((function(){return e.viewModel.featureFormDisabled}),(function(t){return e._featureForm.disabled=t}))])}},{key:"destroy",value:function(){this._attachments.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy()}},{key:"loadDependencies",value:function(){return Promise.all([(0,kn.h)({"flow-item":function(){return Promise.all([n.e(92358),n.e(46895),n.e(89219),n.e(63839),n.e(65138),n.e(2654),n.e(23635),n.e(89524),n.e(48926)]).then(n.bind(n,48926))},flow:function(){return n.e(53049).then(n.bind(n,53049))},icon:function(){return Promise.all([n.e(92358),n.e(87474)]).then(n.bind(n,87474))},list:function(){return Promise.all([n.e(92358),n.e(46895),n.e(54438),n.e(34504),n.e(8715),n.e(38782)]).then(n.bind(n,38782))}}),Cn(),Cn(),Ln(),Rn(),Cn(),Promise.all([(0,kn.h)({button:function(){return Promise.all([n.e(92358),n.e(46895),n.e(54438),n.e(14105),n.e(32275)]).then(n.bind(n,32275))}}),(0,kn.h)({accordion:function(){return n.e(56379).then(n.bind(n,56379))},"accordion-item":function(){return Promise.all([n.e(92358),n.e(8865)]).then(n.bind(n,8865))}})]),(0,Jn.QC)(),Promise.all([Ln(),Rn(),Cn()]),Promise.all([(0,kn.h)({icon:function(){return Promise.all([n.e(92358),n.e(87474)]).then(n.bind(n,87474))},loader:function(){return Promise.all([n.e(92358),n.e(46895),n.e(92382)]).then(n.bind(n,92382))}}),Ln(),Cn()])])}},{key:"_deleteButtonCommonInfo",get:function(){return{appearance:"outline",kind:"danger"}}},{key:"_loading",get:function(){var e=this.viewModel;return e.syncing||e.updating||this._attachments.submitting}},{key:"activeWorkflow",get:function(){return this.viewModel.activeWorkflow}},{key:"allowedWorkflows",get:function(){return this.viewModel.allowedWorkflows},set:function(e){(0,f.Mr)(v.Z.getLogger(this),"allowedWorkflows",{replacement:"visibleElements",version:"4.29",warnOnce:!0}),this.viewModel.allowedWorkflows=e}},{key:"hideTemplatesForInactiveLayers",get:function(){return this.viewModel.hideTemplatesForInactiveLayers},set:function(e){this.viewModel.hideTemplatesForInactiveLayers=e}},{key:"icon",get:function(){return"pencil"},set:function(e){this._overrideIfSome("icon",e)}},{key:"label",get:function(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""},set:function(e){this._overrideIfSome("label",e)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(e){this.viewModel.labelOptions=e}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(e){this.viewModel.layerInfos=e}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(e){this.viewModel.snappingOptions=e}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(e){this.viewModel.tooltipOptions=e}},{key:"valueOptions",get:function(){return this.viewModel.valueOptions},set:function(e){this.viewModel.valueOptions=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"startCreateFeaturesWorkflowAtFeatureTypeSelection",value:function(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}},{key:"startCreateFeaturesWorkflowAtFeatureCreation",value:function(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(e)}},{key:"startCreateFeaturesWorkflowAtFeatureEdit",value:function(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureEdit(e)}},{key:"startUpdateWorkflowAtFeatureSelection",value:function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}},{key:"startUpdateWorkflowAtMultipleFeatureSelection",value:function(e){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(e)}},{key:"startUpdateWorkflowAtFeatureEdit",value:function(e){return this.viewModel.startUpdateWorkflowAtFeatureEdit(e)}},{key:"deleteFeatureFromWorkflow",value:function(){return this.viewModel.deleteFeatureFromWorkflow()}},{key:"cancelWorkflow",value:function(e){return this.viewModel.cancelWorkflow(e)}},{key:"render",value:function(){var e=this,t=this.viewModel,n=this.classes(F.base,cr.z.widget,cr.z.panel);return t?(0,_n.u)("div",{class:n,key:"base"},(0,_n.u)("calcite-flow",{key:"flow"},t.pageStack.map((function(t){return e._renderPage(t)}))),this._prompt?(0,_n.u)(Jn.NL,(0,r.Z)((0,r.Z)({},this._prompt),{},{headingLevel:this.headingLevel})):void 0):(0,_n.u)("div",{class:n,key:"empty"})}},{key:"_renderPage",value:function(e){switch(e){case"disabled":break;case"ready":return this._renderReady();case"awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo();case"creating-features-upload-details":return this._renderUploadDetails();case"creating-features":return this._renderCreatingFeatures();case"editing-existing-feature":case"editing-attributes":return this._renderUpdateFeature();case"awaiting-update-feature-candidate":return this._renderFeatureList();case"adding-attachment":return this._renderAttachmentAdding();case"editing-attachment":return this._renderAttachmentEditing()}return(0,_n.u)("div",{key:"empty-page"})}},{key:"_renderAwaitingFeatureCreationInfo",value:function(){var e=this.EditorPanel,t=this.messages;return(0,_n.u)(e,{heading:t.selectTemplate,key:"templates-panel"},(0,_n.u)(Mn,{key:"feature-templates"},(0,_n.u)(In,null,this._featureTemplates.render())))}},{key:"_renderUploadDetails",value:function(){var e=this.EditorPanel,t=this.activeWorkflow,n=this.messages;if("create-features"!==(null===t||void 0===t?void 0:t.type))return null;var r=t.data.upload;return r?(0,_n.u)(e,{heading:n.createFeatures,key:"upload-details-panel"},(0,_n.u)(rr,{helpMessage:this._helpMessage,messages:n,upload:r})):null}},{key:"_renderCreatingFeatures",value:function(){var e,t,n=this,r=this.EditorPanel,a=this.activeWorkflow,i=this.messages,o=this.messagesCommon,s=this.headingLevel,u=this.viewModel;if(!a)return null;var l="create-features"===a.type&&a.numPendingFeatures>0||"update"===a.type&&"create-features"===(null===a||void 0===a||null===(e=a.activeWorkflow)||void 0===e?void 0:e.type)&&(null===(t=a.activeWorkflow)||void 0===t?void 0:t.numPendingFeatures)>0;return(0,_n.u)(r,{heading:i.createFeatures,key:"create-features-panel"},l?(0,_n.u)(Yn,{editorViewModel:u,headingLevel:s,messages:i,messagesCommon:o,renderAttachments:function(){return n._attachments.render()},renderFeatureForm:function(){return n._featureForm.render()},onDelete:this._onDelete,onSave:this._onSave}):(0,_n.u)(En,{helpMessage:this._helpMessage}))}},{key:"_renderUpdateFeature",value:function(){var e=this,t=this.EditorPanel,n=this.messages,r=this.messagesCommon,a=this.headingLevel,i=this.viewModel;return(0,_n.u)(t,{heading:n.editFeature,key:"update-feature-panel"},(0,_n.u)(Yn,{editorViewModel:i,headingLevel:a,messages:n,messagesCommon:r,renderAttachments:function(){return e._attachments.render()},renderFeatureForm:function(){return e._featureForm.render()},onDelete:this._onDelete,onSave:this._onSave}))}},{key:"_renderCustomTemplateGroupContent",value:function(e){var t=this.messages,n=this.viewModel,r=(0,h.ei)(e.group.items,(function(e){return n.itemHasInvalidFormTemplate(e)?t.formFieldCreateError:void 0}));return r?(0,_n.u)(Gn,{icon:yn.t,message:r}):null}},{key:"_renderAttachmentAdding",value:function(){var e=this.EditorPanel,t=this._attachments,n=this.messages,r=this.messagesCommon;return(0,_n.u)(e,{heading:n.addAttachment,key:"attachment-adding-panel"},(0,_n.u)(Mn,{key:"attachments"},t.render()),(0,_n.u)(Un,{buttons:[{label:t.submitting?r.cancel:r.add,disabled:t.submitting||!t.selectedFile,onClick:this._onAttachmentAdd}]}))}},{key:"_renderAttachmentEditing",value:function(){var e=this.EditorPanel,t=this._attachments,n=this.activeWorkflow,a=this.messages,i=this.messagesCommon;return n?(0,_n.u)(e,{heading:a.editAttachment,key:"attachment-editing-panel"},(0,_n.u)(Mn,{key:"attachments"},t.render()),n.shouldAllowAttachmentEditing?(0,_n.u)(Un,{buttons:[{label:i.update,disabled:t.submitting||!t.selectedFile,onClick:this._onAttachmentUpdate},(0,r.Z)((0,r.Z)({},this._deleteButtonCommonInfo),{},{onClick:this._onAttachmentDelete,disabled:t.submitting,label:i.delete})]}):void 0):null}},{key:"_renderReady",value:function(){var e=this.EditorPanel,t=this.messages,n=this.viewModel,r=this.visibleElements,a=this._helpMessage;return(0,_n.u)(e,{heading:t.widgetLabel,key:"landing-panel"},(0,_n.u)(Mn,{key:"landing-content"},n.editorItems.length?[r.editFeaturesSection?(0,_n.u)(In,{key:"edit-actions"},this._renderUpdateActions()):null,r.createFeaturesSection&&n.canCreateVisible?(0,_n.u)(In,{key:"create-actions"},this._renderCreateActions()):null]:(0,_n.u)(Fn,{key:"no-content"},t.noEditableLayers)),a?(0,_n.u)("div",{class:F.helpMessage,key:"footer-actions",slot:"footer"},a):void 0)}},{key:"_helpMessage",get:function(){var e,t=this.activeWorkflow,n=this.messages,r=this.view,a=null===t||void 0===t?void 0:t.helpMessage;return a?null===(e=n["3d"===(null===r||void 0===r?void 0:r.type)?"helpMessages3d":"helpMessages2d"])||void 0===e?void 0:e[a]:void 0}},{key:"_renderUpdateActions",value:function(){var e,t=this.messages,n=this.messagesCommon,r=this.viewModel,a={id:"select",label:n.select};return(0,_n.u)("div",{class:F.updateActions,key:"update-actions"},(0,_n.u)($n.X,{level:(0,$n.M)(this.headingLevel)},t.editFeatures),(0,_n.u)("calcite-list",{class:F.updateActionsList,selectionAppearance:"border",selectionMode:"single"},(0,Sn.x1)({disabled:!r.canUpdateVisible,grouped:!1,item:a,selectedItem:"awaiting-feature-to-update"===(null===(e=r.activeWorkflow)||void 0===e?void 0:e.stepId)?a:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}},{key:"_renderCreateActions",value:function(){return(0,_n.u)("div",{key:"create-actions"},(0,_n.u)($n.X,{level:(0,$n.M)(this.headingLevel)},this.messages.createFeatures),(0,_n.u)("div",{class:F.featureTemplatesContainer,key:"templates"},this._featureTemplates.render()))}},{key:"_renderFeatureList",value:function(){var e=this,t=this.EditorPanel,n=this.viewModel,r=n.activeWorkflow;if("update"!==(null===r||void 0===r?void 0:r.type))return null;var a=r.data.candidates,i=(0,Xn.n)(this.messages.multipleFeaturesTemplate,{total:a.length});return(0,_n.u)(t,{heading:i,key:"feature-list"},(0,_n.u)(Wn,{editorItems:n.editorItems,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:r,onFilterTextChange:function(t){return e._filterText=t},onSelectFeature:function(e,t){return n.selectFeature(e,t)}}))}},{key:"_showPromptAndWait",value:function(e){var t=this,n=e.title,r=e.message,a=e.yesLabel,i=e.noLabel,o=(0,y.hh)(),s=this.view,u=null===s||void 0===s?void 0:s.focused;return this._showPrompt({title:n,message:r,context:"danger",actions:{primary:{label:a,action:function(){return o.resolve(!0)}},secondary:{label:i,action:function(){return o.resolve(!1)}}}}),o.promise.finally((function(){t._clearPrompt(),u&&(null===s||void 0===s||s.focus())}))}}]),p}(C.Z);(0,p._)([(0,m.Cb)()],fr.prototype,"_featureForm",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_attachments",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_featureTemplates",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_filterText",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_prompt",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_spinner",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_deleteButtonCommonInfo",null),(0,p._)([(0,m.Cb)()],fr.prototype,"_loading",null),(0,p._)([(0,m.Cb)({readOnly:!0})],fr.prototype,"activeWorkflow",null),(0,p._)([(0,m.Cb)()],fr.prototype,"allowedWorkflows",null),(0,p._)([(0,m.Cb)()],fr.prototype,"headingLevel",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"hideTemplatesForInactiveLayers",null),(0,p._)([(0,m.Cb)()],fr.prototype,"icon",null),(0,p._)([(0,m.Cb)()],fr.prototype,"label",null),(0,p._)([(0,m.Cb)()],fr.prototype,"labelOptions",null),(0,p._)([(0,m.Cb)()],fr.prototype,"layerInfos",null),(0,p._)([(0,m.Cb)(),(0,dr.H)("esri/widgets/Editor/t9n/Editor")],fr.prototype,"messages",void 0),(0,p._)([(0,m.Cb)(),(0,dr.H)("esri/t9n/common")],fr.prototype,"messagesCommon",void 0),(0,p._)([(0,m.Cb)(),(0,dr.H)("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],fr.prototype,"messagesTemplates",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"snappingOptions",null),(0,p._)([(0,m.Cb)()],fr.prototype,"tooltipOptions",null),(0,p._)([(0,m.Cb)()],fr.prototype,"supportingWidgetDefaults",void 0),(0,p._)([(0,m.Cb)({type:k.Z,nonNullable:!0})],fr.prototype,"valueOptions",null),(0,p._)([(0,m.Cb)()],fr.prototype,"view",null),(0,p._)([(0,m.Cb)(),(0,pr.s)(["sketch-create","sketch-delete","sketch-update","workflow-cancel","workflow-commit"])],fr.prototype,"viewModel",void 0),(0,p._)([(0,m.Cb)({type:gn,nonNullable:!0})],fr.prototype,"visibleElements",void 0),(0,p._)([(0,m.Cb)()],fr.prototype,"_helpMessage",null);var vr=fr=(0,p._)([(0,g.j)("esri.widgets.Editor")],fr)},45966:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(4942),a=n(15671),i=n(43144),o=n(60136),s=n(29388),u=n(27366),l=n(66978),c=n(94172),d=n(49861),p=(n(93169),n(32718),n(84936),n(69912)),f=n(33565),v=n(67354),h=(n(80975),n(67005)),y="esri-spinner",w={base:y,spinnerStart:"".concat(y,"--start"),spinnerFinish:"".concat(y,"--finish")},m=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var i;return(0,a.Z)(this,n),(i=t.call(this,e,r))._animationDelay=500,i._animationPromise=null,i.viewModel=new v.Z,i}return(0,i.Z)(n,[{key:"initialize",value:function(){var e=this;this.addHandles((0,c.watch)((function(){return e.visible}),(function(t){return e._visibleChange(t)})))}},{key:"destroy",value:function(){this._animationPromise=null}},{key:"location",get:function(){return this.viewModel.location},set:function(e){this.viewModel.location=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}},{key:"show",value:function(e){var t=this,n=null!==e&&void 0!==e?e:{},r=n.location,a=n.promise;r&&(this.viewModel.location=r),this.visible=!0;a&&a.catch((function(){})).then((function(){return t.hide()}))}},{key:"hide",value:function(){this.visible=!1}},{key:"render",value:function(){var e,t=this.visible,n=!!this.viewModel.screenLocation,a=t&&n,i=!t&&n,o=(e={},(0,r.Z)(e,w.spinnerStart,a),(0,r.Z)(e,w.spinnerFinish,i),e),s=this._getPositionStyles();return(0,h.u)("div",{class:this.classes(w.base,o),styles:s})}},{key:"_visibleChange",value:function(e){var t=this;if(e)this.viewModel.screenLocationEnabled=!0;else{var n=(0,l.e4)(this._animationDelay);this._animationPromise=n,n.catch((function(){})).then((function(){t._animationPromise===n&&(t.viewModel.screenLocationEnabled=!1,t._animationPromise=null)}))}}},{key:"_getPositionStyles",value:function(){var e=this.viewModel,t=e.screenLocation,n=e.view;if(null==n||null==t)return{};var r=n.padding;return{left:t.x-r.left+"px",top:t.y-r.top+"px"}}}]),n}(f.Z);(0,u._)([(0,d.Cb)()],m.prototype,"location",null),(0,u._)([(0,d.Cb)()],m.prototype,"view",null),(0,u._)([(0,d.Cb)({type:v.Z})],m.prototype,"viewModel",void 0),(0,u._)([(0,d.Cb)()],m.prototype,"visible",null);var g=m=(0,u._)([(0,p.j)("esri.widgets.Spinner")],m)},67354:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(43144),a=n(15671),i=n(60136),o=n(29388),s=n(27366),u=n(49861),l=(n(93169),n(32718),n(84936),n(69912)),c=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).visible=!1,r}return(0,r.Z)(n)}(n(70407).Z);(0,s._)([(0,u.Cb)()],c.prototype,"visible",void 0);var d=c=(0,s._)([(0,l.j)("esri.widgets.Spinner.SpinnerViewModel")],c)},70407:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(15671),a=n(43144),i=n(60136),o=n(29388),s=n(27366),u=n(91505),l=n(94172),c=n(49861),d=(n(93169),n(32718),n(84936),n(69912)),p=n(79803),f=function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(e){var a;return(0,r.Z)(this,n),(a=t.call(this,e)).location=null,a.screenLocationEnabled=!1,a.view=null,a.addHandles([(0,l.when)((function(){var e=a.screenLocationEnabled?a.view:null;return e?[e.size,"3d"===e.type?e.camera:e.viewpoint]:null}),(function(){return a.notifyChange("screenLocation")})),(0,l.watch)((function(){return a.screenLocation}),(function(e,t){null!=e&&null!=t&&a.emit("view-change")}))]),a}return(0,a.Z)(n,[{key:"destroy",value:function(){this.view=null}},{key:"screenLocation",get:function(){var e=this.location,t=this.view,n=this.screenLocationEnabled,r=null===t||void 0===t?void 0:t.spatialReference,a=r?(0,p.projectOrLoad)(e,r).geometry:null;return n&&a&&null!==t&&void 0!==t&&t.ready?t.toScreen(a):null}}]),n}(u.Z.EventedAccessor);(0,s._)([(0,c.Cb)()],f.prototype,"location",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"screenLocation",null),(0,s._)([(0,c.Cb)()],f.prototype,"screenLocationEnabled",void 0),(0,s._)([(0,c.Cb)()],f.prototype,"view",void 0);var v=f=(0,s._)([(0,d.j)("esri.widgets.support.AnchorElementViewModel")],f)}}]);
//# sourceMappingURL=90856.32b1468b.chunk.js.map