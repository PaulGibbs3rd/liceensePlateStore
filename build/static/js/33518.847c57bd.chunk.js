"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[33518],{66612:function(t,e,r){r.d(e,{HW:function(){return u},PQ:function(){return a},nk:function(){return s},rJ:function(){return o},z8:function(){return i}});var n=r(1413),i={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255},o={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},s={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},a={setNull:50,conditional:78},u=(0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)((0,n.Z)({},{plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65}),o),s),{majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75}),a)},43346:function(t,e,r){r.d(e,{Ue:function(){return Pn},G8:function(){return Tn}});var n=r(1413),i=r(86950),o=r(10064),s=r(84652),a=r(29439),u=r(15671),l=r(43144),c=r(60136),p=r(29388),f=r(27366),v=r(49861),d=(r(93169),r(32718),r(84936),r(69912)),h=r(92089),m=r(46784),y=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).raster=void 0,t}return(0,l.Z)(r)}(m.wq);(0,f._)([(0,v.Cb)({json:{write:!0}})],y.prototype,"raster",void 0);var g,b=y=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.BaseFunctionArguments")],y),w=g=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).raster2=void 0,t}return(0,l.Z)(r,[{key:"rasters",get:function(){return[this.raster,this.raster2]}},{key:"clone",value:function(){return new g({raster:this.raster,raster2:this.raster2,operation:this.operation})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],w.prototype,"operation",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],w.prototype,"raster2",void 0),(0,f._)([(0,v.Cb)({readOnly:!0})],w.prototype,"rasters",null);var _=w=g=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ArithmeticFunctionArguments")],w),x=r(93433),C=r(89125),Z=r(99278),A=r(53737),k=new Set(["slope","aspect","curvature","hillshade","shadedrelief","statistics"]),T=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionArguments=null,t.readingBufferSize=0,t.id=-1,t.isNoopProcess=!1,t.rawInputBandIds=[],t.rawSourceRasterInfos=null,t.isInputBandIdsSwizzled=!1,t.swizzledBandSelection=[],t.isBranch=!1,t._bindingResult=null,t}return(0,l.Z)(r,[{key:"supportsGPU",get:function(){return this._bindingResult.supportsGPU}},{key:"flatWebGLFunctionChain",get:function(){var t,e=this.getWebGLProcessorDefinition();if(!e)return null;for(var r=[e],n=e.parameters,i=n.rasters||n.raster&&[n.raster];null!==(o=i)&&void 0!==o&&o.length;){var o;r.unshift.apply(r,(0,x.Z)(i));for(var s=[],a=0;a<i.length;a++){var u=i[a].parameters,l=u.rasters||u.raster&&[u.raster];(null===l||void 0===l?void 0:l.length)&&s.push.apply(s,(0,x.Z)(l))}i=s}for(var c=r.length-1;c>=0;c--)r[c].isNoopProcess&&r.splice(c,1);for(var p=!1,f=0;f<r.length;f++){var v=r[f];v.id=r.length-f-1;var d=v.parameters.rasters;p=p||null!=d&&d.length>1}var h=r.some((function(t){var e=t.name;return k.has(e.toLowerCase())})),m=this.rawSourceRasterInfos;return{functions:r,hasBranches:p,hasFocalFunction:h,isSourceSingleBand:1===(null===m||void 0===m||null===(t=m[0])||void 0===t?void 0:t.bandCount)}}},{key:"bind",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this.id=r+1;for(var n=this._getRasterValues(),i=!0,o=0;o<n.length;o++){var s=n[o];if(null!=s&&this._isRasterFunctionValue(s)){var a=s.bind(t,e,this.id+o);if(!a.success)return this._bindingResult=a,a;i=i&&a.supportsGPU}}return!this.rasterInfo||e?(this.sourceRasterInfos=this._getSourceRasterInfos(t),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=i&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult):(this._bindingResult={success:!0,supportsGPU:!0},this.processInputBandIds(),this._bindingResult)}},{key:"process",value:function(t){var e,r=this,i=this._getRasterValues(),o=0===i.length?null!==(e=t.pixelBlocks)&&void 0!==e?e:t.primaryPixelBlocks:i.map((function(e){return r._readRasterValue(e,t)}));return this._processPixels((0,n.Z)((0,n.Z)({},t),{},{pixelBlocks:o}))}},{key:"processInputBandIds",value:function(){var t,e=this._getRasterValues().filter(this._isRasterFunctionValue);if(e.length>1){var r=e.map((function(t){return t.processInputBandIds()[0]}));this.rawInputBandIds=r,this.isInputBandIdsSwizzled=this.rawInputBandIds.some((function(t,e){return t!==e}));var n=e.filter((function(t){return"ExtractBand"===t.functionName}));return n.length&&n.forEach((function(t,e){t.isInputBandIdsSwizzled=!0,t.swizzledBandSelection=[e,e,e]})),this.rawInputBandIds}var i=e[0];if(i){if(t=i.processInputBandIds(),i.isInputBandIdsSwizzled)return this.rawInputBandIds=t,t}else{t=[];for(var o=this.sourceRasterInfos[0].bandCount,s=0;s<o;s++)t.push(s)}var a=this._getInputBandIds(t);return this.isInputBandIdsSwizzled=a.some((function(t,e){return t!==e})),this.rawInputBandIds=a,this.rawInputBandIds}},{key:"getPrimaryRasters",value:function(){var t=[],e=[];return this._getPrimaryRasters(this,t,e),{rasters:t,rasterIds:e}}},{key:"getWebGLProcessorDefinition",value:function(){var t=this,e=this._getWebGLParameters(),r=this.functionArguments,n=r.raster,i=r.rasters;return i&&Array.isArray(i)&&i.length?(e.rasters=i.map((function(e){return t._isRasterFunctionValue(e)?e.getWebGLProcessorDefinition():"number"==typeof e?{name:"Constant",parameters:{value:e},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:e},pixelType:"f32",id:-1,isNoopProcess:!1}})),e.rasters.some((function(t){return null!=t}))||(e.rasters=null)):this._isRasterFunctionValue(n)&&(e.raster=n.getWebGLProcessorDefinition()),{name:this.functionName,parameters:e,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}},{key:"getClippingGeometries",value:function(){var t=this,e=[];"Clip"===this.functionName&&e.push(this.functionArguments);var r=this.functionArguments,n=r.raster,i=r.rasters;if(i&&Array.isArray(i)&&i.length)i.forEach((function(r){if(t._isRasterFunctionValue(r)){var n=r.getClippingGeometries();e.push.apply(e,(0,x.Z)(n))}}));else if(this._isRasterFunctionValue(n)){var o=n.getClippingGeometries();e.push.apply(e,(0,x.Z)(o))}return e}},{key:"_getOutputPixelType",value:function(t){var e;return"unknown"===this.outputPixelType?t:null!==(e=this.outputPixelType)&&void 0!==e?e:t}},{key:"_getWebGLParameters",value:function(){return{}}},{key:"_getInputBandIds",value:function(t){return t}},{key:"_removeStatsHistColormapVAT",value:function(t){t.statistics=null,t.histograms=null,t.colormap=null,t.attributeTable=null}},{key:"_getRasterValues",value:function(){var t,e=this,r=this.rasterArgumentNames;return"rasters"===r[0]?null!==(t=this.functionArguments.rasters)&&void 0!==t?t:[]:r.flatMap((function(t){return e.functionArguments[t]}))}},{key:"_getSourceRasterInfos",value:function(t){var e,r=this._getRasterValues(),n=t.rasterInfos,i=t.rasterIds;if(0===r.length)return n;var o=r.map((function(t){return t&&"object"==typeof t&&"bind"in t&&t.rasterInfo?t.rasterInfo:"string"==typeof t&&i.includes(t)?n[i.indexOf(t)]:"number"!=typeof t?n[0]:void 0})),s=null!==(e=o.find((function(t){return t})))&&void 0!==e?e:n[0];return o.forEach((function(t,e){void 0===t&&(o[e]=s)})),o}},{key:"_getPrimaryRasterId",value:function(t){return null===t||void 0===t?void 0:t.rasterId}},{key:"_getPrimaryRasters",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=0;n<t.sourceRasters.length;n++){var i=t.sourceRasters[n];if("number"!=typeof i)if("bind"in i)this._getPrimaryRasters(i,e,r);else{var o=i,s=this._getPrimaryRasterId(o);if(null==s)continue;r.includes(s)||(this.mainPrimaryRasterId===s?(e.unshift(o),r.unshift(s)):(e.push(o),r.push(s)))}}}},{key:"_isRasterFunctionValue",value:function(t){return null!=t&&"object"==typeof t&&"getWebGLProcessorDefinition"in t}},{key:"_readRasterValue",value:function(t,e){var r=e.primaryPixelBlocks;if(null==t||"$$"===t){var n=r[0];return null==n?null:n.clone()}if("string"==typeof t){var i=e.primaryRasterIds.indexOf(t);return-1===i?null:r[i]}if("number"==typeof t){var o=r[0];if(null==o)return null;var s=o.width,a=o.height,u=o.pixelType,l=new Float32Array(s*a);l.fill(t);var c=this.sourceRasterInfos[0].bandCount,p=new Array(c).fill(l);return new Z.Z({width:s,height:a,pixelType:u,pixels:p})}return t.process(e)}},{key:"_patchRasterInfo",value:function(){var t=this.rasterInfo;if(null!==t&&void 0!==t&&t.keyProperties){var e=t.bandCount,r=t.keyProperties,i=t.statistics,o=t.histograms,s=r.BandProperties;s&&s.length!==e&&(t.keyProperties=(0,n.Z)((0,n.Z)({},r),{},{BandProperties:void 0})),i&&i.length!==e&&(t.statistics=i.length>e?i.slice(0,e):null),o&&o.length!==e&&(t.histograms=o.length>e?o.slice(0,e):null),r.BAND_COUNT&&Number(r.BAND_COUNT)!==e&&(t.keyProperties=(0,n.Z)((0,n.Z)({},r),{},{BAND_COUNT:"string"==typeof r.BAND_COUNT?String(e):e}))}}}]),r}(m.wq);(0,f._)([(0,v.Cb)({json:{write:!0}})],T.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],T.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}}),(0,C.p)((function(t){return null===t||void 0===t?void 0:t.toLowerCase()}))],T.prototype,"outputPixelType",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],T.prototype,"mainPrimaryRasterId",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"sourceRasters",void 0),(0,f._)([(0,v.Cb)({type:[A.Z],json:{write:!0}})],T.prototype,"sourceRasterInfos",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],T.prototype,"rasterInfo",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],T.prototype,"readingBufferSize",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],T.prototype,"id",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"isNoopProcess",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"supportsGPU",null),(0,f._)([(0,v.Cb)()],T.prototype,"rawInputBandIds",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"rawSourceRasterInfos",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"isInputBandIdsSwizzled",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"swizzledBandSelection",void 0),(0,f._)([(0,v.Cb)()],T.prototype,"isBranch",void 0),(0,f._)([(0,v.Cb)({readOnly:!0})],T.prototype,"flatWebGLFunctionChain",null),(0,f._)([(0,v.Cb)()],T.prototype,"_bindingResult",void 0);var P=T=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.BaseRasterFunction")],T),F=r(37762),N=r(66612),I=new Map([[N.nk.acos,{domain:[0,Math.PI],isInteger:!1}],[N.nk.asin,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[N.nk.atan,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[N.nk.cos,{domain:[-1,1],isInteger:!1}],[N.nk.sin,{domain:[-1,1],isInteger:!1}],[N.rJ.booleanAnd,{domain:[0,1],isInteger:!0}],[N.rJ.booleanNot,{domain:[0,1],isInteger:!0}],[N.rJ.booleanOr,{domain:[0,1],isInteger:!0}],[N.rJ.booleanXOr,{domain:[0,1],isInteger:!0}],[N.rJ.equalTo,{domain:[0,1],isInteger:!0}],[N.rJ.notEqual,{domain:[0,1],isInteger:!0}],[N.rJ.greaterThan,{domain:[0,1],isInteger:!0}],[N.rJ.greaterThanEqual,{domain:[0,1],isInteger:!0}],[N.rJ.lessThan,{domain:[0,1],isInteger:!0}],[N.rJ.lessThanEqual,{domain:[0,1],isInteger:!0}],[N.rJ.isNull,{domain:[0,1],isInteger:!0}]]);function R(t){return I.get(t)}var j=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];function B(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.map((function(t){return t.mask})),n=r.filter((function(t){return null!=t})),i=t[0].pixels[0].length;if(0===n.length||e&&n.length!==r.length)return new Uint8Array(i).fill(255);var o=n[0],s=new Uint8Array(o);if(1===n.length)return s;if(!e){for(var a=1;a<n.length;a++)for(var u=n[a],l=0;l<s.length;l++)s[l]&&(s[l]=u[l]?255:0);return s}for(var c=1;c<n.length;c++)for(var p=n[c],f=0;f<s.length;f++)0===s[f]&&(s[f]=p[f]?255:0);return s}function S(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]+o[l]);return u}function M(t,e,r){var n=(0,a.Z)(t,1)[0],i=n.length,o=Z.Z.createEmptyBand("f32",i);return o.set(n),o}function D(t,e,r){for(var n=(0,a.Z)(t,1)[0],i=n.length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(o[s]=n[s]*n[s]);return o}function O(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]-o[l]);return u}function z(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]*o[l]);return u}function G(t,e,r){for(var n=(0,a.Z)(t,1)[0],i=n.length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(o[s]=Math.sign(n[s])*Math.floor(Math.abs(n[s])));return o}function V(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]/o[l]);return u}function E(t,e,r){return V(t,e,"f32")}function L(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=Math.floor(i[l]/o[l]));return u}function U(t,e,r,n){var i=t[0],o=i.length,s=Z.Z.createEmptyBand(r,o);if(n===N.nk.atanh){for(var a=0;a<o;a++)if(e[a]){var u=i[a];Math.abs(u)>=1?e[a]=0:s[a]=Math.atanh(u)}return s}for(var l=n===N.nk.asin?Math.asin:Math.acos,c=0;c<o;c++)if(e[c]){var p=i[c];Math.abs(p)>1?e[c]=0:s[c]=l(p)}return s}function W(t,e,r,n){for(var i=(0,a.Z)(t,1)[0],o=i.length,s=Z.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(s[u]=n(i[u]));return s}function J(t,e,r,n){for(var i=(0,a.Z)(t,2),o=i[0],s=i[1],u=o.length,l=Z.Z.createEmptyBand(r,u),c=0;c<u;c++)e&&!e[c]||(l[c]=n(o[c],s[c]));return l}function H(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]&o[l]);return u}function q(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]<<o[l]);return u}function X(t,e,r){for(var n=(0,a.Z)(t,1)[0],i=n.length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(o[s]=~n[s]);return o}function $(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]|o[l]);return u}function K(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]>>o[l]);return u}function Y(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]^o[l]);return u}function Q(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]&&o[l]?1:0);return u}function tt(t,e,r){for(var n=(0,a.Z)(t,1)[0],i=n.length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(o[s]=n[s]?0:1);return o}function et(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]||o[l]?1:0);return u}function rt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=(i[l]?1:0)^(o[l]?1:0));return u}function nt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]===o[l]?1:0);return u}function it(t,e,r,n){for(var i=(0,a.Z)(t,1)[0],o=i.length,s=Z.Z.createEmptyBand(r,o),u=n===Math.E,l=0;l<o;l++)e&&!e[l]||(s[l]=u?Math.exp(i[l]):Math.pow(n,i[l]));return s}function ot(t,e,r){return it(t,e,r,10)}function st(t,e,r){return it(t,e,r,2)}function at(t,e,r){return it(t,e,r,Math.E)}function ut(t,e,r,n){for(var i=(0,a.Z)(t,1)[0],o=i.length,s=Z.Z.createEmptyBand(r,o),u=0;u<o;u++)e&&!e[u]||(i[u]<=0?e[u]=0:s[u]=n(i[u]));return s}function lt(t,e,r){return ut(t,e,r,Math.log10)}function ct(t,e,r){return ut(t,e,r,Math.log2)}function pt(t,e,r){return ut(t,e,r,Math.log)}function ft(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]>o[l]?1:0);return u}function vt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]>=o[l]?1:0);return u}function dt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]<o[l]?1:0);return u}function ht(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]<=o[l]?1:0);return u}function mt(t,e,r){var n=(0,a.Z)(t,1)[0].length,i=Z.Z.createEmptyBand(r,n);if(!e)return i;for(var o=0;o<n;o++)i[o]=e[o]?0:1;return i}function yt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]%o[l]);return u}function gt(t,e,r){for(var n=(0,a.Z)(t,1)[0],i=n.length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)e&&!e[s]||(o[s]=-n[s]);return o}function bt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e&&!e[l]||(u[l]=i[l]===o[l]?0:1);return u}function wt(t,e,r){for(var n=(0,a.Z)(t,2),i=n[0],o=n[1],s=i.length,u=Z.Z.createEmptyBand(r,s),l=new Uint8Array(s),c=0;c<s;c++)null!=e&&!e[c]||0!==i[c]||(u[c]=o[c],l[c]=255);return{band:u,mask:l}}function _t(t,e,r){for(var n=(0,a.Z)(t,3),i=n[0],o=n[1],s=n[2],u=i.length,l=Z.Z.createEmptyBand(r,u),c=0;c<u;c++)e&&!e[c]||(l[c]=i[c]?o[c]:s[c]);return l}function xt(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0],o=i.length,s=Z.Z.createEmptyBand(r,o),u=0;u<o;u++)if(!e||e[u]){for(var l=i[u],c=1;c<n;c++){var p=t[c][u];l<p&&(l=p)}s[u]=l}return s}function Ct(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0],o=i.length,s=Z.Z.createEmptyBand(r,o),u=0;u<o;u++)if(!e||e[u]){for(var l=i[u],c=1;c<n;c++){var p=t[c][u];l>p&&(l=p)}s[u]=l}return s}function Zt(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0],o=i.length,s=Z.Z.createEmptyBand(r,o),u=0;u<o;u++)if(!e||e[u]){for(var l=i[u],c=l,p=1;p<n;p++){var f=t[p][u];c<f?c=f:l>f&&(l=f)}s[u]=c-l}return s}function At(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0].length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)if(!e||e[s]){for(var u=0,l=0;l<n;l++)u+=t[l][s];o[s]=u/n}return o}function kt(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0].length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)if(!e||e[s])for(var u=0;u<n;u++){var l=t[u];o[s]+=l[s]}return o}function Tt(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0].length,o=Z.Z.createEmptyBand(r,i),s=0;s<i;s++)if(!e||e[s]){for(var u=new Float32Array(n),l=0,c=0;c<n;c++){var p=t[c];l+=p[s],u[c]=p[s]}l/=n;for(var f=0,v=0;v<n;v++)f+=Math.pow(u[v]-l,2);o[s]=Math.sqrt(f/n)}return o}function Pt(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=Math.floor(n/2),o=(0,a.Z)(t,1)[0].length,s=Z.Z.createEmptyBand(r,o),u=new Float32Array(n),l=n%2==1,c=0;c<o;c++)if(!e||e[c]){for(var p=0;p<n;p++)u[p]=t[p][c];u.sort(),s[c]=l?u[i]:(u[i]+u[i-1])/2}return s}function Ft(t,e,r){var n=(0,a.Z)(t,2),i=n[0],o=n[1];if(null==o)return i;for(var s=i.length,u=Z.Z.createEmptyBand(r,s),l=0;l<s;l++)e[l]&&(i[l]===o[l]?u[l]=i[l]:e[l]=0);return u}function Nt(t,e,r){var n=t.length;if(n<=2)return Ft(t,e,r);for(var i=t[0].length,o=Z.Z.createEmptyBand(r,i),s=new Map,a=0;a<i;a++)if(!e||e[a]){var u=void 0;s.clear();for(var l=0;l<n;l++)u=t[l][a],s.set(u,s.has(u)?s.get(u)+1:1);var c,p=0,f=0,v=(0,F.Z)(s.keys());try{for(v.s();!(c=v.n()).done;){var d=c.value;(p=s.get(d))>f&&(f=p,u=d)}}catch(h){v.e(h)}finally{v.f()}o[a]=u}return o}function It(t,e,r){var n=t.length;if(n<=2)return Ft(t,e,r);for(var i=t[0].length,o=Z.Z.createEmptyBand(r,i),s=new Map,a=0;a<i;a++)if(!e||e[a]){var u=void 0;s.clear();for(var l=0;l<n;l++)u=t[l][a],s.set(u,s.has(u)?s.get(u)+1:1);var c,p=0,f=t.length,v=(0,F.Z)(s.keys());try{for(v.s();!(c=v.n()).done;){var d=c.value;(p=s.get(d))<f&&(f=p,u=d)}}catch(h){v.e(h)}finally{v.f()}o[a]=u}return o}function Rt(t,e,r){var n=t.length;if(n<2)return t[0];for(var i=(0,a.Z)(t,1)[0].length,o=Z.Z.createEmptyBand(r,i),s=new Set,u=0;u<i;u++)if(!e||e[u]){var l=void 0;s.clear();for(var c=0;c<n;c++)l=t[c][u],s.add(l);o[u]=s.size}return o}var jt=new Map,Bt=new Map,St=new Map,Mt=new Map;function Dt(){jt.size||(jt.set(4,Math.sqrt),jt.set(6,Math.acos),jt.set(7,Math.asin),jt.set(8,Math.atan),jt.set(9,Math.atanh),jt.set(10,Math.abs),jt.set(21,Math.cos),jt.set(22,Math.cosh),jt.set(48,Math.floor),jt.set(49,Math.ceil),jt.set(51,Math.sin),jt.set(52,Math.sinh),jt.set(56,Math.tan),jt.set(57,Math.tanh),jt.set(59,Math.acosh),jt.set(60,Math.asinh),jt.set(65,Math.floor),Bt.set(5,Math.pow),Bt.set(61,Math.atan2),St.set(1,S),St.set(2,O),St.set(3,z),St.set(11,H),St.set(12,q),St.set(13,X),St.set(14,$),St.set(15,K),St.set(16,Y),St.set(17,Q),St.set(18,tt),St.set(19,et),St.set(20,rt),St.set(23,V),St.set(24,nt),St.set(25,at),St.set(26,ot),St.set(27,st),St.set(28,ft),St.set(29,vt),St.set(30,G),St.set(31,mt),St.set(32,M),St.set(33,dt),St.set(34,ht),St.set(35,pt),St.set(36,lt),St.set(37,ct),St.set(44,yt),St.set(45,gt),St.set(46,bt),St.set(53,D),St.set(64,E),St.set(65,L),St.set(76,_t),St.set(78,_t),Mt.set(38,Nt),Mt.set(39,xt),Mt.set(40,At),Mt.set(41,Pt),Mt.set(42,Ct),Mt.set(43,It),Mt.set(47,Zt),Mt.set(54,Tt),Mt.set(55,kt),Mt.set(58,Rt),Mt.set(66,Nt),Mt.set(67,xt),Mt.set(68,At),Mt.set(69,Pt),Mt.set(70,Ct),Mt.set(71,It),Mt.set(72,Zt),Mt.set(73,Tt),Mt.set(74,kt),Mt.set(75,Rt))}function Ot(t,e,r,n){var i=(0,h.rL)(r),o=(0,a.Z)(i,2),s=o[0],u=o[1],l=(0,h.DV)(r);l&&(s-=1e-5,u+=1e-5);for(var c=0;c<e.length;c++)if(e[c]){var p=t[c];isNaN(p)||p<s||p>u?e[c]=0:n[c]=l?Math.round(p):p}}function zt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Dt();for(var n=B(t,e>=66&&e<=75),i=r.outputPixelType,o=void 0===i?"f32":i,s=!Mt.has(e)||r.processAsMultiband,a=s?t[0].pixels.length:1,u=[],l=function(r){var i=Mt.has(e)&&!s?t.flatMap((function(t){return t.pixels})):t.map((function(t){return t.pixels[r]})),a=void 0,l=!0;if(e===N.PQ.setNull){var c=wt(i,n,o);a=c.band,n=c.mask,l=!1}else St.has(e)?a=St.get(e)(i,n,"f64"):jt.has(e)?a=e===N.nk.asin||e===N.nk.acos||e===N.nk.atanh?U(i,n,"f64",e):W(i,n,"f64",jt.get(e)):Bt.has(e)?a=J(i,n,"f64",Bt.get(e)):Mt.has(e)?a=Mt.get(e)(i,n,"f64"):(a=i[0],l=!1);if(l&&e!==N.rJ.isNull&&!I.has(e)){var p=Z.Z.createEmptyBand(o,a.length);n||(n=new Uint8Array(a.length).fill(255)),Ot(a,n,o,p),a=p}u.push(a)},c=0;c<a;c++)l(c);var p=t[0];return new Z.Z({width:p.width,height:p.height,pixelType:o,mask:e===N.rJ.isNull?null:n,pixels:u})}var Gt=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Arithmetic",t.functionArguments=null,t.rasterArgumentNames=["raster","raster2"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments.operation;if(t<1||t>6)return{success:!1,supportsGPU:!1,error:"unsupported operation"};var e=this.sourceRasterInfos[0].clone();return this.outputPixelType=this._getOutputPixelType(e.pixelType),e.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(e),this.rasterInfo=e,{success:!0,supportsGPU:e.bandCount<=3}}},{key:"_processPixels",value:function(t){var e=t.pixelBlocks;return null==(null===e||void 0===e?void 0:e[0])||null==(null===e||void 0===e?void 0:e[1])?null:function(t,e,r){var n;return zt(t,e=null!==(n=[null,1,2,3,23,5,44][e])&&void 0!==n?n:1,{outputPixelType:r})}(e,this.functionArguments.operation,this.outputPixelType)}},{key:"_getWebGLParameters",value:function(){var t,e=["","plus","minus","times","divide","power","mod"][this.functionArguments.operation],r=null!==(t=this.outputPixelType)&&void 0!==t?t:"f32",n=(0,h.rL)(r),i=(0,a.Z)(n,2),o=i[0],s=i[1],u=(0,h.DV)(r);return u&&(o-=1e-4,s+=1e-4),{imageCount:2,operationName:e,domainRange:[o,s],isOutputRounded:u}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Gt.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:_,json:{write:!0,name:"rasterFunctionArguments"}})],Gt.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Gt.prototype,"rasterArgumentNames",void 0);var Vt,Et=Gt=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ArithmeticFunction")],Gt),Lt=Vt=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){return(0,u.Z)(this,r),e.apply(this,arguments)}return(0,l.Z)(r,[{key:"clone",value:function(){return new Vt({raster:this.raster})}}]),r}(b),Ut=Lt=Vt=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],Lt),Wt=r(86807),Jt=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Aspect",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,this.outputPixelType=this._getOutputPixelType("f32");var n=r.clone();return n.pixelType=this.outputPixelType,n.statistics=[{min:-1,max:360,avg:180,stddev:30}],n.histograms=null,n.colormap=null,n.attributeTable=null,n.bandCount=1,this.rasterInfo=n,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=t.extent,i=t.primaryPixelSizes,o=null===i||void 0===i?void 0:i[0],s=null!==o&&void 0!==o?o:n?{x:n.width/r.width,y:n.height/r.height}:{x:1,y:1};return(0,Wt.M_)(r,{resolution:s})}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Jt.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Ut,json:{write:!0,name:"rasterFunctionArguments"}})],Jt.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Jt.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Jt.prototype,"isGCS",void 0);var Ht=Jt=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.AspectFunction")],Jt),qt=r(27135),Xt=r(43404),$t=new Set(["+","-","*","/","(",")"]);function Kt(t,e){return t.toLowerCase().startsWith("b")?e[parseInt(t.slice(1),10)-1]:parseFloat(t)}function Yt(t,e,r,n){if("number"==typeof r&&"number"==typeof n)return r+n;var i,o,s;"number"==typeof r?(i=(s=n).length,(o=new Float32Array(i)).fill(r)):(i=r.length,o=r,n.constructor===Number?(s=new Float32Array(i)).fill(n):s=n);var a=new Float32Array(i);switch(e){case"+":for(var u=0;u<i;u++)(null==t||t[u])&&(a[u]=o[u]+s[u]);break;case"-":for(var l=0;l<i;l++)(null==t||t[l])&&(a[l]=o[l]-s[l]);break;case"*":for(var c=0;c<i;c++)(null==t||t[c])&&(a[c]=o[c]*s[c]);break;case"/":for(var p=0;p<i;p++)(null==t||t[p])&&s[p]&&(a[p]=o[p]/s[p]);break;case"(":case")":throw new Error("encountered error with custom band index equation")}return a}function Qt(t,e){t.splice(e,1);var r=0,n=0;do{r=0,n=0;for(var i=0;i<t.length;i++)if("("===t[i])r=i;else if(")"===t[i]){n=i;break}n===r+1&&t.splice(r,2)}while(n===r+1);return t}function te(t){if(1===t.length)return{opIndex:0,numIndex:0};for(var e=0,r=0,n=0;n<t.length;n++)if("("===t[n])e=n;else if(")"===t[n]){r=n;break}for(var i=0===r?t:t.slice(e+1,r),o=-1,s=0;s<i.length;s++)if("*"===i[s]||"/"===i[s]){o=s;break}if(o>-1)r>0&&(o+=e+1);else{for(var a=0;a<i.length;a++)if("+"===i[a]||"-"===i[a]){o=a;break}r>0&&(o+=e+1)}for(var u=0,l=0;l<o;l++)"("===t[l]&&u++;return{opIndex:o,numIndex:o-u}}function ee(t,e,r){var n,i=function(t,e){(t=t.replaceAll(" ","")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));for(var r=t.split(""),n=[],i=[],o="",s=0;s<r.length;s++){var a=r[s];$t.has(a)?(o.length&&i.push(Kt(o,e)),n.push(a),o=""):o=o.concat(a)}return o.length&&i.push(Kt(o,e)),{ops:n,nums:i}}(r,e),o=i.ops,s=i.nums;if(0===o.length){var a=1===s.length?s[0]:e[0];if(a instanceof Float32Array)return[a];var u=new Float32Array(e[0].length);return"number"==typeof a?u.fill(a):u.set(a),[u]}for(;o.length>0;){var l=te(o),c=l.numIndex,p=l.opIndex;if(n=Yt(t,o[p],s[c],s[c+1]),1===o.length)break;o=Qt(o,p),s.splice(c,2,n)}return[n]}var re,ne=r(17314),ie=new Xt.X({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function oe(t,e){if(!(0,ne.nk)(t))return t;var r,n=e.equation,i=e.method,o=e.bandIndexes.map((function(t){return t-1})),s=t.pixels,u=t.mask;switch(i){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":r=ae(u,s[o[0]],s[o[1]]);break;case"ndwi":r=ae(u,s[o[1]],s[o[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),o=0;o<n;o++)if(null==t||t[o]){var s=e[o],a=r[o];a&&(i[o]=s/a)}return[i]}(u,s[o[0]],s[o[1]]);break;case"ci-g":case"ci-re":r=function(t,e,r){for(var n=e.length,i=new Float32Array(n),o=0;o<n;o++)if(null==t||t[o]){var s=e[o],a=r[o];a&&(i[o]=s/a-1)}return[i]}(u,s[o[0]],s[o[1]]);break;case"savi":r=function(t,e,r,n){for(var i=r.length,o=new Float32Array(i),s=0;s<i;s++)if(null==t||t[s]){var a=r[s],u=e[s],l=u+a+n;l&&(o[s]=(u-a)/l*(1+n))}return[o]}(u,s[o[0]],s[o[1]],o[2]+1);break;case"tsavi":r=function(t,e,r,n,i,o){for(var s=r.length,a=new Float32Array(s),u=-i*n+o*(1+n*n),l=0;l<s;l++)if(null==t||t[l]){var c=r[l],p=e[l],f=i*p+c+u;f&&(a[l]=n*(p-n*c-i)/f)}return[a]}(u,s[o[0]],s[o[1]],o[2]+1,o[3]+1,o[4]+1);break;case"msavi":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),o=0;o<n;o++)if(null==t||t[o]){var s=r[o],a=e[o],u=2*a+1;i[o]=.5*(u-Math.sqrt(u*u-8*(a-s)))}return[i]}(u,s[o[0]],s[o[1]]);break;case"gemi":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),o=0;o<n;o++)if(null==t||t[o]){var s=r[o],a=e[o];if(1!==s&&a+s+.5!==0){var u=(2*(a*a-s*s)+1.5*a+.5*s)/(a+s+.5);i[o]=u*(1-.25*u)-(s-.125)/(1-s)}}return[i]}(u,s[o[0]],s[o[1]]);break;case"pvi":r=function(t,e,r,n,i){for(var o=r.length,s=new Float32Array(o),a=1/Math.sqrt(1+n*n),u=0;u<o;u++)if(null==t||t[u]){var l=r[u],c=e[u];s[u]=(c-n*l-i)*a}return[s]}(u,s[o[0]],s[o[1]],o[2]+1,o[3]+1);break;case"gvitm":r=function(t,e){for(var r=(0,a.Z)(e,6),n=r[0],i=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=n.length,p=new Float32Array(c),f=0;f<c;f++)(null==t||t[f])&&(p[f]=-.2848*n[f]-.2435*i[f]-.5436*o[f]+.7243*s[f]+.084*u[f]-.18*l[f]);return[p]}(u,[s[o[0]],s[o[1]],s[o[2]],s[o[3]],s[o[4]],s[o[5]]]);break;case"sultan":r=function(t,e){for(var r=(0,a.Z)(e,5),n=r[0],i=r[1],o=r[2],s=r[3],u=r[4],l=n.length,c=new Float32Array(l),p=new Float32Array(l),f=new Float32Array(l),v=0;v<l;v++)(null==t||t[v])&&(c[v]=u[v]?s[v]/u[v]*100:0,p[v]=n[v]?s[v]/n[v]*100:0,f[v]=o[v]?i[v]/o[v]*(s[v]/o[v])*100:0);return[c,p,f]}(u,[s[o[0]],s[o[1]],s[o[2]],s[o[3]],s[o[4]]]);break;case"vari":r=function(t,e){for(var r=(0,a.Z)(e,3),n=r[0],i=r[1],o=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==t||t[l])for(l=0;l<s;l++){var c=n[l],p=i[l],f=p+c-o[l];f&&(u[l]=(p-c)/f)}return[u]}(u,[s[o[0]],s[o[1]],s[o[2]]]);break;case"mtvi2":r=function(t,e){for(var r=(0,a.Z)(e,3),n=r[0],i=r[1],o=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==t||t[l])for(l=0;l<s;l++){var c=n[l],p=i[l],f=o[l],v=Math.sqrt(Math.pow(2*c+1,2)-(6*c-5*Math.sqrt(p))-.5);if(v){var d=1.5*(1.2*(c-f)-2.5*(p-f));u[l]=d/v}}return[u]}(u,[s[o[0]],s[o[1]],s[o[2]]]);break;case"rtvi-core":r=function(t,e){for(var r=(0,a.Z)(e,3),n=r[0],i=r[1],o=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==t||t[l])for(l=0;l<s;l++){var c=n[l],p=i[l],f=o[l];u[l]=100*(c-p)-10*(c-f)}return[u]}(u,[s[o[0]],s[o[1]],s[o[2]]]);break;case"evi":r=function(t,e){for(var r=(0,a.Z)(e,3),n=r[0],i=r[1],o=r[2],s=n.length,u=new Float32Array(s),l=0;l<s;l++)if(null==t||t[l])for(l=0;l<s;l++){var c=n[l],p=i[l],f=c+6*p-7.5*o[l]+1;f&&(u[l]=2.5*(c-p)/f)}return[u]}(u,[s[o[0]],s[o[1]],s[o[2]]]);break;case"wndwi":r=function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=(0,a.Z)(e,3),i=n[0],o=n[1],s=n[2],u=o.length,l=new Float32Array(u),c=0;c<u;c++)if(null==t||t[c])for(c=0;c<u;c++){var p=i[c],f=o[c],v=s[c],d=p+r*f+(1-r)*v;d&&(l[c]=(p-r*f-(1-r)*v)/d)}return[l]}(u,[s[o[0]],s[o[1]],s[o[2]]],o[3]?o[3]+1:.5);break;case"bai":r=function(t,e,r){for(var n=r.length,i=new Float32Array(n),o=0;o<n;o++)if(null==t||t[o])for(o=0;o<n;o++){var s=Math.pow(.1-e[o],2)+Math.pow(.06-r[o],2);s&&(i[o]=1/s)}return[i]}(u,s[o[0]],s[o[1]]);break;case"custom":r=ee(u,s,n);break;default:return t}var l=null!=u?new Uint8Array(u.length):null;null!=u&&null!=l&&l.set(u);var c=new Z.Z({width:t.width,height:t.height,pixelType:"f32",pixels:r,mask:l});return c.updateStatistics(),c}function se(t){var e=new Float32Array(9);return e[3*t[0]]=1,e[3*t[1]+1]=1,e[3*t[2]+2]=1,e}function ae(t,e,r){for(var n=r.length,i=new Float32Array(n),o=0;o<n;o++)if(null==t||t[o]){var s=e[o],a=r[o],u=s+a;u&&(i[o]=(s-a)/u)}return[i]}var ue=re=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).method="custom",t}return(0,l.Z)(r,[{key:"clone",value:function(){return new re({method:this.method,bandIndexes:this.bandIndexes,raster:(0,s.d9)(this.raster)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{type:String,write:!0}})],ue.prototype,"bandIndexes",void 0),(0,f._)([(0,qt.J)(ie)],ue.prototype,"method",void 0);var le=ue=re=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],ue),ce=new Set(["vari","mtvi2","rtvi-core","evi"]),pe=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="BandArithmetic",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){this.outputPixelType=this._getOutputPixelType("f32");var t=this.sourceRasterInfos[0];if(t.bandCount<2)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};var e=t.clone();return e.pixelType=this.outputPixelType,e.bandCount="sultan"===this.functionArguments.method?3:1,this._removeStatsHistColormapVAT(e),e.keyProperties=(0,n.Z)((0,n.Z)({},e.keyProperties),{},{BandProperties:void 0}),this.rasterInfo=e,{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return r;var n=this.functionArguments,i=n.method,o=n.bandIndexes,s=o.split(" ").map((function(t){return parseFloat(t)}));return oe(r,{method:i,bandIndexes:s,equation:o})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments.bandIndexes.split(" ").map((function(t){return parseFloat(t)-1}));2===t.length&&t.push(0);var e,r,n=this.isInputBandIdsSwizzled?[0,1,2]:t,i=new Float32Array(3);switch(this.functionArguments.method){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":e=se([n[0],n[1],0]),r="ndxi";break;case"ndwi":e=se([n[1],n[0],0]),r="ndxi";break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":e=se([n[0],n[1],0]),r="sr";break;case"ci-g":case"ci-re":e=se([n[0],n[1],0]),r="ci";break;case"savi":e=se([n[0],n[1],0]),r="savi",i[0]=t[2]+1;break;case"tsavi":e=se([n[0],n[1],0]),r="tsavi",i[0]=t[2]+1,i[1]=t[3]+1,i[2]=t[4]+1;break;case"msavi":e=se([n[0],n[1],0]),r="msavi";break;case"gemi":e=se([n[0],n[1],0]),r="gemi";break;case"pvi":e=se([n[0],n[1],0]),r="tsavi",i[0]=t[2]+1,i[1]=t[3]+1;break;case"vari":e=se([n[0],n[1],n[2]]),r="vari";break;case"mtvi2":e=se([n[0],n[1],n[2]]),r="mtvi";break;case"rtvi-core":e=se([n[0],n[1],n[2]]),r="rtvicore";break;case"evi":e=se([n[0],n[1],n[2]]),r="evi";break;case"wndwi":e=se([n[0],n[1],0]),r="wndwi",i[0]=t[3]?t[3]+1:.5;break;case"bai":e=se([n[1],n[0],0]),r="bai";break;default:e=se([0,1,2]),r="custom"}return{bandIndexMat3:e,indexType:r,adjustments:i}}},{key:"_getInputBandIds",value:function(t){if("custom"===this.functionArguments.method)return t;var e=this.functionArguments.bandIndexes.split(" ").map((function(t){return parseFloat(t)-1})),r=t.length,n=e.map((function(t){return t>=r?r-1:t})),i=ce.has(this.functionArguments.method)?3:2,o=n.slice(0,i).map((function(e){return t[e]}));return 2===o.length&&o.push(0),o}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],pe.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:le,json:{write:!0,name:"rasterFunctionArguments"}})],pe.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],pe.prototype,"rasterArgumentNames",void 0);var fe,ve=pe=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],pe),de=r(59486),he=r(77981),me=new Xt.X({1:"outside",2:"inside"},{useNumericKeys:!0}),ye=fe=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).clippingType="outside",t}return(0,l.Z)(r,[{key:"clone",value:function(){return new fe({clippingGeometry:this.clippingGeometry.clone(),clippingType:this.clippingType})}}]),r}(b);(0,f._)([(0,v.Cb)({types:de.qM,json:{read:he.im,write:!0}})],ye.prototype,"clippingGeometry",void 0),(0,f._)([(0,v.Cb)({json:{read:me.read,write:me.write}})],ye.prototype,"clippingType",void 0);var ge=ye=fe=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ClipFunctionArguments")],ye),be=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Clip",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone();return this.outputPixelType=this._getOutputPixelType(t.pixelType),t.pixelType=this.outputPixelType,this.rasterInfo=t,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.clippingGeometry,r=t.clippingType;return{clippingGeometry:e.toJSON(),clippingType:r}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],be.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:ge,json:{write:!0,name:"rasterFunctionArguments"}})],be.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],be.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)()],be.prototype,"isNoopProcess",void 0);var we,_e=be=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ClipFunction")],be),xe=r(38511),Ce=r(22850),Ze=r(57634),Ae=we=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){return(0,u.Z)(this,r),e.apply(this,arguments)}return(0,l.Z)(r,[{key:"castColormapName",value:function(t){if(!t)return null;var e=t.toLowerCase();return Ce.Oi.includes(e)?e:null}},{key:"readColorRamp",value:function(t){return(0,Ze.i)(t)}},{key:"readColorRampName",value:function(t,e){if(!t)return null;var r=Ce.H0.jsonValues.find((function(e){return e.toLowerCase()===t.toLowerCase()}));return r?Ce.H0.fromJSON(r):null}},{key:"clone",value:function(){var t;return new we({colormap:(0,s.d9)(this.colormap),colormapName:this.colormapName,colorRamp:null===(t=this.colorRamp)||void 0===t?void 0:t.clone(),colorRampName:this.colorRampName})}}]),r}(b);(0,f._)([(0,v.Cb)({type:[[Number]],json:{write:!0}})],Ae.prototype,"colormap",void 0),(0,f._)([(0,v.Cb)({type:String,json:{write:!0}})],Ae.prototype,"colormapName",void 0),(0,f._)([(0,C.p)("colormapName")],Ae.prototype,"castColormapName",null),(0,f._)([(0,v.Cb)({types:Ze.V,json:{write:!0}})],Ae.prototype,"colorRamp",void 0),(0,f._)([(0,xe.r)("colorRamp")],Ae.prototype,"readColorRamp",null),(0,f._)([(0,v.Cb)({type:Ce.H0.apiValues,json:{type:Ce.H0.jsonValues,write:Ce.H0.write}})],Ae.prototype,"colorRampName",void 0),(0,f._)([(0,xe.r)("colorRampName")],Ae.prototype,"readColorRampName",null);var ke=Ae=we=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],Ae),Te=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],Pe=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];function Fe(t,e){for(var r,n=[],i=[],o=0;o<t.length-1;o++)n.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:t[o].slice(1),toColor:t[o+1].slice(1)}),i.push(t[o+1][0]-t[o][0]);var s=t[t.length-1][0];return(0,Ce.XL)({type:"multipart",colorRamps:n},{numColors:s,weights:e=null!==(r=e)&&void 0!==r?r:i})}function Ne(t){var e;switch(t){case"elevation":e=Fe([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case"gray":e=(0,Ce.XL)({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case"hillshade":e=Fe([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case"ndvi":e=Te;break;case"ndvi2":e=function(){for(var t=Fe([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]),e=t.length;e<256;e++)t.push([6,27,7]);return t}();break;case"ndvi3":e=Pe;break;case"random":e=function(){for(var t=[],e=0;e<256;e++){for(var r=[],n=0;n<3;n++)r.push(Math.round(255*Math.random()));t.push(r)}return t}()}return e?(e=e.map((function(t,e){return[e].concat((0,x.Z)(t))})),e):null}var Ie=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Colormap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.sourceRasterInfos[0];if(r.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};var n=this.functionArguments,i=n.colormap,o=n.colormapName,s=n.colorRamp,a=n.colorRampName;if(null===(t=i)||void 0===t||!t.length)if(s)this.colorRamp=s,i=(0,Ce.Jw)(s,{interpolateAlpha:!0});else if(a){var u=(0,Ce.B4)(a);u&&(i=(0,Ce.Jw)(u),this.colorRamp=(0,Ze.i)(u))}else o&&(i=Ne(o));if(null===(e=i)||void 0===e||!e.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};var l=this._getOutputPixelType(r.pixelType);this.outputPixelType=l.startsWith("f")?"s32":l;var c=r.clone();return c.pixelType=this.outputPixelType,c.colormap=i,c.bandCount=1,this.rasterInfo=c,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];return!r||(0,h.DV)(r.pixelType)||(r=r.clone()).clamp(this.outputPixelType),r}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Ie.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:ke,json:{write:!0,name:"rasterFunctionArguments"}})],Ie.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Ie.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)()],Ie.prototype,"isNoopProcess",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Ie.prototype,"indexedColormap",void 0),(0,f._)([(0,v.Cb)()],Ie.prototype,"colorRamp",void 0);var Re,je=Ie=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ColormapFunction")],Ie),Be=r(31201),Se=Re=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).rasters=[],t}return(0,l.Z)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new Re({rasters:(0,s.d9)(this.rasters)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],Se.prototype,"rasters",void 0),(0,f._)([(0,Be.c)("rasters")],Se.prototype,"writeRasters",null);var Me=Se=Re=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],Se),De=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="CompositeBand",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);var r=e.clone();if(r.attributeTable=null,r.colormap=null,r.pixelType=this.outputPixelType,r.bandCount=t.map((function(t){return t.bandCount})).reduce((function(t,e){return t+e})),t.every((function(t){var e=t.statistics;return null!=e&&e.length}))){var i=[];t.forEach((function(t){var e=t.statistics;return null!=e&&i.push.apply(i,(0,x.Z)(e))})),r.statistics=i}if(t.every((function(t){var e=t.histograms;return null!=e&&e.length}))){var o=[];t.forEach((function(t){var e=t.histograms;return null!=e&&o.push.apply(o,(0,x.Z)(e))})),r.histograms=o}r.bandCount>1&&(r.colormap=null,r.attributeTable=null);var s=t.every((function(t){var e;return null===(e=t.keyProperties.BandProperties)||void 0===e?void 0:e.length}))?t.flatMap((function(t){return t.keyProperties.BandProperties})):void 0;return r.keyProperties=(0,n.Z)((0,n.Z)({},r.keyProperties),{},{BandProperties:s}),this.rasterInfo=r,{success:!0,supportsGPU:r.bandCount<=3}}},{key:"_processPixels",value:function(t){var e=t.pixelBlocks;return e?null==(null===e||void 0===e?void 0:e[0])?null:(0,ne.Gd)(e):null}},{key:"_getWebGLParameters",value:function(){return{bandCount:this.rasterInfo.bandCount}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],De.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Me,json:{write:!0,name:"rasterFunctionArguments"}})],De.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],De.prototype,"rasterArgumentNames",void 0);var Oe,ze=De=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.CompositeBandFunction")],De),Ge=r(83040),Ve=new Xt.X({0:"difference",1:"relative-difference",2:"categorical",3:"euclidean-distance",4:"angle-difference",5:"band-with-most-change"},{useNumericKeys:!0}),Ee=new Xt.X({0:"all",1:"changed",2:"unchanged"},{useNumericKeys:!0});function Le(t,e,r,i){var o=(0,a.Z)(t,2),s=o[0],u=o[1],l=(0,h.DV)(r)&&!(0,h.DV)(s.pixelType)&&!(0,h.DV)(u.pixelType),c=[s.mask,u.mask].filter((function(t){return t})),p=Z.Z.combineBandMasks(c),f=t.map((function(t){return t.pixels[0]})),v=s.width,d=s.height,m=Z.Z.createEmptyBand(r,v*d);switch(e){case"difference":case"relative-difference":!function(t){for(var e=(0,a.Z)(t.bands,2),r=e[0],n=e[1],i=t.mask,o=t.isRelative,s=t.isRoundingNeeded,u=t.outBand,l=r.length,c=0;c<l;c++)if(!i||i[c]){var p=r[c]-n[c];if(o){var f=Math.max(Math.abs(r[c])-Math.abs(n[c]));p=f>0?p/f:0}u[c]=s?Math.round(p):p}}({bands:f,mask:p,outBand:m,isRoundingNeeded:l,isRelative:"relative-difference"===e});break;case"categorical":!function(t){for(var e=(0,a.Z)(t.bands,2),r=e[0],n=e[1],i=(0,a.Z)(t.categoryIndexLookups,2),o=i[0],s=i[1],u=(0,a.Z)(t.classNames,2),l=u[0],c=u[1],p=t.mask,f=t.keepMethod,v=t.outBand,d=r.length,h=l.length,m=c.length,y=h*m,g=y+1,b=y+2,w=0;w<d;w++)if(!p||p[w]){var _=r[w],x=n[w],C=o[_],Z=s[x],A=l[C],k=c[Z];v[w]=null==C||null==Z?y:"changed"===f&&A===k?g:"unchanged"===f&&A!==k?b:C*m+Z}}((0,n.Z)({bands:f,mask:p,outBand:m},i));break;case"euclidean-distance":!function(t){for(var e=(0,a.Z)(t.pixels,2),r=e[0],n=e[1],i=t.mask,o=t.outBand,s=r[0].length,u=r.length,l=0;l<s;l++)if(!i||i[l]){for(var c=0,p=0;p<u;p++){var f=r[p][l]-n[p][l];c+=f*f}o[l]=Math.sqrt(c)}}({pixels:t.map((function(t){return t.pixels})),mask:p,outBand:m});break;case"angle-difference":!function(t){for(var e=(0,a.Z)(t.pixels,2),r=e[0],n=e[1],i=t.mask,o=t.outBand,s=r[0].length,u=r.length,l=0;l<s;l++)if(!i||i[l]){for(var c=0,p=0,f=0,v=0;v<u;v++){var d=r[v][l],h=n[v][l];c+=d*h,p+=d*d,f+=h*h}var m=Math.sqrt(p*f);o[l]=m?Math.acos(c/m):1.5707963267948966}}({pixels:t.map((function(t){return t.pixels})),mask:p,outBand:m});break;case"band-with-most-change":!function(t){for(var e=(0,a.Z)(t.pixels,2),r=e[0],n=e[1],i=t.mask,o=t.outBand,s=r[0].length,u=r.length,l=0;l<s;l++)if(!i||i[l]){for(var c=0,p=0,f=0;f<u;f++){var v=Math.abs(r[f][l]-n[f][l]);v>c&&(c=v,p=f)}o[l]=p}}({pixels:t.map((function(t){return t.pixels})),mask:p,outBand:m})}var y=new Z.Z({width:v,height:d,pixels:[m],pixelType:r,mask:p});return y.updateStatistics(),y}var Ue=Oe=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).method="difference",t.keepMethod="all",t.raster2=void 0,t}return(0,l.Z)(r,[{key:"rasters",get:function(){return[this.raster,this.raster2]}},{key:"clone",value:function(){return new Oe({raster:this.raster,raster2:this.raster2,method:this.method,keepMethod:this.keepMethod})}}]),r}(b);(0,f._)([(0,qt.J)(Ve)],Ue.prototype,"method",void 0),(0,f._)([(0,qt.J)(Ee)],Ue.prototype,"keepMethod",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Ue.prototype,"raster2",void 0),(0,f._)([(0,v.Cb)({readOnly:!0})],Ue.prototype,"rasters",null);var We=Ue=Oe=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ComputeChangeFunctionArguments")],Ue),Je=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="ComputeChange",t.functionArguments=null,t.rasterArgumentNames=["raster","raster2"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this,e=this.functionArguments.method,r=this.sourceRasterInfos[0].clone();if(this.outputPixelType=this._getOutputPixelType(r.pixelType),r.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(r),"categorical"===e){var n=this.sourceRasterInfos.map((function(t){return t.attributeTable})),i=this._getFieldNames(n,"value"),o=n.map((function(e){return t._getClassFieldName(e)}));if(null==i[0]||null==i[1]||null==o[0]||null==o[1])return{success:!1,supportsGPU:!1,error:"both inputs must have proper attribute table with value and class fields"};this._updateAttributeTable(r,i,o)}return r.bandCount=1,this.rasterInfo=r,{success:!0,supportsGPU:"difference"===e||"relative-difference"===e}}},{key:"_processPixels",value:function(t){var e=t.pixelBlocks;return null==(null===e||void 0===e?void 0:e[0])||null==(null===e||void 0===e?void 0:e[1])?null:Le(e,this.functionArguments.method,this.outputPixelType,this._categoryConfig)}},{key:"_getWebGLParameters",value:function(){var t,e=null!==(t=this.outputPixelType)&&void 0!==t?t:"f32",r=(0,h.rL)(e),n=(0,a.Z)(r,2),i=n[0],o=n[1],s=(0,h.DV)(e);return s&&(i-=1e-4,o+=1e-4),{method:this.functionArguments.method,domainRange:[i,o],isOutputRounded:s}}},{key:"_updateAttributeTable",value:function(t,e,r){var n=this.sourceRasterInfos.map((function(t){return t.attributeTable})),i=n.map((function(t,r){return t.features.map((function(t){return t.attributes[e[r]]}))})),o=n.map((function(t,e){return t.features.map((function(t){return t.attributes[r[e]]}))})),s=i.map((function(t){var e=[];return t.forEach((function(t,r){return e[t]=r})),e})),u=this.functionArguments.keepMethod;this._categoryConfig={categoryIndexLookups:s,classNames:o,keepMethod:u};var l=n[0].clone();l.fields=[new Ge.Z({name:"OID",type:"oid"}),new Ge.Z({name:"Value",type:"integer"}),new Ge.Z({name:"ClassName",type:"string"}),new Ge.Z({name:"Class_From",type:"string"}),new Ge.Z({name:"Class_To",type:"string"})];var c=this._getFieldNames(n,"red"),p=this._getFieldNames(n,"green"),f=this._getFieldNames(n,"blue"),v=[],d=2===c.length&&2===p.length&&2===f.length;d&&(v.push.apply(v,(0,x.Z)(n.map((function(t,e){return t.features.map((function(t){return[t.attributes[c[e]],t.attributes[p[e]],t.attributes[f[e]]]}))})))),l.fields.push(new Ge.Z({name:"Red",type:"integer"}),new Ge.Z({name:"Green",type:"integer"}),new Ge.Z({name:"Blue",type:"integer"})));var h=l.features[0].clone();h.geometry=null;for(var m=[],y=i.map((function(t){return t.length})),g=(0,a.Z)(y,2),b=g[0],w=g[1],_=1,C=0;C<b;C++)for(var Z=o[0][C],A=0;A<w;A++){var k=o[1][A];if(!("changed"===u&&Z===k||"unchanged"===u&&Z!==k)){var T=h.clone();T.attributes={OID:_++,Value:C*w+A,ClassName:Z===k?Z:"".concat(Z," -> ").concat(k),Class_From:Z,Class_To:k},d&&(T.attributes.Red=v[0][C][0]+v[1][A][0]>>1,T.attributes.Green=v[0][C][1]+v[1][A][1]>>1,T.attributes.Blue=v[0][C][2]+v[1][A][2]>>1),m.push(T)}}if("changed"===u){var P=h.clone();P.attributes={OID:_++,Value:b*w+1,ClassName:"No Change",Class_From:"Same",Class_To:"Same"},m.push(P)}else if("unchanged"===u){var F=h.clone();F.attributes={OID:_++,Value:b*w+2,ClassName:"Changed",Class_From:"Any",Class_To:"Any"},m.push(F)}l.features=m,t.attributeTable=l}},{key:"_getFieldNames",value:function(t,e){return t.map((function(t){var r;return null===(r=t.fields.find((function(t){return t.name.toLowerCase()===e})))||void 0===r?void 0:r.name})).filter((function(t){return t}))}},{key:"_getClassFieldName",value:function(t){var e,r,n=null!==(e=null!==(r=t.fields.find((function(t){return"string"===t.type&&t.name.toLowerCase().startsWith("class")})))&&void 0!==r?r:t.fields.find((function(t){return"string"===t.type&&t.name.toLowerCase().includes("class")||t.name.toLowerCase().includes("type")||t.name.toLowerCase().includes("name")})))&&void 0!==e?e:t.fields.find((function(t){return"string"===t.type}));return null===n||void 0===n?void 0:n.name}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Je.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:We,json:{write:!0,name:"rasterFunctionArguments"}})],Je.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Je.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Je.prototype,"_categoryConfig",void 0);var He,qe=Je=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ComputeChangeFunction")],Je),Xe=He=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).contrastOffset=0,t.brightnessOffset=0,t}return(0,l.Z)(r,[{key:"clone",value:function(){return new He({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],Xe.prototype,"contrastOffset",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Xe.prototype,"brightnessOffset",void 0);var $e=Xe=He=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],Xe),Ke=r(21449),Ye=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="ContrastBrightness",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];if("u8"!==t.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");var e=t.clone();this._removeStatsHistColormapVAT(e),this.rasterInfo=e;var r=this.functionArguments,n=r.contrastOffset,i=r.brightnessOffset;return this.lookup=(0,Ke.gI)(n,i),{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=this,n=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];return null==n?null:(0,ne.XV)(n,{lut:n.pixels.map((function(){return r.lookup})),offset:0,outputPixelType:"u8"})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments;return{contrastOffset:t.contrastOffset,brightnessOffset:t.brightnessOffset}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Ye.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:$e,json:{write:!0,name:"rasterFunctionArguments"}})],Ye.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Ye.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Ye.prototype,"lookup",void 0);var Qe=Ye=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],Ye);function tr(t,e,r,n,i){for(var o=Math.floor(n/2),s=0;s<o;s++)for(var a=0;a<e;a++)t[s*e+a]=t[(i-1-s)*e+a],t[(r-1-s)*e+a]=t[(r-i+s)*e+a];for(var u=Math.floor(i/2),l=0;l<r;l++)for(var c=l*e,p=0;p<u;p++)t[c+p]=t[c+i-1-p],t[c+e-p-1]=t[c+e+p-i]}var er,rr=new Map;function nr(t,e,r,n,i,o,s){for(var a=new Float32Array(e*r),u=o.length,l=s?0:n,c=s?n:0,p=s?1:e,f=l;f<r-l;f++)for(var v=f*e,d=c;d<e-c;d++)if(!i||i[v+d]){for(var h=0,m=0;m<u;m++)h+=t[v+d+(m-n)*p]*o[m];a[v+d]=h}return a}function ir(t,e,r,n,i,o,s){for(var a=new Float32Array(e*r),u=Math.floor(n/2),l=Math.floor(i/2),c=u;c<r-u;c++)for(var p=c*e,f=l;f<e-l;f++)if(!o||o[p+f]){for(var v=0,d=0;d<n;d++)for(var h=0;h<i;h++)v+=t[p+f+(d-u)*e+h-l]*s[d*i+h];a[p+f]=v}return a}function or(t,e){var r=function(t){for(var e=Math.sqrt(t.length),r=t.slice(0,e),n=[1],i=1;i<e;i++){for(var o=null,s=0;s<e;s++){var a=t[s+i*e],u=t[s];if(null==o)if(0===u){if(a)return{separable:!1,row:null,col:null}}else o=a/u;else if(a/u!==o)return{separable:!1,row:null,col:null}}if(null==o)return{separable:!1,row:null,col:null};n.push(o)}return{separable:!0,row:r,col:n}}(e.kernel),n=!1!==e.mirrorEdges,i=r.separable?function(t,e,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.pixels,o=t.width,s=t.height,a=t.pixelType,u=t.mask,l=i.length,c=[],p=e.length,f=r.length,v=Math.floor(p/2),d=Math.floor(f/2),h=0;h<l;h++){var m=nr(i[h],o,s,v,u,e,!0);m=nr(m,o,s,d,u,r,!1),n&&tr(m,o,s,p,f),c.push(m)}return new Z.Z({width:o,height:s,pixelType:a,pixels:c,mask:u})}(t,r.row,r.col,n):function(t,e){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.pixels,i=t.width,o=t.height,s=t.pixelType,a=t.mask,u=n.length,l=[],c=e.kernel,p=e.rows,f=e.cols,v=0;v<u;v++){var d=ir(n[v],i,o,p,f,a,c);r&&tr(d,i,o,p,f),l.push(d)}return new Z.Z({width:i,height:o,pixelType:s,pixels:l,mask:a})}(t,e,n),o=e.outputPixelType;return o&&i.clamp(o),i}rr.set(N.z8.none,[0,0,0,0,1,0,0,0,0]),rr.set(N.z8.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),rr.set(N.z8.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),rr.set(N.z8.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),rr.set(N.z8.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),rr.set(N.z8.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),rr.set(N.z8.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),rr.set(N.z8.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),rr.set(N.z8.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),rr.set(N.z8.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),rr.set(N.z8.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),rr.set(N.z8.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),rr.set(N.z8.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),rr.set(N.z8.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),rr.set(N.z8.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),rr.set(N.z8.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),rr.set(N.z8.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),rr.set(N.z8.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),rr.set(N.z8.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),rr.set(N.z8.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),rr.set(N.z8.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),rr.set(N.z8.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),rr.set(N.z8.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var sr=er=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).rows=3,t.cols=3,t.kernel=[0,0,0,0,1,0,0,0,0],t}return(0,l.Z)(r,[{key:"convolutionType",set:function(t){this._set("convolutionType",t);var e=rr.get(t);if(e&&t!==N.z8.userDefined&&t!==N.z8.none){var r=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",r),this._set("rows",r)}}},{key:"clone",value:function(){return new er({cols:this.cols,rows:this.rows,kernel:(0,x.Z)(this.kernel),convolutionType:this.convolutionType,raster:(0,s.d9)(this.raster)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{type:Number,write:!0}})],sr.prototype,"rows",void 0),(0,f._)([(0,v.Cb)({json:{type:Number,write:!0}})],sr.prototype,"cols",void 0),(0,f._)([(0,v.Cb)({json:{name:"type",type:Number,write:!0}})],sr.prototype,"convolutionType",null),(0,f._)([(0,v.Cb)({json:{type:[Number],write:!0}})],sr.prototype,"kernel",void 0);var ar=sr=er=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],sr),ur=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Convolution",t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_normalizedKernel",get:function(){var t=this.functionArguments,e=t.kernel,r=t.convolutionType,n=e.reduce((function(t,e){return t+e}));return-1===r||0===n||1===n?e:e.map((function(t){return t/n}))}},{key:"_bindSourceRasters",value:function(){var t=this.functionArguments,e=t.convolutionType,r=t.rows,n=t.cols,i=t.kernel;if(!Object.values(N.z8).includes(e))return{success:!1,supportsGPU:!1,error:"convolution-function: the specified kernel type is not supported ".concat(e)};if(e!==N.z8.none&&r*n!==i.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var o=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(o.pixelType);var s=o.clone();s.pixelType=this.outputPixelType;var a=[N.z8.none,N.z8.sharpen,N.z8.sharpen2,N.z8.sharpening3x3,N.z8.sharpening5x5];return(-1===e||"u8"!==this.outputPixelType&&!a.includes(e))&&(s.statistics=null,s.histograms=null),s.colormap=null,s.attributeTable=null,this.rasterInfo=s,{success:!0,supportsGPU:i.length<=25}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r||this.functionArguments.convolutionType===N.z8.none)return r;var n=this.functionArguments,i=n.rows,o=n.cols;return or(r,{kernel:this._normalizedKernel,rows:i,cols:o,outputPixelType:this.outputPixelType})}},{key:"_getWebGLParameters",value:function(){var t=new Float32Array(25);return t.set(this._normalizedKernel),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:t,clampRange:(0,h.rL)(this.outputPixelType)}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],ur.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:ar,json:{write:!0,name:"rasterFunctionArguments"}})],ur.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],ur.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)()],ur.prototype,"_normalizedKernel",null);var lr,cr=ur=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ConvolutionFunction")],ur),pr=new Xt.X({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0}),fr=lr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).curvatureType="standard",t.zFactor=1,t}return(0,l.Z)(r,[{key:"readCurvatureType",value:function(t,e){var r,n;return pr.fromJSON(null!==(r=null!==(n=e.type)&&void 0!==n?n:e.curvatureType)&&void 0!==r?r:0)}},{key:"clone",value:function(){return new lr({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:{target:"type"}}}),(0,qt.J)(pr)],fr.prototype,"curvatureType",void 0),(0,f._)([(0,xe.r)("curvatureType",["type","curvatureType"])],fr.prototype,"readCurvatureType",null),(0,f._)([(0,v.Cb)({type:Number,json:{write:!0}})],fr.prototype,"zFactor",void 0);var vr=fr=lr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],fr),dr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Curvature",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e;this.outputPixelType=this._getOutputPixelType("f32");var r=this.sourceRasterInfos[0].clone();return r.pixelType=this.outputPixelType,r.bandCount=1,this._removeStatsHistColormapVAT(r),this.rasterInfo=r,this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.functionArguments,i=n.zFactor,o=n.curvatureType,s=t.extent,a=t.primaryPixelSizes,u=null===a||void 0===a?void 0:a[0],l=null!==u&&void 0!==u?u:s?{x:s.width/r.width,y:s.height/r.height}:{x:1,y:1},c=this.isGCS&&i>=1?i*Wt._p:i;return(0,Wt.Ne)(r,{zFactor:c,curvatureType:o,resolution:l})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.zFactor;return{curvatureType:t.curvatureType,zFactor:this.isGCS&&e>=1?e*Wt._p:e}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],dr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:vr,json:{write:!0,name:"rasterFunctionArguments"}})],dr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],dr.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],dr.prototype,"isGCS",void 0);var hr,mr=dr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.CurvatureFunction")],dr),yr=hr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).bandIds=[],t.bandNames=[],t.bandWavelengths=[],t.missingBandAction=ne.CD.bestMatch,t}return(0,l.Z)(r,[{key:"clone",value:function(){var t,e,r;return new hr({bandIds:null===(t=this.bandIds)||void 0===t?void 0:t.slice(),bandNames:null===(e=this.bandNames)||void 0===e?void 0:e.slice(),bandWavelengths:null===(r=this.bandWavelengths)||void 0===r?void 0:r.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],yr.prototype,"bandIds",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],yr.prototype,"bandNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],yr.prototype,"bandWavelengths",void 0),(0,f._)([(0,qt.J)({0:"name",1:"wavelength",2:"id"})],yr.prototype,"method",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],yr.prototype,"missingBandAction",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],yr.prototype,"wavelengthMatchTolerance",void 0);var gr=yr=hr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],yr),br=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="ExtractBand",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e,r=this.functionArguments,i=this.sourceRasterInfos[0],o=r.method,s=r.bandNames,a=r.bandWavelengths,u=r.bandIds,l=r.missingBandAction,c=(null===s||void 0===s?void 0:s.length)&&("name"===o||"id"!==o&&!(null!==u&&void 0!==u&&u.length)),p=(null===a||void 0===a?void 0:a.length)&&("wavelength"===o||"id"!==o&&!(null!==u&&void 0!==u&&u.length)),f=l===ne.CD.fail,v=c?function(t,e){for(var r=t.bandInfos.map((function(t){return t.name.toLowerCase()})),n=[],i=0;i<e.length;i++){var o=e[i].toLowerCase(),s=r.indexOf(o);if(-1===s&&"nearinfrared"===o&&(s=r.findIndex((function(t){return t.startsWith("nearinfrared_1")})),-1===s&&(s=r.findIndex((function(t){return t.startsWith("nearinfrared")})))),-1===s)return null;n.push(s)}return n}(i,s):p?function(t,e,r,n){for(var i=r.wavelengthMatchTolerance,o=t.bandInfos,s=[],a=0;a<o.length;a++){var u=o[a],l=u.minWavelength,c=u.maxWavelength;if(!l||!c)return null;s.push({minWavelength:l,maxWavelength:c})}for(var p=[],f=0;f<e.length;f++){for(var v=e[f],d=!1,h=-1,m=Number.MAX_VALUE,y=0;y<s.length;y++){var g=s[y],b=v>=g.minWavelength&&v<=g.maxWavelength,w=Math.abs(v-(g.minWavelength+g.maxWavelength)/2);b?w<m&&(d=!0,h=y,m=w):!d&&w<m&&(h=y,m=w)}if(!d&&i&&m<i&&(d=!0),!d&&n)return null;p.push(h)}return p}(i,a,this.functionArguments,f):function(t,e,r){var n=t.bandCount;return null===e||void 0===e||!e.length||r&&e.some((function(t){return t<0||t>=n}))?null:e}(i,u,f);if(null==v)return{success:!1,supportsGPU:!1,error:"extract-band-function: Invalid ".concat(c?"band names":p?"band wavelengths":"band ids"," for the imagery data source")};this.functionArguments.bandIds=v,this.functionArguments.method="id",this.outputPixelType=this._getOutputPixelType("f32");var d=i.clone();d.pixelType=this.outputPixelType,d.bandCount=v.length;var h=d.statistics,m=d.histograms;null!=h&&h.length&&(d.statistics=v.map((function(t){return h[t]||h[h.length-1]}))),null!=m&&m.length&&(d.histograms=v.map((function(t){return m[t]||m[m.length-1]})));var y=null===(t=d.keyProperties)||void 0===t?void 0:t.BandProperties;return null!==(e=y)&&void 0!==e&&e.length&&(y=v.map((function(t){return t>=y.length?y[y.length-1]:y[t]})),d.keyProperties=(0,n.Z)((0,n.Z)({},d.keyProperties),{},{BandProperties:y})),this.rasterInfo=d,{success:!0,supportsGPU:d.bandCount<=3}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=r.pixels.length,i=this.functionArguments.bandIds.map((function(t){return t>=n?n-1:t}));return r.extractBands(i)}},{key:"_getWebGLParameters",value:function(){var t;if(this.isInputBandIdsSwizzled)t=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{var e,r;0===(t=(0,x.Z)(this.functionArguments.bandIds)).length?t=[0,1,2]:t.length<3&&(t[1]=null!==(e=t[1])&&void 0!==e?e:t[0],t[2]=null!==(r=t[2])&&void 0!==r?r:t[1]);for(var n=0;n<3;n++)t[n]=Math.min(t[n],2)}return{bandIndexMat3:se(t)}}},{key:"_getInputBandIds",value:function(t){var e=t.length;return this.functionArguments.bandIds.map((function(t){return t>=e?e-1:t})).map((function(e){return t[e]}))}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],br.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:gr,json:{write:!0,name:"rasterFunctionArguments"}})],br.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],br.prototype,"rasterArgumentNames",void 0);var wr,_r=br=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.ExtractBandFunction")],br);var xr=wr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){return(0,u.Z)(this,r),e.apply(this,arguments)}return(0,l.Z)(r,[{key:"clone",value:function(){return new wr({conversionParameters:(0,x.Z)(this.conversionParameters),raster:this.raster})}}]),r}(b);(0,f._)([(0,v.Cb)({type:[Number],json:{write:!0}})],xr.prototype,"conversionParameters",void 0);var Cr=xr=wr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.GrayscaleFunctionArguments")],xr),Zr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Grayscale",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_normalizedWeights",get:function(){var t=this.functionArguments.conversionParameters,e=t.reduce((function(t,e){return t+e}));return t.map((function(t){return t/e}))}},{key:"_bindSourceRasters",value:function(){var t=this.functionArguments.conversionParameters;if(null===t||void 0===t||!t.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};var e=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(e.pixelType),e.pixelType=this.outputPixelType;var r=3===t.length||3===e.bandCount&&t.length>3;return e.bandCount=1,this._removeStatsHistColormapVAT(e),this.rasterInfo=e,{success:!0,supportsGPU:r}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];return null==r?null:function(t,e,r){for(var n=t.pixels,i=t.width,o=t.height,s=t.mask,u=t.bandMasks,l=i*o,c=null!==u&&void 0!==u&&u.length?Z.Z.combineBandMasks(u):s,p=Math.min(e.length,n.length),f=r.startsWith("f"),v=!f&&r!==t.pixelType,d=(0,h.rL)(r),m=(0,a.Z)(d,2),y=m[0],g=m[1],b=Z.Z.createEmptyBand(r,l),w=0;w<o;w++)for(var _=w*i,x=0;x<i;x++,_++)if(!c||c[_]){for(var C=0,A=0;A<p;A++)C+=e[A]*n[A][_];f||(C=Math.round(C),v&&(C=C>g?g:C<y?y:C)),b[_]=C}var k=new Z.Z({width:i,height:o,pixels:[b],pixelType:r,mask:c});return k.updateStatistics(),k}(r,this._normalizedWeights,this.outputPixelType)}},{key:"_getWebGLParameters",value:function(){return{weights:this._normalizedWeights}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Zr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Cr,json:{write:!0,name:"rasterFunctionArguments"}})],Zr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Zr.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)()],Zr.prototype,"_normalizedWeights",null);var Ar,kr=Zr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.GrayscaleFunction")],Zr),Tr=Ar=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).rasters=[],t.processAsMultiband=!0,t}return(0,l.Z)(r,[{key:"writeRasters",value:function(t,e){e.rasters=t.map((function(t){return"number"==typeof t||"string"==typeof t?t:t.toJSON()}))}},{key:"clone",value:function(){return new Ar({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:(0,s.d9)(this.rasters)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],Tr.prototype,"operation",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Tr.prototype,"rasters",void 0),(0,f._)([(0,Be.c)("rasters")],Tr.prototype,"writeRasters",null),(0,f._)([(0,v.Cb)({json:{write:!0}})],Tr.prototype,"processAsMultiband",void 0);var Pr=Tr=Ar=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],Tr),Fr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Local",t.functionArguments=null,t.rasterArgumentNames=["rasters"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos,e=t[0],r=e.bandCount,n=this.functionArguments.processAsMultiband;if(t.some((function(t){return t.bandCount!==r})))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};var i=this.functionArguments,o=i.operation,s=i.rasters,a=j[o];if(!(999===a||s.length===a||s.length<=1&&1===a))return{success:!1,supportsGPU:!1,error:"local-function: the length of functionArguments.rasters does not match operation's requirement: ".concat(a)};var u=e.clone();return u.bandCount=999!==a||n?r:1,this._removeStatsHistColormapVAT(u),this._updateStatistics(u),this._updatePixelType(u),this.rasterInfo=u,{success:!0,supportsGPU:1===u.bandCount&&a<=3&&(o<11||o>16)}}},{key:"_processPixels",value:function(t){var e,r=t.pixelBlocks;return null==r||r.some((function(t){return null==t}))?null:zt(r,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:null!==(e=this.outputPixelType)&&void 0!==e?e:void 0})}},{key:"_getWebGLParameters",value:function(){var t,e,r,n=this.functionArguments.operation,i=j[n],o=null!==(t=null===(e=Object.keys(N.HW).find((function(t){return N.HW[t]===n})))||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"undefined",s=null!==(r=this.outputPixelType)&&void 0!==r?r:"f32",u=(0,h.rL)(s),l=(0,a.Z)(u,2),c=l[0],p=l[1],f=(0,h.DV)(s);return f&&(c-=1e-4,p+=1e-4),{imageCount:i,operationName:o,domainRange:[c,p],isOutputRounded:f}}},{key:"_updateStatistics",value:function(t){var e,r,n=this.sourceRasterInfos[0],i=this.functionArguments.operation,o=null===(e=R(i))||void 0===e?void 0:e.domain;if(o){t.statistics=[];for(var s=0;s<t.bandCount;s++)t.statistics[s]={min:o[0],max:o[1],avg:(o[0]+o[1])/2,stddev:(o[0]+o[1])/10}}else 45===i&&(null===(r=n.statistics)||void 0===r?void 0:r.length)&&(t.statistics=n.statistics.map((function(t){return{min:-t.max,max:-t.min,avg:null!=t.avg?-t.avg:void 0,stddev:null!=t.stddev?-t.stddev:void 0}})))}},{key:"_updatePixelType",value:function(t){var e,r=this.sourceRasterInfos[0],n=r.statistics,i=r.pixelType,o=this.functionArguments.operation,s=null!==(e=R(o))&&void 0!==e?e:{domain:null,isInteger:!1},a=s.domain,u=s.isInteger,l="f32";if(a&&u)l=(0,h.JQ)(a[0],a[1]);else if(30===o){var c=null===n||void 0===n?void 0:n[0];l=c?(0,h.JQ)(c.min,c.max):(0,h.DV)(i)?i:"s32"}else if(45===o&&(0,h.DV)(i)){var p=null===n||void 0===n?void 0:n.map((function(t){return-t.max})),f=null===n||void 0===n?void 0:n.map((function(t){return-t.min})),v=null!==p&&void 0!==p&&p.length?Math.min.apply(Math,(0,x.Z)(p)):null,d=null!==f&&void 0!==f&&f.length?Math.min.apply(Math,(0,x.Z)(f)):null;l=null!=v&&null!=d?(0,h.JQ)(v,d):i.startsWith("s")?i.replace("s","u"):"u1"===i||"u2"===i||"u4"===i?"s8":"u8"===i?"s16":"s32"}t.pixelType=this.outputPixelType=this._getOutputPixelType(l)}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Fr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Pr,json:{write:!0,name:"rasterFunctionArguments"}})],Fr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Fr.prototype,"rasterArgumentNames",void 0);var Nr,Ir=Fr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.LocalFunction")],Fr),Rr=r(16889),jr=Nr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).includedRanges=null,t.noDataValues=null,t.noDataInterpretation=ne.DX.matchAny,t}return(0,l.Z)(r,[{key:"normalizedNoDataValues",get:function(){var t=this.noDataValues;if(null===t||void 0===t||!t.length)return null;var e=!1,r=t.map((function(t){if("number"==typeof t)return e=!0,[t];if("string"==typeof t){var r=t.trim().split(" ").filter((function(t){return""!==t.trim()})).map((function(t){return Number(t)}));return e=e||r.length>0,0===r.length?null:r}return null}));return e?r:null}},{key:"clone",value:function(){var t,e,r,n;return new Nr({includedRanges:null!==(t=null===(e=this.includedRanges)||void 0===e?void 0:e.slice())&&void 0!==t?t:[],noDataValues:null!==(r=null===(n=this.noDataValues)||void 0===n?void 0:n.slice())&&void 0!==r?r:[],noDataInterpretation:this.noDataInterpretation})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],jr.prototype,"includedRanges",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],jr.prototype,"noDataValues",void 0),(0,f._)([(0,v.Cb)()],jr.prototype,"normalizedNoDataValues",null),(0,f._)([(0,v.Cb)({json:{write:!0}})],jr.prototype,"noDataInterpretation",void 0);var Br=jr=Nr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],jr),Sr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Mask",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,this.rasterInfo=t;var r=this.functionArguments,n=r.includedRanges,i=r.normalizedNoDataValues;if((null===n||void 0===n||!n.length)&&(null===i||void 0===i||!i.length))return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};for(var o=[],s=0;s<t.bandCount;s++){var a=(0,ne.nA)(e,null===n||void 0===n?void 0:n.slice(2*s,2*s+2),null===i||void 0===i?void 0:i[s]);if(null==a){o=null;break}o.push(a)}this.lookups=o;var u=null!=i&&i.every((function(t){var e;return(null===t||void 0===t?void 0:t.length)===(null===(e=i[0])||void 0===e?void 0:e.length)}));return{success:!0,supportsGPU:(!n||n.length<=2*ne.$f)&&(!i||u&&i[0].length<=ne.$f)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.outputPixelType,i=this.lookups,o=this.functionArguments,s=o.includedRanges,a=o.noDataInterpretation,u=o.normalizedNoDataValues,l=a===ne.DX.matchAll;return(0,ne.sS)(r,{includedRanges:s,noDataValues:u,outputPixelType:n,matchAll:l,lookups:i})}},{key:"_getWebGLParameters",value:function(){var t,e=this.functionArguments,r=e.includedRanges,n=e.normalizedNoDataValues,i=new Float32Array(ne.$f);i.fill(Rr.F3),(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.length)&&i.set(n[0]);for(var o=new Float32Array(ne.$f),s=0;s<o.length;s+=2){var a,u;o[s]=null!==(a=null===r||void 0===r?void 0:r[s])&&void 0!==a?a:-Rr.F3,o[s+1]=null!==(u=null===r||void 0===r?void 0:r[s+1])&&void 0!==u?u:Rr.F3}return null!==r&&void 0!==r&&r.length&&o.set(r),{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:i,includedRanges:o}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Sr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Br,json:{write:!0,name:"rasterFunctionArguments"}})],Sr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Sr.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Sr.prototype,"lookups",void 0);var Mr,Dr=Sr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.MaskFunction")],Sr),Or=Mr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).visibleBandID=0,t.infraredBandID=1,t.scientificOutput=!1,t}return(0,l.Z)(r,[{key:"clone",value:function(){var t=this.visibleBandID,e=this.infraredBandID,r=this.scientificOutput;return new Mr({visibleBandID:t,infraredBandID:e,scientificOutput:r})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],Or.prototype,"visibleBandID",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Or.prototype,"infraredBandID",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Or.prototype,"scientificOutput",void 0);var zr=Or=Mr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Or),Gr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="NDVI",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments,e=t.scientificOutput,r=t.visibleBandID,i=t.infraredBandID;this.outputPixelType=this._getOutputPixelType(e?"f32":"u8");var o=this.sourceRasterInfos[0],s=Math.max(r,i);if(o.bandCount<2||s>=o.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};var u=o.clone();u.pixelType=this.outputPixelType,u.colormap=null,u.histograms=null,u.bandCount=1,u.keyProperties=(0,n.Z)((0,n.Z)({},u.keyProperties),{},{BandProperties:void 0});var l=e?[-1,1,0,.1]:[0,200,100,10],c=(0,a.Z)(l,4),p=c[0],f=c[1],v=c[2],d=c[3];return u.statistics=[{min:p,max:f,avg:v,stddev:d}],this.rasterInfo=u,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.functionArguments;return function(t,e,r,n){for(var i=t.mask,o=t.pixels,s=t.width,a=t.height,u=o[r],l=o[e],c=l.length,p=n?new Uint8Array(c):new Float32Array(c),f=n?100:1,v=n?100.5:0,d=0;d<c;d++)if(null==i||i[d]){var h=u[d],m=l[d],y=h+m;y&&(p[d]=(h-m)/y*f+v)}var g=new Z.Z({width:s,height:a,mask:i,pixelType:n?"u8":"f32",pixels:[p]});return g.updateStatistics(),g}(r,n.visibleBandID,n.infraredBandID,!n.scientificOutput)}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.visibleBandID,r=t.infraredBandID,n=t.scientificOutput;return{bandIndexMat3:se(this.isInputBandIdsSwizzled?[0,1,2]:[r,e,0]),scaled:!n}}},{key:"_getInputBandIds",value:function(t){var e=this.functionArguments,r=e.visibleBandID;return[e.infraredBandID,r,0].map((function(e){return t[e]}))}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Gr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:zr,json:{write:!0,name:"rasterFunctionArguments"}})],Gr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Gr.prototype,"rasterArgumentNames",void 0);var Vr,Er=Gr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.NDVIFunction")],Gr),Lr=Vr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).inputRanges=null,t.outputValues=null,t.noDataRanges=null,t.allowUnmatched=!1,t.isLastInputRangeInclusive=!1,t}return(0,l.Z)(r,[{key:"clone",value:function(){return new Vr({inputRanges:(0,x.Z)(this.inputRanges),outputValues:(0,x.Z)(this.outputValues),noDataRanges:(0,x.Z)(this.noDataRanges),allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],Lr.prototype,"inputRanges",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Lr.prototype,"outputValues",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Lr.prototype,"noDataRanges",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Lr.prototype,"allowUnmatched",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Lr.prototype,"isLastInputRangeInclusive",void 0);var Ur=Lr=Vr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],Lr),Wr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Remap",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0].clone(),e=t.pixelType;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null,t.bandCount=1,t.attributeTable=null;var r=t.statistics,i=this.functionArguments,o=i.allowUnmatched,s=i.outputValues,a=i.inputRanges,u=i.noDataRanges,l=i.isLastInputRangeInclusive;if(null!=r&&r.length&&null!==s&&void 0!==s&&s.length)if(o){var c=Math.min.apply(null,[].concat((0,x.Z)(s),[r[0].min])),p=Math.max.apply(null,[].concat((0,x.Z)(s),[r[0].max]));t.statistics=[(0,n.Z)((0,n.Z)({},r[0]),{},{min:c,max:p})]}else{for(var f=s[0],v=f,d=0;d<s.length;d++)f=f>s[d]?s[d]:f,v=v>s[d]?v:s[d];t.statistics=[(0,n.Z)((0,n.Z)({},r[0]),{},{min:f,max:v})]}return this.rasterInfo=t,this.lookup=o?null:(0,ne.oB)({srcPixelType:e,inputRanges:a,outputValues:s,noDataRanges:u,allowUnmatched:o,isLastInputRangeInclusive:l,outputPixelType:this.outputPixelType}),{success:!0,supportsGPU:(!s||s.length<=ne.$f)&&(!u||u.length<=ne.$f)}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.lookup,i=this.outputPixelType;if(n){var o=(0,ne.XV)(r,{lut:[n.lut],offset:n.offset,outputPixelType:i});return null!=o&&n.mask&&(o.mask=(0,ne.wV)(r.pixels[0],r.mask,n.mask,n.offset,"u8")),o}var s=this.functionArguments,a=s.inputRanges,u=s.outputValues,l=s.noDataRanges,c=s.allowUnmatched,p=s.isLastInputRangeInclusive;return(0,ne.a2)(r,{inputRanges:a,outputValues:u,noDataRanges:l,outputPixelType:i,allowUnmatched:c,isLastInputRangeInclusive:p})}},{key:"_getWebGLParameters",value:function(){for(var t,e,r=this.functionArguments,n=r.allowUnmatched,i=r.noDataRanges,o=r.isLastInputRangeInclusive,s=new Float32Array(3*ne.$f),a=1e-5,u=null!==(t=this.functionArguments.inputRanges)&&void 0!==t?t:[],l=null!==(e=this.functionArguments.outputValues)&&void 0!==e?e:[],c=l.length,p=0;p<ne.$f;p++){var f,v,d;s[3*p]=null!==(f=u[2*p])&&void 0!==f?f:Rr.F3-1,s[3*p+1]=null!==(v=u[2*p+1])&&void 0!==v?v:Rr.F3,s[3*p+2]=null!==(d=l[p])&&void 0!==d?d:0,p<c&&(p>0&&(s[3*p]-=a),(p<c-1||!o)&&(s[3*p+1]-=a))}var m=new Float32Array(2*ne.$f);return m.fill(Rr.F3),(null===i||void 0===i?void 0:i.length)&&m.set(i),{allowUnmatched:n,rangeMaps:s,noDataRanges:m,clampRange:(0,h.rL)(this.outputPixelType)}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Wr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Ur,json:{write:!0,name:"rasterFunctionArguments"}})],Wr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Wr.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Wr.prototype,"lookup",void 0);var Jr,Hr=Wr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.RemapFunction")],Wr),qr=new Xt.X({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0}),Xr=Jr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).slopeType="degree",t.zFactor=1,t.pixelSizePower=.664,t.pixelSizeFactor=.024,t.removeEdgeEffect=!1,t}return(0,l.Z)(r,[{key:"clone",value:function(){return new Jr({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}}]),r}(b);(0,f._)([(0,qt.J)(qr)],Xr.prototype,"slopeType",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{write:!0}})],Xr.prototype,"zFactor",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{name:"psPower",write:!0}})],Xr.prototype,"pixelSizePower",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{name:"psZFactor",write:!0}})],Xr.prototype,"pixelSizeFactor",void 0),(0,f._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],Xr.prototype,"removeEdgeEffect",void 0);var $r=Xr=Jr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],Xr),Kr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Slope",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isGCS=!1,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t,e;this.outputPixelType=this._getOutputPixelType("f32");var r=this.sourceRasterInfos[0].clone();return r.pixelType=this.outputPixelType,r.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null,r.histograms=null,r.colormap=null,r.attributeTable=null,r.bandCount=1,this.rasterInfo=r,this.isGCS=null!==(t=null===(e=r.spatialReference)||void 0===e?void 0:e.isGeographic)&&void 0!==t&&t,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return null;var n=this.functionArguments,i=n.zFactor,o=n.slopeType,s=n.pixelSizePower,a=n.pixelSizeFactor,u=this.isGCS,l=t.extent,c=t.primaryPixelSizes,p=null===c||void 0===c?void 0:c[0],f=null!==p&&void 0!==p?p:l?{x:l.width/r.width,y:l.height/r.height}:{x:1,y:1};return(0,Wt.yg)(r,{zFactor:i,slopeType:o,pixelSizePower:s,pixelSizeFactor:a,isGCS:u,resolution:f})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.zFactor,r=t.slopeType,n=t.pixelSizeFactor,i=t.pixelSizePower;return{zFactor:this.isGCS&&e>=1?e*Wt._p:e,slopeType:r,pixelSizeFactor:null!==n&&void 0!==n?n:0,pixelSizePower:null!==i&&void 0!==i?i:0}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Kr.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:$r,json:{write:!0,name:"rasterFunctionArguments"}})],Kr.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Kr.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],Kr.prototype,"isGCS",void 0);var Yr,Qr=Kr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.SlopeFunction")],Kr),tn=new Xt.X({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});function en(t,e){var r=e.fillNoDataOnly,n=t.band,i=t.width,o=t.height,s=t.mask,a=t.outBand;if(!r||s){for(var u=e.statisticsType,l=e.kernelRows,c=e.kernelCols,p="stddev"===u,f=i*o,v=new Float64Array(f),d=new Float64Array(f),h=new Uint32Array(f),m=0;m<o;m++){for(var y=m*i,g=0,b=0,w=0,_=0;_<c;_++)s&&!s[y+_]||(g+=n[y+_],p&&(b+=Math.pow(n[y+_],2)),w++);v[y]=g,d[y]=b,h[y]=w;for(var x=1;x<=i-c;x++){var C=y+x-1,Z=C+c;s?(s[C]&&(w--,g-=n[C],p&&(b-=Math.pow(n[C],2))),s[Z]&&(w++,g+=n[Z],p&&(b+=Math.pow(n[Z],2)))):(g-=n[C],g+=n[Z],p&&(b-=Math.pow(n[C],2),b+=Math.pow(n[Z],2))),v[y+x]=g,h[y+x]=w,p&&(d[y+x]=b)}}for(var A=new Float64Array(f),k=new Float64Array(f),T=new Uint32Array(f),P=l*i,F=0;F<=i-c;F++){for(var N=0,I=0,R=0,j=0;j<l;j++){var B=j*i+F;N+=v[B],R+=h[B],p&&(I+=d[B])}A[F]=N,k[F]=I,T[F]=R;for(var S=1;S<=o-l;S++){var M=(S-1)*i+F,D=M+P;N-=v[M],N+=v[D],R-=h[M],R+=h[D],p&&(I-=d[M],I+=d[D]),A[S*i+F]=N,k[S*i+F]=I,T[S*i+F]=R}}for(var O=Math.floor(l/2),z=Math.floor(c/2),G=O;G<o-O;G++)for(var V=G*i,E=z;E<i-z;E++){var L=(G-O)*i+E-z,U=T[L];if(0!==U&&(!r||s&&!s[V+E])){var W=A[L]/U,J=p?Math.sqrt((k[L]-A[L]*W)/U):W;a[V+E]=J,s&&(s[V+E]=255)}}}else a.set(n)}function rn(t,e){var r=e.fillNoDataOnly,n=t.band,i=t.width,o=t.height,s=t.mask,a=t.outBand;if(!r||s){for(var u=e.kernelRows,l=e.kernelCols,c=e.statisticsType,p=Math.floor(u/2),f=Math.floor(l/2),v="min"===c,d=a.slice(),h=new Uint32Array(i*o),m=p;m<o-p;m++)for(var y=m*i,g=f;g<i-f;g++){for(var b=v?Number.MAX_VALUE:-Number.MAX_VALUE,w=0,_=0;_<u;_++)for(var x=0;x<l;x++){var C=y+g+(_-p)*i+x-f;s&&!s[C]||(b=v?Math.min(b,n[C]):Math.max(b,n[C]),w++)}s?(d[y+g]=0===w?0:b,h[y+g]=w):a[y+g]=0===w?0:b}if(s)for(var Z=p;Z<o-p;Z++)for(var A=Z*i,k=f;k<i-f;k++)if(h[A+k]){if(r&&s[A+k])continue;a[A+k]=d[A+k],s[A+k]=255}}else a.set(n)}function nn(t,e){var r=e.fillNoDataOnly,n=t.band,i=t.width,o=t.height,s=t.mask,a=t.outBand;if(!r||s){for(var u=e.kernelRows,l=e.kernelCols,c=Math.floor(u/2),p=Math.floor(l/2),f=a.slice(),v=new Uint32Array(i*o),d=c;d<o-c;d++)for(var h=d*i,m=p;m<i-p;m++)if(!r||null===s||void 0===s||!s[h+m]){for(var y=[],g=0;g<u;g++)for(var b=0;b<l;b++){var w=h+m+(g-c)*i+b-p;s&&!s[w]||y.push(n[w])}y.length&&(y.sort((function(t,e){return t-e})),s?(f[h+m]=y[Math.floor((y.length-1)/2)],v[h+m]=y.length):a[h+m]=y[Math.floor((y.length-1)/2)])}if(s)for(var _=c;_<o-c;_++)for(var x=_*i,C=p;C<i-p;C++)if(v[x+C]){if(r&&s[x+C])continue;a[x+C]=f[x+C],s[x+C]=255}}else a.set(n)}function on(t,e){var r=e.fillNoDataOnly,n=t.band,i=t.width,o=t.height,s=t.mask,a=t.outBand;if(!r||s){for(var u=e.kernelRows,l=e.kernelCols,c=Math.floor(u/2),p=Math.floor(l/2),f="majority"===e.statisticsType,v=u*l,d=a.slice(),h=new Uint32Array(i*o),m=c;m<o-c;m++)for(var y=m*i,g=p;g<i-p;g++)if(!r||null===s||void 0===s||!s[y+g]){for(var b=new Map,w=0;w<u;w++)for(var _=0;_<l;_++){var x=y+g+(w-c)*i+_-p;if(!s||s[x]){var C=n[x];b.set(C,b.has(C)?b.get(C)+1:1)}}if(0!==b.size){var Z,A=0,k=0,T=f?0:v+1,P=(0,F.Z)(b.keys());try{for(P.s();!(Z=P.n()).done;){var N=Z.value;f===(k=b.get(N))>T&&(T=k,A=N)}}catch(B){P.e(B)}finally{P.f()}s?(d[y+g]=A,h[y+g]=b.size):a[y+g]=A}}if(s)for(var I=c;I<o-c;I++)for(var R=I*i,j=p;j<i-p;j++)if(h[R+j]){if(r&&s[R+j])continue;a[R+j]=d[R+j],s[R+j]=255}}else a.set(n)}var sn=Yr=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).rows=3,t.cols=3,t.fillNoDataOnly=!1,t.statisticsType="min",t}return(0,l.Z)(r,[{key:"clone",value:function(){return new Yr({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:(0,s.d9)(this.raster)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0,read:{source:["kernelRows","rows"],reader:function(t,e){var r;return Number(null!==(r=null!==t&&void 0!==t?t:null===e||void 0===e?void 0:e.kernelRows)&&void 0!==r?r:3)}}}})],sn.prototype,"rows",void 0),(0,f._)([(0,v.Cb)({json:{write:!0,read:{source:["kernelCols","cols"],reader:function(t,e){var r;return Number(null!==(r=null!==t&&void 0!==t?t:null===e||void 0===e?void 0:e.kernelCols)&&void 0!==r?r:3)}}}})],sn.prototype,"cols",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],sn.prototype,"fillNoDataOnly",void 0),(0,f._)([(0,v.Cb)({json:{read:{source:["statisticsType","type"],reader:function(t,e){var r,n;return null!==(r=tn.fromJSON(null!==(n=null===e||void 0===e?void 0:e.statisticsType)&&void 0!==n?n:null===e||void 0===e?void 0:e.type))&&void 0!==r?r:"min"}},write:{target:"type"}}}),(0,qt.J)(tn)],sn.prototype,"statisticsType",void 0);var an=sn=Yr=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],sn),un=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Statistics",t.rasterArgumentNames=["raster"],t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.functionArguments.toJSON().type;if(t<1||t>7)return{success:!1,supportsGPU:!1,error:"statistics-function: the given statistics type is not supported ".concat(t)};var e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);var r=e.clone();return r.pixelType=this.outputPixelType,"stddev"===this.functionArguments.statisticsType&&this._removeStatsHistColormapVAT(r),this.rasterInfo=r,{success:!0,supportsGPU:r.bandCount<=3&&t<5}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return r;var n=this.functionArguments,i=n.statisticsType;return function(t,e){var r,n,i=t.mask,o=e.fillNoDataOnly;if(o&&!i)return t;var s=t.pixels,a=t.width,u=t.height,l=t.bandMasks,c=t.pixelType,p=s.length,f=a*u,v=[],d=e.kernelRows,h=e.kernelCols,m=e.statisticsType,y=e.mirrorEdges;if(o&&!i)return t;for(var g=null!==(r=e.outputPixelType)&&void 0!==r?r:c,b=[],w=0;w<p;w++){var _,x,C=s[w],A=Z.Z.createEmptyBand(g,f);o&&A.set(C);var k=null!==(_=null===l||void 0===l?void 0:l[w])&&void 0!==_?_:i,T=null!==(x=null===k||void 0===k?void 0:k.slice())&&void 0!==x?x:null,P={band:C,width:a,height:u,mask:T,outBand:A};switch(m){case"min":case"max":rn(P,e);break;case"mean":case"stddev":en(P,e);break;case"median":nn(P,e);break;case"majority":case"minority":on(P,e)}y&&!o&&tr(A,a,u,d,h),v.push(A),T&&b.push(T)}var F=null!==(n=b[0])&&void 0!==n?n:i;b.length!==p&&(b.length=0),p>1&&(null===l||void 0===l?void 0:l.length)&&(F=Z.Z.combineBandMasks(l));var N=new Z.Z({pixelType:g,width:a,height:u,pixels:v,bandMasks:l&&b.length?b:null,mask:F});return N.updateStatistics(),N}(r,{kernelRows:n.rows,kernelCols:n.cols,fillNoDataOnly:n.fillNoDataOnly,outputPixelType:this.outputPixelType,statisticsType:i,mirrorEdges:!0})}},{key:"_getWebGLParameters",value:function(){var t=this.functionArguments,e=t.rows,r=t.cols,n=t.statisticsType;return{fillNoDataOnly:t.fillNoDataOnly,kernelRows:e,kernelCols:r,statisticsType:n,clampRange:(0,h.rL)(this.outputPixelType)}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],un.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:an,json:{write:!0,name:"rasterFunctionArguments"}})],un.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],un.prototype,"rasterArgumentNames",void 0);var ln,cn=un=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.StatisticsFunction")],un),pn=ln=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).statistics=null,t.histograms=null,t}return(0,l.Z)(r,[{key:"readStatistics",value:function(t,e){if(null===t||void 0===t||!t.length)return null;var r=[];return t.forEach((function(t){var e,n,i={min:t.min,max:t.max,avg:null!==(e=t.avg)&&void 0!==e?e:t.mean,stddev:null!==(n=t.stddev)&&void 0!==n?n:t.standardDeviation};r.push(i)})),r}},{key:"writeStatistics",value:function(t,e,r){if(null!==t&&void 0!==t&&t.length){var i=[];t.forEach((function(t){var e=(0,n.Z)((0,n.Z)({},t),{},{mean:t.avg,standardDeviation:t.stddev});delete e.avg,delete e.stddev,i.push(e)})),e[r]=i}}},{key:"clone",value:function(){return new ln({statistics:(0,s.d9)(this.statistics),histograms:(0,s.d9)(this.histograms)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],pn.prototype,"statistics",void 0),(0,f._)([(0,xe.r)("statistics")],pn.prototype,"readStatistics",null),(0,f._)([(0,Be.c)("statistics")],pn.prototype,"writeStatistics",null),(0,f._)([(0,v.Cb)({json:{write:!0}})],pn.prototype,"histograms",void 0);var fn=pn=ln=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],pn),vn=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="StatisticsHistogram",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");var e=t.clone(),r=this.functionArguments,n=r.statistics,i=r.histograms;return i&&(e.histograms=i),n&&(e.statistics=n),this.rasterInfo=e,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],vn.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:fn,json:{write:!0,name:"rasterFunctionArguments"}})],vn.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],vn.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],vn.prototype,"indexedColormap",void 0),(0,f._)([(0,v.Cb)()],vn.prototype,"isNoopProcess",void 0);var dn,hn=vn=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],vn),mn=new Xt.X({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0}),yn=dn=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).computeGamma=!1,t.dynamicRangeAdjustment=!1,t.gamma=[],t.histograms=null,t.statistics=null,t.stretchType="none",t.useGamma=!1,t}return(0,l.Z)(r,[{key:"writeStatistics",value:function(t,e,r){var n;(null===(n=t)||void 0===n?void 0:n.length)&&(Array.isArray(t[0])||(t=t.map((function(t){return[t.min,t.max,t.avg,t.stddev]}))),e[r]=t)}},{key:"clone",value:function(){return new dn({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:(0,s.d9)(this.statistics),gamma:(0,s.d9)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:(0,s.d9)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}}]),r}(b);(0,f._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],yn.prototype,"computeGamma",void 0),(0,f._)([(0,v.Cb)({type:Boolean,json:{name:"dra",write:!0}})],yn.prototype,"dynamicRangeAdjustment",void 0),(0,f._)([(0,v.Cb)({type:[Number],json:{write:!0}})],yn.prototype,"gamma",void 0),(0,f._)([(0,v.Cb)()],yn.prototype,"histograms",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{write:!0}})],yn.prototype,"maxPercent",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{write:!0}})],yn.prototype,"minPercent",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{write:!0}})],yn.prototype,"numberOfStandardDeviations",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{name:"max",write:!0}})],yn.prototype,"outputMax",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{name:"min",write:!0}})],yn.prototype,"outputMin",void 0),(0,f._)([(0,v.Cb)({type:Number,json:{write:!0}})],yn.prototype,"sigmoidStrengthLevel",void 0),(0,f._)([(0,v.Cb)({json:{type:[[Number]],write:!0}})],yn.prototype,"statistics",void 0),(0,f._)([(0,Be.c)("statistics")],yn.prototype,"writeStatistics",null),(0,f._)([(0,qt.J)(mn)],yn.prototype,"stretchType",void 0),(0,f._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],yn.prototype,"useGamma",void 0);var gn=yn=dn=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],yn),bn=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Stretch",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.lookup=null,t.cutOffs=null,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){this.lookup=null,this.cutOffs=null;var t=this.sourceRasterInfos[0],e=t.pixelType,r=this.functionArguments,i=r.dynamicRangeAdjustment,o=r.gamma,s=r.useGamma;if(!i&&["u8","u16","s8","s16"].includes(e)){var a=(0,Ke.AV)(r.toJSON(),{rasterInfo:t}),u=(0,h.DV)(this.outputPixelType)?"round":"float";this.lookup=(0,Ke.hE)((0,n.Z)((0,n.Z)({pixelType:e},a),{},{gamma:s?o:null,rounding:u})),this.cutOffs=a}else i||(this.cutOffs=(0,Ke.AV)(r.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(e);var l=t.clone();l.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(l),"u8"===this.outputPixelType&&(l.keyProperties.DataType="processed");var c=this.functionArguments,p=c.outputMin,f=void 0===p?0:p,v=c.outputMax,d=void 0===v?255:v;l.statistics=[];for(var m=0;m<l.bandCount;m++)l.statistics[m]={min:f,max:d};return this.rasterInfo=l,{success:!0,supportsGPU:!i}}},{key:"_processPixels",value:function(t){var e,r=null===(e=t.pixelBlocks)||void 0===e?void 0:e[0];if(null==r)return r;var i=this.lookup;if(i)return(0,ne.XV)(r,(0,n.Z)((0,n.Z)({},i),{},{outputPixelType:this.rasterInfo.pixelType}));var o=this.functionArguments,s=this.cutOffs||(0,Ke.AV)(o.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r}),a=o.useGamma?o.gamma:null;return(0,Ke.dy)(r,(0,n.Z)((0,n.Z)({},s),{},{gamma:a,outputPixelType:this.outputPixelType}))}},{key:"_getWebGLParameters",value:function(){var t,e=this.functionArguments,r=e.outputMin,n=void 0===r?0:r,i=e.outputMax,o=void 0===i?255:i,s=e.gamma,a=e.useGamma,u=this.rasterInfo.bandCount>=2?3:1,l=a&&null!==s&&void 0!==s&&s.length?(0,Ke.um)(u,s):[1,1,1],c=null!==(t=this.cutOffs)&&void 0!==t?t:{minCutOff:[0,0,0],maxCutOff:[255,255,255]},p=c.minCutOff,f=c.maxCutOff;1===p.length&&(p[1]=p[2]=p[0],f[1]=f[2]=f[0]);var v,d=new Float32Array(u);for(v=0;v<u;v++)d[v]=(o-n)/(f[v]-p[v]);var m=(0,h.DV)(this.outputPixelType);return{bandCount:u,outMin:n,outMax:o,minCutOff:p,maxCutOff:f,factor:d,useGamma:a,gamma:a&&s?s:[1,1,1],gammaCorrection:a&&l?l:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:m,type:"stretch"}}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],bn.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:gn,json:{write:!0,name:"rasterFunctionArguments"}})],bn.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],bn.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],bn.prototype,"lookup",void 0),(0,f._)([(0,v.Cb)({json:{write:!0}})],bn.prototype,"cutOffs",void 0);var wn,_n=bn=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.StretchFunction")],bn),xn=wn=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).attributeTableAsRecordSet=null,t}return(0,l.Z)(r,[{key:"clone",value:function(){return new wn({attributeTableAsRecordSet:(0,s.d9)(this.attributeTableAsRecordSet)})}}]),r}(b);(0,f._)([(0,v.Cb)({json:{write:!0}})],xn.prototype,"attributeTableAsRecordSet",void 0);var Cn=xn=wn=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.TableFunctionArguments")],xn),Zn=function(t){(0,c.Z)(r,t);var e=(0,p.Z)(r);function r(){var t;return(0,u.Z)(this,r),(t=e.apply(this,arguments)).functionName="Table",t.functionArguments=null,t.rasterArgumentNames=["raster"],t.isNoopProcess=!0,t}return(0,l.Z)(r,[{key:"_bindSourceRasters",value:function(){var t=this.sourceRasterInfos[0];if(t.bandCount>1||t.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};if(!this.functionArguments.attributeTableAsRecordSet)return{success:!1,supportsGPU:!1,error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(t.pixelType);var e=t.clone();return e.pixelType=this.outputPixelType,e.bandCount=1,"thematic"!==e.dataType&&(e.keyProperties=e.keyProperties?(0,n.Z)((0,n.Z)({},e.keyProperties),{},{DataType:"thematic"}):{DataType:"thematic"}),this.rasterInfo=e,{success:!0,supportsGPU:!0}}},{key:"_processPixels",value:function(t){var e;return null===(e=t.pixelBlocks)||void 0===e?void 0:e[0]}}]),r}(P);(0,f._)([(0,v.Cb)({json:{write:!0,name:"rasterFunction"}})],Zn.prototype,"functionName",void 0),(0,f._)([(0,v.Cb)({type:Cn,json:{write:!0,name:"rasterFunctionArguments"}})],Zn.prototype,"functionArguments",void 0),(0,f._)([(0,v.Cb)()],Zn.prototype,"rasterArgumentNames",void 0),(0,f._)([(0,v.Cb)()],Zn.prototype,"isNoopProcess",void 0);var An=Zn=(0,f._)([(0,d.j)("esri.layers.support.rasterFunctions.TableFunction")],Zn),kn=new Map;function Tn(t,e){var r=t.rasterFunctionArguments;r&&(r.rasters||[r.raster,r.raster2]).forEach((function(t){t&&"number"!=typeof t&&("string"==typeof t?t.startsWith("http")&&(e.includes(t)||e.push(t)):"rasterFunctionArguments"in t&&Tn(t,e))}))}function Pn(t,e){var r;if(e=null!==(r=e)&&void 0!==r?r:{},"function"in(t=(0,s.d9)(t))&&"arguments"in t&&t.arguments){var n=Sn(t,new Map,e);if(Dn(n),!n.renderingRule)throw new o.Z("raster-function-helper","Unsupported raster function json.");t=n.renderingRule}if("rasterFunction"in t)return In(t=Nn(t),e);throw new o.Z("raster-function-helper","unsupported raster function json.")}function Fn(t){return!!(t&&"object"==typeof t&&t.rasterFunction&&t.rasterFunctionArguments)}function Nn(t){var e,r=t.rasterFunction,i=t.rasterFunctionArguments,o={};for(var s in i){var a=i[s],u=s.toLowerCase();if("rasters"===u&&Array.isArray(a))o.rasters=a.map((function(t){return Fn(t)?Nn(t):t}));else switch(Fn(a)&&(a=Nn(a)),u){case"dra":o.dra=a;break;case"pspower":o.psPower=a;break;case"pszfactor":o.psZFactor=a;break;case"bandids":o.bandIds=a;break;default:o[s[0].toLowerCase()+s.slice(1)]=a}}return"Local"!==r||null!==(e=o.rasters)&&void 0!==e&&e.length||(o.rasters=["$$"]),(0,n.Z)((0,n.Z)({},t),{},{rasterFunctionArguments:o})}function In(t,e){var r,i=t.rasterFunction,s=t.rasterFunctionArguments,a=null===(r=t.outputPixelType)||void 0===r?void 0:r.toLowerCase();if(null==i||!kn.has(i))throw new o.Z("raster-function-helper","unsupported raster function: ".concat(i));for(var u=kn.get(i),l=("function"==typeof u.ctor?u.ctor:u.ctor.default).fromJSON((0,n.Z)((0,n.Z)({},t),{},{outputPixelType:a})),c=l.rasterArgumentNames,p=[],f=function(t,e){return"rasters"===e[0]&&Array.isArray(t.rasters)?t.rasters:e.map((function(e){return t[e]}))}(s,c),v="rasters"===c[0]||c.length>1,d=[],h=0;h<f.length;h++){var m,y=f[h],g=void 0;null==y||"string"==typeof y&&y.startsWith("$")?p.push(null===e||void 0===e?void 0:e.raster):"string"==typeof y?e[y]&&p.push(e[y]):"number"!=typeof y&&"rasterFunction"in y&&(g=In(y,e),v||(l.functionArguments[c[h]]=g),p.push(g)),v&&d.push(null!==(m=g)&&void 0!==m?m:y)}if(v&&("rasters"===c[0]?l.functionArguments.rasters=d:c.forEach((function(t,e){l.functionArguments[t]=d[e]}))),e){var b;l.sourceRasters=p;var w=null===(b=e.raster)||void 0===b?void 0:b.url;w&&(l.mainPrimaryRasterId=w)}return l}function Rn(t,e){if(t&&e)for(var r in t){var n=t[r];n&&"object"==typeof n&&"type"in n&&("RasterFunctionTemplate"===n.type?Rn(n.arguments,e):"RasterFunctionVariable"===n.type&&null!=e[n.name]&&(n.value=e[n.name]))}}function jn(t,e){var r;if(!t||"object"!=typeof t)return t;var n=t.value;if(!n||"object"!=typeof n)return t.isDataset?"$$":n;if(Array.isArray(n))return 0===n.length?[]:n.map((function(t){return"object"==typeof t&&"RasterFunctionVariable"===t.type?jn(t,e):t}));if("value"in n&&["number","string","boolean"].includes(typeof n.value))return n.value;if(t.isDataset&&"Scalar"!==n.type)return"$$";if(!("type"in n))return n;var i=n;switch(n.type){case"Scalar":i=n.value;break;case"AlgorithmicColorRamp":i=Bn(n);break;case"MultiPartColorRamp":i={type:"multipart",colorRamps:n.ArrayOfColorRamp.map(Bn)};break;case"ArgumentArray":if(null!==(r=n.elements)&&void 0!==r&&r.length&&"RasterStatistics"!==n.elements[0].type){for(var s=[],a=0;a<n.elements.length;a++){var u=n.elements[a],l=u.type;if(l)if("RasterFunctionTemplate"===l){var c=Sn(u,e).renderingRule;s.push(c),null!=u._object_id&&e.set(u._object_id,c)}else{if("RasterFunctionVariable"!==l)throw new o.Z("raster-function-helper","unsupported raster function json.");var p=jn(u,e);s.push(p),null!=u._object_id&&e.set(u._object_id,p)}else s.push(u)}i=s}else i=n.elements}return null!=n._object_id&&e.set(n._object_id,i),i}function Bn(t){var e,r=null!==(e=t.algorithm)&&void 0!==e?e:"esriHSVAlgorithm",n=t.FromColor,o=t.ToColor;if(!Array.isArray(n)){var s=(0,i.xr)({h:n.Hue,s:n.Saturation,v:n.Value});n=[s.r,s.g,s.b,n.AlphaValue]}if(!Array.isArray(o)){var a=(0,i.xr)({h:o.Hue,s:o.Saturation,v:o.Value});o=[a.r,a.g,a.b,o.AlphaValue]}return{type:"algorithmic",algorithm:r,fromColor:n,toColor:o}}function Sn(t,e,r){r&&Rn(t,r);var n={renderingRule:{},templates:e};return Mn(t,n),n}function Mn(t,e){if(t&&e.renderingRule){var r=e.renderingRule,n=e.templates,i=t.function,o=t.arguments,s=t._object_id;if(i&&o){null!=s&&n.set(s,r),r.rasterFunction=i.type.replace("Function",""),r.outputPixelType=i.pixelType;var a={};for(var u in r.rasterFunctionArguments=a,o)if("type"!==u&&"object_id"!==u&&"_object_ref_id"!==u){var l=o[u];l&&"object"==typeof l&&"type"in l&&("RasterFunctionTemplate"===l.type||"RasterFunctionVariable"===l.type)?("RasterFunctionVariable"===l.type?a[u]=jn(l,n):(r.rasterFunctionArguments[u]={},Mn(l,{renderingRule:r.rasterFunctionArguments[u],templates:n})),null!=l._object_id&&n.set(l._object_id,a[u])):a[u]=l}switch(a.DEM&&!a.Raster&&(a.Raster=a.DEM,delete a.DEM),r.rasterFunction){case"Stretch":!function(t){var e;null!==(e=t.Statistics)&&void 0!==e&&e.length&&"object"==typeof t.Statistics&&(t.Statistics=t.Statistics.map((function(t){return[t.min,t.max,t.mean,t.standardDeviation]}))),null!=t.NumberOfStandardDeviation&&(t.NumberOfStandardDeviations=t.NumberOfStandardDeviation,delete t.NumberOfStandardDeviation)}(a);break;case"Colormap":!function(t){var e,r;"randomcolorramp"===(null===(e=t.ColorRamp)||void 0===e||null===(r=e.type)||void 0===r?void 0:r.toLowerCase())&&(delete t.ColorRamp,t.ColormapName="Random"),0===t.ColorSchemeType&&delete t.ColorRamp}(a);break;case"Convolution":!function(t){null!=t.ConvolutionType&&(t.Type=t.ConvolutionType,delete t.ConvolutionType)}(a);break;case"Mask":!function(t){var e;(null===(e=t.NoDataValues)||void 0===e?void 0:e.length)&&"string"==typeof t.NoDataValues[0]&&(t.NoDataValues=t.NoDataValues.filter((function(t){return""!==t})).map((function(t){return Number(t)})))}(a)}}}}function Dn(t){var e=t.renderingRule,r=t.templates;if("object"==typeof e&&null!==e&&void 0!==e&&e.rasterFunctionArguments&&r.size){var n=e.rasterFunctionArguments,i=function(t){var e=n[t],i="_object_ref_id"===t?e:e&&"object"==typeof e&&"_object_ref_id"in e?e._object_ref_id:null;if(null==i)e&&"object"==typeof e&&(e.rasterFunctionArguments&&Dn({renderingRule:e,templates:r}),Array.isArray(e)&&e.forEach((function(t,n){if("object"==typeof t)if(null!=t._object_ref_id){if(!r.has(t._object_ref_id))throw new o.Z("raster-function-helper","unsupported raster function json. _object_ref_id: ".concat(e," does not exist"));var s=r.get(i);s&&"object"==typeof s?Object.assign(t,s):e[n]=s}else Dn({renderingRule:t,templates:r})})));else{if(!r.has(i))throw new o.Z("raster-function-helper","unsupported raster function json. _object_ref_id: ".concat(i," does not exist"));var s=r.get(i);"_object_ref_id"!==t?n[t]=s:s&&"object"==typeof s&&Object.assign(n,s)}};for(var s in n)i(s)}}kn.set("Arithmetic",{desc:"Arithmetic Function",ctor:Et,rasterArgumentNames:["rasters"]}),kn.set("Aspect",{desc:"Aspect Function",ctor:Ht,rasterArgumentNames:["raster"]}),kn.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:ve,rasterArgumentNames:["raster"]}),kn.set("Colormap",{desc:"Colormap Function",ctor:je,rasterArgumentNames:["raster"]}),kn.set("CompositeBand",{desc:"CompositeBand Function",ctor:ze,rasterArgumentNames:["rasters"]}),kn.set("ComputeChange",{desc:"ComputeChange Function",ctor:qe,rasterArgumentNames:["rasters"]}),kn.set("Convolution",{desc:"Convolution Function",ctor:cr,rasterArgumentNames:["raster"]}),kn.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:Qe,rasterArgumentNames:["raster"]}),kn.set("ExtractBand",{desc:"ExtractBand Function",ctor:_r,rasterArgumentNames:["raster"]}),kn.set("Curvature",{desc:"Curvature Function",ctor:mr,rasterArgumentNames:["raster"]}),kn.set("Grayscale",{desc:"Grayscale Function",ctor:kr,rasterArgumentNames:["raster"]}),kn.set("Clip",{desc:"Clip Function",ctor:_e,rasterArgumentNames:["raster"]}),kn.set("Local",{desc:"Local Function",ctor:Ir,rasterArgumentNames:["rasters"]}),kn.set("Mask",{desc:"Mask Function",ctor:Dr,rasterArgumentNames:["raster"]}),kn.set("NDVI",{desc:"NDVI Function",ctor:Er,rasterArgumentNames:["raster"]}),kn.set("Remap",{desc:"Remap Function",ctor:Hr,rasterArgumentNames:["raster"]}),kn.set("Slope",{desc:"Slope Function",ctor:Qr,rasterArgumentNames:["raster"]}),kn.set("Statistics",{desc:"Focal Statistics Function",ctor:cn,rasterArgumentNames:["raster"]}),kn.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:hn,rasterArgumentNames:["raster"]}),kn.set("Stretch",{desc:"Stretch Function",ctor:_n,rasterArgumentNames:["raster"]}),kn.set("Table",{desc:"Attribute Table Function",ctor:An,rasterArgumentNames:["raster"]})},32935:function(t,e,r){r.d(e,{Z:function(){return f}});var n=r(15671),i=r(43144),o=r(60136),s=r(29388),a=r(27366),u=r(46784),l=r(49861),c=(r(93169),r(32718),r(84936),r(69912)),p=function(t){(0,o.Z)(r,t);var e=(0,s.Z)(r);function r(){return(0,n.Z)(this,r),e.apply(this,arguments)}return(0,i.Z)(r,[{key:"affectsPixelSize",get:function(){return!1}},{key:"forwardTransform",value:function(t){return t}},{key:"inverseTransform",value:function(t){return t}}]),r}(u.wq);(0,a._)([(0,l.Cb)()],p.prototype,"affectsPixelSize",null),(0,a._)([(0,l.Cb)({json:{write:!0}})],p.prototype,"spatialReference",void 0);var f=p=(0,a._)([(0,c.j)("esri.layers.support.rasterTransforms.BaseRasterTransform")],p)},3089:function(t,e,r){r.d(e,{Z:function(){return d}});var n,i=r(15671),o=r(43144),s=r(60136),a=r(29388),u=r(27366),l=r(49861),c=(r(93169),r(32718),r(84936),r(27135)),p=r(69912),f=r(32935),v=n=function(t){(0,s.Z)(r,t);var e=(0,a.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.apply(this,arguments)).type="gcs-shift",t.tolerance=1e-8,t}return(0,o.Z)(r,[{key:"forwardTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}},{key:"inverseTransform",value:function(t){return"point"===(t=t.clone()).type?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}},{key:"clone",value:function(){return new n({tolerance:this.tolerance})}}]),r}(f.Z);(0,u._)([(0,c.J)({GCSShiftXform:"gcs-shift"})],v.prototype,"type",void 0),(0,u._)([(0,l.Cb)()],v.prototype,"tolerance",void 0);var d=v=n=(0,u._)([(0,p.j)("esri.layers.support.rasterTransforms.GCSShiftTransform")],v)},69405:function(t,e,r){r.d(e,{Z:function(){return x}});var n,i=r(93433),o=r(15671),s=r(43144),a=r(60136),u=r(29388),l=r(29439),c=r(27366),p=(r(59486),r(49861)),f=(r(93169),r(32718),r(84936),r(27135)),v=r(38511),d=r(69912),h=r(31201),m=r(32935),y=r(848),g=r(53866);function b(t,e,r){var n=e.x,i=e.y;if(r<2)return{x:t[0]+n*t[2]+i*t[4],y:t[1]+n*t[3]+i*t[5]};if(2===r){var o=n*n,s=i*i,a=n*i;return{x:t[0]+n*t[2]+i*t[4]+o*t[6]+a*t[8]+s*t[10],y:t[1]+n*t[3]+i*t[5]+o*t[7]+a*t[9]+s*t[11]}}var u=n*n,l=i*i,c=n*i,p=u*n,f=u*i,v=n*l,d=i*l;return{x:t[0]+n*t[2]+i*t[4]+u*t[6]+c*t[8]+l*t[10]+p*t[12]+f*t[14]+v*t[16]+d*t[18],y:t[1]+n*t[3]+i*t[5]+u*t[7]+c*t[9]+l*t[11]+p*t[13]+f*t[15]+v*t[17]+d*t[19]}}function w(t,e,r){var n=e.xmin,i=e.ymin,o=e.xmax,s=e.ymax,a=e.spatialReference,u=[];if(r<2)u.push({x:n,y:s}),u.push({x:o,y:s}),u.push({x:n,y:i}),u.push({x:o,y:i});else{for(var l=10,c=0;c<l;c++)u.push({x:n,y:i+(s-i)*c/(l-1)}),u.push({x:o,y:i+(s-i)*c/(l-1)});l=8;for(var p=1;p<=l;p++)u.push({x:n+(o-n)*p/l,y:i}),u.push({x:n+(o-n)*p/l,y:s})}u=u.map((function(e){return b(t,e,r)}));var f=u.map((function(t){return t.x})),v=u.map((function(t){return t.y}));return new g.Z({xmin:Math.min.apply(null,f),xmax:Math.max.apply(null,f),ymin:Math.min.apply(null,v),ymax:Math.max.apply(null,v),spatialReference:a})}var _=n=function(t){(0,a.Z)(r,t);var e=(0,u.Z)(r);function r(){var t;return(0,o.Z)(this,r),(t=e.apply(this,arguments)).polynomialOrder=1,t.type="polynomial",t}return(0,s.Z)(r,[{key:"readForwardCoefficients",value:function(t,e){var r=e.coeffX,n=e.coeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var i=[],o=0;o<r.length;o++)i.push(r[o]),i.push(n[o]);return i}},{key:"writeForwardCoefficients",value:function(t,e,r){for(var n=[],i=[],o=0;o<(null===t||void 0===t?void 0:t.length);o++)o%2==0?n.push(t[o]):i.push(t[o]);e.coeffX=n,e.coeffY=i}},{key:"inverseCoefficients",get:function(){var t=this._get("inverseCoefficients"),e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=function(t){var e=(0,l.Z)(t,6),r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=i*a-s*o,c=s*o-i*a;return[(s*n-r*a)/u,(i*n-r*o)/c,a/u,o/c,-s/u,-i/c]}(e)),t},set:function(t){this._set("inverseCoefficients",t)}},{key:"readInverseCoefficients",value:function(t,e){var r=e.inverseCoeffX,n=e.inverseCoeffY;if(null===r||void 0===r||!r.length||null===n||void 0===n||!n.length||r.length!==n.length)return null;for(var i=[],o=0;o<r.length;o++)i.push(r[o]),i.push(n[o]);return i}},{key:"writeInverseCoefficients",value:function(t,e,r){for(var n=[],i=[],o=0;o<(null===t||void 0===t?void 0:t.length);o++)o%2==0?n.push(t[o]):i.push(t[o]);e.inverseCoeffX=n,e.inverseCoeffY=i}},{key:"affectsPixelSize",get:function(){return this.polynomialOrder>0}},{key:"forwardTransform",value:function(t){if("point"===t.type){var e=b(this.forwardCoefficients,t,this.polynomialOrder);return new y.Z({x:e.x,y:e.y,spatialReference:t.spatialReference})}return w(this.forwardCoefficients,t,this.polynomialOrder)}},{key:"inverseTransform",value:function(t){if("point"===t.type){var e=b(this.inverseCoefficients,t,this.polynomialOrder);return new y.Z({x:e.x,y:e.y,spatialReference:t.spatialReference})}return w(this.inverseCoefficients,t,this.polynomialOrder)}},{key:"clone",value:function(){return new n({polynomialOrder:this.polynomialOrder,forwardCoefficients:this.forwardCoefficients?(0,i.Z)(this.forwardCoefficients):null,inverseCoefficients:this.inverseCoefficients?(0,i.Z)(this.inverseCoefficients):null})}}]),r}(m.Z);(0,c._)([(0,p.Cb)({json:{write:!0}})],_.prototype,"polynomialOrder",void 0),(0,c._)([(0,p.Cb)()],_.prototype,"forwardCoefficients",void 0),(0,c._)([(0,v.r)("forwardCoefficients",["coeffX","coeffY"])],_.prototype,"readForwardCoefficients",null),(0,c._)([(0,h.c)("forwardCoefficients")],_.prototype,"writeForwardCoefficients",null),(0,c._)([(0,p.Cb)({json:{write:!0}})],_.prototype,"inverseCoefficients",null),(0,c._)([(0,v.r)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],_.prototype,"readInverseCoefficients",null),(0,c._)([(0,h.c)("inverseCoefficients")],_.prototype,"writeInverseCoefficients",null),(0,c._)([(0,p.Cb)()],_.prototype,"affectsPixelSize",null),(0,c._)([(0,f.J)({PolynomialXform:"polynomial"})],_.prototype,"type",void 0);var x=_=n=(0,c._)([(0,d.j)("esri.layers.support.rasterTransforms.PolynomialTransform")],_)}}]);
//# sourceMappingURL=33518.847c57bd.chunk.js.map