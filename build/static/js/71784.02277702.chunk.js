"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[71784],{15946:function(e,t,i){i.d(t,{Z:function(){return M}});var l,n=i(15671),s=i(43144),r=i(60136),o=i(29388),a=i(27366),u=i(46784),d=i(84652),v=i(49861),c=(i(93169),i(32718),i(69912)),h=i(28158),f=i(43404),p=i(25243),y=(i(84936),new f.X({slider:"slider",picker:"picker"})),m=l=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var l;return(0,n.Z)(this,i),(l=t.call(this,e)).interactionMode=null,l.numStops=null,l.stopInterval=null,l}return(0,s.Z)(i,[{key:"clone",value:function(){return new l({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}}]),i}(u.wq);(0,a._)([(0,v.Cb)({type:y.apiValues,nonNullable:!0,json:{type:y.jsonValues,default:null,read:{reader:y.read},write:{isRequired:!0,writer:y.write}}})],m.prototype,"interactionMode",void 0),(0,a._)([(0,v.Cb)({type:p.z8,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy:function(){var e=null!=this.stopInterval;return{enabled:!e,isRequired:!e}}}}})],m.prototype,"numStops",void 0),(0,a._)([(0,v.Cb)({type:Number,json:{write:{overridePolicy:function(){return{isRequired:null==this.numStops}}}}})],m.prototype,"stopInterval",void 0);var g,_=m=l=(0,a._)([(0,c.j)("esri.webdoc.widgets.Range")],m),b=i(64850),w=g=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var l;return(0,n.Z)(this,i),(l=t.call(this,e)).range=null,l.timeSlider=null,l.floorFilter=null,l}return(0,s.Z)(i,[{key:"clone",value:function(){return new g((0,d.d9)({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}}]),i}(u.wq);(0,a._)([(0,v.Cb)({type:_,json:{write:!0}})],w.prototype,"range",void 0),(0,a._)([(0,v.Cb)({type:b.Z,json:{write:!0}})],w.prototype,"timeSlider",void 0),(0,a._)([(0,v.Cb)({type:h.Z,json:{write:!0}})],w.prototype,"floorFilter",void 0);var M=w=g=(0,a._)([(0,c.j)("esri.webdoc.Widgets")],w)},28158:function(e,t,i){i.d(t,{Z:function(){return f}});var l,n=i(15671),s=i(43144),r=i(60136),o=i(29388),a=i(27366),u=i(46784),d=i(84652),v=i(49861),c=(i(93169),i(32718),i(69912)),h=l=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var l;return(0,n.Z)(this,i),(l=t.call(this,e)).enabled=!1,l.longNames=!1,l.minimized=!1,l.pinnedLevels=!1,l.site=null,l.facility=null,l.level=null,l}return(0,s.Z)(i,[{key:"clone",value:function(){return new l((0,d.d9)({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}}]),i}(u.wq);(0,a._)([(0,v.Cb)({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],h.prototype,"enabled",void 0),(0,a._)([(0,v.Cb)({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],h.prototype,"longNames",void 0),(0,a._)([(0,v.Cb)({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],h.prototype,"minimized",void 0),(0,a._)([(0,v.Cb)({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],h.prototype,"pinnedLevels",void 0),(0,a._)([(0,v.Cb)({type:String,json:{read:{source:"site"},write:{target:"site"}}})],h.prototype,"site",void 0),(0,a._)([(0,v.Cb)({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],h.prototype,"facility",void 0),(0,a._)([(0,v.Cb)({type:String,json:{read:{source:"level"},write:{target:"level"}}})],h.prototype,"level",void 0);var f=h=l=(0,a._)([(0,c.j)("esri.webdoc.widgets.FloorFilter")],h)},64850:function(e,t,i){i.d(t,{Z:function(){return w}});var l,n=i(15671),s=i(43144),r=i(60136),o=i(29388),a=i(27366),u=i(62044),d=i(12355),v=i(46784),c=i(84652),h=i(18202),f=i(49861),p=i(25243),y=i(38511),m=i(69912),g=i(31201),_=i(58359),b=l=function(e){(0,r.Z)(i,e);var t=(0,o.Z)(i);function i(e){var l;return(0,n.Z)(this,i),(l=t.call(this,e)).currentTimeExtent=null,l.fullTimeExtent=null,l.loop=!1,l.numStops=null,l.numThumbs=null,l.stopDelay=null,l.stopInterval=null,l.stops=null,l}return(0,s.Z)(i,[{key:"readCurrentTimeExtent",value:function(e){if(e){var t=null!=e[0]?new Date(e[0]):null,i=null!=e[1]?new Date(e[1]):null;return new u.Z({start:t,end:i})}}},{key:"writeCurrentTimeExtent",value:function(e,t,i){e&&(0,h.RB)(i,[null!=e.start?e.start.getTime():null,null!=e.end?e.end.getTime():null],t)}},{key:"readFullTimeExtent",value:function(e,t){var i=t.properties;if(i){var l=null!=i.endTime?new Date(i.endTime):null,n=null!=i.startTime?new Date(i.startTime):null;return new u.Z({start:n,end:l})}}},{key:"writeFullTimeExtent",value:function(e,t){if(e){var i=t.properties=t.properties||{},l=e.end,n=e.start;l&&(i.endTime=null!=l?l.getTime():null),n&&(i.startTime=null!=n?n.getTime():null)}}},{key:"readStopInterval",value:function(e,t,i){return e?d.Z.fromJSON({value:e.interval,unit:e.units},i):null}},{key:"writeStopInterval",value:function(e,t,i,l){if(e){var n=e.toJSON(l);(0,h.RB)("properties.timeStopInterval",{interval:n.value,units:n.unit},t)}}},{key:"readStops",value:function(e){return null!==e&&void 0!==e&&e.length?e.map((function(e){return new Date(e)})):null}},{key:"writeStops",value:function(e,t,i){(null===e||void 0===e?void 0:e.length)&&(0,h.RB)(i,e.map((function(e){return e.getTime()})),t)}},{key:"clone",value:function(){return new l((0,c.d9)({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}}]),i}(v.wq);(0,a._)([(0,f.Cb)({type:u.Z,json:{type:[[p.z8,p.p2]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],b.prototype,"currentTimeExtent",void 0),(0,a._)([(0,y.r)("currentTimeExtent")],b.prototype,"readCurrentTimeExtent",null),(0,a._)([(0,g.c)("currentTimeExtent")],b.prototype,"writeCurrentTimeExtent",null),(0,a._)([(0,f.Cb)({type:u.Z,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],b.prototype,"fullTimeExtent",void 0),(0,a._)([(0,y.r)("fullTimeExtent")],b.prototype,"readFullTimeExtent",null),(0,a._)([(0,g.c)("fullTimeExtent")],b.prototype,"writeFullTimeExtent",null),(0,a._)([(0,f.Cb)({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],b.prototype,"loop",void 0),(0,a._)([(0,f.Cb)({type:p.z8,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy:function(){var e,t=!!this.stopInterval,i=!(null===(e=this.stops)||void 0===e||!e.length),l=!(t||i);return{enabled:l,isRequired:l}}}}})],b.prototype,"numStops",void 0),(0,a._)([(0,f.Cb)({type:[1,2],nonNullable:!0,json:{type:p.z8,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],b.prototype,"numThumbs",void 0),(0,a._)([(0,f.Cb)({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],b.prototype,"stopDelay",void 0),(0,a._)([(0,f.Cb)({type:d.Z,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:_.v.jsonValues.filter((function(e){return"esriTimeUnitsUnknown"!==e}))}},overridePolicy:function(){var e,t=null!=this.numStops,i=!(null===(e=this.stops)||void 0===e||!e.length);return{enabled:!i,isRequired:!(t||i)}}}}})],b.prototype,"stopInterval",void 0),(0,a._)([(0,y.r)("stopInterval")],b.prototype,"readStopInterval",null),(0,a._)([(0,g.c)("stopInterval")],b.prototype,"writeStopInterval",null),(0,a._)([(0,f.Cb)({type:[Date],json:{type:[p.z8],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy:function(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],b.prototype,"stops",void 0),(0,a._)([(0,y.r)("stops")],b.prototype,"readStops",null),(0,a._)([(0,g.c)("stops")],b.prototype,"writeStops",null);var w=b=l=(0,a._)([(0,m.j)("esri.webdoc.widgets.TimeSlider")],b)},38675:function(e,t,i){function l(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass}i.d(t,{s:function(){return l}})},71784:function(e,t,i){i.r(t),i.d(t,{default:function(){return A}});var l=i(15671),n=i(43144),s=i(60136),r=i(29388),o=i(27366),a=(i(59166),i(94172)),u=i(49861),d=(i(93169),i(32718),i(84936),i(69912)),v=i(33565),c="esri-floor-filter",h="".concat(c,"__filter-menu"),f={floorFilter:c,floorFilterLayout:"".concat(c,"__layout--"),floorFilterPosition:"".concat(c,"__position--"),buttonContainer:"".concat(c,"__button-container"),buttonContainerLevels:"".concat(c,"__button-container--levels"),buttonInfo:"".concat(c,"__button-info"),buttonLabel:"".concat(c,"__button-label"),browseButton:"".concat(c,"__browse-button"),closeLevelsButton:"".concat(c,"__close-levels-button"),zoomButton:"".concat(c,"__zoom-button"),zoomButtonLevels:"".concat(c,"__zoom-button--levels"),minimizeToggleButton:"".concat(c,"__minimize-toggle-button"),levelsContainer:"".concat(c,"__levels-container"),levelButton:"".concat(c,"__level-button"),levelButtonActive:"".concat(c,"__level-button--active"),separator:"".concat(c,"__separator"),filterMenu:h,filterMenuHeader:"".concat(h,"-header"),filterMenuHeaderTextGroup:"".concat(h,"-header-text-group"),filterMenuHeaderText:"".concat(h,"-header-text"),filterMenuHeaderSubtext:"".concat(h,"-header-subtext"),filterMenuHeaderBack:"".concat(h,"-header-back"),filterMenuSearch:"".concat(h,"-search"),filterMenuSearchInput:"".concat(h,"-search-input"),filterMenuItems:"".concat(h,"-items"),filterMenuItemName:"".concat(h,"-item-name"),filterMenuSelectedItem:"".concat(h,"-item-name--selected"),filterMenuSite:"".concat(h,"-site"),filterMenuFacility:"".concat(h,"-facility"),selectedItemCircle:"".concat(c,"__selected-item-circle")},p=i(29439),y=i(74165),m=i(15861),g=i(7138),_=i(14921),b=i(80987),w=i(10064),M=i(66978),k=i(38499),I=i(15946),F=i(28158),T=i(38675);function L(e){return"esri.WebScene"===e.declaredClass}var x=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(e){var n;return(0,l.Z)(this,i),(n=t.call(this,e)).filterMenuOpen=!1,n.filterMenuType="site",n.filterMode="base-floors",n.levelsExpanded=!0,n.searchTerm=null,n.view=null,n._updateFloorFilterTask=null,n._viewHeightBreakpoint=null,n._viewWidthBreakpoint=null,n}return(0,n.Z)(i,[{key:"initialize",value:function(){var e=this;this.addHandles([(0,a.watch)((function(){var t;return null===(t=e.view)||void 0===t?void 0:t.map}),(function(t){null!=e._updateFloorFilterTask&&(e._updateFloorFilterTask.abort(),e._updateFloorFilterTask=null),e._updateFloorFilterTask=(0,_.vr)(function(){var i=(0,m.Z)((0,y.Z)().mark((function i(l){return(0,y.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e._updateFloorFilterFromMap(t);case 2:(0,M.k_)(l),e._setInitialViewState(t);case 4:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())}),a.initial),(0,a.watch)((function(){return e.view}),(function(t,i){e._unregisterWidget(i),e._registerWidget(t),e._watchSearchResults(t)}),a.syncAndInitial),(0,a.watch)((function(){var t,i;return null!==(t=null===(i=e.view)||void 0===i?void 0:i.widthBreakpoint)&&void 0!==t?t:null}),(function(t){e._viewWidthBreakpoint=t})),(0,a.watch)((function(){var t,i;return null!==(t=null===(i=e.view)||void 0===i?void 0:i.heightBreakpoint)&&void 0!==t?t:null}),(function(t){e._viewHeightBreakpoint=t}))])}},{key:"destroy",value:function(){this._unregisterWidget(this.view),this.view=null,null!=this._updateFloorFilterTask&&(this._updateFloorFilterTask.abort(),this._updateFloorFilterTask=null)}},{key:"enabled",set:function(e){this._callOverride("enabled",e)}},{key:"facility",set:function(e){if(e&&this._isOverridden("facility")){var t=this.getFacility(e);this.hasMultipleSites&&(this.site=(null===t||void 0===t?void 0:t.siteId)||null)}this._callOverride("facility",e)}},{key:"filterFeatures",set:function(e){this._callOverride("filterFeatures",e)}},{key:"filterLayers",set:function(e){this._callOverride("filterLayers",e)}},{key:"hasFacilities",get:function(){var e,t,i,l;return null!=(null===(e=this.filterLayers)||void 0===e?void 0:e.facilityLayer)&&(null===(t=this.filterFeatures)||void 0===t||null===(i=t.facilities)||void 0===i||null===(l=i.facilitiesInfo)||void 0===l?void 0:l.length)>0}},{key:"hasLevels",get:function(){var e,t,i,l;return null!=(null===(e=this.filterLayers)||void 0===e?void 0:e.levelLayer)&&(null===(t=this.filterFeatures)||void 0===t||null===(i=t.levels)||void 0===i||null===(l=i.levelsInfo)||void 0===l?void 0:l.length)>0}},{key:"hasMultipleSites",get:function(){var e,t,i,l;return null!=(null===(e=this.filterLayers)||void 0===e?void 0:e.siteLayer)&&(null===(t=this.filterFeatures)||void 0===t||null===(i=t.sites)||void 0===i||null===(l=i.sitesInfo)||void 0===l?void 0:l.length)>1}},{key:"isNormalMode",get:function(){var e=!0,t=this._viewWidthBreakpoint;return"xsmall"!==this._viewHeightBreakpoint&&"xsmall"!==t||(e=!1),e}},{key:"level",set:function(e){var t,i,l;if(!e)return this._callOverride("level",e),this.facility=null,this.site=null,void this.setFloors(null);var n=null,s=null,r=null===e||void 0===e?void 0:e.split("--");if((null===r||void 0===r?void 0:r.length)>1&&"all"===r[0]?n={id:e,facilityId:s=r[1],shortName:null,longName:null,levelNumber:null,verticalOrder:null}:s=null!==(t=null===(i=n=this.getLevel(e))||void 0===i?void 0:i.facilityId)&&void 0!==t?t:null,this.level!==e||this.isNormalMode||this.levelsExpanded)n&&this.hasFacilities&&this.hasLevels?(this.facility=s,this.hasMultipleSites&&(this.site=(null===(l=this.getFacility(s))||void 0===l?void 0:l.siteId)||null),this.setFloors(n)):this._isOverridden("level")&&(this.facility=null,this.site=null,this.hasMultipleSites&&(this.filterMenuType="site"),this.setFloors(null)),this._callOverride("level",e);else{var o=this.getFacilityLevels(s);(null===o||void 0===o?void 0:o.length)>1&&(this.levelsExpanded=!0)}}},{key:"longNames",set:function(e){this._callOverride("longNames",e)}},{key:"minimized",set:function(e){this._callOverride("minimized",e)}},{key:"pinnedLevels",set:function(e){this._callOverride("pinnedLevels",e)}},{key:"site",set:function(e){this._callOverride("site",e)}},{key:"state",get:function(){return this.view&&this.filterFeatures&&this.hasFacilities&&this.hasLevels?"ready":this.view&&!this.filterFeatures?"loading":"disabled"}},{key:"filterFacilities",value:function(e){var t=this,i=e;return this.searchTerm&&(this.searchTerm=this.searchTerm.trim(),i=e.filter((function(e){var i;return e.name.toLowerCase().includes(null===(i=t.searchTerm)||void 0===i?void 0:i.toLowerCase())}))),this.site&&(i=i.filter((function(e){return e.siteId===t.site}))),i.sort((function(e,t){var i=e.name,l=t.name;return i.localeCompare(l,void 0,{sensitivity:"base"})}))}},{key:"filterSites",value:function(e){var t=this,i=e;return this.searchTerm&&(this.searchTerm=this.searchTerm.trim(),i=e.filter((function(e){var i;return e.name.toLowerCase().includes(null===(i=t.searchTerm)||void 0===i?void 0:i.toLowerCase())}))),i.sort((function(e,t){var i=e.name,l=t.name;return i.localeCompare(l,void 0,{sensitivity:"base"})}))}},{key:"getBaseLevel",value:function(e){var t,i,l=null===(t=this.filterFeatures)||void 0===t||null===(i=t.levels)||void 0===i?void 0:i.levelsInfo,n=null;if(e){var s=e.id;if(l&&l.length>0&&(l.forEach((function(e){0===e.verticalOrder&&e.facilityId===s&&(n=e)})),!n)){var r=null;l.forEach((function(e){var t,i;e.facilityId===s&&(r?(null!==(t=e.verticalOrder)&&void 0!==t?t:0)>=0?null!=r.verticalOrder&&(r.verticalOrder<0||(null!==(i=e.verticalOrder)&&void 0!==i?i:0)<r.verticalOrder)&&(r=e):null!=r.verticalOrder&&null!=e.verticalOrder&&r.verticalOrder<0&&e.verticalOrder>r.verticalOrder&&(r=e):r=e)})),r&&(n=r)}}return n}},{key:"getFacility",value:function(e){var t,i,l,n;return null!==(t=null===(i=this.filterFeatures)||void 0===i||null===(l=i.facilities)||void 0===l||null===(n=l.facilitiesInfo)||void 0===n?void 0:n.find((function(t){return t.id===e})))&&void 0!==t?t:null}},{key:"getFacilityLevels",value:function(e){var t,i;return e&&null!==(t=this.filterFeatures)&&void 0!==t&&null!==(i=t.levels)&&void 0!==i&&i.levelsInfo?this.filterFeatures.levels.levelsInfo.filter((function(t){return t.facilityId===e})).sort((function(e,t){var i,l,n=null!==(i=e.verticalOrder)&&void 0!==i?i:0,s=null!==(l=t.verticalOrder)&&void 0!==l?l:0;return n>s?-1:n===s?0:1})):[]}},{key:"getLevel",value:function(e){var t,i,l,n;return null!==(t=null===(i=this.filterFeatures)||void 0===i||null===(l=i.levels)||void 0===l||null===(n=l.levelsInfo)||void 0===n?void 0:n.find((function(t){return t.id===e})))&&void 0!==t?t:null}},{key:"getSite",value:function(e){var t,i,l,n;return null!==(t=null===(i=this.filterFeatures)||void 0===i||null===(l=i.sites)||void 0===l||null===(n=l.sitesInfo)||void 0===n?void 0:n.find((function(t){return t.id===e})))&&void 0!==t?t:null}},{key:"goTo",value:function(e){if(this.view&&e){var t=e.geometry;t&&t.extent&&this.callGoTo({target:t.extent,options:{duration:(0,k.HA)(1e3),easing:"in-out-quad"}})}}},{key:"setFloors",value:function(e){var t,i,l=this,n=this.view;n&&(null!==n&&void 0!==n&&null!==(t=n.map)&&void 0!==t&&null!==(i=t.allLayers)&&void 0!==i&&i.forEach((function(e){"feature"===e.type&&l._computeViewAllModeFloors(e)})),n.floors=new b.Z(this._computeFloors(e)))}},{key:"updateWebDocument",value:function(e){if((0,T.s)(e)){var t,i,l,n=new F.Z({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:null!==(t=this.site)&&void 0!==t?t:null,facility:null!==(i=this.facility)&&void 0!==i?i:null,level:null!==(l=this.level)&&void 0!==l?l:null});e.widgets?e.widgets.floorFilter=n:e.widgets=new I.Z({floorFilter:n})}}},{key:"_computeFloors",value:function(e){var t;if("single-floor"===this.filterMode)this._computeSingleFloor(e);else if("base-floors"===this.filterMode)return"3d"===(null===(t=this.view)||void 0===t?void 0:t.type)?this._computeBaseFloors3D(e):this._computeBaseFloors(e);return this._computeEmptyFloors()}},{key:"_computeSingleFloor",value:function(e){if(!e)return this._computeEmptyFloors();var t=[];return"all"===(null===e||void 0===e?void 0:e.id)?this.getFacilityLevels(e.facilityId).forEach((function(e){e.id&&t.push(e.id)})):e&&t.push(e.id),t}},{key:"_computeBaseFloors",value:function(e){var t,i,l=null===(t=this.filterFeatures)||void 0===t||null===(i=t.levels)||void 0===i?void 0:i.levelsInfo;if(null===l||void 0===l||!l.length)return this._computeEmptyFloors();var n=[];"all"===(null===e||void 0===e?void 0:e.id)?this.getFacilityLevels(e.facilityId).forEach((function(e){e.id&&n.push(e.id)})):e&&n.push(e.id);var s=null===e||void 0===e?void 0:e.facilityId;return l.forEach((function(e){var t=e.id,i=e.facilityId,l=e.verticalOrder;(s||0!==l||n.includes(t))&&(i===s||0!==l||n.includes(t))||n.push(t)})),n}},{key:"_computeBaseFloors3D",value:function(e){var t,i,l,n=null===(t=this.filterFeatures)||void 0===t||null===(i=t.levels)||void 0===i?void 0:i.levelsInfo;if(null===n||void 0===n||!n.length)return this._computeEmptyFloors();var s=[],r=null!==(l=null===e||void 0===e?void 0:e.id.split("--"))&&void 0!==l?l:[];(null===r||void 0===r?void 0:r.length)>1&&"all"===r[0]?this.getFacilityLevels(null===e||void 0===e?void 0:e.facilityId).forEach((function(e){e.id&&s.push(e.id)})):e&&s.push(e.id);var o=null===e||void 0===e?void 0:e.facilityId;return n.forEach((function(e){var t=e.id,i=e.facilityId;(o||s.includes(t))&&(i===o||s.includes(t))||s.push(t)})),s}},{key:"_computeEmptyFloors",value:function(){return[]}},{key:"_setFilterLayers",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(){var t,i,l,n,s,r,o,a,u,d,v,c,h,f,p,m,g,_,b,M,k,I,F,x,C,S,N,B,Z,O,z,E;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.view)||this._isOverridden("filterLayers")){e.next=16;break}if((0,T.s)(t.map)||L(t.map)){e.next=4;break}throw new w.Z("Map must be a webmap or webscene");case 4:if(l=t.map,!((null===(n=null===l||void 0===l?void 0:l.allLayers)||void 0===n||null===(i=n.items)||void 0===i?void 0:i.length)>0)){e.next=16;break}if(g={siteLayer:null,facilityLayer:null,levelLayer:null},_=null===(s=l.floorInfo)||void 0===s||null===(r=s.siteLayer)||void 0===r?void 0:r.layerId,b=null===(o=l.floorInfo)||void 0===o||null===(a=o.facilityLayer)||void 0===a?void 0:a.layerId,M=null===(u=l.floorInfo)||void 0===u||null===(d=u.levelLayer)||void 0===d?void 0:d.layerId,k=(null===(v=l.floorInfo)||void 0===v||null===(c=v.siteLayer)||void 0===c?void 0:c.sublayerId)||(null===(h=l.floorInfo)||void 0===h||null===(f=h.facilityLayer)||void 0===f?void 0:f.sublayerId)||(null===(p=l.floorInfo)||void 0===p||null===(m=p.levelLayer)||void 0===m?void 0:m.sublayerId),b&&M){e.next=9;break}return e.abrupt("return");case 9:if(I=n.items.filter((function(e){return"feature"===e.type||"scene"===e.type})),F=n.items.filter((function(e){return"map-image"===e.type})),!((null===F||void 0===F?void 0:F.length)>0&&k)){e.next=15;break}return e.next=13,Promise.all(F.map((function(e){return e.load()})));case 13:O=null===(x=l.floorInfo)||void 0===x||null===(C=x.siteLayer)||void 0===C?void 0:C.sublayerId,z=null===(S=l.floorInfo)||void 0===S||null===(N=S.facilityLayer)||void 0===N?void 0:N.sublayerId,E=null===(B=l.floorInfo)||void 0===B||null===(Z=B.levelLayer)||void 0===Z?void 0:Z.sublayerId,F.forEach((function(e){var t=e.id,i=null===e||void 0===e?void 0:e.allSublayers,l=null===i||void 0===i?void 0:i.items;(t===_||t===b||t===M)&&(null===l||void 0===l?void 0:l.length)>0&&i.items.forEach((function(e){var i=e.id;t===_&&i===O?g.siteLayer=e:i===z?g.facilityLayer=e:i===E&&(g.levelLayer=e)}))}));case 15:(null===I||void 0===I?void 0:I.length)>0&&I.forEach((function(e){var t=e.id;t===_?g.siteLayer=e:t===b?g.facilityLayer=e:t===M&&(g.levelLayer=e)})),this.filterLayers=g;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFilterFeatures",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(){var t,i,l,n,s;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isOverridden("filterFeatures")){e.next=2;break}return e.abrupt("return",this.filterFeatures);case 2:return e.next=4,Promise.all([this._getSites(),this._getFacilities(),this._getLevels()]);case 4:return t=e.sent,i=(0,p.Z)(t,3),l=i[0],n=i[1],s=i[2],e.abrupt("return",{sites:l,facilities:n,levels:s});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getSites",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(){var t,i,l,n,s,r,o,a,u,d,v,c,h,f,p,m,g;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l={sitesInfo:[]},n=this.filterLayers,s=this.view,r=null===s||void 0===s?void 0:s.map,(o=n.siteLayer)&&null!==r&&void 0!==r&&null!==(t=r.floorInfo)&&void 0!==t&&t.siteLayer){e.next=3;break}return e.abrupt("return",l);case 3:return(a=o.createQuery()).returnGeometry=!0,a.outFields=["*"],a.returnZ=!0,"type"in o&&"scene"===o.type&&(a.multipatchOption="xyFootprint"),u=r.floorInfo.siteLayer,d=u.siteIdField,v=u.nameField,e.next=10,o.queryFeatures(a);case 10:return(null===(c=e.sent)||void 0===c||null===(i=c.features)||void 0===i?void 0:i.length)>0&&(p=c.features,m=(null===o||void 0===o||null===(h=o.fieldsIndex.get(d))||void 0===h?void 0:h.name)||d,g=(null===o||void 0===o||null===(f=o.fieldsIndex.get(v))||void 0===f?void 0:f.name)||v,null!=m&&null!=g&&p.forEach((function(e){var t=e.attributes,i=e.geometry,n=t[m],s=t[g];n&&s&&l.sitesInfo.push({id:n,name:s,geometry:i})}))),e.abrupt("return",l);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getFacilities",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(){var t,i,l,n,s,r,o,a,u,d,v,c,h,f,p,m,g,_,b,w;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=this.filterLayers,n=this.view,s=null===n||void 0===n?void 0:n.map,r=l.facilityLayer,o={facilitiesInfo:[]},r&&null!==s&&void 0!==s&&null!==(t=s.floorInfo)&&void 0!==t&&t.facilityLayer){e.next=3;break}return e.abrupt("return",o);case 3:return(a=r.createQuery()).returnGeometry=!0,a.outFields=["*"],a.returnZ=!0,"type"in r&&"scene"===r.type&&(a.multipatchOption="xyFootprint"),u=s.floorInfo.facilityLayer,d=u.facilityIdField,v=u.siteIdField,c=u.nameField,e.next=11,r.queryFeatures(a);case 11:return(null===(h=e.sent)||void 0===h||null===(i=h.features)||void 0===i?void 0:i.length)>0&&(g=h.features,_=(null===r||void 0===r||null===(f=r.fieldsIndex.get(d))||void 0===f?void 0:f.name)||d,b=(null===r||void 0===r||null===(p=r.fieldsIndex.get(v))||void 0===p?void 0:p.name)||v,w=(null===r||void 0===r||null===(m=r.fieldsIndex.get(c))||void 0===m?void 0:m.name)||c,_&&b&&w&&g.forEach((function(e){var t=e.attributes,i=e.geometry,l=t[_],n=t[b],s=t[w];l&&s&&o.facilitiesInfo.push({id:l,siteId:n,name:s,geometry:i})}))),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getLevels",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(){var t,i,l,n,s,r,o,a,u,d,v,c,h,f,p,m,g,_,b,w,M,k,I,F,T,L,x,C,S;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=this.filterLayers,n=this.view,s=null===n||void 0===n?void 0:n.map,r=l.levelLayer,o={levelsInfo:[]},r&&null!==s&&void 0!==s&&null!==(t=s.floorInfo)&&void 0!==t&&t.levelLayer){e.next=3;break}return e.abrupt("return",o);case 3:return(a=r.createQuery()).returnGeometry=!0,a.outFields=["*"],a.returnZ=!0,u=s.floorInfo.levelLayer,d=u.levelIdField,v=u.facilityIdField,c=u.longNameField,h=u.shortNameField,f=u.levelNumberField,p=u.verticalOrderField,e.next=14,r.queryFeatures(a);case 14:return(null===(m=e.sent)||void 0===m||null===(i=m.features)||void 0===i?void 0:i.length)>0&&(I=m.features,F=(null===r||void 0===r||null===(g=r.fieldsIndex.get(d))||void 0===g?void 0:g.name)||d,T=(null===r||void 0===r||null===(_=r.fieldsIndex.get(v))||void 0===_?void 0:_.name)||v,L=(null===r||void 0===r||null===(b=r.fieldsIndex.get(c))||void 0===b?void 0:b.name)||c,x=(null===r||void 0===r||null===(w=r.fieldsIndex.get(h))||void 0===w?void 0:w.name)||h,C=(null===r||void 0===r||null===(M=r.fieldsIndex.get(f))||void 0===M?void 0:M.name)||f,S=(null===r||void 0===r||null===(k=r.fieldsIndex.get(p))||void 0===k?void 0:k.name)||p,F&&T&&L&&x&&C&&S&&I.forEach((function(e){var t=e.attributes,i=t[F],l=t[T],n=t[L],s=t[x],r=t[C],a=t[S];i&&l&&n&&s&&"number"==typeof r&&"number"==typeof a&&o.levelsInfo.push({id:i,facilityId:l,longName:n,shortName:s,levelNumber:r,verticalOrder:a})}))),e.abrupt("return",o);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_registerWidget",value:function(e){(null===e||void 0===e?void 0:e.persistableViewModels.includes(this))||null===e||void 0===e||e.persistableViewModels.add(this)}},{key:"_unregisterWidget",value:function(e){null===e||void 0===e||e.persistableViewModels.remove(this)}},{key:"_watchSearchResults",value:function(e){var t=this;null===e||void 0===e||e.on("select-result-floor",(function(e){var i=t.getLevel(e);i&&t.level!==e&&(t.level=e,t.setFloors(i))}))}},{key:"_setInitialViewState",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(t){var i,l,n,s,r,o,a,u,d;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.view){e.next=46;break}return e.prev=1,e.next=4,this.view.when();case 4:return e.next=6,this._setFilterLayers();case 6:return e.next=8,this._getFilterFeatures();case 8:if(i=e.sent){e.next=11;break}return e.abrupt("return");case 11:if(this.filterFeatures=i,this.hasFacilities&&this.hasLevels){e.next=13;break}return e.abrupt("return",void console.error("Facilities and Levels are required for the Floor Filter widget"));case 13:if(this.hasMultipleSites||(this.filterMenuType="facility"),!this.facility||!this.level){e.next=19;break}this.filterMenuType="facility",l=this.getFacility(this.facility),n=this.getLevel(this.level),this.site||(this.site=(null===l||void 0===l?void 0:l.siteId)||void 0),this.setFloors(n),e.next=41;break;case 19:if(!this.facility||this.level){e.next=25;break}this.filterMenuType="facility",s=this.getFacility(this.facility),r=this.getBaseLevel(s),this.site||(this.site=(null===s||void 0===s?void 0:s.siteId)||void 0),this.level=(null===r||void 0===r?void 0:r.id)||void 0,this.setFloors(r),e.next=41;break;case 25:if(this.facility||!this.level){e.next=31;break}this.filterMenuType="facility",o=this.getLevel(this.level),a=this.getFacility(null===o||void 0===o?void 0:o.facilityId),this.facility=(null===a||void 0===a?void 0:a.id)||void 0,this.site||(this.site=(null===a||void 0===a?void 0:a.siteId)||void 0),this.setFloors(o),e.next=41;break;case 31:if(this.site&&!this.facility&&!this.level){e.next=40;break}if(t&&(0,T.s)(t)){e.next=34;break}return e.abrupt("return",void this.setFloors(null));case 34:if(d=null===t||void 0===t||null===(u=t.widgets)||void 0===u?void 0:u.floorFilter){e.next=37;break}return e.abrupt("return",void this.setFloors(null));case 37:d.site&&!this.site&&(this.site=d.site,this.filterMenuType="facility"),this.setFloors(null),e.next=41;break;case 40:this.filterMenuType="site",this.setFloors(null);case 41:e.next=46;break;case 43:e.prev=43,e.t0=e.catch(1),console.error("Couldn't retrieve sites, facilities, and levels",e.t0);case 46:case"end":return e.stop()}}),e,this,[[1,43]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_callOverride",value:function(e,t){this._override(e,t)}},{key:"_updateFloorFilterFromMap",value:function(){var e=(0,m.Z)((0,y.Z)().mark((function e(t){var i,l;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(0,T.s)(t)){e.next=2;break}return e.abrupt("return");case 2:(l=null===t||void 0===t||null===(i=t.widgets)||void 0===i?void 0:i.floorFilter)&&(this._isOverridden("enabled")||(this.enabled=l.enabled),this._isOverridden("longNames")||(this.longNames=l.longNames),this._isOverridden("minimized")||(this.minimized=l.minimized),this._isOverridden("pinnedLevels")||(this.pinnedLevels=l.pinnedLevels),this._isOverridden("site")||(this.site=l.site),this._isOverridden("facility")||(this.facility=l.facility),this._isOverridden("level")||(this.level=l.level));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_computeViewAllModeFloors",value:function(e){var t,i=this.filterFeatures;if(null!==(t=e.floorInfo)&&void 0!==t&&t.viewAllMode&&this.hasLevels&&this.hasFacilities&&"base-floors"===this.filterMode){var l=this.level,n=this.facility,s=[];i.levels.levelsInfo.forEach((function(e){var t=e.id,i=e.facilityId;n&&i===n?l&&t===l&&s.push(t):s.push(t)})),e.floorInfo.viewAllLevelIds=new b.Z(s)}}}]),i}((0,i(99505)._)(g.default));(0,o._)([(0,u.Cb)({value:!1})],x.prototype,"enabled",null),(0,o._)([(0,u.Cb)({value:void 0})],x.prototype,"facility",null),(0,o._)([(0,u.Cb)({value:null})],x.prototype,"filterFeatures",null),(0,o._)([(0,u.Cb)({value:null})],x.prototype,"filterLayers",null),(0,o._)([(0,u.Cb)()],x.prototype,"filterMenuOpen",void 0),(0,o._)([(0,u.Cb)()],x.prototype,"filterMenuType",void 0),(0,o._)([(0,u.Cb)()],x.prototype,"filterMode",void 0),(0,o._)([(0,u.Cb)()],x.prototype,"hasFacilities",null),(0,o._)([(0,u.Cb)()],x.prototype,"hasLevels",null),(0,o._)([(0,u.Cb)()],x.prototype,"hasMultipleSites",null),(0,o._)([(0,u.Cb)({readOnly:!0})],x.prototype,"isNormalMode",null),(0,o._)([(0,u.Cb)({value:void 0})],x.prototype,"level",null),(0,o._)([(0,u.Cb)({value:!1})],x.prototype,"longNames",null),(0,o._)([(0,u.Cb)()],x.prototype,"levelsExpanded",void 0),(0,o._)([(0,u.Cb)({value:!1})],x.prototype,"minimized",null),(0,o._)([(0,u.Cb)({value:!1})],x.prototype,"pinnedLevels",null),(0,o._)([(0,u.Cb)()],x.prototype,"searchTerm",void 0),(0,o._)([(0,u.Cb)({value:void 0})],x.prototype,"site",null),(0,o._)([(0,u.Cb)({readOnly:!0})],x.prototype,"state",null),(0,o._)([(0,u.Cb)()],x.prototype,"view",void 0),(0,o._)([(0,u.Cb)()],x.prototype,"_viewHeightBreakpoint",void 0),(0,o._)([(0,u.Cb)()],x.prototype,"_viewWidthBreakpoint",void 0),(0,o._)([(0,u.Cb)()],x.prototype,"updateWebDocument",null);var C=x=(0,o._)([(0,d.j)("esri.widgets.FloorFilter.FloorFilterViewModel")],x),S=i(7021),N=i(96919),B=i(33095),Z=i(80975),O=i(80532),z=i(67005),E=i(8704),W=new Set(["ArrowUp","ArrowDown","End","Home"]),j=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(e,n){var s;return(0,l.Z)(this,i),(s=t.call(this,e,n))._activeMenu=null,s._activeMenuIndex={levels:-1,menuItems:-1},s._baseNode=null,s._facilitiesListNode=null,s._levelsListNode=null,s._sitesListNode=null,s._searchInput=null,s.viewModel=new C,s.messages=null,s.messagesCommon=null,s.headingLevel=2,s._resizeObserver=new ResizeObserver((function(){return s.scheduleRender()})),s.addHandles((0,a.watch)((function(){return s._searchInput}),(function(){return s._focusSearch()}))),s}return(0,n.Z)(i,[{key:"destroy",value:function(){var e;null===(e=this._resizeObserver)||void 0===e||e.disconnect()}},{key:"enabled",get:function(){return this.viewModel.enabled},set:function(e){this.viewModel.enabled=e}},{key:"longNames",get:function(){return this.viewModel.longNames},set:function(e){this.viewModel.longNames=e}},{key:"minimized",get:function(){return this.viewModel.minimized},set:function(e){this.viewModel.minimized=e}},{key:"pinnedLevels",get:function(){return this.viewModel.pinnedLevels},set:function(e){this.viewModel.pinnedLevels=e}},{key:"site",get:function(){return this.viewModel.site},set:function(e){this.viewModel.site=e}},{key:"facility",get:function(){return this.viewModel.facility},set:function(e){this.viewModel.facility=e}},{key:"level",get:function(){return this.viewModel.level},set:function(e){this.viewModel.level=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(e){this.viewModel.goToOverride=e}},{key:"icon",get:function(){return"floor-plan"},set:function(e){this._overrideIfSome("icon",e)}},{key:"updateWebDocument",value:function(e){return this.viewModel.updateWebDocument(e)}},{key:"render",value:function(){var e,t=this.longNames&&this.viewModel.isNormalMode?"expanded":"collapsed",i=this._renderButtons(),l=this._renderFilterMenu(),n=(0,z.u)("div",{class:this.classes(f.separator)}),s=this._getComponentPosition(),r=this._getPosition(s),o="top-right"===s||"bottom-right"===s,a="top-left"===s||"bottom-left"===s,u=(0,Z.dZ)(this.container),d=u&&a||!u&&o?l:i,v=u&&a||!u&&o?i:l;return(0,z.u)("div",{afterCreate:this._afterBaseNodeCreate,class:this.classes(f.floorFilter,S.z.widget,"".concat(f.floorFilterLayout).concat(t),"".concat(f.floorFilterPosition).concat(r)),key:"floor-filter-menu"},d,null!==(e=this.viewModel)&&void 0!==e&&e.filterMenuOpen?n:null,v)}},{key:"_renderButtons",value:function(){var e=this._getComponentPosition(),t=[];return"top"===this._getPosition(e)?(t.push(this._renderBrowseButton()),t.push(this._renderLevelButtons()),t.push(this._renderCloseLevelsButton()),t.push(this._renderZoomButton()),t.push(this._renderCollapseToggleButton())):(t.push(this._renderCollapseToggleButton()),t.push(this._renderZoomButton()),t.push(this._renderCloseLevelsButton()),t.push(this._renderLevelButtons()),t.push(this._renderBrowseButton())),(0,z.u)("div",{class:this.classes(S.z.widget,f.buttonContainer),key:"button-container"},t)}},{key:"_renderBrowseButton",value:function(){var e,t=this.longNames,i=this.messages;return(0,z.u)("button",{"aria-expanded":this.viewModel.filterMenuOpen.toString(),"aria-label":i.buttons.browse,bind:this,class:this.classes(S.z.widget,S.z.widgetButton,S.z.interactive,("loading"===this.viewModel.state||"disabled"===this.viewModel.state)&&S.z.buttonDisabled,f.browseButton,(null===(e=this.viewModel)||void 0===e?void 0:e.filterMenuOpen)&&S.z.widgetButtonActive),key:"browse-button",onclick:this._toggleFilterMenu,title:i.buttons.browse,type:"button"},(0,z.u)("div",{class:this.classes(f.buttonInfo)},(0,z.u)("span",{class:this.classes(B.W.icon,B.W.urbanModel)}),(0,z.u)("span",{class:this.classes(f.buttonLabel)},t&&this.viewModel.isNormalMode?i.buttons.browse:null)))}},{key:"_renderLevelButtons",value:function(){var e,t,i,l,n,s,r=this;if(null===(e=this.viewModel)||void 0===e||null===(t=e.filterFeatures)||void 0===t||null===(i=t.levels)||void 0===i||!i.levelsInfo||!this.facility)return null;var o=this.facility,a=this.messagesCommon,u=this.messages,d=null===(l=this.viewModel)||void 0===l?void 0:l.getFacility(o),v=(null===(n=this.viewModel)||void 0===n?void 0:n.getFacilityLevels(o)).map((function(e){return r._renderLevelButton(e)}));if(!v.length)return null;var c=d&&(0,E.n)(u.selector.levelsLabel,{name:'"'.concat(d.name,'"')});if(this._isWebScene(null===(s=this.view)||void 0===s?void 0:s.map)&&(null===v||void 0===v?void 0:v.length)>1){var h={id:"all--".concat(o),facilityId:o,shortName:a.all,longName:a.all,levelNumber:null,verticalOrder:null},p=this._renderLevelButton(h);v.push(p)}return(0,z.u)("ul",{afterCreate:Z.Yo,"aria-label":c,bind:this,class:this.classes(f.levelsContainer),"data-id":"levels","data-node-ref":"_levelsListNode",key:"levels-button-container",onkeydown:this._handleListKeydown},v)}},{key:"_renderLevelButton",value:function(e){var t=this.longNames,i=e.shortName,l=e.longName,n=e.id,s="levels--".concat(n),r=this.level===n,o=t&&this.viewModel.isNormalMode?l:i;return this.viewModel.isNormalMode||r||this.viewModel.levelsExpanded?(0,z.u)("li",{key:s},(0,z.u)("button",{bind:this,class:this.classes(S.z.widgetButton,r?S.z.widgetButtonActive:null,S.z.interactive,f.levelButton),"data-id":n,"data-list-id":"levels",onclick:this._levelSelected,onfocus:this._onItemFocus,type:"button"},o)):null}},{key:"_renderCloseLevelsButton",value:function(){if(!this.level||this.viewModel.isNormalMode||!this.viewModel.levelsExpanded)return null;var e=this.messagesCommon;return(0,z.u)("button",{"aria-label":e.close,bind:this,class:this.classes(S.z.widget,S.z.widgetButton,S.z.interactive,f.closeLevelsButton),key:"close-levels-button",onclick:this._closeLevels,title:e.close,type:"button"},(0,z.u)("div",{class:this.classes(f.buttonInfo)},(0,z.u)("span",{class:this.classes(B.W.icon,B.W.close)})))}},{key:"_renderZoomButton",value:function(){var e,t,i,l,n,s=this.longNames,r=this.messages,o=this.facility,a=this.site,u=null===(e=this.viewModel)||void 0===e?void 0:e.filterMenuType,d=null===(t=this.viewModel)||void 0===t?void 0:t.filterMenuOpen,v=null===(i=this.viewModel)||void 0===i?void 0:i.getSite(a),c=null===(l=this.viewModel)||void 0===l?void 0:l.getFacility(o),h="site"===u&&d?!v:!c;return(0,z.u)("button",{"aria-label":r.buttons.zoomTo,bind:this,class:this.classes(S.z.widget,S.z.widgetButton,h&&S.z.buttonDisabled,S.z.interactive,(null===(n=this.viewModel)||void 0===n?void 0:n.getFacilityLevels(o).length)>0?f.zoomButtonLevels:f.zoomButton),key:"zoom-button",onclick:this._zoomToClicked,title:r.buttons.zoomTo,type:"button"},(0,z.u)("div",{class:this.classes(f.buttonInfo)},(0,z.u)("span",{class:this.classes(B.W.icon,B.W.zoomToObject)}),(0,z.u)("span",{class:this.classes(f.buttonLabel)},s&&this.viewModel.isNormalMode?r.buttons.zoomTo:null)))}},{key:"_renderCollapseToggleButton",value:function(){var e=this.longNames,t=this.messagesCommon,i=e?B.W.collapse:B.W.expand,l=this.classes(B.W.icon,i),n=e?t.collapse:t.expand;return(0,z.u)("button",{"aria-label":n,bind:this,class:this.classes(S.z.widget,S.z.widgetButton,S.z.interactive,f.minimizeToggleButton),key:"minimize-toggle-button",onclick:this._toggleCollapsed,title:n,type:"button"},(0,z.u)("div",{class:this.classes(f.buttonInfo)},(0,z.u)("span",{class:l}),(0,z.u)("span",{class:this.classes(f.buttonLabel)},e&&this.viewModel.isNormalMode?t.collapse:null)))}},{key:"_renderFilterMenu",value:function(){var e,t,i;return null!==(e=this.viewModel)&&void 0!==e&&e.filterMenuOpen?"site"===(null===(t=this.viewModel)||void 0===t?void 0:t.filterMenuType)?this._renderSiteFilterMenu():"facility"===(null===(i=this.viewModel)||void 0===i?void 0:i.filterMenuType)?this._renderFacilityFilterMenu():null:null}},{key:"_renderSiteFilterMenu",value:function(){var e,t,i=this.messages,l=this.messagesCommon,n=this.site?null===(e=this.viewModel)||void 0===e||null===(t=e.getSite(this.site))||void 0===t?void 0:t.name:i.selector.selectSite,s=(0,z.u)("div",{class:this.classes("".concat(f.filterMenuHeader)),key:"filter-menu-site-header"},(0,z.u)("div",{class:this.classes(f.filterMenuHeaderTextGroup)},(0,z.u)(N.X,{class:this.classes(f.filterMenuHeaderText),level:this.headingLevel},n)),(0,z.u)("button",{bind:this,class:this.classes(B.W.icon,B.W.close),onclick:this._closeClicked,title:l.close,type:"button"})),r=this._renderSearchInput(),o=this._renderSiteItems();return(0,z.u)("div",{class:this.classes(f.filterMenu),key:"filter-menu-site"},s,r,o)}},{key:"_renderFacilityFilterMenu",value:function(){var e,t,i,l,n=this.messages,s=this.messagesCommon,r=this.site,o=null===(e=this.viewModel)||void 0===e||null===(t=e.getSite(r))||void 0===t?void 0:t.name,a=this.facility&&(null===(i=this.viewModel)||void 0===i||null===(l=i.getFacility(this.facility))||void 0===l?void 0:l.name)||n.selector.selectFacility,u=this.viewModel.hasMultipleSites?(0,z.u)("button",{bind:this,class:this.classes(f.filterMenuHeaderBack),onclick:this._backClicked,title:s.back,type:"button"},(0,z.u)("span",{class:this.classes((0,Z.dZ)(this.container)?B.W.right:B.W.left)})):null,d=this.viewModel.hasMultipleSites?(0,z.u)(N.X,{class:this.classes(f.filterMenuHeaderSubtext),level:(0,N.M)(this.headingLevel)},o):null,v=(0,z.u)("div",{class:this.classes(f.filterMenuHeader),key:"filter-menu-site-header"},u,(0,z.u)("div",{class:this.classes(f.filterMenuHeaderTextGroup)},(0,z.u)(N.X,{class:this.classes(f.filterMenuHeaderText),level:this.headingLevel},a),d),(0,z.u)("button",{bind:this,class:this.classes(B.W.icon,B.W.close),onclick:this._closeClicked,title:s.close,type:"button"})),c=this._renderSearchInput(),h=this._renderFacilityItems();return(0,z.u)("div",{class:this.classes(f.filterMenu),key:"filter-menu-facility"},v,c,h)}},{key:"_renderSearchInput",value:function(){var e,t=this.messagesCommon;return(0,z.u)("div",{class:this.classes(f.filterMenuSearch),key:"filter-menu-search"},(0,z.u)("span",{class:this.classes(B.W.icon,B.W.search)}),(0,z.u)("input",{afterCreate:Z.Yo,bind:this,class:this.classes(f.filterMenuSearchInput),"data-node-ref":"_searchInput",oninput:this._onSearchChange,onpaste:this._onSearchChange,placeholder:t.search,value:null!==(e=this.viewModel.searchTerm)&&void 0!==e?e:void 0}))}},{key:"_renderBlueCircle",value:function(){return(0,z.u)("span",{class:this.classes(f.selectedItemCircle),key:"floor-filter__selected-item-circle"})}},{key:"_renderSiteItems",value:function(){var e,t,i,l,n=this;if(null===(e=this.viewModel)||void 0===e||null===(t=e.filterFeatures)||void 0===t||null===(i=t.sites)||void 0===i||!i.sitesInfo)return null;var s=this.messages,r=this.viewModel.filterFeatures.sites.sitesInfo,o=this.viewModel.filterSites(r).map((function(e){return n._renderSiteItem(e)})),a=0===o.length&&(null===(l=this.viewModel)||void 0===l?void 0:l.searchTerm)&&(0,z.u)("div",{class:this.classes(S.z.empty)},s.noResults);return(0,z.u)("ul",{afterCreate:Z.Yo,"aria-label":s.selector.sitesLabel,bind:this,class:this.classes(f.filterMenuItems),"data-id":"sites","data-node-ref":"_sitesListNode",key:"filter-menu-items--sites",onkeydown:this._handleListKeydown,tabIndex:-1},o,a)}},{key:"_renderSiteItem",value:function(e){var t=e.name,i=e.id,l="filter-menu-site--".concat(i),n=this.site===i;return(0,z.u)("li",{key:l},(0,z.u)("button",{bind:this,class:this.classes(f.filterMenuSite),"data-id":i,"data-list-id":"sites",onclick:this._siteSelected,onfocus:this._onItemFocus,type:"button"},n?this._renderBlueCircle():null,(0,z.u)("span",{class:this.classes(n?f.filterMenuSelectedItem:f.filterMenuItemName)},t),(0,z.u)("span",{class:this.classes((0,Z.dZ)(this.container)?B.W.left:B.W.right)})))}},{key:"_renderFacilityItems",value:function(){var e,t,i,l,n=this;if(null===(e=this.viewModel)||void 0===e||null===(t=e.filterFeatures)||void 0===t||null===(i=t.facilities)||void 0===i||!i.facilitiesInfo)return null;var s=this.messages,r=this.site,o=this.viewModel.getSite(r),a=this.viewModel.filterFeatures.facilities.facilitiesInfo,u=this.viewModel.filterFacilities(a).map((function(e){return n._renderFacilityItem(e)})),d=0===u.length&&(null===(l=this.viewModel)||void 0===l?void 0:l.searchTerm)&&(0,z.u)("div",{class:this.classes(S.z.empty)},s.noResults),v=o?(0,E.n)(s.selector.siteFacilitiesLabel,{name:'"'.concat(o.name,'"')}):s.selector.facilitiesLabel;return(0,z.u)("ul",{afterCreate:Z.Yo,"aria-label":v,bind:this,class:this.classes(f.filterMenuItems),"data-id":"facilities","data-node-ref":"_facilitiesListNode",key:"filter-menu-items--facilities",onkeydown:this._handleListKeydown,tabIndex:-1},u,d)}},{key:"_renderFacilityItem",value:function(e){var t=e.name,i=e.id,l="filter-menu-facility--".concat(i),n=this.facility===i;return(0,z.u)("li",{key:l},(0,z.u)("button",{bind:this,class:this.classes(f.filterMenuFacility),"data-id":i,"data-list-id":"facilities",onclick:this._facilitySelected,onfocus:this._onItemFocus,type:"button"},n?this._renderBlueCircle():null,(0,z.u)("span",{class:this.classes(n?f.filterMenuSelectedItem:f.filterMenuItemName)},t)))}},{key:"_afterBaseNodeCreate",value:function(e){var t,i;this._baseNode&&null!==(t=this._resizeObserver)&&void 0!==t&&t.unobserve(this._baseNode),this._baseNode=e,null===(i=this._resizeObserver)||void 0===i||i.observe(this._baseNode)}},{key:"_toggleCollapsed",value:function(){this.longNames=!this.longNames}},{key:"_toggleFilterMenu",value:function(){var e,t,i=null!==(e=null===(t=this.viewModel)||void 0===t?void 0:t.filterMenuOpen)&&void 0!==e&&e;this.viewModel.filterMenuOpen=!i}},{key:"_setFilterMenuType",value:function(e){this.viewModel.filterMenuType=e}},{key:"_zoomToClicked",value:function(){var e,t;if(this.site&&"site"===(null===(e=this.viewModel)||void 0===e?void 0:e.filterMenuType)&&null!==(t=this.viewModel)&&void 0!==t&&t.filterMenuOpen){var i,l=null===(i=this.viewModel)||void 0===i?void 0:i.getSite(this.site);this.viewModel.goTo(l)}else if(this.facility){var n,s=null===(n=this.viewModel)||void 0===n?void 0:n.getFacility(this.facility);this.viewModel.goTo(s)}else if(this.site){var r,o=null===(r=this.viewModel)||void 0===r?void 0:r.getSite(this.site);this.viewModel.goTo(o)}}},{key:"_onSearchChange",value:function(e){var t,i=e.target;""===i.value?this.viewModel.searchTerm=null:i.value&&(null===(t=this.viewModel)||void 0===t?void 0:t.searchTerm)!==i.value&&(this.viewModel.searchTerm=i.value)}},{key:"_closeClicked",value:function(){this.viewModel.searchTerm=null,this.viewModel.filterMenuOpen=!1}},{key:"_backClicked",value:function(){this._setFilterMenuType("site"),this.viewModel.searchTerm=null}},{key:"_siteSelected",value:function(e){var t=e.currentTarget.getAttribute("data-id"),i=this.viewModel.getSite(t),l=!1;this.site!==t&&(this.facility=null,this.level=null,l=!0,this.viewModel.levelsExpanded=!1),this.site=t,this.viewModel.searchTerm=null,this._setFilterMenuType("facility"),this.viewModel.goTo(i),l&&this.viewModel.setFloors(null)}},{key:"_facilitySelected",value:function(e){var t=this,i=e.currentTarget.getAttribute("data-id"),l=this.viewModel.getFacility(i),n=!1;if(this.facility!==i){if("base-floors"===this.viewModel.filterMode){var s,r=null===(s=this.viewModel)||void 0===s?void 0:s.getBaseLevel(l);this.level=r?r.id:null}else this.level=null;n=!0,this.viewModel.levelsExpanded=!1}if(this.facility=i,this.viewModel.goTo(l),n){var o=this.viewModel.getLevel(this.level);this.viewModel.setFloors(o)}if(!this.viewModel.isNormalMode){var a=this.viewModel.getFacilityLevels(i);(null===a||void 0===a?void 0:a.length)>1&&(this.viewModel.levelsExpanded=!0)}setTimeout((function(){return t._focusActiveLevel()}),50)}},{key:"_levelSelected",value:function(e){var t=e.currentTarget.getAttribute("data-id");this.level=t}},{key:"_closeLevels",value:function(){this.viewModel.levelsExpanded=!1}},{key:"_isWebScene",value:function(e){return"esri.WebScene"===(null===e||void 0===e?void 0:e.declaredClass)}},{key:"_getComponentPosition",value:function(){var e,t;return null!=this.container?null===(e=this.view)||void 0===e||null===(t=e.ui)||void 0===t?void 0:t.getPosition(this.container):null}},{key:"_getPosition",value:function(e){switch(e){case"bottom-right":case"bottom-left":return"bottom";default:return"top"}}},{key:"_handleListKeydown",value:function(e){var t=e.currentTarget.getAttribute("data-id"),i=null;"sites"===t||"facilities"===t?(this._activeMenu!==t&&(this._activeMenuIndex.menuItems=-1),this._activeMenu=t,i="menuItems"):"levels"===t&&(i="levels");var l="sites"===t?this._sitesListNode:"facilities"===t?this._facilitiesListNode:"levels"===t?this._levelsListNode:null,n=e.key,s="Tab"===n,r=W.has(n);r&&e.preventDefault();var o=null===l||void 0===l?void 0:l.getElementsByTagName("li");o&&0!==o.length&&(r||s)&&this._handleItemNavigation(n,e.shiftKey,o,s,i)}},{key:"_handleItemNavigation",value:function(e,t,i,l,n){if(n){this._activeMenuIndex[n]===i.length&&this._activeMenuIndex[n]--,-1===this._activeMenuIndex[n]&&this._activeMenuIndex[n]++;var s=this._activeMenuIndex[n];switch(e){case"Home":this._activeMenuIndex[n]=0;break;case"End":this._activeMenuIndex[n]=i.length-1;break;case"ArrowUp":this._activeMenuIndex[n]=this._activeMenuIndex[n]<=0?i.length-1:this._activeMenuIndex[n]-1;break;case"ArrowDown":this._activeMenuIndex[n]=this._activeMenuIndex[n]===i.length-1?0:this._activeMenuIndex[n]+1}if("Tab"===e&&t&&this._activeMenuIndex[n]>=0&&this._activeMenuIndex[n]--,"Tab"===e&&!t&&this._activeMenuIndex[n]<i.length&&this._activeMenuIndex[n]++,s!==this._activeMenuIndex[n]&&this._activeMenuIndex[n]>-1&&this._activeMenuIndex[n]<i.length&&!l){var r=i[this._activeMenuIndex[n]].getElementsByTagName("button"),o=1===(null===r||void 0===r?void 0:r.length)?r[0]:null;null===o||void 0===o||o.focus()}}}},{key:"_focusSearch",value:function(){var e;null===(e=this._searchInput)||void 0===e||e.focus()}},{key:"_focusActiveLevel",value:function(){var e,t=this,i=this.level,l=this._levelsListNode,n=null===l||void 0===l?void 0:l.getElementsByTagName("li");if(i&&l&&n){var s=null===(e=this._facilitiesListNode)||void 0===e?void 0:e.getElementsByTagName("li");this._activeMenuIndex.menuItems=s?s.length-1:-1;for(var r=[],o=0;o<n.length;o++){var a=n[o].getElementsByTagName("button");1===(null===a||void 0===a?void 0:a.length)&&r.push(a[0])}r.forEach((function(e,l){e.getAttribute("data-id")===i&&(e.focus(),t._activeMenuIndex.levels=l)}))}}},{key:"_onItemFocus",value:function(e){var t=this,i=e.currentTarget,l=i.getAttribute("data-list-id"),n=i.getAttribute("data-id"),s="sites"===l?this._sitesListNode:"facilities"===l?this._facilitiesListNode:"levels"===l?this._levelsListNode:null;if(s){var r=null===s||void 0===s?void 0:s.getElementsByTagName("li");if(r){var o=[];Array.from(r).forEach((function(e){var t=e.getElementsByTagName("button");1===(null===t||void 0===t?void 0:t.length)&&o.push(t[0])}));var a=null;switch(l){case"sites":case"facilities":a="menuItems";break;case"levels":a="levels"}if(a){var u=a;o.forEach((function(e,i){e.getAttribute("data-id")===n&&t._activeMenuIndex[u]!==i&&(t._activeMenuIndex[u]=i)}))}}}}}]),i}(v.Z);(0,o._)([(0,u.Cb)()],j.prototype,"_searchInput",void 0),(0,o._)([(0,u.Cb)()],j.prototype,"enabled",null),(0,o._)([(0,u.Cb)()],j.prototype,"longNames",null),(0,o._)([(0,u.Cb)()],j.prototype,"minimized",null),(0,o._)([(0,u.Cb)()],j.prototype,"pinnedLevels",null),(0,o._)([(0,u.Cb)()],j.prototype,"site",null),(0,o._)([(0,u.Cb)()],j.prototype,"facility",null),(0,o._)([(0,u.Cb)()],j.prototype,"level",null),(0,o._)([(0,u.Cb)()],j.prototype,"view",null),(0,o._)([(0,u.Cb)({type:C})],j.prototype,"viewModel",void 0),(0,o._)([(0,u.Cb)(),(0,O.H)("esri/widgets/FloorFilter/t9n/FloorFilter")],j.prototype,"messages",void 0),(0,o._)([(0,u.Cb)(),(0,O.H)("esri/t9n/common")],j.prototype,"messagesCommon",void 0),(0,o._)([(0,u.Cb)()],j.prototype,"goToOverride",null),(0,o._)([(0,u.Cb)()],j.prototype,"headingLevel",void 0),(0,o._)([(0,u.Cb)()],j.prototype,"icon",null);var A=j=(0,o._)([(0,d.j)("esri.widgets.FloorFilter")],j)},99505:function(e,t,i){i.d(t,{_:function(){return v}});var l=i(15671),n=i(43144),s=i(60136),r=i(29388),o=i(27366),a=i(92026),u=i(49861),d=(i(93169),i(32718),i(84936),i(69912)),v=function(e){var t=function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){var e;(0,l.Z)(this,i);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).goToOverride=null,e.view=null,e}return(0,n.Z)(i,[{key:"callGoTo",value:function(e){var t=this.view;return(0,a.O3)(t),this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}}]),i}(e);return(0,o._)([(0,u.Cb)()],t.prototype,"goToOverride",void 0),(0,o._)([(0,u.Cb)()],t.prototype,"view",void 0),t=(0,o._)([(0,d.j)("esri.widgets.support.GoTo")],t)}},96919:function(e,t,i){i.d(t,{M:function(){return c},X:function(){return d}});var l=i(1413),n=i(44925),s=i(16889),r=i(7021),o=i(80975),a=i(67005),u=["level","class"];function d(e,t){var i=e.level,s=e.class,d=(0,n.Z)(e,u),c=v(i);return(0,a.u)("h".concat(c),(0,l.Z)((0,l.Z)({},d),{},{"aria-level":String(c),class:(0,o.Sh)(r.z.heading,s),role:"heading"}),t)}function v(e){return(0,s.uZ)(Math.ceil(e),1,6)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return v(e+t)}},7021:function(e,t,i){i.d(t,{z:function(){return l}});var l={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"}},33095:function(e,t,i){i.d(t,{W:function(){return l}});var l={checkMark:"esri-icon-check-mark",close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",loadingIndicator:"esri-icon-loading-indicator",locateCircled:"esri-icon-locate-circled",minus:"esri-icon-minus",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"}}}]);
//# sourceMappingURL=71784.02277702.chunk.js.map