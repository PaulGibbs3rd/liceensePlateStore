"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[37608],{76432:function(e,n,t){t.d(n,{t:function(){return l}});var r=t(15671),i=t(43144),a=t(84652),o=t(39052),u=t(56885),s=function(){function e(n,t){(0,r.Z)(this,e),this._observable=new u.s,this._value=n,this._equalityFunction=t}return(0,i.Z)(e,[{key:"value",get:function(){return(0,o.it)(this._observable),this._value},set:function(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}},{key:"mutate",value:function(e){e(this._value),this._observable.notify()}}]),e}();function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.y7;return new s(e,n)}},34311:function(e,n,t){function r(e,n,t){return{objectId:e,target:n,distance:t,type:"vertex"}}function i(e,n,t,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return{objectId:e,target:n,distance:t,type:"edge",start:r,end:i,draped:a}}t.d(n,{p:function(){return i},u:function(){return r}})},63543:function(e,n,t){t.d(n,{Dm:function(){return d},Hq:function(){return y},MS:function(){return v},bU:function(){return l}});var r=t(4942),i=t(1413),a=t(93169),o=t(84652),u=t(60480),s=t(76115);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.I4:"esriGeometryPolyline"===e?s.ET:s.lF}}}var c=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,p=1;function d(e,n){if((0,a.Z)("esri-csp-restrictions"))return function(){return(0,i.Z)((0,r.Z)({},n,null),e)};try{var t="this".concat(f(n)," = null;");for(var o in e)t+="this".concat(f(o)," = ").concat(JSON.stringify(e[o]),";");var u=new Function("\n      return class AttributesClass$".concat(p++," {\n        constructor() {\n          ").concat(t,";\n        }\n      }\n    "))();return function(){return new u}}catch(s){return function(){return(0,i.Z)((0,r.Z)({},n,null),e)}}}function f(e){return c.test(e)?".".concat(e):'["'.concat(e,'"]')}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,o.d9)(e)}}]}function v(e,n){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:n,supportsDelete:n,supportsEditing:n,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:n,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:u.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:n,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},50568:function(e,n,t){t.d(n,{Qc:function(){return A},Fd:function(){return q},TD:function(){return R},Cn:function(){return j},zS:function(){return M},WZ:function(){return D}});var r=t(29439),i=t(37762),a=t(74165),o=t(15861),u=t(15671),s=t(43144),l=t(97326),c=t(60136),p=t(29388),d=t(27366),f=(t(59486),t(7138)),y=t(10064),v=t(32718),h=t(77427),m=t(76672),b=t(49861),g=(t(93169),t(84936),t(69912)),T=t(80885),w=t(79803),k=t(92975),Z=t(83406),I=t(3182),x=t(77981),_=function(){function e(){(0,u.Z)(this,e),this._featureLookup=new Map}return(0,s.Z)(e,[{key:"deleteFromStore",value:function(e){var n=this;e.forEach((function(e){n._featureLookup.delete(e)}))}},{key:"readFromStoreByList",value:function(e){var n=this,t=[];return e.forEach((function(e){var r=n.readFromStoreById(e);r&&t.push(r)})),t}},{key:"readFromStoreById",value:function(e){var n;return null!==(n=this._featureLookup.get(e))&&void 0!==n?n:null}},{key:"writeToStore",value:function(e,n,t){var r=this,i=[];return e.forEach((function(e){if(null!==e&&void 0!==e&&e.id){e.properties||(e.properties=[]);var a,o=null;if(t&&e.properties[t]&&(o=(0,Z.GH)(e.properties[t])),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[n]=e.id,e.id&&r._featureLookup.has(e.id)&&r._featureLookup.get(e.id).attributes){var u=r._featureLookup.get(e.id),s=JSON.parse(JSON.stringify(Object.assign(u.attributes,e.properties)));t&&e.properties[t]&&(s[t]=(0,x.im)(e.properties[t])),a=new I.u_(o?JSON.parse(JSON.stringify(o)):null!==u&&void 0!==u&&u.geometry?JSON.parse(JSON.stringify(u.geometry)):null,s,null,e.properties[n])}else a=new I.u_(o?JSON.parse(JSON.stringify(o)):null,e.properties,null,e.properties[n]);r._featureLookup.set(e.id,a),i.push(a)}})),i}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"resetInstance",value:function(){e.instance&&(e.instance=null)}}]),e}(),S=t(69086),C=t(97316),E=t(5924),L=t(21149),N=t(53866),M="ESRI__ID",D="ESRI__ORIGIN_ID",R="ESRI__DESTINATION_ID",j="ESRI__LAYOUT_GEOMETRY",q="ESRI__AGGREGATION_COUNT",A=function(e){(0,c.Z)(t,e);var n=(0,p.Z)(t);function t(e){var r,i,a,o;(0,u.Z)(this,t),(o=n.call(this,e))._processingCacheUpdatesLookup=new Map,o.knowledgeGraph=null,o.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},o.entityTypeNames=new Set,o.relationshipTypeNames=new Set,o.geographicLookup=new Map,o.sublayerCaches=new Map,o.nodeConnectionsLookup=new Map,o.relationshipConnectionsLookup=new Map,o.memberIdTypeLookup=new Map;var s=new Map;return null!==(r=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==r&&r.forEach((function(n){var t,r;n.name&&(s.set(n.name,"entity"),o._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!(null!==(t=e.inclusionModeDefinition)&&void 0!==t&&t.generateAllSublayers)||o.entityTypeNames.add(n.name),null===(r=n.properties)||void 0===r||r.forEach((function(e){var t;e.geometryType&&"esriGeometryNull"!==e.geometryType&&o.geographicLookup.set(n.name,{name:null!==(t=e.name)&&void 0!==t?t:"",geometryType:e.geometryType})})))})),null!==(i=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==i&&i.forEach((function(n){var t,r;n.name&&(s.set(n.name,"relationship"),o._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!(null!==(t=e.inclusionModeDefinition)&&void 0!==t&&t.generateAllSublayers)||o.relationshipTypeNames.add(n.name),null===(r=n.properties)||void 0===r||r.forEach((function(e){var t;e.geometryType&&"esriGeometryNull"!==e.geometryType&&o.geographicLookup.set(n.name,{name:null!==(t=e.name)&&void 0!==t?t:"",geometryType:e.geometryType})})))})),null===(a=e.inclusionModeDefinition)||void 0===a||a.namedTypeDefinitions.forEach((function(n,t){var r;if("entity"===s.get(t))o.entityTypeNames.add(t);else{var i;if("relationship"!==s.get(t))return v.Z.getLogger((0,l.Z)(o)).warn("A named type, ".concat(t,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.delete(t));o.relationshipTypeNames.add(t)}var a=new Map;null!==(r=n.members)&&void 0!==r&&r.forEach((function(e){(0,h.s1)(o.memberIdTypeLookup,e.id,(function(){return new Set})).add(t);var n=o.getById(e.id);n&&a.set(e.id,n)})),o.sublayerCaches.set(t,a)})),o}return(0,s.Z)(t,[{key:"addToLayer",value:function(e){var n=this;e.forEach((function(e){var t=e.typeName,r=e.id;if(!n.inclusionModeDefinition)throw new y.Z("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(n.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(n.inclusionModeDefinition.namedTypeDefinitions.has(t)){var i=n.inclusionModeDefinition.namedTypeDefinitions.get(t);i.members||(i.members=new Map),i.members.set(r,{id:r}),(0,h.s1)(n.memberIdTypeLookup,r,(function(){return new Set})).add(t)}}else{var a=new Map;a.set(r,{id:r}),n.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:a}),(0,h.s1)(n.memberIdTypeLookup,r,(function(){return new Set})).add(t)}}))}},{key:"getById",value:function(e){return _.getInstance().readFromStoreById(e)}},{key:"getData",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t,r){var i,o,u,s,l,c,p,d,f,y,v=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.objectType.name&&null!==(i=this.inclusionModeDefinition)&&void 0!==i&&i.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0)||this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name)){e.next=2;break}return e.abrupt("return",[]);case 2:if(o=n||new L.Z({where:"1=1",outFields:["*"]}),"link-chart"!==t.parentCompositeLayer.type){e.next=10;break}if(c=t.parentCompositeLayer,p=this._processingCacheUpdatesLookup.get(null!==(u=t.objectType.name)&&void 0!==u?u:""),d=o.outFields,e.t0=d&&1===d.length&&d[0]===M&&"1=1"===o.where,e.t0){e.next=8;break}return e.next=8,Promise.all(null!==p&&void 0!==p?p:[]);case 8:return f=this.sublayerCaches.has(null!==(s=t.objectType.name)&&void 0!==s?s:"")?Array.from(null===(l=this.sublayerCaches.get(t.objectType.name))||void 0===l?void 0:l.values()):[],y=[],e.abrupt("return",(f.forEach((function(e){v.relationshipTypeNames.has(t.objectType.name)?e.geometry=c.relationshipLinkChartDiagramLookup.get(e.attributes[t.objectIdField]):e.geometry=c.entityLinkChartDiagramLookup.get(e.attributes[t.objectIdField]),e.attributes[j]=e.geometry,y.push(e)})),y));case 10:return e.abrupt("return",this.retrieveDataFromService(o,t,r));case 11:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"getConnectedRecordIds",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t){var r,u,s,l,c,p,d,f=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],u="",s=[],l=new Map,n.forEach((function(e){if(f.memberIdTypeLookup.has(e)){var n,t=(0,i.Z)(f.memberIdTypeLookup.get(e));try{for(t.s();!(n=t.n()).done;){var r,a=n.value;if(!f.entityTypeNames.has(a))return;l.has(a)?null===(r=l.get(a))||void 0===r||r.push(e):l.set(a,[e])}}catch(o){t.e(o)}finally{t.f()}}})),t&&0!==(null===t||void 0===t?void 0:t.length)){c=(0,i.Z)(t);try{for(c.s();!(p=c.n()).done;)d=p.value,u=u+d+"|"}catch(y){c.e(y)}finally{c.f()}u=u.slice(0,-1)}return l.forEach((function(e,n){var i;i=t&&0!==(null===t||void 0===t?void 0:t.length)?"MATCH (n:".concat(n,")-[r:").concat(u,"]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]"):"MATCH (n:".concat(n,")-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]");var l=new Promise((function(n){(0,o.Z)((0,a.Z)().mark((function n(){var t,o,u,s,l,c;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,C.executeQueryStreaming)(f.knowledgeGraph,new E.Z({openCypherQuery:i,bindParameters:{ids:e}}));case 2:t=n.sent.resultRowsStream.getReader(),n.prev=3;case 4:return n.next=6,t.read();case 6:if(o=n.sent,u=o.done,s=o.value,!u){n.next=11;break}return n.abrupt("break",14);case 11:for(l=0;l<s.length;l++)c=s[l],r.push({id:c[0],typeName:c[1]}),r.push({id:c[2],typeName:c[3]});case 12:n.next=4;break;case 14:n.next=21;break;case 16:if(n.prev=16,n.t0=n.catch(3),"AbortError"===n.t0.name){n.next=20;break}throw n.t0;case 20:v.Z.getLogger(f).info("Request aborted as expected");case 21:case"end":return n.stop()}}),n,null,[[3,16]])})))().then((function(){n()}))}));s.push(l)})),this.refreshCacheContent(),e.next=8,Promise.all(s);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"getAttachedRelationships",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t){var r,i,o,u,s,l,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",e.next=4,(0,C.executeQueryStreaming)(this.knowledgeGraph,new E.Z({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:n,relationshipExclusionIds:t}}));case 4:i=e.sent.resultRowsStream.getReader(),e.prev=5;case 6:return e.next=8,i.read();case 8:if(o=e.sent,u=o.done,s=o.value,!u){e.next=13;break}return e.abrupt("break",16);case 13:for(l=0;l<s.length;l++)c=s[l],r.push({id:c[0],typeName:c[1]});case 14:e.next=6;break;case 16:e.next=23;break;case 18:if(e.prev=18,e.t0=e.catch(5),"AbortError"===e.t0.name){e.next=22;break}throw e.t0;case 22:v.Z.getLogger(this).info("Request aborted as expected");case 23:return e.abrupt("return",r);case 24:case"end":return e.stop()}}),e,this,[[5,18]])})));return function(n,t){return e.apply(this,arguments)}}()},{key:"refreshCacheContent",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t,u){var s,l,c,p,d,f,v,m,b,g,T,w,k,Z,I=this,x=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v=!(x.length>3&&void 0!==x[3])||x[3],m=_.getInstance(),b=[],g=new Map,T=new Map,null!==(s=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==s&&s.forEach((function(e){e.name&&T.set(e.name,e)})),null!==(l=this.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==l&&l.forEach((function(e){e.name&&T.set(e.name,e)})),n||this.inclusionModeDefinition?n?n.forEach((function(e){if(I.memberIdTypeLookup.has(e)){var n,t=(0,i.Z)(I.memberIdTypeLookup.get(e));try{for(t.s();!(n=t.n()).done;){var r,a=n.value;g.has(a)?null===(r=g.get(a))||void 0===r||r.push(e):g.set(a,[e])}}catch(o){t.e(o)}finally{t.f()}}})):null===(c=this.inclusionModeDefinition)||void 0===c||null===(p=c.namedTypeDefinitions)||void 0===p||p.forEach((function(e,n){e.useAllData?g.set(n,null):e.members&&e.members.forEach((function(e){var t;g.has(n)&&null!==g.get(n)?null===(t=g.get(n))||void 0===t||t.push(e.id):g.set(n,[e.id])}))})):(null!==(d=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==d&&d.forEach((function(e){e.name&&g.set(e.name,null)})),null===(f=this.knowledgeGraph.dataModel.entityTypes)||void 0===f||f.forEach((function(e){e.name&&g.set(e.name,null)}))),w=(0,i.Z)(g);try{for(Z=function(){var e,n=(0,r.Z)(k.value,2),i=n[0],s=n[1],l=new Promise((function(e){var n=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n,r,o,l,c,p,d,f,b,g,w;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new Set,l=[],p="",d=!1,t||null!==(n=T.get(i))&&void 0!==n&&null!==(r=n.properties)&&void 0!==r&&r.forEach((function(e){e.name&&o.add(e.name)})),u&&I.geographicLookup.has(i)&&(b=null===(f=I.geographicLookup.get(i))||void 0===f?void 0:f.name)&&o.add(b),!I.entityTypeNames.has(i)){e.next=7;break}p="MATCH (n:".concat(i,") ").concat(s?"WHERE id(n) IN $ids ":"","return ID(n)"),o.forEach((function(e){p+=", n.".concat(e),l.push(e)})),e.next=10;break;case 7:if(I.relationshipTypeNames.has(i)){e.next=9;break}throw new y.Z("knowledge-graph:layer-data-manager","The graph type of ".concat(i," could not be determined. Was this type set in the KG data model and inclusion definition?"));case 9:d=!0,p="MATCH ()-[n:".concat(i,"]->() ").concat(s?"WHERE id(n) IN $ids ":"","return ID(n), id(startNode(n)), id(endNode(n))"),o.forEach((function(e){p+=", n.".concat(e),l.push(e)}));case 10:return c=new E.Z(s?{openCypherQuery:p,bindParameters:{ids:s}}:{openCypherQuery:p}),e.next=13,(0,C.executeQueryStreaming)(I.knowledgeGraph,c);case 13:g=e.sent.resultRowsStream.getReader(),w=(0,a.Z)().mark((function e(){var n,t,r,o,u,s,c,p,f,y,b,T;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.read();case 2:if(u=e.sent,s=u.done,c=u.value,!s){e.next=7;break}return e.abrupt("return","break");case 7:for(p=[],f=function(e){var n=c[e],t=0,r=0,i={properties:{}};for(i.id=n[t],t++,r++,d&&(i.originId=n[t],t++,r++,i.destinationId=n[t],t++,r++,(0,h.s1)(I.nodeConnectionsLookup,i.originId,(function(){return new Set})).add(i.id),(0,h.s1)(I.nodeConnectionsLookup,i.destinationId,(function(){return new Set})).add(i.id),(0,h.s1)(I.relationshipConnectionsLookup,i.id,(function(){return[i.originId,i.destinationId]})));t<n.length;t++)i.properties[l[t-r]]=n[t];p.push(i)},y=0;y<c.length;y++)f(y);b=m.writeToStore(p,M,null===(n=I.geographicLookup.get(i))||void 0===n?void 0:n.name),I.sublayerCaches.has(i)||I.sublayerCaches.set(i,new Map),v&&!(null!==(t=I.inclusionModeDefinition)&&void 0!==t&&t.namedTypeDefinitions.has(i))&&null!==(r=I.inclusionModeDefinition)&&void 0!==r&&r.namedTypeDefinitions.set(i,{useAllData:!1,members:new Map}),v&&(null===(o=I.inclusionModeDefinition)||void 0===o||!o.namedTypeDefinitions.get(i).members)&&(I.inclusionModeDefinition.namedTypeDefinitions.get(i).members=new Map),T=I.sublayerCaches.get(i),b.forEach((function(e){var n,t;null!==T&&void 0!==T&&T.set(e.attributes[M],e),v&&(null===(n=I.inclusionModeDefinition)||void 0===n||!n.namedTypeDefinitions.get(i).members.has(e.attributes[M]))&&(null!==(t=I.inclusionModeDefinition)&&void 0!==t&&t.namedTypeDefinitions.get(i).members.set(e.attributes[M],{id:e.attributes[M]}),(0,h.s1)(I.memberIdTypeLookup,e.attributes[M],(function(){return new Set})).add(i))}));case 14:case"end":return e.stop()}}),e)}));case 15:return e.delegateYield(w(),"t0",16);case 16:if("break"!==e.t0){e.next=19;break}return e.abrupt("break",21);case 19:e.next=15;break;case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n().then((function(){e(null)}))}));b.push(l),null===(e=I._processingCacheUpdatesLookup.get(i))||void 0===e||e.push(l)},w.s();!(k=w.n()).done;)Z()}catch(S){w.e(S)}finally{w.f()}return e.next=7,Promise.all(b);case 7:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()},{key:"removeFromLayer",value:function(e){var n,t=this,r=new Set,a=new Set(e.map((function(e){return e.id}))),o=(0,i.Z)(e);try{var u=function(){var e,i,a,o=n.value;r.add(o.typeName),1===(null===(e=t.memberIdTypeLookup.get(o.id))||void 0===e?void 0:e.size)?t.memberIdTypeLookup.delete(o.id):null===(i=t.memberIdTypeLookup.get(o.id))||void 0===i||i.delete(o.typeName),null===(a=t.inclusionModeDefinition)||void 0===a||a.namedTypeDefinitions.forEach((function(e,n){var t;n===o.typeName&&(null===(t=e.members)||void 0===t?void 0:t.has(o.id))&&e.members.delete(o.id)}))};for(o.s();!(n=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}r.forEach((function(e){var n;null===(n=t.sublayerCaches.get(e))||void 0===n||n.forEach((function(n,r){var i;a.has(r)&&(null===(i=t.sublayerCaches.get(e))||void 0===i||i.delete(r))}))}))}},{key:"retrieveDataFromService",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n,t,r){var i,o,u,s,l,c,p,d,f,v,h,b,g,Z,I,x,L,D,R,j,q,A,O,G,F,Q,U,P,J,B,Y,H,z,V,W,$,K,X,ee,ne,te,re,ie,ae,oe,ue,se,le,ce,pe,de,fe,ye,ve,he,me,be;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=_.getInstance(),h=new Set,b=[],Z="",I=[],x="relationship"===t.graphType,L=null===(i=this.inclusionModeDefinition)||void 0===i||null===(o=i.namedTypeDefinitions)||void 0===o||null===(u=o.get(t.objectType.name))||void 0===u?void 0:u.useAllData,D=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name),R=!L&&D?Array.from(D).sort():null,null===(s=this.inclusionModeDefinition)||void 0===s||null===(l=s.namedTypeDefinitions)||void 0===l||null===(c=l.get(t.objectType.name))||void 0===c||!c.useAllData){e.next=8;break}(null===(p=this.inclusionModeDefinition)||void 0===p||null===(d=p.namedTypeDefinitions)||void 0===d||null===(f=d.get(t.objectType.name))||void 0===f?void 0:f.useAllData)&&null!=n.objectIds&&(R=n.objectIds),e.next=20;break;case 8:if(!(null!=n.objectIds&&R&&R.length>0)){e.next=13;break}j=n.objectIds,n.objectIds=R.filter((function(e){return j.includes(e)})),e.next=20;break;case 13:if(null==n.objectIds){e.next=17;break}R=n.objectIds,e.next=20;break;case 17:if(null===(q=this.inclusionModeDefinition)||void 0===q||!q.namedTypeDefinitions.has(t.objectType.name)||null!==(A=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))&&void 0!==A&&A.members&&!((null===(O=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===O||null===(G=O.members)||void 0===G?void 0:G.size)<1)){e.next=19;break}return e.abrupt("return",(n.objectIds=[],[]));case 19:n.objectIds=R;case 20:if(null!=n.outFields&&((F=n.outFields).includes("*")?t.fields.forEach((function(e){h.add(e.name)})):F.forEach((function(e){e!==M&&e!==t.geometryFieldName&&h.add(e)}))),null==n.geometry){e.next=46;break}if(J=n.geometry,Y=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,H=null===Y||void 0===Y?void 0:Y.spatialReference,z=null===Y||void 0===Y||null===(Q=Y.serviceCapabilities)||void 0===Q?void 0:Q.geometryCapabilities,V=null===z||void 0===z?void 0:z.geometryMaxBoundingRectangleSizeX,W=null===z||void 0===z?void 0:z.geometryMaxBoundingRectangleSizeY,null===J||void 0===J||null===(U=J.extent)||void 0===U||!U.spatialReference||null!==(P=J.spatialReference)&&void 0!==P&&P.isWGS84){e.next=31;break}return e.next=28,(0,w.initializeProjection)(J.extent.spatialReference,k.YU);case 28:B=(0,w.project)(J.extent,k.YU),e.next=32;break;case 31:B=J.extent;case 32:if(!(V&&W&&H)){e.next=38;break}if(4326!==H.wkid&&($=new N.Z({spatialReference:H,xmax:V,ymax:W}),K=(0,w.project)($,k.YU),V=K.xmax,W=K.ymax),!(B.xmax-B.xmin>V)){e.next=36;break}throw new y.Z("knowledge-graph:layer-data-manager","Extent x bounds should be within ".concat(V,"\xb0 latitude, limit exceeded"));case 36:if(!(B.ymax-B.ymin>W)){e.next=38;break}throw new y.Z("knowledge-graph:layer-data-manager","Extent y bounds should be within ".concat(W,"\xb0 longitude, limit exceeded"));case 38:if(null==n.where||"1=1"===n.where){e.next=43;break}return e.next=41,(0,m.E)(n.where.toUpperCase(),t.fieldsIndex);case 41:X=e.sent,t.fields.forEach((function(e){X.fieldNames.includes(e.name)&&h.add(e.name)}));case 43:Z=x?"Match ()-[n:".concat(t.objectType.name,"]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n), id(startNode(r)), id(endNode(r))"):"Match (n:".concat(t.objectType.name,") WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n)"),t.geometryFieldName&&h.add(t.geometryFieldName),h.forEach((function(e){Z+=", n.".concat(e),b.push(e)})),g=new E.Z({openCypherQuery:Z,bindParameters:{param_filter_geom:new T.Z({rings:(0,S.MM)(B)})}}),e.next=60;break;case 46:if(ee="",null==n.where||"1=1"===n.where){e.next=56;break}return e.next=50,(0,m.E)(n.where,t.fieldsIndex);case 50:ne=e.sent,t.fields.forEach((function(e){ne.fieldNames.includes(e.name)&&h.add(e.name)})),te=new Set(["column-reference","string","number","binary-expression"]),re=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]),ie=!1,ae=function e(n){if("column-reference"===n.type)return"n.".concat(n.column);if("string"===n.type)return"'".concat(n.value,"'");if("number"===n.type)return"".concat(n.value);if("binary-expression"===n.type&&te.has(n.left.type)&&te.has(n.right.type)&&re.has(n.operator))return"".concat(e(n.left)," ").concat(n.operator," ").concat(e(n.right));if("binary-expression"===n.type&&"LIKE"===n.operator){var t="";if("function"===n.left.type&&"column-reference"===n.left.args.value[0].type)t+="lower(n.".concat(n.left.args.value[0].column,")");else{if("column-reference"!==n.left.type)return ie=!0,"";t+="lower(n.".concat(n.left.column,")")}if(t+=" CONTAINS (","string"!==n.right.type)return ie=!0,"";var r=n.right.value;return"%"===r.charAt(0)&&(r=r.slice(1)),"%"===r.charAt(r.length-1)&&(r=r.slice(0,-1)),t+="'".concat(r.toLowerCase(),"')")}return ie=!0,""},ee=ae(ne.parseTree),ie&&(ee="");case 56:oe="",oe=x?"Match ()-[n:".concat(t.objectType.name,"]->()"):"Match (n:".concat(t.objectType.name,")"),ue=!1,R&&(ue=!0,oe+=" WHERE ID(n) IN $ids"),ee&&(oe+=ue?" AND":" WHERE",oe+=" ".concat(ee)),oe+=" return ID(n)",x&&(oe+=", id(startNode(n)), id(endNode(n))"),n.returnGeometry&&t.geometryFieldName&&h.add(t.geometryFieldName),h.forEach((function(e){oe+=", n.".concat(e),b.push(e)})),g=new E.Z(R?{openCypherQuery:oe,bindParameters:{ids:R}}:{openCypherQuery:oe});case 60:return e.next=62,(0,C.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,g,r);case 62:se=e.sent.resultRowsStream.getReader();case 63:return e.next=65,se.read();case 65:if(ce=e.sent,pe=ce.done,de=ce.value,!pe){e.next=70;break}return e.abrupt("break",75);case 70:for(fe=[],ye=0;ye<de.length;ye++){for(ve=de[ye],me=0,(be={properties:{}}).id=ve[he=0],he++,me++,x&&(be.originId=ve[he],he++,me++,be.destinationId=ve[he],he++,me++);he<ve.length;he++)be.properties[b[he-me]]=ve[he];fe.push(be)}I=I.concat(v.writeToStore(fe,M,null===(le=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))||void 0===le?void 0:le.name));case 73:e.next=63;break;case 75:return e.abrupt("return",I);case 76:case"end":return e.stop()}}),e,this)})));return function(n,t,r){return e.apply(this,arguments)}}()}]),t}(f.default);(0,d._)([(0,b.Cb)()],A.prototype,"knowledgeGraph",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"inclusionModeDefinition",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"entityTypeNames",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"relationshipTypeNames",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"geographicLookup",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"sublayerCaches",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"nodeConnectionsLookup",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"relationshipConnectionsLookup",void 0),(0,d._)([(0,b.Cb)()],A.prototype,"memberIdTypeLookup",void 0),A=(0,d._)([(0,g.j)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],A)},21438:function(e,n,t){t.d(n,{Z:function(){return ie}});var r=t(74165),i=t(15861),a=t(15671),o=t(43144),u=t(60136),s=t(29388),l=t(1413),c=t(44925),p=t(27366),d=(t(59486),t(44055)),f=(t(94931),t(15126),t(98689),t(57823),t(32066),t(49018),t(34999),t(28189),t(9014)),y=t(40464),v=t(84652),h=t(97642),m=(t(70431),t(49861)),b=(t(93169),t(32718),t(69912)),g=t(31201),T=t(25265),w=t(79803),k=t(78952),Z=t(92975),I=t(30651),x=t(68928),_=t(75878),S=t(63543),C=t(50568),E=(t(84936),(0,t(25610).v)()),L=t(6693),N=t(7632),M=t(49661),D=t(9855),R=t(71684),j=t(56811),q=t(99063),A=t(70361),O=t(7653),G=t(83040),F=t(37270),Q=t(77748),U=t(85116),P=t(49818),J=t(21149),B=t(81085),Y=t(82485),H=t(53866),z=t(80885),V=t(29909),W=t(27823),$=["target","writer","overridePolicy"];function K(e){if(!e.json)return e;e.json.write=X(e.json.write);var n,t=e.json.origins;if(!t)return e;for(n in t){var r=t[n];r&&(r.write=X(r.write))}return e}function X(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){e.target,e.writer,e.overridePolicy;var n=(0,c.Z)(e,$);return function(e,t){var r=ne.call(this,e,t);return r.enabled?(0,l.Z)((0,l.Z)({},n),r):r}}(e)),e):!0===e?ee():e}function ee(){return{overridePolicy:ne}}function ne(e,n){var t=!!this.geometryType,r={enabled:t};return t&&(r=(0,l.Z)((0,l.Z)({},r),te.call(this,e,n))),r}function te(e,n){return{ignoreOrigin:this.originIdOf(n)>T.s3.DEFAULTS}}var re=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(e){var r;return(0,a.Z)(this,t),(r=n.call(this,e)).blendMode="normal",r.capabilities=(0,S.MS)(!1,!1),r.charts=null,r.definitionExpression=null,r.displayField="",r.effect=null,r.elevationInfo=null,r.featureEffect=null,r.graphType=null,r.labelsVisible=!0,r.labelingInfo=null,r.layerType=null,r.legendEnabled=!0,r.maxScale=0,r.minScale=0,r.objectIdField=C.zS,r.objectType=null,r.opacity=1,r.orderBy=null,r.parentCompositeLayer=null,r.persistenceEnabled=!0,r.popupEnabled=!0,r.popupTemplate=null,r.refreshInterval=0,r.source={openPorts:function(){return r.load().then((function(){var e=new MessageChannel;return new Y.Z(e.port1,{channel:e,client:{queryFeatures:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=J.Z.fromJSON(e);return r.queryFeaturesJSON(t,n)}}}),[e.port2]}))}},r.title=null,r.type="knowledge-graph-sublayer",r.useViewTime=!0,r.visible=!0,r}return(0,o.Z)(t,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"featureReduction",set:function(e){var n=this._normalizeFeatureReduction(e);this._set("featureReduction",n)}},{key:"fields",get:function(){var e,n,t=[];return null!==(e=this.objectType)&&void 0!==e&&null!==(n=e.properties)&&void 0!==n&&n.forEach((function(e){var n="esriFieldTypeOID"===e.fieldType?"esriFieldTypeInteger":e.fieldType;t.push(G.Z.fromJSON({name:e.name,type:n,alias:e.alias,defaultValue:e.defaultValue,editable:e.editable,nullable:e.nullable}))})),t.push(G.Z.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),G.Z.fromJSON({name:C.Fd,type:"esriFieldTypeInteger",alias:C.Fd,editable:!1})),t}},{key:"geometryType",get:function(){var e,n,t;if("link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type))return"relationship"===this.graphType?"polyline":"point";var r=null===(n=this.parentCompositeLayer)||void 0===n?void 0:n.dataManager.geographicLookup.get(null===(t=this.objectType)||void 0===t?void 0:t.name),i=null===r||void 0===r?void 0:r.geometryType;return i&&"esriGeometryNull"!==i?W.M.fromJSON(i):null}},{key:"geometryFieldName",get:function(){var e,n,t,r;if("link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type))return C.Cn;var i=null===(n=this.parentCompositeLayer)||void 0===n?void 0:n.dataManager.geographicLookup.get(null===(t=this.objectType)||void 0===t?void 0:t.name);return null!==(r=null===i||void 0===i?void 0:i.name)&&void 0!==r?r:null}},{key:"graphTypeName",get:function(){var e;return null===(e=this.objectType)||void 0===e?void 0:e.name}},{key:"hasM",get:function(){var e,n,t,r,i,a=null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.dataManager.geographicLookup.get(null===(n=this.objectType)||void 0===n?void 0:n.name),o=null===a||void 0===a?void 0:a.name,u=o?null===(t=this.objectType)||void 0===t||null===(r=t.properties)||void 0===r?void 0:r[o]:null;return null!==(i=null===u||void 0===u?void 0:u.hasM)&&void 0!==i&&i}},{key:"hasZ",get:function(){var e,n,t,r,i,a=null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.dataManager.geographicLookup.get(null===(n=this.objectType)||void 0===n?void 0:n.name),o=null===a||void 0===a?void 0:a.name,u=o?null===(t=this.objectType)||void 0===t||null===(r=t.properties)||void 0===r?void 0:r[o]:null;return null!==(i=null===u||void 0===u?void 0:u.hasZ)&&void 0!==i&&i}},{key:"renderer",get:function(){var e;return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type)?"relationship"===this.graphType?(0,f.i)((0,S.bU)(W.M.toJSON("polyline")).renderer):(0,f.i)((0,S.bU)(W.M.toJSON("point")).renderer):(0,f.i)((0,S.bU)(W.M.toJSON(this.geometryType)).renderer)},set:function(e){(0,F.YN)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"spatialReference",get:function(){var e,n,t,r,i;return null!==(e=null===(n=this.parentCompositeLayer)||void 0===n||null===(t=n.dataManager)||void 0===t||null===(r=t.knowledgeGraph)||void 0===r||null===(i=r.dataModel)||void 0===i?void 0:i.spatialReference)&&void 0!==e?e:k.Z.WGS84}},{key:"writeTitle",value:function(e,n){n.title=null!==e&&void 0!==e?e:"Layer"}},{key:"createPopupTemplate",value:function(e){return(0,B.eZ)(this,e)}},{key:"createQuery",value:function(){return new J.Z({where:"1=1",outFields:["*"]})}},{key:"getField",value:function(e){for(var n=0;n<this.fields.length;n++)if(this.fields[n].name===e)return this.fields[n];return null}},{key:"getFieldDomain",value:function(e,n){return null}},{key:"queryFeatures",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o,u,s=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._setupQueryObjects(n);case 2:return i=e.sent,a=i.resolvedQuery,o=i.queryEngine,e.t0=P.Z,e.next=8,o.executeQuery(a.toJSON(),null===t||void 0===t?void 0:t.signal);case 8:return e.t1=e.sent,u=e.t0.fromJSON.call(e.t0,e.t1),e.abrupt("return",(u.features.forEach((function(e){e.sourceLayer=s})),u));case 11:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._setupQueryObjects(n);case 2:return i=e.sent,a=i.resolvedQuery,o=i.queryEngine,e.next=7,o.executeQuery(a.toJSON(),null===t||void 0===t?void 0:t.signal);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._setupQueryObjects(n);case 2:return i=e.sent,a=i.resolvedQuery,o=i.queryEngine,e.abrupt("return",o.executeQueryForCount(a.toJSON(),null===t||void 0===t?void 0:t.signal));case 6:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"queryExtent",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,t,i,a,o,u,s,c,p,d,f,y,v=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=v.length>0&&void 0!==v[0]?v[0]:{},u=v.length>1?v[1]:void 0,s=(0,l.Z)((0,l.Z)({},o),{},{returnGeometry:!0}),e.next=5,this._setupQueryObjects(s);case 5:return c=e.sent,p=c.resolvedQuery,d=c.queryEngine,e.next=10,d.executeQueryForExtent(p.toJSON(),null===u||void 0===u?void 0:u.signal);case 10:return f=e.sent,e.abrupt("return",(y=null!=(null===(n=f.extent)||void 0===n?void 0:n.xmin)&&null!=(null===(t=f.extent)||void 0===t?void 0:t.xmax)&&null!=(null===(i=f.extent)||void 0===i?void 0:i.ymin)&&null!=(null===(a=f.extent)||void 0===a?void 0:a.ymax)?new H.Z(f.extent):new H.Z,{count:f.count,extent:y}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"queryObjectIds",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=J.Z.from(n),"link-chart"!==this.parentCompositeLayer.type||!this._cachedQueryEngine){e.next=5;break}a=this._cachedQueryEngine,e.next=9;break;case 5:return e.next=7,this.parentCompositeLayer.dataManager.getData(i,this,t);case 7:o=e.sent,a=this.loadQueryEngine(o);case 9:return e.abrupt("return",a.executeQueryForIds(i.toJSON(),null===t||void 0===t?void 0:t.signal));case 10:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()},{key:"loadQueryEngine",value:function(e){var n=new x.Z({geometryType:W.M.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),t=new _.q({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:W.M.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:n});return t.featureStore.addMany(e),t}},{key:"refreshCachedQueryEngine",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.parentCompositeLayer.dataManager.getData(new J.Z({where:"1=1",outFields:[C.zS]}),this);case 2:n=e.sent,this._cachedQueryEngine=this.loadQueryEngine(n);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_setupQueryObjects",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,a,o,u,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=J.Z.from(n),o=a.geometry,e.t0=o&&!(null!==(i=o.spatialReference)&&void 0!==i&&i.isWGS84),!e.t0){e.next=6;break}return e.next=5,(0,w.initializeProjection)(o.spatialReference,Z.YU);case 5:a.geometry=(0,w.project)(o instanceof z.Z||o instanceof V.Z?o:o.extent,Z.YU);case 6:if("link-chart"!==this.parentCompositeLayer.type||!this._cachedQueryEngine){e.next=10;break}u=this._cachedQueryEngine,e.next=14;break;case 10:return e.next=12,this.parentCompositeLayer.dataManager.getData(a,this,t);case 12:s=e.sent,u=this.loadQueryEngine(s);case 14:return e.abrupt("return",{resolvedQuery:a,queryEngine:u});case 15:case"end":return e.stop()}}),e,this)})));return function(n,t){return e.apply(this,arguments)}}()}]),t}(function(e){var n=function(e){(0,u.Z)(t,e);var n=(0,s.Z)(t);function t(){var e;return(0,a.Z)(this,t),(e=n.apply(this,arguments)).fields=[],e.fieldsIndex=null,e}return(0,o.Z)(t)}(e);return(0,p._)([(0,m.Cb)(E.fields)],n.prototype,"fields",void 0),(0,p._)([(0,m.Cb)(E.fieldsIndex)],n.prototype,"fieldsIndex",void 0),n=(0,p._)([(0,b.j)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],n),n}((0,M.M)((0,N.b)((0,L.h7)((0,D.c)((0,q.n)((0,j.M)((0,R.Q)((0,h.R)(I.Z))))))))));(0,p._)([(0,m.Cb)(K((0,v.d9)(L.nE)))],re.prototype,"blendMode",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"capabilities",void 0),(0,p._)([(0,m.Cb)({json:{origins:{"web-scene":{write:!1}},write:ee()}})],re.prototype,"charts",void 0),(0,p._)([(0,m.Cb)({readOnly:!0})],re.prototype,"defaultPopupTemplate",null),(0,p._)([(0,m.Cb)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],re.prototype,"definitionExpression",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"displayField",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(L.qu)))],re.prototype,"effect",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"elevationInfo",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(N.d)))],re.prototype,"featureEffect",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(O.d)))],re.prototype,"featureReduction",null),(0,p._)([(0,m.Cb)()],re.prototype,"fields",null),(0,p._)([(0,m.Cb)()],re.prototype,"geometryType",null),(0,p._)([(0,m.Cb)()],re.prototype,"geometryFieldName",null),(0,p._)([(0,m.Cb)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],re.prototype,"graphType",void 0),(0,p._)([(0,m.Cb)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],re.prototype,"graphTypeName",null),(0,p._)([(0,m.Cb)()],re.prototype,"hasM",null),(0,p._)([(0,m.Cb)()],re.prototype,"hasZ",null),(0,p._)([(0,m.Cb)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],re.prototype,"id",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(A.iR)))],re.prototype,"labelsVisible",void 0),(0,p._)([(0,m.Cb)({type:[Q.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:U.r,write:ee()}})],re.prototype,"labelingInfo",void 0),(0,p._)([(0,m.Cb)({readOnly:!0,json:{read:!1,write:{writer:function(e,n){n.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],re.prototype,"layerType",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(A.rn)))],re.prototype,"legendEnabled",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(A.u1)))],re.prototype,"maxScale",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(A.rO)))],re.prototype,"minScale",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"objectIdField",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"objectType",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(A.Oh)))],re.prototype,"opacity",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(D.l)))],re.prototype,"orderBy",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"parentCompositeLayer",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(A.C_)))],re.prototype,"popupEnabled",void 0),(0,p._)([(0,m.Cb)({type:d.Z,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],re.prototype,"popupTemplate",void 0),(0,p._)([(0,m.Cb)({type:Number,json:{write:{overridePolicy:te}}})],re.prototype,"refreshInterval",void 0),(0,p._)([(0,m.Cb)({types:y.A,json:{name:"layerDefinition.drawingInfo.renderer",write:ee()}})],re.prototype,"renderer",null),(0,p._)([(0,m.Cb)()],re.prototype,"source",void 0),(0,p._)([(0,m.Cb)()],re.prototype,"spatialReference",null),(0,p._)([(0,m.Cb)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],re.prototype,"title",void 0),(0,p._)([(0,g.c)("title")],re.prototype,"writeTitle",null),(0,p._)([(0,m.Cb)({json:{read:!1}})],re.prototype,"type",void 0),(0,p._)([(0,m.Cb)(K((0,v.d9)(q.I)))],re.prototype,"useViewTime",void 0),(0,p._)([(0,m.Cb)({type:Boolean,json:{name:"visibility",write:ee()}})],re.prototype,"visible",void 0);var ie=re=(0,p._)([(0,b.j)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],re)},69086:function(e,n,t){t.d(n,{MM:function(){return T},Ag:function(){return Z},bv:function(){return w},jR:function(){return x}});var r,i=t(74165),a=t(29439),o=t(37762),u=t(15861),s=t(76200),l=t(10064),c=t(77427),p=(t(83406),t(97316)),d=t(5924);t(59486),t(78952);!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(r||(r={}));var f,y;r.ELEMENTUID,r.TYPENAME;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(f||(f={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(y||(y={}));var v,h,m,b,g=t(72430);t(71084);function T(e){if(!e.spatialReference.isWGS84)throw new l.Z("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}function w(e,n){return k.apply(this,arguments)}function k(){return k=(0,u.Z)((0,i.Z)().mark((function e(n,t){var r,s,l,c,f,y,v,h,m,b,g,T,w,k,Z,I,x;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],l=new Map,c=[],null!==(r=t.dataModel)&&void 0!==r&&r.relationshipTypes){f=(0,o.Z)(t.dataModel.relationshipTypes);try{for(f.s();!(y=f.n()).done;)(v=y.value).name&&l.set(v.name,[])}catch(_){f.e(_)}finally{f.f()}}h=(0,o.Z)(n);try{for(h.s();!(m=h.n()).done;)g=m.value,l.has(g.typeName)&&(null===(b=l.get(g.typeName))||void 0===b||b.push(g.id))}catch(_){h.e(_)}finally{h.f()}T=(0,o.Z)(l),e.prev=5,T.s();case 7:if((w=T.n()).done){e.next=15;break}if(k=(0,a.Z)(w.value,2),Z=k[0],!((I=k[1]).length<1)){e.next=11;break}return e.abrupt("continue",13);case 11:x=new d.Z({openCypherQuery:"MATCH (n)-[r:".concat(Z,"]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]"),bindParameters:{ids:I}}),c.push((0,p.executeQueryStreaming)(t,x).then(function(){var e=(0,u.Z)((0,i.Z)().mark((function e(n){var t,r,a,u,l,c,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.resultRowsStream.getReader();case 1:return e.next=3,t.read();case 3:if(r=e.sent,a=r.done,u=r.value,!a){e.next=8;break}return e.abrupt("break",12);case 8:l=(0,o.Z)(u);try{for(l.s();!(c=l.n()).done;)p=c.value,s.push({id:p[0],typeName:p[1]}),s.push({id:p[2],typeName:p[3]})}catch(_){l.e(_)}finally{l.f()}case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),T.e(e.t0);case 20:return e.prev=20,T.f(),e.finish(20);case 23:return e.next=25,Promise.all(c);case 25:return e.abrupt("return",s);case 26:case"end":return e.stop()}}),e,null,[[5,17,20,23]])}))),k.apply(this,arguments)}function Z(e,n){return I.apply(this,arguments)}function I(){return(I=(0,u.Z)((0,i.Z)().mark((function e(n,t){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!==(r=t)&&void 0!==r||(t=!1),a={generateAllSublayers:t,namedTypeDefinitions:new Map},e.next=4,C(n).then((function(e){M(e,a)}));case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return _.apply(this,arguments)}function _(){return(_=(0,u.Z)((0,i.Z)().mark((function e(n){var t,r,a,o,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.$G)();case 2:if(t=e.sent,S(r=new t.MapOfObjectIdentifierSets,t,n),a=new t.MapOfObjectIdentifierSetsEncoder,e.prev=6,a.set_map_of_identifier_sets(r),a.encode(),0===(o=a.get_encoding_result()).error.error_code){e.next=11;break}throw new l.Z("knowledge-graph:layer-support-utils",o.error.error_message);case 11:return u=structuredClone(o.get_byte_buffer()),e.abrupt("return",(a.delete(),u));case 13:return e.prev=13,r.delete(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[6,,13,16]])})))).apply(this,arguments)}function S(e,n,t){var r,i=(0,o.Z)(t.namedTypeDefinitions);try{for(i.s();!(r=i.n()).done;){var u=(0,a.Z)(r.value,2),s=u[0],l=u[1];if(l.members&&!l.useAllData){var c,p=l.members.keys(),d=new n.GlobalIdArray,f=new n.ObjectIdentifierSet,y=(0,o.Z)(p);try{for(y.s();!(c=y.n()).done;){var v=c.value;d.add_globalid(v)}}catch(h){y.e(h)}finally{y.f()}f.set_globalid_array(d),d.delete(),e.put_identifier_set(s,f),f.delete()}}}catch(h){i.e(h)}finally{i.f()}return e}function C(e){return E.apply(this,arguments)}function E(){return(E=(0,u.Z)((0,i.Z)().mark((function e(n){var t,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.Z)(n,{responseType:"array-buffer"});case 2:return t=e.sent,e.next=5,t.data;case 5:return r=e.sent,e.abrupt("return",L(new Uint8Array(r)));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return N.apply(this,arguments)}function N(){return(N=(0,u.Z)((0,i.Z)().mark((function e(n){var t,r,a,o,u,s,c,p,d,f,y,v,h,m,T,w;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,g.$G)();case 2:if(e.t0=e.sent.MapOfObjectIdentifierSetsDecoder,t=new e.t0,r=t.decode(new Uint8Array(n)),a=new Map,0===r.error_code){e.next=8;break}throw new l.Z("knowledge-graph:layer-support-utils",r.error_message);case 8:o=t.get_map_of_identifier_sets(),u=o.keys,s=u.size(),c=0;case 10:if(!(c<s)){e.next=25;break}if(p=u.get(c),d=o.query_identifier_set(p),f=[],d.id_array_type.value!==b.GLOBALID_ARRAY){e.next=17;break}for(y=d.get_globalid_array(),v=y.count(),h=0;h<v;h++)f.push(y.get_globalid_at(h));e.next=21;break;case 17:if(d.id_array_type.value===b.IDENTIFIER_ARRAY){e.next=19;break}throw new l.Z("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");case 19:for(m=d.get_identifier_array(),T=m.count(),w=0;w<T;w++)f.push(m.get_identifier_at(w).toString());case 21:a.set(p,f);case 22:c++,e.next=10;break;case 25:return e.abrupt("return",(t.delete(),a));case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,n){var t,r=(0,o.Z)(e);try{for(r.s();!(t=r.n()).done;){var i,u=(0,a.Z)(t.value,2),s=u[0],l=u[1],p=(0,c.s1)(n.namedTypeDefinitions,s,(function(){return{useAllData:!1,members:new Map}})),d=(0,o.Z)(l);try{for(d.s();!(i=d.n()).done;){var f=i.value;p.members.has(f)||p.members.set(f,{id:f})}}catch(y){d.e(y)}finally{d.f()}}}catch(y){r.e(y)}finally{r.f()}return n}!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(v||(v={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(h||(h={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(m||(m={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(b||(b={}))},35594:function(e,n,t){t.d(n,{F:function(){return i},o:function(){return a}});var r=t(77981);function i(e){return{geometryType:(0,r.Ji)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}function a(e,n,t){var i=(0,r.q9)(n);return e.map((function(e){var n=i.fromJSON(e);return n.spatialReference=t,n}))}},14725:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=(t(59486),t(49861)),l=(t(93169),t(32718),t(84936),t(69912)),c=t(25695),p=t(848),d=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).layoutGeometry=null,r}return(0,r.Z)(t)}(c.Z);(0,u._)([(0,s.Cb)({type:p.Z,json:{write:!0}})],d.prototype,"layoutGeometry",void 0);var f=d=(0,u._)([(0,l.j)("esri.rest.knowledgeGraph.Entity")],d)},25695:function(e,n,t){t.d(n,{Z:function(){return p}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=t(49861),l=(t(93169),t(32718),t(84936),t(69912)),c=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).typeName=null,r.id=null,r}return(0,r.Z)(t)}(t(92364).Z);(0,u._)([(0,s.Cb)({type:String,json:{write:!0}})],c.prototype,"typeName",void 0),(0,u._)([(0,s.Cb)({type:String,json:{write:!0}})],c.prototype,"id",void 0);var p=c=(0,u._)([(0,l.j)("esri.rest.knowledgeGraph.GraphNamedObject")],c)},92364:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=t(46784),l=t(49861),c=(t(93169),t(32718),t(84936),t(69912)),p=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).properties=null,r}return(0,r.Z)(t)}(s.wq);(0,u._)([(0,l.Cb)({json:{write:!0}})],p.prototype,"properties",void 0);var d=p=(0,u._)([(0,c.j)("esri.rest.knowledgeGraph.GraphObject")],p)},5924:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=t(49861),l=(t(93169),t(32718),t(84936),t(69912)),c=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).openCypherQuery="",r}return(0,r.Z)(t)}(t(7138).default);(0,u._)([(0,s.Cb)()],c.prototype,"openCypherQuery",void 0);var p=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).bindParameters=null,r.bindGeometryQuantizationParameters=null,r.outputQuantizationParameters=null,r.outputSpatialReference=null,r.provenanceBehavior=null,r}return(0,r.Z)(t)}(c=(0,u._)([(0,l.j)("esri.rest.knowledgeGraph.GraphQuery")],c));(0,u._)([(0,s.Cb)()],p.prototype,"bindParameters",void 0),(0,u._)([(0,s.Cb)()],p.prototype,"bindGeometryQuantizationParameters",void 0),(0,u._)([(0,s.Cb)()],p.prototype,"outputQuantizationParameters",void 0),(0,u._)([(0,s.Cb)()],p.prototype,"outputSpatialReference",void 0),(0,u._)([(0,s.Cb)()],p.prototype,"provenanceBehavior",void 0);var d=p=(0,u._)([(0,l.j)("esri.rest.knowledgeGraph.GraphQueryStreaming")],p)},2736:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=(t(32718),t(93169),t(84936),t(10064),t(69912)),l=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){return(0,i.Z)(this,t),n.call(this,e)}return(0,r.Z)(t)}(t(92364).Z),c=l=(0,u._)([(0,s.j)("esri.rest.knowledgeGraph.ObjectValue")],l)},11933:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=t(46784),l=t(49861),c=(t(93169),t(32718),t(84936),t(69912)),p=t(92364),d=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).path=null,r}return(0,r.Z)(t)}(s.wq);(0,u._)([(0,l.Cb)({type:[p.Z],json:{write:!0}})],d.prototype,"path",void 0);var f=d=(0,u._)([(0,c.j)("esri.rest.knowledgeGraph.Path")],d)},49074:function(e,n,t){t.d(n,{Z:function(){return f}});var r=t(43144),i=t(15671),a=t(60136),o=t(29388),u=t(27366),s=(t(59486),t(49861)),l=(t(93169),t(32718),t(84936),t(69912)),c=t(25695),p=t(29909),d=function(e){(0,a.Z)(t,e);var n=(0,o.Z)(t);function t(e){var r;return(0,i.Z)(this,t),(r=n.call(this,e)).originId=null,r.destinationId=null,r.layoutGeometry=null,r}return(0,r.Z)(t)}(c.Z);(0,u._)([(0,s.Cb)({type:String,json:{write:!0}})],d.prototype,"originId",void 0),(0,u._)([(0,s.Cb)({type:String,json:{write:!0}})],d.prototype,"destinationId",void 0),(0,u._)([(0,s.Cb)({type:p.Z,json:{write:!0}})],d.prototype,"layoutGeometry",void 0);var f=d=(0,u._)([(0,l.j)("esri.rest.knowledgeGraph.Relationship")],d)},23084:function(e,n,t){t.d(n,{LP:function(){return d},cv:function(){return p},en:function(){return c},lA:function(){return l}});var r=t(1413),i=t(42265),a=t(19545),o=t(84652),u=t(35995),s=t(66660);function l(e,n){return n?(0,r.Z)((0,r.Z)({},n),{},{query:(0,r.Z)((0,r.Z)({},null!==e&&void 0!==e?e:{}),n.query)}):{query:e}}function c(e){return"string"==typeof e?(0,u.mN)(e):(0,o.d9)(e)}function p(e,n,t){var r={};for(var i in e)if("declaredClass"!==i){var a=e[i];if(null!=a&&"function"!=typeof a)if(Array.isArray(a))r[i]=a.map((function(e){return p(e)}));else if("object"==typeof a)if(a.toJSON){var o=a.toJSON(null===t||void 0===t?void 0:t[i]);r[i]=n?o:JSON.stringify(o)}else r[i]=n?a:JSON.stringify(a);else r[i]=a}return r}function d(e,n){var t;return e?(0,s.r)(e)&&(n||i.Z.apiKey)?n||i.Z.apiKey:null===a.id||void 0===a.id||null===(t=a.id.findCredential(e))||void 0===t?void 0:t.token:null}},23037:function(e,n,t){t.d(n,{Bf:function(){return h},Bj:function(){return k},Df:function(){return v},Py:function(){return w},Qs:function(){return G},Us:function(){return _},aL:function(){return x},iG:function(){return b},ql:function(){return T},se:function(){return m},vZ:function(){return g},zb:function(){return I}});var r,i=t(29439),a=t(54557),o=t(42265),u=t(80987),s=t(32718),l=t(92026),c=t(35995),p=t(25243),d=t(32551),f=t(68954),y=function(){return s.Z.getLogger("esri.support.basemapUtils")};function v(){return{}}function h(e){for(var n in e){var t=e[n];(0,l.SC)(t),delete e[n]}}function m(e,n){var t,r;if("string"==typeof e){var u=e in f.s,s=!u&&e.includes("/");if(!u&&!s){var l=Object.entries(f.s).filter((function(e){var n=(0,i.Z)(e,2),t=(n[0],n[1]);return o.Z.apiKey&&!t.classic||!o.Z.apiKey&&(t.classic||t.is3d)})).map((function(e){var n=(0,i.Z)(e,1)[0];return'"'.concat(n,'"')})).sort().join(", ");return y().warn("Unable to find basemap definition for: ".concat(e,". Try one of these: ").concat(l)),null}n&&(r=n[e]),r||(r=u?a.default.fromId(e):new a.default({style:{id:e}}),n&&(n[e]=r))}else r=(0,p.se)(a.default,e);return null!==(t=r)&&void 0!==t&&t.destroyed&&(y().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function b(e){var n;return"Web Scene"===(null===(n=e.portalItem)||void 0===n?void 0:n.type)||e.referenceLayers.some((function(e){return"scene"===e.type}))}function g(e){var n,t;return!(null===e||void 0===e||null===(n=e.portalItem)||void 0===n||null===(t=n.tags)||void 0===t||!t.some((function(e){return"beta"===e.toLowerCase()})))}function T(e,n){var t,r,i,a;return(null===(t=e.basemap)||void 0===t||null===(r=t.referenceLayers)||void 0===r?void 0:r.some((function(e){return e.uid===n})))||(null===(i=e.basemap)||void 0===i||null===(a=i.baseLayers)||void 0===a?void 0:a.some((function(e){return e.uid===n})))}function w(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=m(e);if(!t)return null;var r=t.clone();return n&&(r.baseLayers=Z(r.baseLayers,n.baseLayers),r.referenceLayers=Z(r.referenceLayers,n.referenceLayers)),r}function k(e,n){var t,r;return e===n||(null!=(null===e||void 0===e||null===(t=e.portalItem)||void 0===t?void 0:t.id)&&e.portalItem.id===(null===n||void 0===n||null===(r=n.portalItem)||void 0===r?void 0:r.id)||"equal"===j(E(e),E(n),{mustMatchReferences:!0}))}function Z(e,n){var t=new u.Z;return e.forEach((function(e){var r=n.find((function(n){return"scene"!==n.type&&A(N(e),N(n))}))||e;t.includes(r)?t.push(e):t.push(r)})),t}function I(e){return!(null===e||void 0===e||!e.baseLayers.concat(e.referenceLayers).some(x))}function x(e){if(C(e.url))return!0;if("vector-tile"===e.type)for(var n in e.sourceNameToSource){var t=e.sourceNameToSource[n];if(C(null===t||void 0===t?void 0:t.sourceUrl))return!0}return!1}function _(e,n){var t,r,i;if(null==n||null==e)return{spatialReference:null,updating:!1};if("not-loaded"===n.loadStatus)return n.load(),{spatialReference:null,updating:!0};if(n.spatialReference)return{spatialReference:n.spatialReference,updating:!1};if(0===n.baseLayers.length)return{spatialReference:null,updating:!1};var a=n.baseLayers.at(0);switch(a.loadStatus){case"not-loaded":a.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}var o=(("supportedSpatialReferences"in a?a.supportedSpatialReferences:null)||["tileInfo"in a?null===(t=a.tileInfo)||void 0===t?void 0:t.spatialReference:a.spatialReference]).filter(Boolean),u=e.spatialReference;return u?{spatialReference:null!==(r=null!==(i=o.find((function(e){return u.equals(e)})))&&void 0!==i?i:o[0])&&void 0!==r?r:null,updating:!1}:{spatialReference:o[0],updating:!1}}var S=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function C(e){if(!e)return!1;var n=new c.R9((0,c.hF)(e));return!!n.authority&&S.test(n.authority)}function E(e){return e?!e.loaded&&e.resourceInfo?D(e.resourceInfo.data):{baseLayers:L(e.baseLayers),referenceLayers:L(e.referenceLayers)}:null}function L(e){return(u.Z.isCollection(e)?e.toArray():e).map(N)}function N(e){var n,t;return{type:e.type,effect:"effect"in e?e.effect:void 0,url:O("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl||""),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible,sublayers:"map-image"!==e.type&&"wms"!==e.type||null==e.sublayers||null===(n=e.sublayers)||void 0===n?void 0:n.map((function(e){return{id:e.id,visible:e.visible}})),activeLayerId:"wmts"===e.type?null===(t=e.activeLayer)||void 0===t?void 0:t.id:void 0}}function M(e){return e.isReference||"ArcGISSceneServiceLayer"===e.layerType}function D(e){var n,t;return e?{baseLayers:R((null!==(n=e.baseMapLayers)&&void 0!==n?n:[]).filter((function(e){return!M(e)}))),referenceLayers:R((null!==(t=e.baseMapLayers)&&void 0!==t?t:[]).filter((function(e){return M(e)})))}:null}function R(e){return e.map((function(e){return function(e){var n,t,r,i;switch(e.layerType){case"VectorTileLayer":i="vector-tile";break;case"ArcGISTiledMapServiceLayer":i="tile";break;case"ArcGISSceneServiceLayer":i="scene";break;default:i="unknown"}return{type:i,effect:e.effect,url:O(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!==(n=e.minScale)&&void 0!==n?n:0,maxScale:null!==(t=e.maxScale)&&void 0!==t?t:0,opacity:null!==(r=e.opacity)&&void 0!==r?r:1,visible:null==e.visibility||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}(e)}))}function j(e,n,t){return null!=e!=(null!=n)?"not-equal":e&&n?q(e.baseLayers,n.baseLayers)?q(e.referenceLayers,n.referenceLayers)?"equal":t.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function q(e,n){if(e.length!==n.length)return!1;for(var t=0;t<e.length;t++)if(!A(e[t],n[t]))return!1;return!0}function A(e,n){if(e.type!==n.type||e.url!==n.url||e.minScale!==n.minScale||e.maxScale!==n.maxScale||e.visible!==n.visible||e.opacity!==n.opacity)return!1;if(!(0,d.yQ)(e.effect,n.effect))return!1;if(null!=e.activeLayerId||null!=n.activeLayerId)return e.activeLayerId===n.activeLayerId;if(null!=e.sublayers||null!=n.sublayers){if(null==e.sublayers||null==n.sublayers||e.sublayers.length!==n.sublayers.length)return!1;for(var t=0;t<e.sublayers.length;t++){var r=e.sublayers.at(t),i=n.sublayers.at(t);if((null===r||void 0===r?void 0:r.id)!==(null===i||void 0===i?void 0:i.id)||(null===r||void 0===r?void 0:r.visible)!==(null===i||void 0===i?void 0:i.visible))return!1}}return!0}function O(e){return e?(0,c.Fv)(e).replace(/^\s*https?:/i,"").toLowerCase():""}function G(e){if(!e)return null;var n=e.thumbnailUrl;if(n)return n;var t=function(e){if(r)return r(e);var n=null,t=E(e),i=!(null!==t&&void 0!==t&&t.baseLayers.length);for(var a in f.s){var o=j(t,D(f.s[a]),{mustMatchReferences:i});if("equal"===o){n=a;break}"base-layers-equal"===o&&(n=a)}return n}(e);return t?f.s[t].thumbnailUrl:(0,l.ei)(e.baseLayers,F)}function F(e){var n;return"portalItem"in e?null===(n=e.portalItem)||void 0===n?void 0:n.thumbnailUrl:void 0}}}]);
//# sourceMappingURL=37608.8b78d2d4.chunk.js.map