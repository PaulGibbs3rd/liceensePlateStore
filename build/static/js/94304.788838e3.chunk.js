"use strict";(self.webpackChunkreact_training=self.webpackChunkreact_training||[]).push([[94304],{59001:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(74165),i=r(15861),a=r(15671),u=r(43144),s=r(82272),h=r(51e3),c=function(){function e(){(0,a.Z)(this,e),this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}return(0,u.Z)(e,[{key:"destroy",value:function(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}},{key:"getResource",value:function(e){var t;return null!==(t=this._resourceMap.get(e))&&void 0!==t?t:null}},{key:"fetchResource",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,a,u=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this._resourceMap.get(t))){e.next=3;break}return e.abrupt("return",{width:i.width,height:i.height});case 3:return a=this._inFlightResourceMap.get(t),e.abrupt("return",a?a.then((function(e){return{width:e.width,height:e.height}})):(a=(0,h.n$)(t,r),this._inFlightResourceMap.set(t,a),a.then((function(e){return u._inFlightResourceMap.delete(t),u._resourceMap.set(t,e),{width:e.width,height:e.height}}),(function(){return{width:0,height:0}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteResource",value:function(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}},{key:"loadFont",value:function(e){return(0,s.mx)(e)}}]),e}()},94304:function(e,t,r){r.r(t),r.d(t,{CIMSymbolRasterizer:function(){return y}});var n=r(74165),i=r(15861),a=r(15671),u=r(43144),s=r(59001),h=r(28222),c=r(78915),o=r(26707),l=r(31027),g=96/72,y=function(){function e(t){(0,a.Z)(this,e),this._spatialReference=t,this._imageDataCanvas=null,this._cimResourceManager=new s.Z}return(0,u.Z)(e,[{key:"_canvas",get:function(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}},{key:"resourceManager",get:function(){return this._cimResourceManager}},{key:"rasterizeCIMSymbolAsync",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,a,u,s,h,g,y){var f,p,m,w,v,b,M,_,k,R,x,C,Z,I,S,F,P,D,z,E,$,B,A;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if((f=t.data)&&"CIMSymbolReference"===f.type&&f.symbol){e.next=5;break}return e.abrupt("return",null);case 5:return p=f.symbol,s||(s=(0,l.JW)(p)),e.next=9,o.E.resolveSymbolOverrides(f,r,this._spatialReference,u,s,h,g);case 9:if(m=e.sent,w=this._cimResourceManager,v=[],c.B$.fetchResources(m,w,v),c.B$.fetchFonts(m,w,v),e.t0=v.length>0,!e.t0){e.next=18;break}return e.next=18,Promise.all(v);case 18:if(b=i.width,M=i.height,_=d(s,b,M,a),k=c.B$.getEnvelope(m,_,w)){e.next=21;break}return e.abrupt("return",null);case 21:R=1,x=0,C=0,e.t1=p.type,e.next="CIMPointSymbol"===e.t1||"CIMTextSymbol"===e.t1?25:"CIMLineSymbol"===e.t1?30:"CIMPolygonSymbol"===e.t1?34:37;break;case 25:return Z=1,k.width>b&&(Z=b/k.width),I=1,k.height>M&&(I=M/k.height),"preview"===a&&(k.width<b&&(Z=b/k.width),k.height<M&&(I=M/k.height)),R=Math.min(Z,I),x=k.x+k.width/2,C=k.y+k.height/2,e.abrupt("break",37);case 30:return(y||k.height>M)&&(R=M/k.height),C=k.y+k.height/2,S=k.x*R+b/2,F=(k.x+k.width)*R+b/2,(P=_.paths)[0][0][0]-=S/R,P[0][2][0]-=(F-b)/R,e.abrupt("break",37);case 34:x=k.x+k.width/2,C=k.y+k.height/2,D=k.x*R+b/2,z=(k.x+k.width)*R+b/2,E=k.y*R+M/2,$=(k.y+k.height)*R+M/2,B=_.rings,D<0&&(B[0][0][0]-=D,B[0][3][0]-=D,B[0][4][0]-=D),E<0&&(B[0][0][1]+=E,B[0][1][1]+=E,B[0][4][1]+=E),z>b&&(B[0][1][0]-=z-b,B[0][2][0]-=z-b),$>M&&(B[0][2][1]+=$-M,B[0][3][1]+=$-M);case 37:return A={type:"cim",data:{type:"CIMSymbolReference",symbol:m}},e.abrupt("return",this.rasterize(A,b,M,x,C,R,s,1,_));case 39:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,u,s,h,c){return e.apply(this,arguments)}}()},{key:"rasterize",value:function(e,t,r,n,i,a,u){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,o=e.data;if(!o||"CIMSymbolReference"!==o.type||!o.symbol)return null;var y=o.symbol,f=this._canvas,p=(window.devicePixelRatio||1)*g;f.width=t*p,f.height=r*p,u||(u=(0,l.JW)(y)),c||(c=d(u,t,r,"legend")),f.width+=2*s,f.height+=2*s;var m=f.getContext("2d",{willReadFrequently:!0}),w=h.zA.createIdentity();return w.translate(-n,-i),w.scale(a*p,-a*p),w.translate(t*p/2+s,r*p/2+s),m.clearRect(0,0,f.width,f.height),new h.cD(m,this._cimResourceManager,w,!0).drawSymbol(y,c),m.getImageData(0,0,f.width,f.height)}}]),e}();function d(e,t,r,n){var i=-t/2+1,a=t/2-1,u=r/2-1,s=-r/2+1;switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[i,0],[0,0],[a,0]]]};default:return"legend"===n?{rings:[[[i,u],[a,0],[a,s],[i,s],[i,u]]]}:{rings:[[[i,u],[a,u],[a,s],[i,s],[i,u]]]}}}}}]);
//# sourceMappingURL=94304.788838e3.chunk.js.map